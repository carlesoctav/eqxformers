module @jit_train_step attributes {mhlo.num_partitions = 4 : i32, mhlo.num_replicas = 1 : i32} {
  sdy.mesh @mesh = <["dp"=4]>
  sdy.mesh @empty_mesh = <[]>
  func.func public @main(%arg0: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg1: tensor<512x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg2: tensor<2x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg3: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg4: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg5: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg6: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg7: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg8: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg9: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg10: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg11: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg12: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg13: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg14: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg15: tensor<12x3072x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg16: tensor<12x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg17: tensor<12x768x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg18: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg19: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg20: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg21: tensor<768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg22: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg23: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg24: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg25: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg26: tensor<30522xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg27: tensor<i32> {sdy.sharding = #sdy.sharding<@empty_mesh, []>}, %arg28: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg29: tensor<512x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg30: tensor<2x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg31: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg32: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg33: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg34: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg35: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg36: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg37: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg38: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg39: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg40: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg41: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg42: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg43: tensor<12x3072x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg44: tensor<12x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg45: tensor<12x768x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg46: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg47: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg48: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg49: tensor<768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg50: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg51: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg52: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg53: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg54: tensor<30522xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg55: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg56: tensor<512x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg57: tensor<2x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg58: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg59: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg60: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg61: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg62: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg63: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg64: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg65: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg66: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg67: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg68: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg69: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg70: tensor<12x3072x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg71: tensor<12x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg72: tensor<12x768x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg73: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg74: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg75: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg76: tensor<768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg77: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg78: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg79: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg80: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg81: tensor<30522xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg82: tensor<i32> {sdy.sharding = #sdy.sharding<@empty_mesh, []>}, %arg83: tensor<64x512xi32> {sdy.sharding = #sdy.sharding<@mesh, [{"dp"}, {}]>}, %arg84: tensor<64x512xi32> {sdy.sharding = #sdy.sharding<@mesh, [{"dp"}, {}]>}, %arg85: tensor<64x512xi32> {sdy.sharding = #sdy.sharding<@mesh, [{"dp"}, {}]>}, %arg86: tensor<64x512xi32> {sdy.sharding = #sdy.sharding<@mesh, [{"dp"}, {}]>}, %arg87: tensor<2xui32>) -> (tensor<i32> {jax.result_info = "result[0]"}, tensor<30522x768xbf16> {jax.result_info = "result[1][0].bert.embeddings.word_embeddings.weight"}, tensor<512x768xbf16> {jax.result_info = "result[1][0].bert.embeddings.position_embeddings.weight"}, tensor<2x768xbf16> {jax.result_info = "result[1][0].bert.embeddings.token_type_embeddings.weight"}, tensor<768xbf16> {jax.result_info = "result[1][0].bert.embeddings.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][0].bert.embeddings.layer_norm.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.query.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.query.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.key.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.key.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.value.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.value.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.output.layer_norm.bias"}, tensor<12x3072x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.intermediate.dense.weight"}, tensor<12x3072xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.intermediate.dense.bias"}, tensor<12x768x3072xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.output.layer_norm.bias"}, tensor<768x768xbf16> {jax.result_info = "result[1][0].mlm_head.dense.weight"}, tensor<768xbf16> {jax.result_info = "result[1][0].mlm_head.dense.bias"}, tensor<768xbf16> {jax.result_info = "result[1][0].mlm_head.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][0].mlm_head.layer_norm.bias"}, tensor<30522x768xbf16> {jax.result_info = "result[1][0].mlm_head.lm_head.pytree[0].weight"}, tensor<30522xbf16> {jax.result_info = "result[1][0].mlm_head.bias"}, tensor<i32> {jax.result_info = "result[1][1].opt_state[1][0].count"}, tensor<30522x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.embeddings.word_embeddings.weight"}, tensor<512x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.embeddings.position_embeddings.weight"}, tensor<2x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.embeddings.token_type_embeddings.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.embeddings.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.embeddings.layer_norm.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.self_attention.query.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.self_attention.query.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.self_attention.key.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.self_attention.key.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.self_attention.value.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.self_attention.value.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.attention.output.layer_norm.bias"}, tensor<12x3072x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.intermediate.dense.weight"}, tensor<12x3072xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.intermediate.dense.bias"}, tensor<12x768x3072xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.bert.encoder.layers.output.layer_norm.bias"}, tensor<768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.mlm_head.dense.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.mlm_head.dense.bias"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.mlm_head.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.mlm_head.layer_norm.bias"}, tensor<30522x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.mlm_head.lm_head.pytree[0].weight"}, tensor<30522xbf16> {jax.result_info = "result[1][1].opt_state[1][0].mu.mlm_head.bias"}, tensor<30522x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.embeddings.word_embeddings.weight"}, tensor<512x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.embeddings.position_embeddings.weight"}, tensor<2x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.embeddings.token_type_embeddings.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.embeddings.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.embeddings.layer_norm.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.self_attention.query.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.self_attention.query.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.self_attention.key.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.self_attention.key.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.self_attention.value.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.self_attention.value.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.attention.output.layer_norm.bias"}, tensor<12x3072x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.intermediate.dense.weight"}, tensor<12x3072xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.intermediate.dense.bias"}, tensor<12x768x3072xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.bert.encoder.layers.output.layer_norm.bias"}, tensor<768x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.mlm_head.dense.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.mlm_head.dense.bias"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.mlm_head.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.mlm_head.layer_norm.bias"}, tensor<30522x768xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.mlm_head.lm_head.pytree[0].weight"}, tensor<30522xbf16> {jax.result_info = "result[1][1].opt_state[1][0].nu.mlm_head.bias"}, tensor<i32> {jax.result_info = "result[1][1].opt_state[1][2].count"}, tensor<i32> {jax.result_info = "result[1][2]['acc'][0]"}, tensor<i32> {jax.result_info = "result[1][2]['acc'][1]"}, tensor<f32> {jax.result_info = "result[1][2]['loss'][0]"}, tensor<i32> {jax.result_info = "result[1][2]['loss'][1]"}, tensor<i32> {jax.result_info = "result[1][2]['total_token']"}) {
    %0 = call @_threefry_split(%arg87) : (tensor<2xui32>) -> tensor<2x2xui32>
    %1 = stablehlo.slice %0 [1:2, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %2 = stablehlo.reshape %1 : (tensor<1x2xui32>) -> tensor<2xui32>
    %3 = stablehlo.iota dim = 0 : tensor<512xi32>
    %4 = stablehlo.broadcast_in_dim %3, dims = [1] : (tensor<512xi32>) -> tensor<1x512xi32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<1x512xi32>) -> tensor<64x512xi32>
    %6 = call @_threefry_split(%2) : (tensor<2xui32>) -> tensor<2x2xui32>
    %7 = stablehlo.slice %6 [0:1, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %8 = stablehlo.reshape %7 : (tensor<1x2xui32>) -> tensor<2xui32>
    %9 = call @_threefry_split(%8) : (tensor<2xui32>) -> tensor<2x2xui32>
    %10 = stablehlo.slice %9 [0:1, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %11 = stablehlo.reshape %10 : (tensor<1x2xui32>) -> tensor<2xui32>
    %12 = stablehlo.slice %9 [1:2, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %13 = stablehlo.reshape %12 : (tensor<1x2xui32>) -> tensor<2xui32>
    %14:2 = call @_take(%arg0, %arg83) : (tensor<30522x768xbf16>, tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>)
    %15:2 = call @_take_15(%arg1, %5) : (tensor<512x768xbf16>, tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>)
    %16 = stablehlo.add %14#0, %15#0 : tensor<64x512x768xbf16>
    %17:2 = call @_take_29(%arg2, %arg85) : (tensor<2x768xbf16>, tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>)
    %18 = stablehlo.add %16, %17#0 : tensor<64x512x768xbf16>
    %19 = stablehlo.convert %18 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %20 = stablehlo.reduce(%19 init: %cst) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %21 = stablehlo.broadcast_in_dim %20, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_0 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %22 = stablehlo.broadcast_in_dim %cst_0, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %23 = stablehlo.divide %21, %22 : tensor<64x512x1xf32>
    %24 = stablehlo.convert %23 : (tensor<64x512x1xf32>) -> tensor<64x512x1xbf16>
    %c = stablehlo.constant dense<0> : tensor<i32>
    %25:4 = call @_var(%18, %c) : (tensor<64x512x768xbf16>, tensor<i32>) -> (tensor<64x512x1xbf16>, tensor<64x512x768xf32>, tensor<f32>, tensor<i1>)
    %cst_1 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %26 = stablehlo.broadcast_in_dim %cst_1, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %27 = stablehlo.maximum %25#0, %26 : tensor<64x512x1xbf16>
    %28 = stablehlo.compare  EQ, %25#0, %27,  FLOAT : (tensor<64x512x1xbf16>, tensor<64x512x1xbf16>) -> tensor<64x512x1xi1>
    %cst_2 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %29 = stablehlo.broadcast_in_dim %cst_2, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_3 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %30 = stablehlo.broadcast_in_dim %cst_3, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %31 = stablehlo.select %28, %29, %30 : tensor<64x512x1xi1>, tensor<64x512x1xbf16>
    %cst_4 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %32 = stablehlo.broadcast_in_dim %cst_4, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %33 = stablehlo.compare  EQ, %32, %27,  FLOAT : (tensor<64x512x1xbf16>, tensor<64x512x1xbf16>) -> tensor<64x512x1xi1>
    %cst_5 = stablehlo.constant dense<2.000000e+00> : tensor<bf16>
    %34 = stablehlo.broadcast_in_dim %cst_5, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_6 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %35 = stablehlo.broadcast_in_dim %cst_6, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %36 = stablehlo.select %33, %34, %35 : tensor<64x512x1xi1>, tensor<64x512x1xbf16>
    %37 = stablehlo.divide %31, %36 : tensor<64x512x1xbf16>
    %cst_7 = stablehlo.constant dense<1.001870e-12> : tensor<bf16>
    %38 = stablehlo.broadcast_in_dim %cst_7, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %39 = stablehlo.add %27, %38 : tensor<64x512x1xbf16>
    %40 = stablehlo.rsqrt %39 : tensor<64x512x1xbf16>
    %41 = stablehlo.divide %40, %39 : tensor<64x512x1xbf16>
    %cst_8 = stablehlo.constant dense<-5.000000e-01> : tensor<bf16>
    %42 = stablehlo.broadcast_in_dim %cst_8, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %43 = stablehlo.multiply %42, %41 : tensor<64x512x1xbf16>
    %44 = stablehlo.broadcast_in_dim %24, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %45 = stablehlo.subtract %18, %44 : tensor<64x512x768xbf16>
    %46 = stablehlo.broadcast_in_dim %40, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %47 = stablehlo.multiply %45, %46 : tensor<64x512x768xbf16>
    %48 = stablehlo.broadcast_in_dim %arg3, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %49 = stablehlo.broadcast_in_dim %48, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %50 = stablehlo.multiply %49, %47 : tensor<64x512x768xbf16>
    %51 = stablehlo.broadcast_in_dim %arg4, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %52 = stablehlo.broadcast_in_dim %51, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %53 = stablehlo.add %50, %52 : tensor<64x512x768xbf16>
    %cst_9 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %54 = call @_bernoulli(%11, %cst_9) : (tensor<2xui32>, tensor<f32>) -> tensor<64x512x768xi1>
    %cst_10 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %55 = stablehlo.broadcast_in_dim %cst_10, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %56 = stablehlo.divide %53, %55 : tensor<64x512x768xbf16>
    %c_11 = stablehlo.constant dense<0> : tensor<i32>
    %57 = call @_where_68(%54, %56, %c_11) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>, tensor<i32>) -> tensor<64x512x768xbf16>
    %c_12 = stablehlo.constant dense<true> : tensor<i1>
    %58 = stablehlo.broadcast_in_dim %c_12, dims = [] : (tensor<i1>) -> tensor<512xi1>
    %59 = stablehlo.broadcast_in_dim %58, dims = [1] : (tensor<512xi1>) -> tensor<512x512xi1>
    %60 = stablehlo.broadcast_in_dim %59, dims = [1, 2] : (tensor<512x512xi1>) -> tensor<64x512x512xi1>
    %61 = stablehlo.broadcast_in_dim %arg84, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %62 = stablehlo.convert %60 : (tensor<64x512x512xi1>) -> tensor<64x512x512xi32>
    %63 = stablehlo.broadcast_in_dim %61, dims = [0, 1, 2] : (tensor<64x512x1xi32>) -> tensor<64x512x512xi32>
    %64 = stablehlo.and %62, %63 : tensor<64x512x512xi32>
    %65 = call @_threefry_split_78(%13) : (tensor<2xui32>) -> tensor<12x2xui32>
    %cst_13 = stablehlo.constant dense<6.400000e+01> : tensor<f32>
    %66 = stablehlo.sqrt %cst_13 : tensor<f32>
    %67 = stablehlo.convert %66 : (tensor<f32>) -> tensor<bf16>
    %68 = stablehlo.broadcast_in_dim %64, dims = [0, 1, 3] : (tensor<64x512x512xi32>) -> tensor<64x512x1x512xi32>
    %cst_14 = stablehlo.constant dense<-3.389530e+38> : tensor<bf16>
    %69:2 = call @_where_91(%68, %cst_14) : (tensor<64x512x1x512xi32>, tensor<bf16>) -> (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>)
    %70:2 = call @_bernoulli_95() : () -> (tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>)
    %c_15 = stablehlo.constant dense<0> : tensor<i32>
    %71 = call @_where_99(%c_15) : (tensor<i32>) -> tensor<64x512x12x512xbf16>
    %72:2 = call @_bernoulli_101() : () -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>)
    %c_16 = stablehlo.constant dense<0> : tensor<i32>
    %73 = call @_where_103(%c_16) : (tensor<i32>) -> tensor<64x512x768xbf16>
    %c_17 = stablehlo.constant dense<0> : tensor<i32>
    %74:3 = call @_var_104(%c_17) : (tensor<i32>) -> (tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>)
    %cst_18 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %75 = stablehlo.broadcast_in_dim %cst_18, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_19 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %76 = stablehlo.broadcast_in_dim %cst_19, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_20 = stablehlo.constant dense<2.000000e+00> : tensor<bf16>
    %77 = stablehlo.broadcast_in_dim %cst_20, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_21 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %78 = stablehlo.broadcast_in_dim %cst_21, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_22 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %79 = stablehlo.broadcast_in_dim %cst_22, dims = [] : (tensor<bf16>) -> tensor<bf16>
    %80:2 = call @_bernoulli_101() : () -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>)
    %c_23 = stablehlo.constant dense<0> : tensor<i32>
    %81 = call @_where_103(%c_23) : (tensor<i32>) -> tensor<64x512x768xbf16>
    %c_24 = stablehlo.constant dense<0> : tensor<i32>
    %82:3 = call @_var_104(%c_24) : (tensor<i32>) -> (tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>)
    %cst_25 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %83 = stablehlo.broadcast_in_dim %cst_25, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_26 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %84 = stablehlo.broadcast_in_dim %cst_26, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_27 = stablehlo.constant dense<2.000000e+00> : tensor<bf16>
    %85 = stablehlo.broadcast_in_dim %cst_27, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_28 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %86 = stablehlo.broadcast_in_dim %cst_28, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_29 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %cst_30 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %cst_31 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %cst_32 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %87 = stablehlo.broadcast_in_dim %cst_32, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_33 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %88 = stablehlo.broadcast_in_dim %cst_33, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %cst_34 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %89 = stablehlo.broadcast_in_dim %cst_34, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_35 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %90 = stablehlo.broadcast_in_dim %cst_35, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_36 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %91 = stablehlo.broadcast_in_dim %cst_36, dims = [] : (tensor<bf16>) -> tensor<12x64x512x12x64xbf16>
    %cst_37 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %92 = stablehlo.broadcast_in_dim %cst_37, dims = [] : (tensor<bf16>) -> tensor<12x64x512x12x64xbf16>
    %cst_38 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %93 = stablehlo.broadcast_in_dim %cst_38, dims = [] : (tensor<f32>) -> tensor<12x64x512x12x512xf32>
    %cst_39 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %94 = stablehlo.broadcast_in_dim %cst_39, dims = [] : (tensor<f32>) -> tensor<12x64x512x12x1xf32>
    %cst_40 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %95 = stablehlo.broadcast_in_dim %cst_40, dims = [] : (tensor<f32>) -> tensor<12x64x512x12x1xf32>
    %c_41 = stablehlo.constant dense<false> : tensor<i1>
    %96 = stablehlo.broadcast_in_dim %c_41, dims = [] : (tensor<i1>) -> tensor<12x64x512x12x512xi1>
    %cst_42 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %97 = stablehlo.broadcast_in_dim %cst_42, dims = [] : (tensor<bf16>) -> tensor<12x64x512x12x512xbf16>
    %cst_43 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %98 = stablehlo.broadcast_in_dim %cst_43, dims = [] : (tensor<bf16>) -> tensor<12x64x512x12x64xbf16>
    %cst_44 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %99 = stablehlo.broadcast_in_dim %cst_44, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_45 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %100 = stablehlo.broadcast_in_dim %cst_45, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %c_46 = stablehlo.constant dense<false> : tensor<i1>
    %101 = stablehlo.broadcast_in_dim %c_46, dims = [] : (tensor<i1>) -> tensor<12x64x512x768xi1>
    %cst_47 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %102 = stablehlo.broadcast_in_dim %cst_47, dims = [] : (tensor<f32>) -> tensor<12x64x512x768xf32>
    %cst_48 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %103 = stablehlo.broadcast_in_dim %cst_48, dims = [] : (tensor<bf16>) -> tensor<12x64x512x1xbf16>
    %cst_49 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %104 = stablehlo.broadcast_in_dim %cst_49, dims = [] : (tensor<bf16>) -> tensor<12x64x512x1xbf16>
    %cst_50 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %105 = stablehlo.broadcast_in_dim %cst_50, dims = [] : (tensor<bf16>) -> tensor<12x64x512x1xbf16>
    %cst_51 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %106 = stablehlo.broadcast_in_dim %cst_51, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %cst_52 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %107 = stablehlo.broadcast_in_dim %cst_52, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %cst_53 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %108 = stablehlo.broadcast_in_dim %cst_53, dims = [] : (tensor<bf16>) -> tensor<12x1x1x768xbf16>
    %cst_54 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %109 = stablehlo.broadcast_in_dim %cst_54, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %cst_55 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %110 = stablehlo.broadcast_in_dim %cst_55, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %cst_56 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %111 = stablehlo.broadcast_in_dim %cst_56, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_57 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %112 = stablehlo.broadcast_in_dim %cst_57, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_58 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %113 = stablehlo.broadcast_in_dim %cst_58, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_59 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %114 = stablehlo.broadcast_in_dim %cst_59, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_60 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %115 = stablehlo.broadcast_in_dim %cst_60, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_61 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %116 = stablehlo.broadcast_in_dim %cst_61, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %cst_62 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %117 = stablehlo.broadcast_in_dim %cst_62, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %c_63 = stablehlo.constant dense<false> : tensor<i1>
    %118 = stablehlo.broadcast_in_dim %c_63, dims = [] : (tensor<i1>) -> tensor<12x64x512x768xi1>
    %cst_64 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %119 = stablehlo.broadcast_in_dim %cst_64, dims = [] : (tensor<f32>) -> tensor<12x64x512x768xf32>
    %cst_65 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %120 = stablehlo.broadcast_in_dim %cst_65, dims = [] : (tensor<bf16>) -> tensor<12x64x512x1xbf16>
    %cst_66 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %121 = stablehlo.broadcast_in_dim %cst_66, dims = [] : (tensor<bf16>) -> tensor<12x64x512x1xbf16>
    %cst_67 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %122 = stablehlo.broadcast_in_dim %cst_67, dims = [] : (tensor<bf16>) -> tensor<12x64x512x1xbf16>
    %cst_68 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %123 = stablehlo.broadcast_in_dim %cst_68, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %cst_69 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %124 = stablehlo.broadcast_in_dim %cst_69, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %cst_70 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %125 = stablehlo.broadcast_in_dim %cst_70, dims = [] : (tensor<bf16>) -> tensor<12x1x1x768xbf16>
    %c_71 = stablehlo.constant dense<0> : tensor<i32>
    %126:88 = stablehlo.while(%iterArg = %arg5, %iterArg_416 = %arg6, %iterArg_417 = %arg7, %iterArg_418 = %arg8, %iterArg_419 = %arg9, %iterArg_420 = %arg10, %iterArg_421 = %arg11, %iterArg_422 = %arg12, %iterArg_423 = %arg13, %iterArg_424 = %arg14, %iterArg_425 = %arg15, %iterArg_426 = %arg16, %iterArg_427 = %arg17, %iterArg_428 = %arg18, %iterArg_429 = %arg19, %iterArg_430 = %arg20, %iterArg_431 = %65, %iterArg_432 = %80#0, %iterArg_433 = %80#1, %iterArg_434 = %cst_29, %iterArg_435 = %72#0, %iterArg_436 = %72#1, %iterArg_437 = %cst_30, %iterArg_438 = %70#0, %iterArg_439 = %70#1, %iterArg_440 = %cst_31, %iterArg_441 = %67, %iterArg_442 = %69#0, %iterArg_443 = %69#1, %iterArg_444 = %71, %iterArg_445 = %73, %iterArg_446 = %74#0, %iterArg_447 = %74#1, %iterArg_448 = %74#2, %iterArg_449 = %81, %iterArg_450 = %82#0, %iterArg_451 = %82#1, %iterArg_452 = %82#2, %iterArg_453 = %76, %iterArg_454 = %75, %iterArg_455 = %78, %iterArg_456 = %77, %iterArg_457 = %79, %iterArg_458 = %84, %iterArg_459 = %83, %iterArg_460 = %86, %iterArg_461 = %85, %iterArg_462 = %c_71, %iterArg_463 = %57, %iterArg_464 = %87, %iterArg_465 = %88, %iterArg_466 = %89, %iterArg_467 = %90, %iterArg_468 = %91, %iterArg_469 = %92, %iterArg_470 = %93, %iterArg_471 = %94, %iterArg_472 = %95, %iterArg_473 = %96, %iterArg_474 = %97, %iterArg_475 = %98, %iterArg_476 = %99, %iterArg_477 = %100, %iterArg_478 = %101, %iterArg_479 = %102, %iterArg_480 = %103, %iterArg_481 = %104, %iterArg_482 = %105, %iterArg_483 = %106, %iterArg_484 = %107, %iterArg_485 = %108, %iterArg_486 = %109, %iterArg_487 = %110, %iterArg_488 = %111, %iterArg_489 = %112, %iterArg_490 = %113, %iterArg_491 = %114, %iterArg_492 = %115, %iterArg_493 = %116, %iterArg_494 = %117, %iterArg_495 = %118, %iterArg_496 = %119, %iterArg_497 = %120, %iterArg_498 = %121, %iterArg_499 = %122, %iterArg_500 = %123, %iterArg_501 = %124, %iterArg_502 = %125) : tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>, tensor<f32>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x512xbf16>, tensor<64x512x768xbf16>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<bf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<i32>, tensor<64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x512xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x512xi1>, tensor<12x64x512x12x512xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x1x1x768xbf16>, tensor<12x768x3072xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x3072x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x1x1x768xbf16>
    cond {
      %c_503 = stablehlo.constant dense<12> : tensor<i32>
      %1452 = stablehlo.compare  LT, %iterArg_462, %c_503,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
      stablehlo.return %1452 : tensor<i1>
    } do {
      %c_503 = stablehlo.constant dense<0> : tensor<i32>
      %c_504 = stablehlo.constant dense<0> : tensor<i32>
      %1452 = stablehlo.dynamic_slice %iterArg, %iterArg_462, %c_503, %c_504, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1453 = stablehlo.reshape %1452 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_505 = stablehlo.constant dense<0> : tensor<i32>
      %1454 = stablehlo.dynamic_slice %iterArg_416, %iterArg_462, %c_505, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1455 = stablehlo.reshape %1454 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_506 = stablehlo.constant dense<0> : tensor<i32>
      %c_507 = stablehlo.constant dense<0> : tensor<i32>
      %1456 = stablehlo.dynamic_slice %iterArg_417, %iterArg_462, %c_506, %c_507, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1457 = stablehlo.reshape %1456 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_508 = stablehlo.constant dense<0> : tensor<i32>
      %1458 = stablehlo.dynamic_slice %iterArg_418, %iterArg_462, %c_508, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1459 = stablehlo.reshape %1458 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_509 = stablehlo.constant dense<0> : tensor<i32>
      %c_510 = stablehlo.constant dense<0> : tensor<i32>
      %1460 = stablehlo.dynamic_slice %iterArg_419, %iterArg_462, %c_509, %c_510, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1461 = stablehlo.reshape %1460 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_511 = stablehlo.constant dense<0> : tensor<i32>
      %1462 = stablehlo.dynamic_slice %iterArg_420, %iterArg_462, %c_511, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1463 = stablehlo.reshape %1462 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_512 = stablehlo.constant dense<0> : tensor<i32>
      %c_513 = stablehlo.constant dense<0> : tensor<i32>
      %1464 = stablehlo.dynamic_slice %iterArg_421, %iterArg_462, %c_512, %c_513, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1465 = stablehlo.reshape %1464 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_514 = stablehlo.constant dense<0> : tensor<i32>
      %1466 = stablehlo.dynamic_slice %iterArg_422, %iterArg_462, %c_514, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1467 = stablehlo.reshape %1466 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_515 = stablehlo.constant dense<0> : tensor<i32>
      %1468 = stablehlo.dynamic_slice %iterArg_423, %iterArg_462, %c_515, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1469 = stablehlo.reshape %1468 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_516 = stablehlo.constant dense<0> : tensor<i32>
      %1470 = stablehlo.dynamic_slice %iterArg_424, %iterArg_462, %c_516, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1471 = stablehlo.reshape %1470 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_517 = stablehlo.constant dense<0> : tensor<i32>
      %c_518 = stablehlo.constant dense<0> : tensor<i32>
      %1472 = stablehlo.dynamic_slice %iterArg_425, %iterArg_462, %c_517, %c_518, sizes = [1, 3072, 768] : (tensor<12x3072x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x3072x768xbf16>
      %1473 = stablehlo.reshape %1472 : (tensor<1x3072x768xbf16>) -> tensor<3072x768xbf16>
      %c_519 = stablehlo.constant dense<0> : tensor<i32>
      %1474 = stablehlo.dynamic_slice %iterArg_426, %iterArg_462, %c_519, sizes = [1, 3072] : (tensor<12x3072xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x3072xbf16>
      %1475 = stablehlo.reshape %1474 : (tensor<1x3072xbf16>) -> tensor<3072xbf16>
      %c_520 = stablehlo.constant dense<0> : tensor<i32>
      %c_521 = stablehlo.constant dense<0> : tensor<i32>
      %1476 = stablehlo.dynamic_slice %iterArg_427, %iterArg_462, %c_520, %c_521, sizes = [1, 768, 3072] : (tensor<12x768x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x3072xbf16>
      %1477 = stablehlo.reshape %1476 : (tensor<1x768x3072xbf16>) -> tensor<768x3072xbf16>
      %c_522 = stablehlo.constant dense<0> : tensor<i32>
      %1478 = stablehlo.dynamic_slice %iterArg_428, %iterArg_462, %c_522, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1479 = stablehlo.reshape %1478 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_523 = stablehlo.constant dense<0> : tensor<i32>
      %1480 = stablehlo.dynamic_slice %iterArg_429, %iterArg_462, %c_523, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1481 = stablehlo.reshape %1480 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_524 = stablehlo.constant dense<0> : tensor<i32>
      %1482 = stablehlo.dynamic_slice %iterArg_430, %iterArg_462, %c_524, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1483 = stablehlo.reshape %1482 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_525 = stablehlo.constant dense<0> : tensor<i32>
      %1484 = stablehlo.dynamic_slice %iterArg_431, %iterArg_462, %c_525, sizes = [1, 2] : (tensor<12x2xui32>, tensor<i32>, tensor<i32>) -> tensor<1x2xui32>
      %1485 = stablehlo.reshape %1484 : (tensor<1x2xui32>) -> tensor<2xui32>
      %1486:40 = func.call @closed_call(%iterArg_432, %iterArg_433, %iterArg_434, %iterArg_435, %iterArg_436, %iterArg_437, %iterArg_438, %iterArg_439, %iterArg_440, %iterArg_441, %iterArg_442, %iterArg_443, %iterArg_444, %iterArg_445, %iterArg_446, %iterArg_447, %iterArg_448, %iterArg_449, %iterArg_450, %iterArg_451, %iterArg_452, %iterArg_453, %iterArg_454, %iterArg_455, %iterArg_456, %iterArg_457, %iterArg_458, %iterArg_459, %iterArg_460, %iterArg_461, %iterArg_463, %1453, %1455, %1457, %1459, %1461, %1463, %1465, %1467, %1469, %1471, %1473, %1475, %1477, %1479, %1481, %1483, %1485) : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>, tensor<f32>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x512xbf16>, tensor<64x512x768xbf16>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<bf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<3072x768xbf16>, tensor<3072xbf16>, tensor<768x3072xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<2xui32>) -> (tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768x768xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x512xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x64xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<1x1x768xbf16>, tensor<768x3072xbf16>, tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<3072x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<1x1x768xbf16>)
      %1487 = stablehlo.broadcast_in_dim %1486#1, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_526 = stablehlo.constant dense<0> : tensor<i32>
      %c_527 = stablehlo.constant dense<0> : tensor<i32>
      %1488 = stablehlo.dynamic_update_slice %iterArg_464, %1487, %iterArg_462, %c_526, %c_527 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1489 = stablehlo.broadcast_in_dim %1486#2, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_528 = stablehlo.constant dense<0> : tensor<i32>
      %c_529 = stablehlo.constant dense<0> : tensor<i32>
      %c_530 = stablehlo.constant dense<0> : tensor<i32>
      %1490 = stablehlo.dynamic_update_slice %iterArg_465, %1489, %iterArg_462, %c_528, %c_529, %c_530 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1491 = stablehlo.broadcast_in_dim %1486#3, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_531 = stablehlo.constant dense<0> : tensor<i32>
      %c_532 = stablehlo.constant dense<0> : tensor<i32>
      %1492 = stablehlo.dynamic_update_slice %iterArg_466, %1491, %iterArg_462, %c_531, %c_532 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1493 = stablehlo.broadcast_in_dim %1486#4, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_533 = stablehlo.constant dense<0> : tensor<i32>
      %c_534 = stablehlo.constant dense<0> : tensor<i32>
      %1494 = stablehlo.dynamic_update_slice %iterArg_467, %1493, %iterArg_462, %c_533, %c_534 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1495 = stablehlo.broadcast_in_dim %1486#5, dims = [1, 2, 3, 4] : (tensor<64x512x12x64xbf16>) -> tensor<1x64x512x12x64xbf16>
      %c_535 = stablehlo.constant dense<0> : tensor<i32>
      %c_536 = stablehlo.constant dense<0> : tensor<i32>
      %c_537 = stablehlo.constant dense<0> : tensor<i32>
      %c_538 = stablehlo.constant dense<0> : tensor<i32>
      %1496 = stablehlo.dynamic_update_slice %iterArg_468, %1495, %iterArg_462, %c_535, %c_536, %c_537, %c_538 : (tensor<12x64x512x12x64xbf16>, tensor<1x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x64xbf16>
      %1497 = stablehlo.broadcast_in_dim %1486#6, dims = [1, 2, 3, 4] : (tensor<64x512x12x64xbf16>) -> tensor<1x64x512x12x64xbf16>
      %c_539 = stablehlo.constant dense<0> : tensor<i32>
      %c_540 = stablehlo.constant dense<0> : tensor<i32>
      %c_541 = stablehlo.constant dense<0> : tensor<i32>
      %c_542 = stablehlo.constant dense<0> : tensor<i32>
      %1498 = stablehlo.dynamic_update_slice %iterArg_469, %1497, %iterArg_462, %c_539, %c_540, %c_541, %c_542 : (tensor<12x64x512x12x64xbf16>, tensor<1x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x64xbf16>
      %1499 = stablehlo.broadcast_in_dim %1486#7, dims = [1, 2, 3, 4] : (tensor<64x512x12x512xf32>) -> tensor<1x64x512x12x512xf32>
      %c_543 = stablehlo.constant dense<0> : tensor<i32>
      %c_544 = stablehlo.constant dense<0> : tensor<i32>
      %c_545 = stablehlo.constant dense<0> : tensor<i32>
      %c_546 = stablehlo.constant dense<0> : tensor<i32>
      %1500 = stablehlo.dynamic_update_slice %iterArg_470, %1499, %iterArg_462, %c_543, %c_544, %c_545, %c_546 : (tensor<12x64x512x12x512xf32>, tensor<1x64x512x12x512xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x512xf32>
      %1501 = stablehlo.broadcast_in_dim %1486#8, dims = [1, 2, 3, 4] : (tensor<64x512x12x1xf32>) -> tensor<1x64x512x12x1xf32>
      %c_547 = stablehlo.constant dense<0> : tensor<i32>
      %c_548 = stablehlo.constant dense<0> : tensor<i32>
      %c_549 = stablehlo.constant dense<0> : tensor<i32>
      %c_550 = stablehlo.constant dense<0> : tensor<i32>
      %1502 = stablehlo.dynamic_update_slice %iterArg_471, %1501, %iterArg_462, %c_547, %c_548, %c_549, %c_550 : (tensor<12x64x512x12x1xf32>, tensor<1x64x512x12x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x1xf32>
      %1503 = stablehlo.broadcast_in_dim %1486#9, dims = [1, 2, 3, 4] : (tensor<64x512x12x1xf32>) -> tensor<1x64x512x12x1xf32>
      %c_551 = stablehlo.constant dense<0> : tensor<i32>
      %c_552 = stablehlo.constant dense<0> : tensor<i32>
      %c_553 = stablehlo.constant dense<0> : tensor<i32>
      %c_554 = stablehlo.constant dense<0> : tensor<i32>
      %1504 = stablehlo.dynamic_update_slice %iterArg_472, %1503, %iterArg_462, %c_551, %c_552, %c_553, %c_554 : (tensor<12x64x512x12x1xf32>, tensor<1x64x512x12x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x1xf32>
      %1505 = stablehlo.broadcast_in_dim %1486#10, dims = [1, 2, 3, 4] : (tensor<64x512x12x512xi1>) -> tensor<1x64x512x12x512xi1>
      %c_555 = stablehlo.constant dense<0> : tensor<i32>
      %c_556 = stablehlo.constant dense<0> : tensor<i32>
      %c_557 = stablehlo.constant dense<0> : tensor<i32>
      %c_558 = stablehlo.constant dense<0> : tensor<i32>
      %1506 = stablehlo.dynamic_update_slice %iterArg_473, %1505, %iterArg_462, %c_555, %c_556, %c_557, %c_558 : (tensor<12x64x512x12x512xi1>, tensor<1x64x512x12x512xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x512xi1>
      %1507 = stablehlo.broadcast_in_dim %1486#11, dims = [1, 2, 3, 4] : (tensor<64x512x12x512xbf16>) -> tensor<1x64x512x12x512xbf16>
      %c_559 = stablehlo.constant dense<0> : tensor<i32>
      %c_560 = stablehlo.constant dense<0> : tensor<i32>
      %c_561 = stablehlo.constant dense<0> : tensor<i32>
      %c_562 = stablehlo.constant dense<0> : tensor<i32>
      %1508 = stablehlo.dynamic_update_slice %iterArg_474, %1507, %iterArg_462, %c_559, %c_560, %c_561, %c_562 : (tensor<12x64x512x12x512xbf16>, tensor<1x64x512x12x512xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x512xbf16>
      %1509 = stablehlo.broadcast_in_dim %1486#12, dims = [1, 2, 3, 4] : (tensor<64x512x12x64xbf16>) -> tensor<1x64x512x12x64xbf16>
      %c_563 = stablehlo.constant dense<0> : tensor<i32>
      %c_564 = stablehlo.constant dense<0> : tensor<i32>
      %c_565 = stablehlo.constant dense<0> : tensor<i32>
      %c_566 = stablehlo.constant dense<0> : tensor<i32>
      %1510 = stablehlo.dynamic_update_slice %iterArg_475, %1509, %iterArg_462, %c_563, %c_564, %c_565, %c_566 : (tensor<12x64x512x12x64xbf16>, tensor<1x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x64xbf16>
      %1511 = stablehlo.broadcast_in_dim %1486#13, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_567 = stablehlo.constant dense<0> : tensor<i32>
      %c_568 = stablehlo.constant dense<0> : tensor<i32>
      %1512 = stablehlo.dynamic_update_slice %iterArg_476, %1511, %iterArg_462, %c_567, %c_568 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1513 = stablehlo.broadcast_in_dim %1486#14, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_569 = stablehlo.constant dense<0> : tensor<i32>
      %c_570 = stablehlo.constant dense<0> : tensor<i32>
      %c_571 = stablehlo.constant dense<0> : tensor<i32>
      %1514 = stablehlo.dynamic_update_slice %iterArg_477, %1513, %iterArg_462, %c_569, %c_570, %c_571 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1515 = stablehlo.broadcast_in_dim %1486#15, dims = [1, 2, 3] : (tensor<64x512x768xi1>) -> tensor<1x64x512x768xi1>
      %c_572 = stablehlo.constant dense<0> : tensor<i32>
      %c_573 = stablehlo.constant dense<0> : tensor<i32>
      %c_574 = stablehlo.constant dense<0> : tensor<i32>
      %1516 = stablehlo.dynamic_update_slice %iterArg_478, %1515, %iterArg_462, %c_572, %c_573, %c_574 : (tensor<12x64x512x768xi1>, tensor<1x64x512x768xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xi1>
      %1517 = stablehlo.broadcast_in_dim %1486#16, dims = [1, 2, 3] : (tensor<64x512x768xf32>) -> tensor<1x64x512x768xf32>
      %c_575 = stablehlo.constant dense<0> : tensor<i32>
      %c_576 = stablehlo.constant dense<0> : tensor<i32>
      %c_577 = stablehlo.constant dense<0> : tensor<i32>
      %1518 = stablehlo.dynamic_update_slice %iterArg_479, %1517, %iterArg_462, %c_575, %c_576, %c_577 : (tensor<12x64x512x768xf32>, tensor<1x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xf32>
      %1519 = stablehlo.broadcast_in_dim %1486#17, dims = [1, 2, 3] : (tensor<64x512x1xbf16>) -> tensor<1x64x512x1xbf16>
      %c_578 = stablehlo.constant dense<0> : tensor<i32>
      %c_579 = stablehlo.constant dense<0> : tensor<i32>
      %c_580 = stablehlo.constant dense<0> : tensor<i32>
      %1520 = stablehlo.dynamic_update_slice %iterArg_480, %1519, %iterArg_462, %c_578, %c_579, %c_580 : (tensor<12x64x512x1xbf16>, tensor<1x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xbf16>
      %1521 = stablehlo.broadcast_in_dim %1486#18, dims = [1, 2, 3] : (tensor<64x512x1xbf16>) -> tensor<1x64x512x1xbf16>
      %c_581 = stablehlo.constant dense<0> : tensor<i32>
      %c_582 = stablehlo.constant dense<0> : tensor<i32>
      %c_583 = stablehlo.constant dense<0> : tensor<i32>
      %1522 = stablehlo.dynamic_update_slice %iterArg_481, %1521, %iterArg_462, %c_581, %c_582, %c_583 : (tensor<12x64x512x1xbf16>, tensor<1x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xbf16>
      %1523 = stablehlo.broadcast_in_dim %1486#19, dims = [1, 2, 3] : (tensor<64x512x1xbf16>) -> tensor<1x64x512x1xbf16>
      %c_584 = stablehlo.constant dense<0> : tensor<i32>
      %c_585 = stablehlo.constant dense<0> : tensor<i32>
      %c_586 = stablehlo.constant dense<0> : tensor<i32>
      %1524 = stablehlo.dynamic_update_slice %iterArg_482, %1523, %iterArg_462, %c_584, %c_585, %c_586 : (tensor<12x64x512x1xbf16>, tensor<1x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xbf16>
      %1525 = stablehlo.broadcast_in_dim %1486#20, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_587 = stablehlo.constant dense<0> : tensor<i32>
      %c_588 = stablehlo.constant dense<0> : tensor<i32>
      %c_589 = stablehlo.constant dense<0> : tensor<i32>
      %1526 = stablehlo.dynamic_update_slice %iterArg_483, %1525, %iterArg_462, %c_587, %c_588, %c_589 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1527 = stablehlo.broadcast_in_dim %1486#21, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_590 = stablehlo.constant dense<0> : tensor<i32>
      %c_591 = stablehlo.constant dense<0> : tensor<i32>
      %c_592 = stablehlo.constant dense<0> : tensor<i32>
      %1528 = stablehlo.dynamic_update_slice %iterArg_484, %1527, %iterArg_462, %c_590, %c_591, %c_592 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1529 = stablehlo.broadcast_in_dim %1486#22, dims = [1, 2, 3] : (tensor<1x1x768xbf16>) -> tensor<1x1x1x768xbf16>
      %c_593 = stablehlo.constant dense<0> : tensor<i32>
      %c_594 = stablehlo.constant dense<0> : tensor<i32>
      %c_595 = stablehlo.constant dense<0> : tensor<i32>
      %1530 = stablehlo.dynamic_update_slice %iterArg_485, %1529, %iterArg_462, %c_593, %c_594, %c_595 : (tensor<12x1x1x768xbf16>, tensor<1x1x1x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x1x1x768xbf16>
      %1531 = stablehlo.broadcast_in_dim %1486#23, dims = [1, 2] : (tensor<768x3072xbf16>) -> tensor<1x768x3072xbf16>
      %c_596 = stablehlo.constant dense<0> : tensor<i32>
      %c_597 = stablehlo.constant dense<0> : tensor<i32>
      %1532 = stablehlo.dynamic_update_slice %iterArg_486, %1531, %iterArg_462, %c_596, %c_597 : (tensor<12x768x3072xbf16>, tensor<1x768x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x3072xbf16>
      %1533 = stablehlo.broadcast_in_dim %1486#24, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_598 = stablehlo.constant dense<0> : tensor<i32>
      %c_599 = stablehlo.constant dense<0> : tensor<i32>
      %c_600 = stablehlo.constant dense<0> : tensor<i32>
      %1534 = stablehlo.dynamic_update_slice %iterArg_487, %1533, %iterArg_462, %c_598, %c_599, %c_600 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1535 = stablehlo.broadcast_in_dim %1486#25, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_601 = stablehlo.constant dense<0> : tensor<i32>
      %c_602 = stablehlo.constant dense<0> : tensor<i32>
      %c_603 = stablehlo.constant dense<0> : tensor<i32>
      %1536 = stablehlo.dynamic_update_slice %iterArg_488, %1535, %iterArg_462, %c_601, %c_602, %c_603 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1537 = stablehlo.broadcast_in_dim %1486#26, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_604 = stablehlo.constant dense<0> : tensor<i32>
      %c_605 = stablehlo.constant dense<0> : tensor<i32>
      %c_606 = stablehlo.constant dense<0> : tensor<i32>
      %1538 = stablehlo.dynamic_update_slice %iterArg_489, %1537, %iterArg_462, %c_604, %c_605, %c_606 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1539 = stablehlo.broadcast_in_dim %1486#27, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_607 = stablehlo.constant dense<0> : tensor<i32>
      %c_608 = stablehlo.constant dense<0> : tensor<i32>
      %c_609 = stablehlo.constant dense<0> : tensor<i32>
      %1540 = stablehlo.dynamic_update_slice %iterArg_490, %1539, %iterArg_462, %c_607, %c_608, %c_609 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1541 = stablehlo.broadcast_in_dim %1486#28, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_610 = stablehlo.constant dense<0> : tensor<i32>
      %c_611 = stablehlo.constant dense<0> : tensor<i32>
      %c_612 = stablehlo.constant dense<0> : tensor<i32>
      %1542 = stablehlo.dynamic_update_slice %iterArg_491, %1541, %iterArg_462, %c_610, %c_611, %c_612 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1543 = stablehlo.broadcast_in_dim %1486#29, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_613 = stablehlo.constant dense<0> : tensor<i32>
      %c_614 = stablehlo.constant dense<0> : tensor<i32>
      %c_615 = stablehlo.constant dense<0> : tensor<i32>
      %1544 = stablehlo.dynamic_update_slice %iterArg_492, %1543, %iterArg_462, %c_613, %c_614, %c_615 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1545 = stablehlo.broadcast_in_dim %1486#30, dims = [1, 2] : (tensor<3072x768xbf16>) -> tensor<1x3072x768xbf16>
      %c_616 = stablehlo.constant dense<0> : tensor<i32>
      %c_617 = stablehlo.constant dense<0> : tensor<i32>
      %1546 = stablehlo.dynamic_update_slice %iterArg_493, %1545, %iterArg_462, %c_616, %c_617 : (tensor<12x3072x768xbf16>, tensor<1x3072x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x3072x768xbf16>
      %1547 = stablehlo.broadcast_in_dim %1486#31, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_618 = stablehlo.constant dense<0> : tensor<i32>
      %c_619 = stablehlo.constant dense<0> : tensor<i32>
      %c_620 = stablehlo.constant dense<0> : tensor<i32>
      %1548 = stablehlo.dynamic_update_slice %iterArg_494, %1547, %iterArg_462, %c_618, %c_619, %c_620 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1549 = stablehlo.broadcast_in_dim %1486#32, dims = [1, 2, 3] : (tensor<64x512x768xi1>) -> tensor<1x64x512x768xi1>
      %c_621 = stablehlo.constant dense<0> : tensor<i32>
      %c_622 = stablehlo.constant dense<0> : tensor<i32>
      %c_623 = stablehlo.constant dense<0> : tensor<i32>
      %1550 = stablehlo.dynamic_update_slice %iterArg_495, %1549, %iterArg_462, %c_621, %c_622, %c_623 : (tensor<12x64x512x768xi1>, tensor<1x64x512x768xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xi1>
      %1551 = stablehlo.broadcast_in_dim %1486#33, dims = [1, 2, 3] : (tensor<64x512x768xf32>) -> tensor<1x64x512x768xf32>
      %c_624 = stablehlo.constant dense<0> : tensor<i32>
      %c_625 = stablehlo.constant dense<0> : tensor<i32>
      %c_626 = stablehlo.constant dense<0> : tensor<i32>
      %1552 = stablehlo.dynamic_update_slice %iterArg_496, %1551, %iterArg_462, %c_624, %c_625, %c_626 : (tensor<12x64x512x768xf32>, tensor<1x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xf32>
      %1553 = stablehlo.broadcast_in_dim %1486#34, dims = [1, 2, 3] : (tensor<64x512x1xbf16>) -> tensor<1x64x512x1xbf16>
      %c_627 = stablehlo.constant dense<0> : tensor<i32>
      %c_628 = stablehlo.constant dense<0> : tensor<i32>
      %c_629 = stablehlo.constant dense<0> : tensor<i32>
      %1554 = stablehlo.dynamic_update_slice %iterArg_497, %1553, %iterArg_462, %c_627, %c_628, %c_629 : (tensor<12x64x512x1xbf16>, tensor<1x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xbf16>
      %1555 = stablehlo.broadcast_in_dim %1486#35, dims = [1, 2, 3] : (tensor<64x512x1xbf16>) -> tensor<1x64x512x1xbf16>
      %c_630 = stablehlo.constant dense<0> : tensor<i32>
      %c_631 = stablehlo.constant dense<0> : tensor<i32>
      %c_632 = stablehlo.constant dense<0> : tensor<i32>
      %1556 = stablehlo.dynamic_update_slice %iterArg_498, %1555, %iterArg_462, %c_630, %c_631, %c_632 : (tensor<12x64x512x1xbf16>, tensor<1x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xbf16>
      %1557 = stablehlo.broadcast_in_dim %1486#36, dims = [1, 2, 3] : (tensor<64x512x1xbf16>) -> tensor<1x64x512x1xbf16>
      %c_633 = stablehlo.constant dense<0> : tensor<i32>
      %c_634 = stablehlo.constant dense<0> : tensor<i32>
      %c_635 = stablehlo.constant dense<0> : tensor<i32>
      %1558 = stablehlo.dynamic_update_slice %iterArg_499, %1557, %iterArg_462, %c_633, %c_634, %c_635 : (tensor<12x64x512x1xbf16>, tensor<1x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xbf16>
      %1559 = stablehlo.broadcast_in_dim %1486#37, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_636 = stablehlo.constant dense<0> : tensor<i32>
      %c_637 = stablehlo.constant dense<0> : tensor<i32>
      %c_638 = stablehlo.constant dense<0> : tensor<i32>
      %1560 = stablehlo.dynamic_update_slice %iterArg_500, %1559, %iterArg_462, %c_636, %c_637, %c_638 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1561 = stablehlo.broadcast_in_dim %1486#38, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_639 = stablehlo.constant dense<0> : tensor<i32>
      %c_640 = stablehlo.constant dense<0> : tensor<i32>
      %c_641 = stablehlo.constant dense<0> : tensor<i32>
      %1562 = stablehlo.dynamic_update_slice %iterArg_501, %1561, %iterArg_462, %c_639, %c_640, %c_641 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1563 = stablehlo.broadcast_in_dim %1486#39, dims = [1, 2, 3] : (tensor<1x1x768xbf16>) -> tensor<1x1x1x768xbf16>
      %c_642 = stablehlo.constant dense<0> : tensor<i32>
      %c_643 = stablehlo.constant dense<0> : tensor<i32>
      %c_644 = stablehlo.constant dense<0> : tensor<i32>
      %1564 = stablehlo.dynamic_update_slice %iterArg_502, %1563, %iterArg_462, %c_642, %c_643, %c_644 : (tensor<12x1x1x768xbf16>, tensor<1x1x1x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x1x1x768xbf16>
      %c_645 = stablehlo.constant dense<1> : tensor<i32>
      %1565 = stablehlo.add %iterArg_462, %c_645 : tensor<i32>
      stablehlo.return %iterArg, %iterArg_416, %iterArg_417, %iterArg_418, %iterArg_419, %iterArg_420, %iterArg_421, %iterArg_422, %iterArg_423, %iterArg_424, %iterArg_425, %iterArg_426, %iterArg_427, %iterArg_428, %iterArg_429, %iterArg_430, %iterArg_431, %iterArg_432, %iterArg_433, %iterArg_434, %iterArg_435, %iterArg_436, %iterArg_437, %iterArg_438, %iterArg_439, %iterArg_440, %iterArg_441, %iterArg_442, %iterArg_443, %iterArg_444, %iterArg_445, %iterArg_446, %iterArg_447, %iterArg_448, %iterArg_449, %iterArg_450, %iterArg_451, %iterArg_452, %iterArg_453, %iterArg_454, %iterArg_455, %iterArg_456, %iterArg_457, %iterArg_458, %iterArg_459, %iterArg_460, %iterArg_461, %1565, %1486#0, %1488, %1490, %1492, %1494, %1496, %1498, %1500, %1502, %1504, %1506, %1508, %1510, %1512, %1514, %1516, %1518, %1520, %1522, %1524, %1526, %1528, %1530, %1532, %1534, %1536, %1538, %1540, %1542, %1544, %1546, %1548, %1550, %1552, %1554, %1556, %1558, %1560, %1562, %1564 : tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>, tensor<f32>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x512xbf16>, tensor<64x512x768xbf16>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<bf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<i32>, tensor<64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x512xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x512xi1>, tensor<12x64x512x12x512xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x1x1x768xbf16>, tensor<12x768x3072xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x3072x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x1x1x768xbf16>
    }
    %127 = stablehlo.transpose %arg21, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %128 = stablehlo.dot_general %126#48, %127, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %129 = stablehlo.broadcast_in_dim %arg22, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %130 = stablehlo.broadcast_in_dim %129, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %131 = stablehlo.add %128, %130 : tensor<64x512x768xbf16>
    %132 = stablehlo.multiply %131, %131 : tensor<64x512x768xbf16>
    %133 = stablehlo.multiply %132, %131 : tensor<64x512x768xbf16>
    %134 = stablehlo.multiply %131, %131 : tensor<64x512x768xbf16>
    %cst_72 = stablehlo.constant dense<3.000000e+00> : tensor<bf16>
    %135 = stablehlo.broadcast_in_dim %cst_72, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %136 = stablehlo.multiply %135, %134 : tensor<64x512x768xbf16>
    %cst_73 = stablehlo.constant dense<4.467770e-02> : tensor<bf16>
    %137 = stablehlo.broadcast_in_dim %cst_73, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %138 = stablehlo.multiply %137, %133 : tensor<64x512x768xbf16>
    %139 = stablehlo.add %131, %138 : tensor<64x512x768xbf16>
    %cst_74 = stablehlo.constant dense<7.968750e-01> : tensor<bf16>
    %140 = stablehlo.broadcast_in_dim %cst_74, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %141 = stablehlo.multiply %140, %139 : tensor<64x512x768xbf16>
    %142 = stablehlo.tanh %141 : tensor<64x512x768xbf16>
    %cst_75 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %143 = stablehlo.broadcast_in_dim %cst_75, dims = [] : (tensor<bf16>) -> tensor<bf16>
    %144 = stablehlo.broadcast_in_dim %143, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %145 = stablehlo.subtract %144, %142 : tensor<64x512x768xbf16>
    %cst_76 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %146 = stablehlo.broadcast_in_dim %cst_76, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %147 = stablehlo.add %146, %142 : tensor<64x512x768xbf16>
    %cst_77 = stablehlo.constant dense<5.000000e-01> : tensor<bf16>
    %148 = stablehlo.broadcast_in_dim %cst_77, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %149 = stablehlo.multiply %148, %147 : tensor<64x512x768xbf16>
    %150 = stablehlo.multiply %131, %149 : tensor<64x512x768xbf16>
    %151 = stablehlo.convert %150 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst_78 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %152 = stablehlo.reduce(%151 init: %cst_78) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %153 = stablehlo.broadcast_in_dim %152, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_79 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %154 = stablehlo.broadcast_in_dim %cst_79, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %155 = stablehlo.divide %153, %154 : tensor<64x512x1xf32>
    %156 = stablehlo.convert %155 : (tensor<64x512x1xf32>) -> tensor<64x512x1xbf16>
    %c_80 = stablehlo.constant dense<0> : tensor<i32>
    %157:4 = call @_var(%150, %c_80) : (tensor<64x512x768xbf16>, tensor<i32>) -> (tensor<64x512x1xbf16>, tensor<64x512x768xf32>, tensor<f32>, tensor<i1>)
    %cst_81 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %158 = stablehlo.broadcast_in_dim %cst_81, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %159 = stablehlo.maximum %157#0, %158 : tensor<64x512x1xbf16>
    %160 = stablehlo.compare  EQ, %157#0, %159,  FLOAT : (tensor<64x512x1xbf16>, tensor<64x512x1xbf16>) -> tensor<64x512x1xi1>
    %cst_82 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %161 = stablehlo.broadcast_in_dim %cst_82, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_83 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %162 = stablehlo.broadcast_in_dim %cst_83, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %163 = stablehlo.select %160, %161, %162 : tensor<64x512x1xi1>, tensor<64x512x1xbf16>
    %cst_84 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %164 = stablehlo.broadcast_in_dim %cst_84, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %165 = stablehlo.compare  EQ, %164, %159,  FLOAT : (tensor<64x512x1xbf16>, tensor<64x512x1xbf16>) -> tensor<64x512x1xi1>
    %cst_85 = stablehlo.constant dense<2.000000e+00> : tensor<bf16>
    %166 = stablehlo.broadcast_in_dim %cst_85, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %cst_86 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %167 = stablehlo.broadcast_in_dim %cst_86, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %168 = stablehlo.select %165, %166, %167 : tensor<64x512x1xi1>, tensor<64x512x1xbf16>
    %169 = stablehlo.divide %163, %168 : tensor<64x512x1xbf16>
    %cst_87 = stablehlo.constant dense<1.001870e-12> : tensor<bf16>
    %170 = stablehlo.broadcast_in_dim %cst_87, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %171 = stablehlo.add %159, %170 : tensor<64x512x1xbf16>
    %172 = stablehlo.rsqrt %171 : tensor<64x512x1xbf16>
    %173 = stablehlo.divide %172, %171 : tensor<64x512x1xbf16>
    %cst_88 = stablehlo.constant dense<-5.000000e-01> : tensor<bf16>
    %174 = stablehlo.broadcast_in_dim %cst_88, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %175 = stablehlo.multiply %174, %173 : tensor<64x512x1xbf16>
    %176 = stablehlo.broadcast_in_dim %156, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %177 = stablehlo.subtract %150, %176 : tensor<64x512x768xbf16>
    %178 = stablehlo.broadcast_in_dim %172, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %179 = stablehlo.multiply %177, %178 : tensor<64x512x768xbf16>
    %180 = stablehlo.broadcast_in_dim %arg23, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %181 = stablehlo.broadcast_in_dim %180, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %182 = stablehlo.multiply %181, %179 : tensor<64x512x768xbf16>
    %183 = stablehlo.broadcast_in_dim %arg24, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %184 = stablehlo.broadcast_in_dim %183, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %185 = stablehlo.add %182, %184 : tensor<64x512x768xbf16>
    %186 = stablehlo.transpose %arg25, dims = [1, 0] : (tensor<30522x768xbf16>) -> tensor<768x30522xbf16>
    %187 = stablehlo.dot_general %185, %186, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x30522xbf16>) -> tensor<64x512x30522xbf16>
    %188 = stablehlo.broadcast_in_dim %arg26, dims = [2] : (tensor<30522xbf16>) -> tensor<1x1x30522xbf16>
    %189 = stablehlo.broadcast_in_dim %188, dims = [0, 1, 2] : (tensor<1x1x30522xbf16>) -> tensor<64x512x30522xbf16>
    %190 = stablehlo.add %187, %189 : tensor<64x512x30522xbf16>
    %191 = stablehlo.convert %190 : (tensor<64x512x30522xbf16>) -> tensor<64x512x30522xf32>
    %c_89 = stablehlo.constant dense<-100> : tensor<i32>
    %192 = stablehlo.broadcast_in_dim %c_89, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %193 = stablehlo.compare  NE, %arg86, %192,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %c_90 = stablehlo.constant dense<0> : tensor<i32>
    %194 = call @_where_232(%193, %arg86, %c_90) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<i32>) -> tensor<64x512xi32>
    %c_91 = stablehlo.constant dense<0> : tensor<i32>
    %195 = call @_where_232(%193, %194, %c_91) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<i32>) -> tensor<64x512xi32>
    %cst_92 = stablehlo.constant dense<0xFF800000> : tensor<f32>
    %196 = stablehlo.reduce(%191 init: %cst_92) applies stablehlo.maximum across dimensions = [2] : (tensor<64x512x30522xf32>, tensor<f32>) -> tensor<64x512xf32>
    %197 = stablehlo.broadcast_in_dim %196, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %198 = stablehlo.broadcast_in_dim %197, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x30522xf32>
    %199 = stablehlo.subtract %191, %198 : tensor<64x512x30522xf32>
    %200 = stablehlo.exponential %199 : tensor<64x512x30522xf32>
    %cst_93 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %201 = stablehlo.reduce(%200 init: %cst_93) applies stablehlo.add across dimensions = [2] : (tensor<64x512x30522xf32>, tensor<f32>) -> tensor<64x512xf32>
    %202 = stablehlo.log %201 : tensor<64x512xf32>
    %203 = stablehlo.broadcast_in_dim %195, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %204:2 = call @take_along_axis(%199, %203) : (tensor<64x512x30522xf32>, tensor<64x512x1xi32>) -> (tensor<64x512x1xf32>, tensor<64x512x1x1xi32>)
    %205 = stablehlo.slice %204#0 [0:64, 0:512, 0:1] : (tensor<64x512x1xf32>) -> tensor<64x512x1xf32>
    %206 = stablehlo.reshape %205 : (tensor<64x512x1xf32>) -> tensor<64x512xf32>
    %207 = stablehlo.subtract %202, %206 : tensor<64x512xf32>
    %cst_94 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %208 = call @_where_256(%193, %207, %cst_94) : (tensor<64x512xi1>, tensor<64x512xf32>, tensor<f32>) -> tensor<64x512xf32>
    %cst_95 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %209 = stablehlo.reduce(%208 init: %cst_95) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512xf32>, tensor<f32>) -> tensor<f32>
    %210 = stablehlo.convert %193 : (tensor<64x512xi1>) -> tensor<64x512xi32>
    %c_96 = stablehlo.constant dense<0> : tensor<i32>
    %211 = stablehlo.reduce(%210 init: %c_96) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512xi32>, tensor<i32>) -> tensor<i32>
    %212 = call @argmax(%191) : (tensor<64x512x30522xf32>) -> tensor<64x512xi32>
    %213 = stablehlo.compare  EQ, %212, %arg86,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %214 = stablehlo.and %213, %193 : tensor<64x512xi1>
    %215 = stablehlo.convert %214 : (tensor<64x512xi1>) -> tensor<64x512xi32>
    %c_97 = stablehlo.constant dense<0> : tensor<i32>
    %216 = stablehlo.reduce(%215 init: %c_97) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512xi32>, tensor<i32>) -> tensor<i32>
    %cst_98 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %217 = stablehlo.broadcast_in_dim %cst_98, dims = [] : (tensor<f32>) -> tensor<f32>
    %218 = stablehlo.broadcast_in_dim %217, dims = [] : (tensor<f32>) -> tensor<64x512xf32>
    %219 = call @_where_274(%193, %218) : (tensor<64x512xi1>, tensor<64x512xf32>) -> tensor<64x512xf32>
    %220 = stablehlo.negate %219 : tensor<64x512xf32>
    %221 = stablehlo.broadcast_in_dim %220, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_99 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %222 = stablehlo.pad %221, %cst_99, low = [0, 0, 0], high = [0, 0, 0], interior = [0, 0, 0] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512x1xf32>
    %223 = call @take_along_axis_275(%204#1, %222) : (tensor<64x512x1x1xi32>, tensor<64x512x1xf32>) -> tensor<64x512x30522xf32>
    %224 = stablehlo.divide %219, %201 : tensor<64x512xf32>
    %225 = stablehlo.broadcast_in_dim %224, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x30522xf32>
    %226 = stablehlo.multiply %225, %200 : tensor<64x512x30522xf32>
    %227 = stablehlo.add %223, %226 : tensor<64x512x30522xf32>
    %228 = stablehlo.convert %227 : (tensor<64x512x30522xf32>) -> tensor<64x512x30522xbf16>
    %cst_100 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %229 = stablehlo.reduce(%228 init: %cst_100) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x30522xbf16>, tensor<bf16>) -> tensor<30522xbf16>
    %230 = stablehlo.reshape %229 : (tensor<30522xbf16>) -> tensor<1x1x30522xbf16>
    %cst_101 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %231 = stablehlo.reduce(%230 init: %cst_101) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x30522xbf16>, tensor<bf16>) -> tensor<30522xbf16>
    %232 = stablehlo.dot_general %228, %185, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x30522xbf16>, tensor<64x512x768xbf16>) -> tensor<30522x768xbf16>
    %233 = stablehlo.transpose %232, dims = [1, 0] : (tensor<30522x768xbf16>) -> tensor<768x30522xbf16>
    %234 = stablehlo.dot_general %228, %186, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x30522xbf16>, tensor<768x30522xbf16>) -> tensor<64x512x768xbf16>
    %235 = stablehlo.transpose %233, dims = [1, 0] : (tensor<768x30522xbf16>) -> tensor<30522x768xbf16>
    %cst_102 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %236 = stablehlo.reduce(%234 init: %cst_102) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %237 = stablehlo.reshape %236 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_103 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %238 = stablehlo.reduce(%237 init: %cst_103) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %239 = stablehlo.broadcast_in_dim %180, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %240 = stablehlo.multiply %239, %234 : tensor<64x512x768xbf16>
    %241 = stablehlo.multiply %234, %179 : tensor<64x512x768xbf16>
    %cst_104 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %242 = stablehlo.reduce(%241 init: %cst_104) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %243 = stablehlo.reshape %242 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_105 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %244 = stablehlo.reduce(%243 init: %cst_105) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %245 = stablehlo.multiply %177, %240 : tensor<64x512x768xbf16>
    %cst_106 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %246 = stablehlo.reduce(%245 init: %cst_106) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<64x512xbf16>
    %247 = stablehlo.reshape %246 : (tensor<64x512xbf16>) -> tensor<64x512x1xbf16>
    %248 = stablehlo.broadcast_in_dim %172, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %249 = stablehlo.multiply %240, %248 : tensor<64x512x768xbf16>
    %250 = stablehlo.negate %249 : tensor<64x512x768xbf16>
    %cst_107 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %251 = stablehlo.reduce(%250 init: %cst_107) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<64x512xbf16>
    %252 = stablehlo.reshape %251 : (tensor<64x512xbf16>) -> tensor<64x512x1xbf16>
    %253 = stablehlo.multiply %247, %175 : tensor<64x512x1xbf16>
    %254 = stablehlo.multiply %253, %169 : tensor<64x512x1xbf16>
    %255 = call @_var_295(%157#1, %157#2, %157#3, %254) : (tensor<64x512x768xf32>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %256 = stablehlo.add %249, %255 : tensor<64x512x768xbf16>
    %257 = stablehlo.convert %252 : (tensor<64x512x1xbf16>) -> tensor<64x512x1xf32>
    %cst_108 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %258 = stablehlo.broadcast_in_dim %cst_108, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %259 = stablehlo.divide %257, %258 : tensor<64x512x1xf32>
    %cst_109 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %260 = stablehlo.reduce(%259 init: %cst_109) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %261 = stablehlo.broadcast_in_dim %260, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %262 = stablehlo.convert %261 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %263 = stablehlo.add %256, %262 : tensor<64x512x768xbf16>
    %264 = stablehlo.multiply %131, %263 : tensor<64x512x768xbf16>
    %265 = stablehlo.multiply %263, %149 : tensor<64x512x768xbf16>
    %cst_110 = stablehlo.constant dense<5.000000e-01> : tensor<bf16>
    %266 = stablehlo.broadcast_in_dim %cst_110, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %267 = stablehlo.multiply %266, %264 : tensor<64x512x768xbf16>
    %268 = stablehlo.multiply %267, %145 : tensor<64x512x768xbf16>
    %269 = stablehlo.multiply %268, %142 : tensor<64x512x768xbf16>
    %270 = stablehlo.add %268, %269 : tensor<64x512x768xbf16>
    %cst_111 = stablehlo.constant dense<7.968750e-01> : tensor<bf16>
    %271 = stablehlo.broadcast_in_dim %cst_111, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %272 = stablehlo.multiply %271, %270 : tensor<64x512x768xbf16>
    %273 = stablehlo.add %265, %272 : tensor<64x512x768xbf16>
    %cst_112 = stablehlo.constant dense<4.467770e-02> : tensor<bf16>
    %274 = stablehlo.broadcast_in_dim %cst_112, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %275 = stablehlo.multiply %274, %272 : tensor<64x512x768xbf16>
    %276 = stablehlo.multiply %275, %136 : tensor<64x512x768xbf16>
    %277 = stablehlo.add %273, %276 : tensor<64x512x768xbf16>
    %cst_113 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %278 = stablehlo.reduce(%277 init: %cst_113) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %279 = stablehlo.reshape %278 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_114 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %280 = stablehlo.reduce(%279 init: %cst_114) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %281 = stablehlo.dot_general %277, %126#48, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %282 = stablehlo.transpose %281, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %283 = stablehlo.dot_general %277, %127, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %284 = stablehlo.transpose %282, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %cst_115 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %285 = stablehlo.broadcast_in_dim %cst_115, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_116 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %286 = stablehlo.broadcast_in_dim %cst_116, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_117 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %287 = stablehlo.broadcast_in_dim %cst_117, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_118 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %288 = stablehlo.broadcast_in_dim %cst_118, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_119 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %289 = stablehlo.broadcast_in_dim %cst_119, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_120 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %290 = stablehlo.broadcast_in_dim %cst_120, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_121 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %291 = stablehlo.broadcast_in_dim %cst_121, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_122 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %292 = stablehlo.broadcast_in_dim %cst_122, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_123 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %293 = stablehlo.broadcast_in_dim %cst_123, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_124 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %294 = stablehlo.broadcast_in_dim %cst_124, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_125 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %295 = stablehlo.broadcast_in_dim %cst_125, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %cst_126 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %296 = stablehlo.broadcast_in_dim %cst_126, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %cst_127 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %297 = stablehlo.broadcast_in_dim %cst_127, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %cst_128 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %298 = stablehlo.broadcast_in_dim %cst_128, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_129 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %299 = stablehlo.broadcast_in_dim %cst_129, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_130 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %300 = stablehlo.broadcast_in_dim %cst_130, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %c_131 = stablehlo.constant dense<0> : tensor<i32>
    %301:63 = stablehlo.while(%iterArg = %126#49, %iterArg_416 = %126#50, %iterArg_417 = %126#51, %iterArg_418 = %126#52, %iterArg_419 = %126#53, %iterArg_420 = %126#54, %iterArg_421 = %126#55, %iterArg_422 = %126#56, %iterArg_423 = %126#57, %iterArg_424 = %126#58, %iterArg_425 = %126#59, %iterArg_426 = %126#60, %iterArg_427 = %126#61, %iterArg_428 = %126#62, %iterArg_429 = %126#63, %iterArg_430 = %126#64, %iterArg_431 = %126#65, %iterArg_432 = %126#66, %iterArg_433 = %126#67, %iterArg_434 = %126#68, %iterArg_435 = %126#69, %iterArg_436 = %126#70, %iterArg_437 = %126#71, %iterArg_438 = %126#72, %iterArg_439 = %126#73, %iterArg_440 = %126#74, %iterArg_441 = %126#75, %iterArg_442 = %126#76, %iterArg_443 = %126#77, %iterArg_444 = %126#78, %iterArg_445 = %126#79, %iterArg_446 = %126#80, %iterArg_447 = %126#81, %iterArg_448 = %126#82, %iterArg_449 = %126#83, %iterArg_450 = %126#84, %iterArg_451 = %126#85, %iterArg_452 = %126#86, %iterArg_453 = %126#87, %iterArg_454 = %67, %iterArg_455 = %69#0, %iterArg_456 = %74#0, %iterArg_457 = %74#1, %iterArg_458 = %82#0, %iterArg_459 = %82#1, %iterArg_460 = %c_131, %iterArg_461 = %283, %iterArg_462 = %285, %iterArg_463 = %286, %iterArg_464 = %287, %iterArg_465 = %288, %iterArg_466 = %289, %iterArg_467 = %290, %iterArg_468 = %291, %iterArg_469 = %292, %iterArg_470 = %293, %iterArg_471 = %294, %iterArg_472 = %295, %iterArg_473 = %296, %iterArg_474 = %297, %iterArg_475 = %298, %iterArg_476 = %299, %iterArg_477 = %300) : tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x512xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x512xi1>, tensor<12x64x512x12x512xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x1x1x768xbf16>, tensor<12x768x3072xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x3072x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x1x1x768xbf16>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<f32>, tensor<i1>, tensor<f32>, tensor<i1>, tensor<i32>, tensor<64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>
    cond {
      %c_478 = stablehlo.constant dense<12> : tensor<i32>
      %1452 = stablehlo.compare  LT, %iterArg_460, %c_478,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
      stablehlo.return %1452 : tensor<i1>
    } do {
      %c_478 = stablehlo.constant dense<12> : tensor<i32>
      %1452 = stablehlo.subtract %c_478, %iterArg_460 : tensor<i32>
      %c_479 = stablehlo.constant dense<1> : tensor<i32>
      %1453 = stablehlo.subtract %1452, %c_479 : tensor<i32>
      %c_480 = stablehlo.constant dense<0> : tensor<i32>
      %c_481 = stablehlo.constant dense<0> : tensor<i32>
      %1454 = stablehlo.dynamic_slice %iterArg, %1453, %c_480, %c_481, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1455 = stablehlo.reshape %1454 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_482 = stablehlo.constant dense<0> : tensor<i32>
      %c_483 = stablehlo.constant dense<0> : tensor<i32>
      %c_484 = stablehlo.constant dense<0> : tensor<i32>
      %1456 = stablehlo.dynamic_slice %iterArg_416, %1453, %c_482, %c_483, %c_484, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1457 = stablehlo.reshape %1456 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_485 = stablehlo.constant dense<0> : tensor<i32>
      %c_486 = stablehlo.constant dense<0> : tensor<i32>
      %1458 = stablehlo.dynamic_slice %iterArg_417, %1453, %c_485, %c_486, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1459 = stablehlo.reshape %1458 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_487 = stablehlo.constant dense<0> : tensor<i32>
      %c_488 = stablehlo.constant dense<0> : tensor<i32>
      %1460 = stablehlo.dynamic_slice %iterArg_418, %1453, %c_487, %c_488, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1461 = stablehlo.reshape %1460 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_489 = stablehlo.constant dense<0> : tensor<i32>
      %c_490 = stablehlo.constant dense<0> : tensor<i32>
      %c_491 = stablehlo.constant dense<0> : tensor<i32>
      %c_492 = stablehlo.constant dense<0> : tensor<i32>
      %1462 = stablehlo.dynamic_slice %iterArg_419, %1453, %c_489, %c_490, %c_491, %c_492, sizes = [1, 64, 512, 12, 64] : (tensor<12x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x64xbf16>
      %1463 = stablehlo.reshape %1462 : (tensor<1x64x512x12x64xbf16>) -> tensor<64x512x12x64xbf16>
      %c_493 = stablehlo.constant dense<0> : tensor<i32>
      %c_494 = stablehlo.constant dense<0> : tensor<i32>
      %c_495 = stablehlo.constant dense<0> : tensor<i32>
      %c_496 = stablehlo.constant dense<0> : tensor<i32>
      %1464 = stablehlo.dynamic_slice %iterArg_420, %1453, %c_493, %c_494, %c_495, %c_496, sizes = [1, 64, 512, 12, 64] : (tensor<12x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x64xbf16>
      %1465 = stablehlo.reshape %1464 : (tensor<1x64x512x12x64xbf16>) -> tensor<64x512x12x64xbf16>
      %c_497 = stablehlo.constant dense<0> : tensor<i32>
      %c_498 = stablehlo.constant dense<0> : tensor<i32>
      %c_499 = stablehlo.constant dense<0> : tensor<i32>
      %c_500 = stablehlo.constant dense<0> : tensor<i32>
      %1466 = stablehlo.dynamic_slice %iterArg_421, %1453, %c_497, %c_498, %c_499, %c_500, sizes = [1, 64, 512, 12, 512] : (tensor<12x64x512x12x512xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x512xf32>
      %1467 = stablehlo.reshape %1466 : (tensor<1x64x512x12x512xf32>) -> tensor<64x512x12x512xf32>
      %c_501 = stablehlo.constant dense<0> : tensor<i32>
      %c_502 = stablehlo.constant dense<0> : tensor<i32>
      %c_503 = stablehlo.constant dense<0> : tensor<i32>
      %c_504 = stablehlo.constant dense<0> : tensor<i32>
      %1468 = stablehlo.dynamic_slice %iterArg_422, %1453, %c_501, %c_502, %c_503, %c_504, sizes = [1, 64, 512, 12, 1] : (tensor<12x64x512x12x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x1xf32>
      %1469 = stablehlo.reshape %1468 : (tensor<1x64x512x12x1xf32>) -> tensor<64x512x12x1xf32>
      %c_505 = stablehlo.constant dense<0> : tensor<i32>
      %c_506 = stablehlo.constant dense<0> : tensor<i32>
      %c_507 = stablehlo.constant dense<0> : tensor<i32>
      %c_508 = stablehlo.constant dense<0> : tensor<i32>
      %1470 = stablehlo.dynamic_slice %iterArg_423, %1453, %c_505, %c_506, %c_507, %c_508, sizes = [1, 64, 512, 12, 1] : (tensor<12x64x512x12x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x1xf32>
      %1471 = stablehlo.reshape %1470 : (tensor<1x64x512x12x1xf32>) -> tensor<64x512x12x1xf32>
      %c_509 = stablehlo.constant dense<0> : tensor<i32>
      %c_510 = stablehlo.constant dense<0> : tensor<i32>
      %c_511 = stablehlo.constant dense<0> : tensor<i32>
      %c_512 = stablehlo.constant dense<0> : tensor<i32>
      %1472 = stablehlo.dynamic_slice %iterArg_424, %1453, %c_509, %c_510, %c_511, %c_512, sizes = [1, 64, 512, 12, 512] : (tensor<12x64x512x12x512xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x512xi1>
      %1473 = stablehlo.reshape %1472 : (tensor<1x64x512x12x512xi1>) -> tensor<64x512x12x512xi1>
      %c_513 = stablehlo.constant dense<0> : tensor<i32>
      %c_514 = stablehlo.constant dense<0> : tensor<i32>
      %c_515 = stablehlo.constant dense<0> : tensor<i32>
      %c_516 = stablehlo.constant dense<0> : tensor<i32>
      %1474 = stablehlo.dynamic_slice %iterArg_425, %1453, %c_513, %c_514, %c_515, %c_516, sizes = [1, 64, 512, 12, 512] : (tensor<12x64x512x12x512xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x512xbf16>
      %1475 = stablehlo.reshape %1474 : (tensor<1x64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
      %c_517 = stablehlo.constant dense<0> : tensor<i32>
      %c_518 = stablehlo.constant dense<0> : tensor<i32>
      %c_519 = stablehlo.constant dense<0> : tensor<i32>
      %c_520 = stablehlo.constant dense<0> : tensor<i32>
      %1476 = stablehlo.dynamic_slice %iterArg_426, %1453, %c_517, %c_518, %c_519, %c_520, sizes = [1, 64, 512, 12, 64] : (tensor<12x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x64xbf16>
      %1477 = stablehlo.reshape %1476 : (tensor<1x64x512x12x64xbf16>) -> tensor<64x512x12x64xbf16>
      %c_521 = stablehlo.constant dense<0> : tensor<i32>
      %c_522 = stablehlo.constant dense<0> : tensor<i32>
      %1478 = stablehlo.dynamic_slice %iterArg_427, %1453, %c_521, %c_522, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1479 = stablehlo.reshape %1478 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_523 = stablehlo.constant dense<0> : tensor<i32>
      %c_524 = stablehlo.constant dense<0> : tensor<i32>
      %c_525 = stablehlo.constant dense<0> : tensor<i32>
      %1480 = stablehlo.dynamic_slice %iterArg_428, %1453, %c_523, %c_524, %c_525, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1481 = stablehlo.reshape %1480 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_526 = stablehlo.constant dense<0> : tensor<i32>
      %c_527 = stablehlo.constant dense<0> : tensor<i32>
      %c_528 = stablehlo.constant dense<0> : tensor<i32>
      %1482 = stablehlo.dynamic_slice %iterArg_429, %1453, %c_526, %c_527, %c_528, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xi1>
      %1483 = stablehlo.reshape %1482 : (tensor<1x64x512x768xi1>) -> tensor<64x512x768xi1>
      %c_529 = stablehlo.constant dense<0> : tensor<i32>
      %c_530 = stablehlo.constant dense<0> : tensor<i32>
      %c_531 = stablehlo.constant dense<0> : tensor<i32>
      %1484 = stablehlo.dynamic_slice %iterArg_430, %1453, %c_529, %c_530, %c_531, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xf32>
      %1485 = stablehlo.reshape %1484 : (tensor<1x64x512x768xf32>) -> tensor<64x512x768xf32>
      %c_532 = stablehlo.constant dense<0> : tensor<i32>
      %c_533 = stablehlo.constant dense<0> : tensor<i32>
      %c_534 = stablehlo.constant dense<0> : tensor<i32>
      %1486 = stablehlo.dynamic_slice %iterArg_431, %1453, %c_532, %c_533, %c_534, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xbf16>
      %1487 = stablehlo.reshape %1486 : (tensor<1x64x512x1xbf16>) -> tensor<64x512x1xbf16>
      %c_535 = stablehlo.constant dense<0> : tensor<i32>
      %c_536 = stablehlo.constant dense<0> : tensor<i32>
      %c_537 = stablehlo.constant dense<0> : tensor<i32>
      %1488 = stablehlo.dynamic_slice %iterArg_432, %1453, %c_535, %c_536, %c_537, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xbf16>
      %1489 = stablehlo.reshape %1488 : (tensor<1x64x512x1xbf16>) -> tensor<64x512x1xbf16>
      %c_538 = stablehlo.constant dense<0> : tensor<i32>
      %c_539 = stablehlo.constant dense<0> : tensor<i32>
      %c_540 = stablehlo.constant dense<0> : tensor<i32>
      %1490 = stablehlo.dynamic_slice %iterArg_433, %1453, %c_538, %c_539, %c_540, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xbf16>
      %1491 = stablehlo.reshape %1490 : (tensor<1x64x512x1xbf16>) -> tensor<64x512x1xbf16>
      %c_541 = stablehlo.constant dense<0> : tensor<i32>
      %c_542 = stablehlo.constant dense<0> : tensor<i32>
      %c_543 = stablehlo.constant dense<0> : tensor<i32>
      %1492 = stablehlo.dynamic_slice %iterArg_434, %1453, %c_541, %c_542, %c_543, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1493 = stablehlo.reshape %1492 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_544 = stablehlo.constant dense<0> : tensor<i32>
      %c_545 = stablehlo.constant dense<0> : tensor<i32>
      %c_546 = stablehlo.constant dense<0> : tensor<i32>
      %1494 = stablehlo.dynamic_slice %iterArg_435, %1453, %c_544, %c_545, %c_546, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1495 = stablehlo.reshape %1494 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_547 = stablehlo.constant dense<0> : tensor<i32>
      %c_548 = stablehlo.constant dense<0> : tensor<i32>
      %c_549 = stablehlo.constant dense<0> : tensor<i32>
      %1496 = stablehlo.dynamic_slice %iterArg_436, %1453, %c_547, %c_548, %c_549, sizes = [1, 1, 1, 768] : (tensor<12x1x1x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x1x1x768xbf16>
      %1497 = stablehlo.reshape %1496 : (tensor<1x1x1x768xbf16>) -> tensor<1x1x768xbf16>
      %c_550 = stablehlo.constant dense<0> : tensor<i32>
      %c_551 = stablehlo.constant dense<0> : tensor<i32>
      %1498 = stablehlo.dynamic_slice %iterArg_437, %1453, %c_550, %c_551, sizes = [1, 768, 3072] : (tensor<12x768x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x3072xbf16>
      %1499 = stablehlo.reshape %1498 : (tensor<1x768x3072xbf16>) -> tensor<768x3072xbf16>
      %c_552 = stablehlo.constant dense<0> : tensor<i32>
      %c_553 = stablehlo.constant dense<0> : tensor<i32>
      %c_554 = stablehlo.constant dense<0> : tensor<i32>
      %1500 = stablehlo.dynamic_slice %iterArg_438, %1453, %c_552, %c_553, %c_554, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1501 = stablehlo.reshape %1500 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_555 = stablehlo.constant dense<0> : tensor<i32>
      %c_556 = stablehlo.constant dense<0> : tensor<i32>
      %c_557 = stablehlo.constant dense<0> : tensor<i32>
      %1502 = stablehlo.dynamic_slice %iterArg_439, %1453, %c_555, %c_556, %c_557, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1503 = stablehlo.reshape %1502 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_558 = stablehlo.constant dense<0> : tensor<i32>
      %c_559 = stablehlo.constant dense<0> : tensor<i32>
      %c_560 = stablehlo.constant dense<0> : tensor<i32>
      %1504 = stablehlo.dynamic_slice %iterArg_440, %1453, %c_558, %c_559, %c_560, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1505 = stablehlo.reshape %1504 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_561 = stablehlo.constant dense<0> : tensor<i32>
      %c_562 = stablehlo.constant dense<0> : tensor<i32>
      %c_563 = stablehlo.constant dense<0> : tensor<i32>
      %1506 = stablehlo.dynamic_slice %iterArg_441, %1453, %c_561, %c_562, %c_563, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1507 = stablehlo.reshape %1506 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_564 = stablehlo.constant dense<0> : tensor<i32>
      %c_565 = stablehlo.constant dense<0> : tensor<i32>
      %c_566 = stablehlo.constant dense<0> : tensor<i32>
      %1508 = stablehlo.dynamic_slice %iterArg_442, %1453, %c_564, %c_565, %c_566, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1509 = stablehlo.reshape %1508 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_567 = stablehlo.constant dense<0> : tensor<i32>
      %c_568 = stablehlo.constant dense<0> : tensor<i32>
      %c_569 = stablehlo.constant dense<0> : tensor<i32>
      %1510 = stablehlo.dynamic_slice %iterArg_443, %1453, %c_567, %c_568, %c_569, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1511 = stablehlo.reshape %1510 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_570 = stablehlo.constant dense<0> : tensor<i32>
      %c_571 = stablehlo.constant dense<0> : tensor<i32>
      %1512 = stablehlo.dynamic_slice %iterArg_444, %1453, %c_570, %c_571, sizes = [1, 3072, 768] : (tensor<12x3072x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x3072x768xbf16>
      %1513 = stablehlo.reshape %1512 : (tensor<1x3072x768xbf16>) -> tensor<3072x768xbf16>
      %c_572 = stablehlo.constant dense<0> : tensor<i32>
      %c_573 = stablehlo.constant dense<0> : tensor<i32>
      %c_574 = stablehlo.constant dense<0> : tensor<i32>
      %1514 = stablehlo.dynamic_slice %iterArg_445, %1453, %c_572, %c_573, %c_574, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1515 = stablehlo.reshape %1514 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_575 = stablehlo.constant dense<0> : tensor<i32>
      %c_576 = stablehlo.constant dense<0> : tensor<i32>
      %c_577 = stablehlo.constant dense<0> : tensor<i32>
      %1516 = stablehlo.dynamic_slice %iterArg_446, %1453, %c_575, %c_576, %c_577, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xi1>
      %1517 = stablehlo.reshape %1516 : (tensor<1x64x512x768xi1>) -> tensor<64x512x768xi1>
      %c_578 = stablehlo.constant dense<0> : tensor<i32>
      %c_579 = stablehlo.constant dense<0> : tensor<i32>
      %c_580 = stablehlo.constant dense<0> : tensor<i32>
      %1518 = stablehlo.dynamic_slice %iterArg_447, %1453, %c_578, %c_579, %c_580, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xf32>
      %1519 = stablehlo.reshape %1518 : (tensor<1x64x512x768xf32>) -> tensor<64x512x768xf32>
      %c_581 = stablehlo.constant dense<0> : tensor<i32>
      %c_582 = stablehlo.constant dense<0> : tensor<i32>
      %c_583 = stablehlo.constant dense<0> : tensor<i32>
      %1520 = stablehlo.dynamic_slice %iterArg_448, %1453, %c_581, %c_582, %c_583, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xbf16>
      %1521 = stablehlo.reshape %1520 : (tensor<1x64x512x1xbf16>) -> tensor<64x512x1xbf16>
      %c_584 = stablehlo.constant dense<0> : tensor<i32>
      %c_585 = stablehlo.constant dense<0> : tensor<i32>
      %c_586 = stablehlo.constant dense<0> : tensor<i32>
      %1522 = stablehlo.dynamic_slice %iterArg_449, %1453, %c_584, %c_585, %c_586, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xbf16>
      %1523 = stablehlo.reshape %1522 : (tensor<1x64x512x1xbf16>) -> tensor<64x512x1xbf16>
      %c_587 = stablehlo.constant dense<0> : tensor<i32>
      %c_588 = stablehlo.constant dense<0> : tensor<i32>
      %c_589 = stablehlo.constant dense<0> : tensor<i32>
      %1524 = stablehlo.dynamic_slice %iterArg_450, %1453, %c_587, %c_588, %c_589, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xbf16>
      %1525 = stablehlo.reshape %1524 : (tensor<1x64x512x1xbf16>) -> tensor<64x512x1xbf16>
      %c_590 = stablehlo.constant dense<0> : tensor<i32>
      %c_591 = stablehlo.constant dense<0> : tensor<i32>
      %c_592 = stablehlo.constant dense<0> : tensor<i32>
      %1526 = stablehlo.dynamic_slice %iterArg_451, %1453, %c_590, %c_591, %c_592, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1527 = stablehlo.reshape %1526 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_593 = stablehlo.constant dense<0> : tensor<i32>
      %c_594 = stablehlo.constant dense<0> : tensor<i32>
      %c_595 = stablehlo.constant dense<0> : tensor<i32>
      %1528 = stablehlo.dynamic_slice %iterArg_452, %1453, %c_593, %c_594, %c_595, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1529 = stablehlo.reshape %1528 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_596 = stablehlo.constant dense<0> : tensor<i32>
      %c_597 = stablehlo.constant dense<0> : tensor<i32>
      %c_598 = stablehlo.constant dense<0> : tensor<i32>
      %1530 = stablehlo.dynamic_slice %iterArg_453, %1453, %c_596, %c_597, %c_598, sizes = [1, 1, 1, 768] : (tensor<12x1x1x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x1x1x768xbf16>
      %1531 = stablehlo.reshape %1530 : (tensor<1x1x1x768xbf16>) -> tensor<1x1x768xbf16>
      %1532:17 = func.call @closed_call_335(%iterArg_454, %iterArg_455, %iterArg_456, %iterArg_457, %iterArg_458, %iterArg_459, %iterArg_461, %1455, %1457, %1459, %1461, %1463, %1465, %1467, %1469, %1471, %1473, %1475, %1477, %1479, %1481, %1483, %1485, %1487, %1489, %1491, %1493, %1495, %1497, %1499, %1501, %1503, %1505, %1507, %1509, %1511, %1513, %1515, %1517, %1519, %1521, %1523, %1525, %1527, %1529, %1531) : (tensor<bf16>, tensor<64x512x12x512xi1>, tensor<f32>, tensor<i1>, tensor<f32>, tensor<i1>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768x768xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x512xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x64xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<1x1x768xbf16>, tensor<768x3072xbf16>, tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<3072x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<1x1x768xbf16>) -> (tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<3072x768xbf16>, tensor<3072xbf16>, tensor<768x3072xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>)
      %1533 = stablehlo.broadcast_in_dim %1532#1, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_599 = stablehlo.constant dense<0> : tensor<i32>
      %c_600 = stablehlo.constant dense<0> : tensor<i32>
      %1534 = stablehlo.dynamic_update_slice %iterArg_462, %1533, %1453, %c_599, %c_600 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1535 = stablehlo.broadcast_in_dim %1532#2, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_601 = stablehlo.constant dense<0> : tensor<i32>
      %1536 = stablehlo.dynamic_update_slice %iterArg_463, %1535, %1453, %c_601 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1537 = stablehlo.broadcast_in_dim %1532#3, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_602 = stablehlo.constant dense<0> : tensor<i32>
      %c_603 = stablehlo.constant dense<0> : tensor<i32>
      %1538 = stablehlo.dynamic_update_slice %iterArg_464, %1537, %1453, %c_602, %c_603 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1539 = stablehlo.broadcast_in_dim %1532#4, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_604 = stablehlo.constant dense<0> : tensor<i32>
      %1540 = stablehlo.dynamic_update_slice %iterArg_465, %1539, %1453, %c_604 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1541 = stablehlo.broadcast_in_dim %1532#5, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_605 = stablehlo.constant dense<0> : tensor<i32>
      %c_606 = stablehlo.constant dense<0> : tensor<i32>
      %1542 = stablehlo.dynamic_update_slice %iterArg_466, %1541, %1453, %c_605, %c_606 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1543 = stablehlo.broadcast_in_dim %1532#6, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_607 = stablehlo.constant dense<0> : tensor<i32>
      %1544 = stablehlo.dynamic_update_slice %iterArg_467, %1543, %1453, %c_607 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1545 = stablehlo.broadcast_in_dim %1532#7, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_608 = stablehlo.constant dense<0> : tensor<i32>
      %c_609 = stablehlo.constant dense<0> : tensor<i32>
      %1546 = stablehlo.dynamic_update_slice %iterArg_468, %1545, %1453, %c_608, %c_609 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1547 = stablehlo.broadcast_in_dim %1532#8, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_610 = stablehlo.constant dense<0> : tensor<i32>
      %1548 = stablehlo.dynamic_update_slice %iterArg_469, %1547, %1453, %c_610 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1549 = stablehlo.broadcast_in_dim %1532#9, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_611 = stablehlo.constant dense<0> : tensor<i32>
      %1550 = stablehlo.dynamic_update_slice %iterArg_470, %1549, %1453, %c_611 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1551 = stablehlo.broadcast_in_dim %1532#10, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_612 = stablehlo.constant dense<0> : tensor<i32>
      %1552 = stablehlo.dynamic_update_slice %iterArg_471, %1551, %1453, %c_612 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1553 = stablehlo.broadcast_in_dim %1532#11, dims = [1, 2] : (tensor<3072x768xbf16>) -> tensor<1x3072x768xbf16>
      %c_613 = stablehlo.constant dense<0> : tensor<i32>
      %c_614 = stablehlo.constant dense<0> : tensor<i32>
      %1554 = stablehlo.dynamic_update_slice %iterArg_472, %1553, %1453, %c_613, %c_614 : (tensor<12x3072x768xbf16>, tensor<1x3072x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x3072x768xbf16>
      %1555 = stablehlo.broadcast_in_dim %1532#12, dims = [1] : (tensor<3072xbf16>) -> tensor<1x3072xbf16>
      %c_615 = stablehlo.constant dense<0> : tensor<i32>
      %1556 = stablehlo.dynamic_update_slice %iterArg_473, %1555, %1453, %c_615 : (tensor<12x3072xbf16>, tensor<1x3072xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x3072xbf16>
      %1557 = stablehlo.broadcast_in_dim %1532#13, dims = [1, 2] : (tensor<768x3072xbf16>) -> tensor<1x768x3072xbf16>
      %c_616 = stablehlo.constant dense<0> : tensor<i32>
      %c_617 = stablehlo.constant dense<0> : tensor<i32>
      %1558 = stablehlo.dynamic_update_slice %iterArg_474, %1557, %1453, %c_616, %c_617 : (tensor<12x768x3072xbf16>, tensor<1x768x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x3072xbf16>
      %1559 = stablehlo.broadcast_in_dim %1532#14, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_618 = stablehlo.constant dense<0> : tensor<i32>
      %1560 = stablehlo.dynamic_update_slice %iterArg_475, %1559, %1453, %c_618 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1561 = stablehlo.broadcast_in_dim %1532#15, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_619 = stablehlo.constant dense<0> : tensor<i32>
      %1562 = stablehlo.dynamic_update_slice %iterArg_476, %1561, %1453, %c_619 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1563 = stablehlo.broadcast_in_dim %1532#16, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_620 = stablehlo.constant dense<0> : tensor<i32>
      %1564 = stablehlo.dynamic_update_slice %iterArg_477, %1563, %1453, %c_620 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %c_621 = stablehlo.constant dense<1> : tensor<i32>
      %1565 = stablehlo.add %iterArg_460, %c_621 : tensor<i32>
      stablehlo.return %iterArg, %iterArg_416, %iterArg_417, %iterArg_418, %iterArg_419, %iterArg_420, %iterArg_421, %iterArg_422, %iterArg_423, %iterArg_424, %iterArg_425, %iterArg_426, %iterArg_427, %iterArg_428, %iterArg_429, %iterArg_430, %iterArg_431, %iterArg_432, %iterArg_433, %iterArg_434, %iterArg_435, %iterArg_436, %iterArg_437, %iterArg_438, %iterArg_439, %iterArg_440, %iterArg_441, %iterArg_442, %iterArg_443, %iterArg_444, %iterArg_445, %iterArg_446, %iterArg_447, %iterArg_448, %iterArg_449, %iterArg_450, %iterArg_451, %iterArg_452, %iterArg_453, %iterArg_454, %iterArg_455, %iterArg_456, %iterArg_457, %iterArg_458, %iterArg_459, %1565, %1532#0, %1534, %1536, %1538, %1540, %1542, %1544, %1546, %1548, %1550, %1552, %1554, %1556, %1558, %1560, %1562, %1564 : tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x512xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x512xi1>, tensor<12x64x512x12x512xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x1x1x768xbf16>, tensor<12x768x3072xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x3072x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x1xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x1x1x768xbf16>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<f32>, tensor<i1>, tensor<f32>, tensor<i1>, tensor<i32>, tensor<64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>
    }
    %302 = call @_where_374(%54, %301#46) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %cst_132 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %303 = stablehlo.broadcast_in_dim %cst_132, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %304 = stablehlo.divide %302, %303 : tensor<64x512x768xbf16>
    %cst_133 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %305 = stablehlo.reduce(%304 init: %cst_133) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %306 = stablehlo.reshape %305 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_134 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %307 = stablehlo.reduce(%306 init: %cst_134) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %308 = stablehlo.broadcast_in_dim %48, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %309 = stablehlo.multiply %308, %304 : tensor<64x512x768xbf16>
    %310 = stablehlo.multiply %304, %47 : tensor<64x512x768xbf16>
    %cst_135 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %311 = stablehlo.reduce(%310 init: %cst_135) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %312 = stablehlo.reshape %311 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_136 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %313 = stablehlo.reduce(%312 init: %cst_136) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %314 = stablehlo.multiply %45, %309 : tensor<64x512x768xbf16>
    %cst_137 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %315 = stablehlo.reduce(%314 init: %cst_137) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<64x512xbf16>
    %316 = stablehlo.reshape %315 : (tensor<64x512xbf16>) -> tensor<64x512x1xbf16>
    %317 = stablehlo.broadcast_in_dim %40, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %318 = stablehlo.multiply %309, %317 : tensor<64x512x768xbf16>
    %319 = stablehlo.negate %318 : tensor<64x512x768xbf16>
    %cst_138 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %320 = stablehlo.reduce(%319 init: %cst_138) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<64x512xbf16>
    %321 = stablehlo.reshape %320 : (tensor<64x512xbf16>) -> tensor<64x512x1xbf16>
    %322 = stablehlo.multiply %316, %43 : tensor<64x512x1xbf16>
    %323 = stablehlo.multiply %322, %37 : tensor<64x512x1xbf16>
    %324 = call @_var_295(%25#1, %25#2, %25#3, %323) : (tensor<64x512x768xf32>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %325 = stablehlo.add %318, %324 : tensor<64x512x768xbf16>
    %326 = stablehlo.convert %321 : (tensor<64x512x1xbf16>) -> tensor<64x512x1xf32>
    %cst_139 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %327 = stablehlo.broadcast_in_dim %cst_139, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %328 = stablehlo.divide %326, %327 : tensor<64x512x1xf32>
    %cst_140 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %329 = stablehlo.reduce(%328 init: %cst_140) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %330 = stablehlo.broadcast_in_dim %329, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %331 = stablehlo.convert %330 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %332 = stablehlo.add %325, %331 : tensor<64x512x768xbf16>
    %333 = call @_take_375(%17#1, %332) : (tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<2x768xbf16>
    %334 = call @_take_379(%15#1, %332) : (tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<512x768xbf16>
    %335 = call @_take_382(%14#1, %332) : (tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<30522x768xbf16>
    %336 = stablehlo.multiply %335, %335 : tensor<30522x768xbf16>
    %337 = stablehlo.convert %336 : (tensor<30522x768xbf16>) -> tensor<30522x768xf32>
    %cst_141 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %338 = stablehlo.reduce(%337 init: %cst_141) applies stablehlo.add across dimensions = [0, 1] : (tensor<30522x768xf32>, tensor<f32>) -> tensor<f32>
    %339 = stablehlo.convert %338 : (tensor<f32>) -> tensor<bf16>
    %cst_142 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %340 = stablehlo.add %cst_142, %339 : tensor<bf16>
    %341 = stablehlo.multiply %334, %334 : tensor<512x768xbf16>
    %342 = stablehlo.convert %341 : (tensor<512x768xbf16>) -> tensor<512x768xf32>
    %cst_143 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %343 = stablehlo.reduce(%342 init: %cst_143) applies stablehlo.add across dimensions = [0, 1] : (tensor<512x768xf32>, tensor<f32>) -> tensor<f32>
    %344 = stablehlo.convert %343 : (tensor<f32>) -> tensor<bf16>
    %345 = stablehlo.add %340, %344 : tensor<bf16>
    %346 = stablehlo.multiply %333, %333 : tensor<2x768xbf16>
    %347 = stablehlo.convert %346 : (tensor<2x768xbf16>) -> tensor<2x768xf32>
    %cst_144 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %348 = stablehlo.reduce(%347 init: %cst_144) applies stablehlo.add across dimensions = [0, 1] : (tensor<2x768xf32>, tensor<f32>) -> tensor<f32>
    %349 = stablehlo.convert %348 : (tensor<f32>) -> tensor<bf16>
    %350 = stablehlo.add %345, %349 : tensor<bf16>
    %351 = stablehlo.multiply %313, %313 : tensor<768xbf16>
    %352 = stablehlo.convert %351 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_145 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %353 = stablehlo.reduce(%352 init: %cst_145) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %354 = stablehlo.convert %353 : (tensor<f32>) -> tensor<bf16>
    %355 = stablehlo.add %350, %354 : tensor<bf16>
    %356 = stablehlo.multiply %307, %307 : tensor<768xbf16>
    %357 = stablehlo.convert %356 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_146 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %358 = stablehlo.reduce(%357 init: %cst_146) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %359 = stablehlo.convert %358 : (tensor<f32>) -> tensor<bf16>
    %360 = stablehlo.add %355, %359 : tensor<bf16>
    %361 = stablehlo.multiply %301#47, %301#47 : tensor<12x768x768xbf16>
    %362 = stablehlo.convert %361 : (tensor<12x768x768xbf16>) -> tensor<12x768x768xf32>
    %cst_147 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %363 = stablehlo.reduce(%362 init: %cst_147) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x768xf32>, tensor<f32>) -> tensor<f32>
    %364 = stablehlo.convert %363 : (tensor<f32>) -> tensor<bf16>
    %365 = stablehlo.add %360, %364 : tensor<bf16>
    %366 = stablehlo.multiply %301#48, %301#48 : tensor<12x768xbf16>
    %367 = stablehlo.convert %366 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_148 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %368 = stablehlo.reduce(%367 init: %cst_148) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %369 = stablehlo.convert %368 : (tensor<f32>) -> tensor<bf16>
    %370 = stablehlo.add %365, %369 : tensor<bf16>
    %371 = stablehlo.multiply %301#49, %301#49 : tensor<12x768x768xbf16>
    %372 = stablehlo.convert %371 : (tensor<12x768x768xbf16>) -> tensor<12x768x768xf32>
    %cst_149 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %373 = stablehlo.reduce(%372 init: %cst_149) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x768xf32>, tensor<f32>) -> tensor<f32>
    %374 = stablehlo.convert %373 : (tensor<f32>) -> tensor<bf16>
    %375 = stablehlo.add %370, %374 : tensor<bf16>
    %376 = stablehlo.multiply %301#50, %301#50 : tensor<12x768xbf16>
    %377 = stablehlo.convert %376 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_150 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %378 = stablehlo.reduce(%377 init: %cst_150) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %379 = stablehlo.convert %378 : (tensor<f32>) -> tensor<bf16>
    %380 = stablehlo.add %375, %379 : tensor<bf16>
    %381 = stablehlo.multiply %301#51, %301#51 : tensor<12x768x768xbf16>
    %382 = stablehlo.convert %381 : (tensor<12x768x768xbf16>) -> tensor<12x768x768xf32>
    %cst_151 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %383 = stablehlo.reduce(%382 init: %cst_151) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x768xf32>, tensor<f32>) -> tensor<f32>
    %384 = stablehlo.convert %383 : (tensor<f32>) -> tensor<bf16>
    %385 = stablehlo.add %380, %384 : tensor<bf16>
    %386 = stablehlo.multiply %301#52, %301#52 : tensor<12x768xbf16>
    %387 = stablehlo.convert %386 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_152 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %388 = stablehlo.reduce(%387 init: %cst_152) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %389 = stablehlo.convert %388 : (tensor<f32>) -> tensor<bf16>
    %390 = stablehlo.add %385, %389 : tensor<bf16>
    %391 = stablehlo.multiply %301#53, %301#53 : tensor<12x768x768xbf16>
    %392 = stablehlo.convert %391 : (tensor<12x768x768xbf16>) -> tensor<12x768x768xf32>
    %cst_153 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %393 = stablehlo.reduce(%392 init: %cst_153) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x768xf32>, tensor<f32>) -> tensor<f32>
    %394 = stablehlo.convert %393 : (tensor<f32>) -> tensor<bf16>
    %395 = stablehlo.add %390, %394 : tensor<bf16>
    %396 = stablehlo.multiply %301#54, %301#54 : tensor<12x768xbf16>
    %397 = stablehlo.convert %396 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_154 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %398 = stablehlo.reduce(%397 init: %cst_154) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %399 = stablehlo.convert %398 : (tensor<f32>) -> tensor<bf16>
    %400 = stablehlo.add %395, %399 : tensor<bf16>
    %401 = stablehlo.multiply %301#55, %301#55 : tensor<12x768xbf16>
    %402 = stablehlo.convert %401 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_155 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %403 = stablehlo.reduce(%402 init: %cst_155) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %404 = stablehlo.convert %403 : (tensor<f32>) -> tensor<bf16>
    %405 = stablehlo.add %400, %404 : tensor<bf16>
    %406 = stablehlo.multiply %301#56, %301#56 : tensor<12x768xbf16>
    %407 = stablehlo.convert %406 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_156 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %408 = stablehlo.reduce(%407 init: %cst_156) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %409 = stablehlo.convert %408 : (tensor<f32>) -> tensor<bf16>
    %410 = stablehlo.add %405, %409 : tensor<bf16>
    %411 = stablehlo.multiply %301#57, %301#57 : tensor<12x3072x768xbf16>
    %412 = stablehlo.convert %411 : (tensor<12x3072x768xbf16>) -> tensor<12x3072x768xf32>
    %cst_157 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %413 = stablehlo.reduce(%412 init: %cst_157) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x3072x768xf32>, tensor<f32>) -> tensor<f32>
    %414 = stablehlo.convert %413 : (tensor<f32>) -> tensor<bf16>
    %415 = stablehlo.add %410, %414 : tensor<bf16>
    %416 = stablehlo.multiply %301#58, %301#58 : tensor<12x3072xbf16>
    %417 = stablehlo.convert %416 : (tensor<12x3072xbf16>) -> tensor<12x3072xf32>
    %cst_158 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %418 = stablehlo.reduce(%417 init: %cst_158) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x3072xf32>, tensor<f32>) -> tensor<f32>
    %419 = stablehlo.convert %418 : (tensor<f32>) -> tensor<bf16>
    %420 = stablehlo.add %415, %419 : tensor<bf16>
    %421 = stablehlo.multiply %301#59, %301#59 : tensor<12x768x3072xbf16>
    %422 = stablehlo.convert %421 : (tensor<12x768x3072xbf16>) -> tensor<12x768x3072xf32>
    %cst_159 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %423 = stablehlo.reduce(%422 init: %cst_159) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x3072xf32>, tensor<f32>) -> tensor<f32>
    %424 = stablehlo.convert %423 : (tensor<f32>) -> tensor<bf16>
    %425 = stablehlo.add %420, %424 : tensor<bf16>
    %426 = stablehlo.multiply %301#60, %301#60 : tensor<12x768xbf16>
    %427 = stablehlo.convert %426 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_160 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %428 = stablehlo.reduce(%427 init: %cst_160) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %429 = stablehlo.convert %428 : (tensor<f32>) -> tensor<bf16>
    %430 = stablehlo.add %425, %429 : tensor<bf16>
    %431 = stablehlo.multiply %301#61, %301#61 : tensor<12x768xbf16>
    %432 = stablehlo.convert %431 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_161 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %433 = stablehlo.reduce(%432 init: %cst_161) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %434 = stablehlo.convert %433 : (tensor<f32>) -> tensor<bf16>
    %435 = stablehlo.add %430, %434 : tensor<bf16>
    %436 = stablehlo.multiply %301#62, %301#62 : tensor<12x768xbf16>
    %437 = stablehlo.convert %436 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_162 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %438 = stablehlo.reduce(%437 init: %cst_162) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %439 = stablehlo.convert %438 : (tensor<f32>) -> tensor<bf16>
    %440 = stablehlo.add %435, %439 : tensor<bf16>
    %441 = stablehlo.multiply %284, %284 : tensor<768x768xbf16>
    %442 = stablehlo.convert %441 : (tensor<768x768xbf16>) -> tensor<768x768xf32>
    %cst_163 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %443 = stablehlo.reduce(%442 init: %cst_163) applies stablehlo.add across dimensions = [0, 1] : (tensor<768x768xf32>, tensor<f32>) -> tensor<f32>
    %444 = stablehlo.convert %443 : (tensor<f32>) -> tensor<bf16>
    %445 = stablehlo.add %440, %444 : tensor<bf16>
    %446 = stablehlo.multiply %280, %280 : tensor<768xbf16>
    %447 = stablehlo.convert %446 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_164 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %448 = stablehlo.reduce(%447 init: %cst_164) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %449 = stablehlo.convert %448 : (tensor<f32>) -> tensor<bf16>
    %450 = stablehlo.add %445, %449 : tensor<bf16>
    %451 = stablehlo.multiply %244, %244 : tensor<768xbf16>
    %452 = stablehlo.convert %451 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_165 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %453 = stablehlo.reduce(%452 init: %cst_165) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %454 = stablehlo.convert %453 : (tensor<f32>) -> tensor<bf16>
    %455 = stablehlo.add %450, %454 : tensor<bf16>
    %456 = stablehlo.multiply %238, %238 : tensor<768xbf16>
    %457 = stablehlo.convert %456 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_166 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %458 = stablehlo.reduce(%457 init: %cst_166) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %459 = stablehlo.convert %458 : (tensor<f32>) -> tensor<bf16>
    %460 = stablehlo.add %455, %459 : tensor<bf16>
    %461 = stablehlo.multiply %235, %235 : tensor<30522x768xbf16>
    %462 = stablehlo.convert %461 : (tensor<30522x768xbf16>) -> tensor<30522x768xf32>
    %cst_167 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %463 = stablehlo.reduce(%462 init: %cst_167) applies stablehlo.add across dimensions = [0, 1] : (tensor<30522x768xf32>, tensor<f32>) -> tensor<f32>
    %464 = stablehlo.convert %463 : (tensor<f32>) -> tensor<bf16>
    %465 = stablehlo.add %460, %464 : tensor<bf16>
    %466 = stablehlo.multiply %231, %231 : tensor<30522xbf16>
    %467 = stablehlo.convert %466 : (tensor<30522xbf16>) -> tensor<30522xf32>
    %cst_168 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %468 = stablehlo.reduce(%467 init: %cst_168) applies stablehlo.add across dimensions = [0] : (tensor<30522xf32>, tensor<f32>) -> tensor<f32>
    %469 = stablehlo.convert %468 : (tensor<f32>) -> tensor<bf16>
    %470 = stablehlo.add %465, %469 : tensor<bf16>
    %471 = stablehlo.sqrt %470 : tensor<bf16>
    %cst_169 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %472 = stablehlo.compare  LT, %471, %cst_169,  FLOAT : (tensor<bf16>, tensor<bf16>) -> tensor<i1>
    %473 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %474 = stablehlo.divide %335, %473 : tensor<30522x768xbf16>
    %cst_170 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %475 = stablehlo.broadcast_in_dim %cst_170, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %476 = stablehlo.multiply %474, %475 : tensor<30522x768xbf16>
    %477 = stablehlo.select %472, %335, %476 : tensor<i1>, tensor<30522x768xbf16>
    %478 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %479 = stablehlo.divide %334, %478 : tensor<512x768xbf16>
    %cst_171 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %480 = stablehlo.broadcast_in_dim %cst_171, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %481 = stablehlo.multiply %479, %480 : tensor<512x768xbf16>
    %482 = stablehlo.select %472, %334, %481 : tensor<i1>, tensor<512x768xbf16>
    %483 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %484 = stablehlo.divide %333, %483 : tensor<2x768xbf16>
    %cst_172 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %485 = stablehlo.broadcast_in_dim %cst_172, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %486 = stablehlo.multiply %484, %485 : tensor<2x768xbf16>
    %487 = stablehlo.select %472, %333, %486 : tensor<i1>, tensor<2x768xbf16>
    %488 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %489 = stablehlo.divide %313, %488 : tensor<768xbf16>
    %cst_173 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %490 = stablehlo.broadcast_in_dim %cst_173, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %491 = stablehlo.multiply %489, %490 : tensor<768xbf16>
    %492 = stablehlo.select %472, %313, %491 : tensor<i1>, tensor<768xbf16>
    %493 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %494 = stablehlo.divide %307, %493 : tensor<768xbf16>
    %cst_174 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %495 = stablehlo.broadcast_in_dim %cst_174, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %496 = stablehlo.multiply %494, %495 : tensor<768xbf16>
    %497 = stablehlo.select %472, %307, %496 : tensor<i1>, tensor<768xbf16>
    %498 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %499 = stablehlo.divide %301#47, %498 : tensor<12x768x768xbf16>
    %cst_175 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %500 = stablehlo.broadcast_in_dim %cst_175, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %501 = stablehlo.multiply %499, %500 : tensor<12x768x768xbf16>
    %502 = stablehlo.select %472, %301#47, %501 : tensor<i1>, tensor<12x768x768xbf16>
    %503 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %504 = stablehlo.divide %301#48, %503 : tensor<12x768xbf16>
    %cst_176 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %505 = stablehlo.broadcast_in_dim %cst_176, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %506 = stablehlo.multiply %504, %505 : tensor<12x768xbf16>
    %507 = stablehlo.select %472, %301#48, %506 : tensor<i1>, tensor<12x768xbf16>
    %508 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %509 = stablehlo.divide %301#49, %508 : tensor<12x768x768xbf16>
    %cst_177 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %510 = stablehlo.broadcast_in_dim %cst_177, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %511 = stablehlo.multiply %509, %510 : tensor<12x768x768xbf16>
    %512 = stablehlo.select %472, %301#49, %511 : tensor<i1>, tensor<12x768x768xbf16>
    %513 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %514 = stablehlo.divide %301#50, %513 : tensor<12x768xbf16>
    %cst_178 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %515 = stablehlo.broadcast_in_dim %cst_178, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %516 = stablehlo.multiply %514, %515 : tensor<12x768xbf16>
    %517 = stablehlo.select %472, %301#50, %516 : tensor<i1>, tensor<12x768xbf16>
    %518 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %519 = stablehlo.divide %301#51, %518 : tensor<12x768x768xbf16>
    %cst_179 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %520 = stablehlo.broadcast_in_dim %cst_179, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %521 = stablehlo.multiply %519, %520 : tensor<12x768x768xbf16>
    %522 = stablehlo.select %472, %301#51, %521 : tensor<i1>, tensor<12x768x768xbf16>
    %523 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %524 = stablehlo.divide %301#52, %523 : tensor<12x768xbf16>
    %cst_180 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %525 = stablehlo.broadcast_in_dim %cst_180, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %526 = stablehlo.multiply %524, %525 : tensor<12x768xbf16>
    %527 = stablehlo.select %472, %301#52, %526 : tensor<i1>, tensor<12x768xbf16>
    %528 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %529 = stablehlo.divide %301#53, %528 : tensor<12x768x768xbf16>
    %cst_181 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %530 = stablehlo.broadcast_in_dim %cst_181, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %531 = stablehlo.multiply %529, %530 : tensor<12x768x768xbf16>
    %532 = stablehlo.select %472, %301#53, %531 : tensor<i1>, tensor<12x768x768xbf16>
    %533 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %534 = stablehlo.divide %301#54, %533 : tensor<12x768xbf16>
    %cst_182 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %535 = stablehlo.broadcast_in_dim %cst_182, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %536 = stablehlo.multiply %534, %535 : tensor<12x768xbf16>
    %537 = stablehlo.select %472, %301#54, %536 : tensor<i1>, tensor<12x768xbf16>
    %538 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %539 = stablehlo.divide %301#55, %538 : tensor<12x768xbf16>
    %cst_183 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %540 = stablehlo.broadcast_in_dim %cst_183, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %541 = stablehlo.multiply %539, %540 : tensor<12x768xbf16>
    %542 = stablehlo.select %472, %301#55, %541 : tensor<i1>, tensor<12x768xbf16>
    %543 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %544 = stablehlo.divide %301#56, %543 : tensor<12x768xbf16>
    %cst_184 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %545 = stablehlo.broadcast_in_dim %cst_184, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %546 = stablehlo.multiply %544, %545 : tensor<12x768xbf16>
    %547 = stablehlo.select %472, %301#56, %546 : tensor<i1>, tensor<12x768xbf16>
    %548 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %549 = stablehlo.divide %301#57, %548 : tensor<12x3072x768xbf16>
    %cst_185 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %550 = stablehlo.broadcast_in_dim %cst_185, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %551 = stablehlo.multiply %549, %550 : tensor<12x3072x768xbf16>
    %552 = stablehlo.select %472, %301#57, %551 : tensor<i1>, tensor<12x3072x768xbf16>
    %553 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %554 = stablehlo.divide %301#58, %553 : tensor<12x3072xbf16>
    %cst_186 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %555 = stablehlo.broadcast_in_dim %cst_186, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %556 = stablehlo.multiply %554, %555 : tensor<12x3072xbf16>
    %557 = stablehlo.select %472, %301#58, %556 : tensor<i1>, tensor<12x3072xbf16>
    %558 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %559 = stablehlo.divide %301#59, %558 : tensor<12x768x3072xbf16>
    %cst_187 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %560 = stablehlo.broadcast_in_dim %cst_187, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %561 = stablehlo.multiply %559, %560 : tensor<12x768x3072xbf16>
    %562 = stablehlo.select %472, %301#59, %561 : tensor<i1>, tensor<12x768x3072xbf16>
    %563 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %564 = stablehlo.divide %301#60, %563 : tensor<12x768xbf16>
    %cst_188 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %565 = stablehlo.broadcast_in_dim %cst_188, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %566 = stablehlo.multiply %564, %565 : tensor<12x768xbf16>
    %567 = stablehlo.select %472, %301#60, %566 : tensor<i1>, tensor<12x768xbf16>
    %568 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %569 = stablehlo.divide %301#61, %568 : tensor<12x768xbf16>
    %cst_189 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %570 = stablehlo.broadcast_in_dim %cst_189, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %571 = stablehlo.multiply %569, %570 : tensor<12x768xbf16>
    %572 = stablehlo.select %472, %301#61, %571 : tensor<i1>, tensor<12x768xbf16>
    %573 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %574 = stablehlo.divide %301#62, %573 : tensor<12x768xbf16>
    %cst_190 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %575 = stablehlo.broadcast_in_dim %cst_190, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %576 = stablehlo.multiply %574, %575 : tensor<12x768xbf16>
    %577 = stablehlo.select %472, %301#62, %576 : tensor<i1>, tensor<12x768xbf16>
    %578 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %579 = stablehlo.divide %284, %578 : tensor<768x768xbf16>
    %cst_191 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %580 = stablehlo.broadcast_in_dim %cst_191, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %581 = stablehlo.multiply %579, %580 : tensor<768x768xbf16>
    %582 = stablehlo.select %472, %284, %581 : tensor<i1>, tensor<768x768xbf16>
    %583 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %584 = stablehlo.divide %280, %583 : tensor<768xbf16>
    %cst_192 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %585 = stablehlo.broadcast_in_dim %cst_192, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %586 = stablehlo.multiply %584, %585 : tensor<768xbf16>
    %587 = stablehlo.select %472, %280, %586 : tensor<i1>, tensor<768xbf16>
    %588 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %589 = stablehlo.divide %244, %588 : tensor<768xbf16>
    %cst_193 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %590 = stablehlo.broadcast_in_dim %cst_193, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %591 = stablehlo.multiply %589, %590 : tensor<768xbf16>
    %592 = stablehlo.select %472, %244, %591 : tensor<i1>, tensor<768xbf16>
    %593 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %594 = stablehlo.divide %238, %593 : tensor<768xbf16>
    %cst_194 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %595 = stablehlo.broadcast_in_dim %cst_194, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %596 = stablehlo.multiply %594, %595 : tensor<768xbf16>
    %597 = stablehlo.select %472, %238, %596 : tensor<i1>, tensor<768xbf16>
    %598 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %599 = stablehlo.divide %235, %598 : tensor<30522x768xbf16>
    %cst_195 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %600 = stablehlo.broadcast_in_dim %cst_195, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %601 = stablehlo.multiply %599, %600 : tensor<30522x768xbf16>
    %602 = stablehlo.select %472, %235, %601 : tensor<i1>, tensor<30522x768xbf16>
    %603 = stablehlo.broadcast_in_dim %471, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %604 = stablehlo.divide %231, %603 : tensor<30522xbf16>
    %cst_196 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %605 = stablehlo.broadcast_in_dim %cst_196, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %606 = stablehlo.multiply %604, %605 : tensor<30522xbf16>
    %607 = stablehlo.select %472, %231, %606 : tensor<i1>, tensor<30522xbf16>
    %cst_197 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %608 = stablehlo.broadcast_in_dim %cst_197, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %609 = stablehlo.multiply %608, %477 : tensor<30522x768xbf16>
    %cst_198 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %610 = stablehlo.broadcast_in_dim %cst_198, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %611 = stablehlo.multiply %610, %arg28 : tensor<30522x768xbf16>
    %612 = stablehlo.add %609, %611 : tensor<30522x768xbf16>
    %cst_199 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %613 = stablehlo.broadcast_in_dim %cst_199, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %614 = stablehlo.multiply %613, %482 : tensor<512x768xbf16>
    %cst_200 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %615 = stablehlo.broadcast_in_dim %cst_200, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %616 = stablehlo.multiply %615, %arg29 : tensor<512x768xbf16>
    %617 = stablehlo.add %614, %616 : tensor<512x768xbf16>
    %cst_201 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %618 = stablehlo.broadcast_in_dim %cst_201, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %619 = stablehlo.multiply %618, %487 : tensor<2x768xbf16>
    %cst_202 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %620 = stablehlo.broadcast_in_dim %cst_202, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %621 = stablehlo.multiply %620, %arg30 : tensor<2x768xbf16>
    %622 = stablehlo.add %619, %621 : tensor<2x768xbf16>
    %cst_203 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %623 = stablehlo.broadcast_in_dim %cst_203, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %624 = stablehlo.multiply %623, %492 : tensor<768xbf16>
    %cst_204 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %625 = stablehlo.broadcast_in_dim %cst_204, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %626 = stablehlo.multiply %625, %arg31 : tensor<768xbf16>
    %627 = stablehlo.add %624, %626 : tensor<768xbf16>
    %cst_205 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %628 = stablehlo.broadcast_in_dim %cst_205, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %629 = stablehlo.multiply %628, %497 : tensor<768xbf16>
    %cst_206 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %630 = stablehlo.broadcast_in_dim %cst_206, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %631 = stablehlo.multiply %630, %arg32 : tensor<768xbf16>
    %632 = stablehlo.add %629, %631 : tensor<768xbf16>
    %cst_207 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %633 = stablehlo.broadcast_in_dim %cst_207, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %634 = stablehlo.multiply %633, %502 : tensor<12x768x768xbf16>
    %cst_208 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %635 = stablehlo.broadcast_in_dim %cst_208, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %636 = stablehlo.multiply %635, %arg33 : tensor<12x768x768xbf16>
    %637 = stablehlo.add %634, %636 : tensor<12x768x768xbf16>
    %cst_209 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %638 = stablehlo.broadcast_in_dim %cst_209, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %639 = stablehlo.multiply %638, %507 : tensor<12x768xbf16>
    %cst_210 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %640 = stablehlo.broadcast_in_dim %cst_210, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %641 = stablehlo.multiply %640, %arg34 : tensor<12x768xbf16>
    %642 = stablehlo.add %639, %641 : tensor<12x768xbf16>
    %cst_211 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %643 = stablehlo.broadcast_in_dim %cst_211, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %644 = stablehlo.multiply %643, %512 : tensor<12x768x768xbf16>
    %cst_212 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %645 = stablehlo.broadcast_in_dim %cst_212, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %646 = stablehlo.multiply %645, %arg35 : tensor<12x768x768xbf16>
    %647 = stablehlo.add %644, %646 : tensor<12x768x768xbf16>
    %cst_213 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %648 = stablehlo.broadcast_in_dim %cst_213, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %649 = stablehlo.multiply %648, %517 : tensor<12x768xbf16>
    %cst_214 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %650 = stablehlo.broadcast_in_dim %cst_214, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %651 = stablehlo.multiply %650, %arg36 : tensor<12x768xbf16>
    %652 = stablehlo.add %649, %651 : tensor<12x768xbf16>
    %cst_215 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %653 = stablehlo.broadcast_in_dim %cst_215, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %654 = stablehlo.multiply %653, %522 : tensor<12x768x768xbf16>
    %cst_216 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %655 = stablehlo.broadcast_in_dim %cst_216, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %656 = stablehlo.multiply %655, %arg37 : tensor<12x768x768xbf16>
    %657 = stablehlo.add %654, %656 : tensor<12x768x768xbf16>
    %cst_217 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %658 = stablehlo.broadcast_in_dim %cst_217, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %659 = stablehlo.multiply %658, %527 : tensor<12x768xbf16>
    %cst_218 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %660 = stablehlo.broadcast_in_dim %cst_218, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %661 = stablehlo.multiply %660, %arg38 : tensor<12x768xbf16>
    %662 = stablehlo.add %659, %661 : tensor<12x768xbf16>
    %cst_219 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %663 = stablehlo.broadcast_in_dim %cst_219, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %664 = stablehlo.multiply %663, %532 : tensor<12x768x768xbf16>
    %cst_220 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %665 = stablehlo.broadcast_in_dim %cst_220, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %666 = stablehlo.multiply %665, %arg39 : tensor<12x768x768xbf16>
    %667 = stablehlo.add %664, %666 : tensor<12x768x768xbf16>
    %cst_221 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %668 = stablehlo.broadcast_in_dim %cst_221, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %669 = stablehlo.multiply %668, %537 : tensor<12x768xbf16>
    %cst_222 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %670 = stablehlo.broadcast_in_dim %cst_222, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %671 = stablehlo.multiply %670, %arg40 : tensor<12x768xbf16>
    %672 = stablehlo.add %669, %671 : tensor<12x768xbf16>
    %cst_223 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %673 = stablehlo.broadcast_in_dim %cst_223, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %674 = stablehlo.multiply %673, %542 : tensor<12x768xbf16>
    %cst_224 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %675 = stablehlo.broadcast_in_dim %cst_224, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %676 = stablehlo.multiply %675, %arg41 : tensor<12x768xbf16>
    %677 = stablehlo.add %674, %676 : tensor<12x768xbf16>
    %cst_225 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %678 = stablehlo.broadcast_in_dim %cst_225, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %679 = stablehlo.multiply %678, %547 : tensor<12x768xbf16>
    %cst_226 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %680 = stablehlo.broadcast_in_dim %cst_226, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %681 = stablehlo.multiply %680, %arg42 : tensor<12x768xbf16>
    %682 = stablehlo.add %679, %681 : tensor<12x768xbf16>
    %cst_227 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %683 = stablehlo.broadcast_in_dim %cst_227, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %684 = stablehlo.multiply %683, %552 : tensor<12x3072x768xbf16>
    %cst_228 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %685 = stablehlo.broadcast_in_dim %cst_228, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %686 = stablehlo.multiply %685, %arg43 : tensor<12x3072x768xbf16>
    %687 = stablehlo.add %684, %686 : tensor<12x3072x768xbf16>
    %cst_229 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %688 = stablehlo.broadcast_in_dim %cst_229, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %689 = stablehlo.multiply %688, %557 : tensor<12x3072xbf16>
    %cst_230 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %690 = stablehlo.broadcast_in_dim %cst_230, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %691 = stablehlo.multiply %690, %arg44 : tensor<12x3072xbf16>
    %692 = stablehlo.add %689, %691 : tensor<12x3072xbf16>
    %cst_231 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %693 = stablehlo.broadcast_in_dim %cst_231, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %694 = stablehlo.multiply %693, %562 : tensor<12x768x3072xbf16>
    %cst_232 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %695 = stablehlo.broadcast_in_dim %cst_232, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %696 = stablehlo.multiply %695, %arg45 : tensor<12x768x3072xbf16>
    %697 = stablehlo.add %694, %696 : tensor<12x768x3072xbf16>
    %cst_233 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %698 = stablehlo.broadcast_in_dim %cst_233, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %699 = stablehlo.multiply %698, %567 : tensor<12x768xbf16>
    %cst_234 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %700 = stablehlo.broadcast_in_dim %cst_234, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %701 = stablehlo.multiply %700, %arg46 : tensor<12x768xbf16>
    %702 = stablehlo.add %699, %701 : tensor<12x768xbf16>
    %cst_235 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %703 = stablehlo.broadcast_in_dim %cst_235, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %704 = stablehlo.multiply %703, %572 : tensor<12x768xbf16>
    %cst_236 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %705 = stablehlo.broadcast_in_dim %cst_236, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %706 = stablehlo.multiply %705, %arg47 : tensor<12x768xbf16>
    %707 = stablehlo.add %704, %706 : tensor<12x768xbf16>
    %cst_237 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %708 = stablehlo.broadcast_in_dim %cst_237, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %709 = stablehlo.multiply %708, %577 : tensor<12x768xbf16>
    %cst_238 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %710 = stablehlo.broadcast_in_dim %cst_238, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %711 = stablehlo.multiply %710, %arg48 : tensor<12x768xbf16>
    %712 = stablehlo.add %709, %711 : tensor<12x768xbf16>
    %cst_239 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %713 = stablehlo.broadcast_in_dim %cst_239, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %714 = stablehlo.multiply %713, %582 : tensor<768x768xbf16>
    %cst_240 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %715 = stablehlo.broadcast_in_dim %cst_240, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %716 = stablehlo.multiply %715, %arg49 : tensor<768x768xbf16>
    %717 = stablehlo.add %714, %716 : tensor<768x768xbf16>
    %cst_241 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %718 = stablehlo.broadcast_in_dim %cst_241, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %719 = stablehlo.multiply %718, %587 : tensor<768xbf16>
    %cst_242 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %720 = stablehlo.broadcast_in_dim %cst_242, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %721 = stablehlo.multiply %720, %arg50 : tensor<768xbf16>
    %722 = stablehlo.add %719, %721 : tensor<768xbf16>
    %cst_243 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %723 = stablehlo.broadcast_in_dim %cst_243, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %724 = stablehlo.multiply %723, %592 : tensor<768xbf16>
    %cst_244 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %725 = stablehlo.broadcast_in_dim %cst_244, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %726 = stablehlo.multiply %725, %arg51 : tensor<768xbf16>
    %727 = stablehlo.add %724, %726 : tensor<768xbf16>
    %cst_245 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %728 = stablehlo.broadcast_in_dim %cst_245, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %729 = stablehlo.multiply %728, %597 : tensor<768xbf16>
    %cst_246 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %730 = stablehlo.broadcast_in_dim %cst_246, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %731 = stablehlo.multiply %730, %arg52 : tensor<768xbf16>
    %732 = stablehlo.add %729, %731 : tensor<768xbf16>
    %cst_247 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %733 = stablehlo.broadcast_in_dim %cst_247, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %734 = stablehlo.multiply %733, %602 : tensor<30522x768xbf16>
    %cst_248 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %735 = stablehlo.broadcast_in_dim %cst_248, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %736 = stablehlo.multiply %735, %arg53 : tensor<30522x768xbf16>
    %737 = stablehlo.add %734, %736 : tensor<30522x768xbf16>
    %cst_249 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %738 = stablehlo.broadcast_in_dim %cst_249, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %739 = stablehlo.multiply %738, %607 : tensor<30522xbf16>
    %cst_250 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %740 = stablehlo.broadcast_in_dim %cst_250, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %741 = stablehlo.multiply %740, %arg54 : tensor<30522xbf16>
    %742 = stablehlo.add %739, %741 : tensor<30522xbf16>
    %743 = stablehlo.multiply %477, %477 : tensor<30522x768xbf16>
    %cst_251 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %744 = stablehlo.broadcast_in_dim %cst_251, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %745 = stablehlo.multiply %744, %743 : tensor<30522x768xbf16>
    %cst_252 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %746 = stablehlo.broadcast_in_dim %cst_252, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %747 = stablehlo.multiply %746, %arg55 : tensor<30522x768xbf16>
    %748 = stablehlo.add %745, %747 : tensor<30522x768xbf16>
    %749 = stablehlo.multiply %482, %482 : tensor<512x768xbf16>
    %cst_253 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %750 = stablehlo.broadcast_in_dim %cst_253, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %751 = stablehlo.multiply %750, %749 : tensor<512x768xbf16>
    %cst_254 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %752 = stablehlo.broadcast_in_dim %cst_254, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %753 = stablehlo.multiply %752, %arg56 : tensor<512x768xbf16>
    %754 = stablehlo.add %751, %753 : tensor<512x768xbf16>
    %755 = stablehlo.multiply %487, %487 : tensor<2x768xbf16>
    %cst_255 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %756 = stablehlo.broadcast_in_dim %cst_255, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %757 = stablehlo.multiply %756, %755 : tensor<2x768xbf16>
    %cst_256 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %758 = stablehlo.broadcast_in_dim %cst_256, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %759 = stablehlo.multiply %758, %arg57 : tensor<2x768xbf16>
    %760 = stablehlo.add %757, %759 : tensor<2x768xbf16>
    %761 = stablehlo.multiply %492, %492 : tensor<768xbf16>
    %cst_257 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %762 = stablehlo.broadcast_in_dim %cst_257, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %763 = stablehlo.multiply %762, %761 : tensor<768xbf16>
    %cst_258 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %764 = stablehlo.broadcast_in_dim %cst_258, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %765 = stablehlo.multiply %764, %arg58 : tensor<768xbf16>
    %766 = stablehlo.add %763, %765 : tensor<768xbf16>
    %767 = stablehlo.multiply %497, %497 : tensor<768xbf16>
    %cst_259 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %768 = stablehlo.broadcast_in_dim %cst_259, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %769 = stablehlo.multiply %768, %767 : tensor<768xbf16>
    %cst_260 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %770 = stablehlo.broadcast_in_dim %cst_260, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %771 = stablehlo.multiply %770, %arg59 : tensor<768xbf16>
    %772 = stablehlo.add %769, %771 : tensor<768xbf16>
    %773 = stablehlo.multiply %502, %502 : tensor<12x768x768xbf16>
    %cst_261 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %774 = stablehlo.broadcast_in_dim %cst_261, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %775 = stablehlo.multiply %774, %773 : tensor<12x768x768xbf16>
    %cst_262 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %776 = stablehlo.broadcast_in_dim %cst_262, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %777 = stablehlo.multiply %776, %arg60 : tensor<12x768x768xbf16>
    %778 = stablehlo.add %775, %777 : tensor<12x768x768xbf16>
    %779 = stablehlo.multiply %507, %507 : tensor<12x768xbf16>
    %cst_263 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %780 = stablehlo.broadcast_in_dim %cst_263, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %781 = stablehlo.multiply %780, %779 : tensor<12x768xbf16>
    %cst_264 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %782 = stablehlo.broadcast_in_dim %cst_264, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %783 = stablehlo.multiply %782, %arg61 : tensor<12x768xbf16>
    %784 = stablehlo.add %781, %783 : tensor<12x768xbf16>
    %785 = stablehlo.multiply %512, %512 : tensor<12x768x768xbf16>
    %cst_265 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %786 = stablehlo.broadcast_in_dim %cst_265, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %787 = stablehlo.multiply %786, %785 : tensor<12x768x768xbf16>
    %cst_266 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %788 = stablehlo.broadcast_in_dim %cst_266, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %789 = stablehlo.multiply %788, %arg62 : tensor<12x768x768xbf16>
    %790 = stablehlo.add %787, %789 : tensor<12x768x768xbf16>
    %791 = stablehlo.multiply %517, %517 : tensor<12x768xbf16>
    %cst_267 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %792 = stablehlo.broadcast_in_dim %cst_267, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %793 = stablehlo.multiply %792, %791 : tensor<12x768xbf16>
    %cst_268 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %794 = stablehlo.broadcast_in_dim %cst_268, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %795 = stablehlo.multiply %794, %arg63 : tensor<12x768xbf16>
    %796 = stablehlo.add %793, %795 : tensor<12x768xbf16>
    %797 = stablehlo.multiply %522, %522 : tensor<12x768x768xbf16>
    %cst_269 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %798 = stablehlo.broadcast_in_dim %cst_269, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %799 = stablehlo.multiply %798, %797 : tensor<12x768x768xbf16>
    %cst_270 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %800 = stablehlo.broadcast_in_dim %cst_270, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %801 = stablehlo.multiply %800, %arg64 : tensor<12x768x768xbf16>
    %802 = stablehlo.add %799, %801 : tensor<12x768x768xbf16>
    %803 = stablehlo.multiply %527, %527 : tensor<12x768xbf16>
    %cst_271 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %804 = stablehlo.broadcast_in_dim %cst_271, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %805 = stablehlo.multiply %804, %803 : tensor<12x768xbf16>
    %cst_272 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %806 = stablehlo.broadcast_in_dim %cst_272, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %807 = stablehlo.multiply %806, %arg65 : tensor<12x768xbf16>
    %808 = stablehlo.add %805, %807 : tensor<12x768xbf16>
    %809 = stablehlo.multiply %532, %532 : tensor<12x768x768xbf16>
    %cst_273 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %810 = stablehlo.broadcast_in_dim %cst_273, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %811 = stablehlo.multiply %810, %809 : tensor<12x768x768xbf16>
    %cst_274 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %812 = stablehlo.broadcast_in_dim %cst_274, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %813 = stablehlo.multiply %812, %arg66 : tensor<12x768x768xbf16>
    %814 = stablehlo.add %811, %813 : tensor<12x768x768xbf16>
    %815 = stablehlo.multiply %537, %537 : tensor<12x768xbf16>
    %cst_275 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %816 = stablehlo.broadcast_in_dim %cst_275, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %817 = stablehlo.multiply %816, %815 : tensor<12x768xbf16>
    %cst_276 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %818 = stablehlo.broadcast_in_dim %cst_276, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %819 = stablehlo.multiply %818, %arg67 : tensor<12x768xbf16>
    %820 = stablehlo.add %817, %819 : tensor<12x768xbf16>
    %821 = stablehlo.multiply %542, %542 : tensor<12x768xbf16>
    %cst_277 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %822 = stablehlo.broadcast_in_dim %cst_277, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %823 = stablehlo.multiply %822, %821 : tensor<12x768xbf16>
    %cst_278 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %824 = stablehlo.broadcast_in_dim %cst_278, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %825 = stablehlo.multiply %824, %arg68 : tensor<12x768xbf16>
    %826 = stablehlo.add %823, %825 : tensor<12x768xbf16>
    %827 = stablehlo.multiply %547, %547 : tensor<12x768xbf16>
    %cst_279 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %828 = stablehlo.broadcast_in_dim %cst_279, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %829 = stablehlo.multiply %828, %827 : tensor<12x768xbf16>
    %cst_280 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %830 = stablehlo.broadcast_in_dim %cst_280, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %831 = stablehlo.multiply %830, %arg69 : tensor<12x768xbf16>
    %832 = stablehlo.add %829, %831 : tensor<12x768xbf16>
    %833 = stablehlo.multiply %552, %552 : tensor<12x3072x768xbf16>
    %cst_281 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %834 = stablehlo.broadcast_in_dim %cst_281, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %835 = stablehlo.multiply %834, %833 : tensor<12x3072x768xbf16>
    %cst_282 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %836 = stablehlo.broadcast_in_dim %cst_282, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %837 = stablehlo.multiply %836, %arg70 : tensor<12x3072x768xbf16>
    %838 = stablehlo.add %835, %837 : tensor<12x3072x768xbf16>
    %839 = stablehlo.multiply %557, %557 : tensor<12x3072xbf16>
    %cst_283 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %840 = stablehlo.broadcast_in_dim %cst_283, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %841 = stablehlo.multiply %840, %839 : tensor<12x3072xbf16>
    %cst_284 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %842 = stablehlo.broadcast_in_dim %cst_284, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %843 = stablehlo.multiply %842, %arg71 : tensor<12x3072xbf16>
    %844 = stablehlo.add %841, %843 : tensor<12x3072xbf16>
    %845 = stablehlo.multiply %562, %562 : tensor<12x768x3072xbf16>
    %cst_285 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %846 = stablehlo.broadcast_in_dim %cst_285, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %847 = stablehlo.multiply %846, %845 : tensor<12x768x3072xbf16>
    %cst_286 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %848 = stablehlo.broadcast_in_dim %cst_286, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %849 = stablehlo.multiply %848, %arg72 : tensor<12x768x3072xbf16>
    %850 = stablehlo.add %847, %849 : tensor<12x768x3072xbf16>
    %851 = stablehlo.multiply %567, %567 : tensor<12x768xbf16>
    %cst_287 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %852 = stablehlo.broadcast_in_dim %cst_287, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %853 = stablehlo.multiply %852, %851 : tensor<12x768xbf16>
    %cst_288 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %854 = stablehlo.broadcast_in_dim %cst_288, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %855 = stablehlo.multiply %854, %arg73 : tensor<12x768xbf16>
    %856 = stablehlo.add %853, %855 : tensor<12x768xbf16>
    %857 = stablehlo.multiply %572, %572 : tensor<12x768xbf16>
    %cst_289 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %858 = stablehlo.broadcast_in_dim %cst_289, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %859 = stablehlo.multiply %858, %857 : tensor<12x768xbf16>
    %cst_290 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %860 = stablehlo.broadcast_in_dim %cst_290, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %861 = stablehlo.multiply %860, %arg74 : tensor<12x768xbf16>
    %862 = stablehlo.add %859, %861 : tensor<12x768xbf16>
    %863 = stablehlo.multiply %577, %577 : tensor<12x768xbf16>
    %cst_291 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %864 = stablehlo.broadcast_in_dim %cst_291, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %865 = stablehlo.multiply %864, %863 : tensor<12x768xbf16>
    %cst_292 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %866 = stablehlo.broadcast_in_dim %cst_292, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %867 = stablehlo.multiply %866, %arg75 : tensor<12x768xbf16>
    %868 = stablehlo.add %865, %867 : tensor<12x768xbf16>
    %869 = stablehlo.multiply %582, %582 : tensor<768x768xbf16>
    %cst_293 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %870 = stablehlo.broadcast_in_dim %cst_293, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %871 = stablehlo.multiply %870, %869 : tensor<768x768xbf16>
    %cst_294 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %872 = stablehlo.broadcast_in_dim %cst_294, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %873 = stablehlo.multiply %872, %arg76 : tensor<768x768xbf16>
    %874 = stablehlo.add %871, %873 : tensor<768x768xbf16>
    %875 = stablehlo.multiply %587, %587 : tensor<768xbf16>
    %cst_295 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %876 = stablehlo.broadcast_in_dim %cst_295, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %877 = stablehlo.multiply %876, %875 : tensor<768xbf16>
    %cst_296 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %878 = stablehlo.broadcast_in_dim %cst_296, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %879 = stablehlo.multiply %878, %arg77 : tensor<768xbf16>
    %880 = stablehlo.add %877, %879 : tensor<768xbf16>
    %881 = stablehlo.multiply %592, %592 : tensor<768xbf16>
    %cst_297 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %882 = stablehlo.broadcast_in_dim %cst_297, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %883 = stablehlo.multiply %882, %881 : tensor<768xbf16>
    %cst_298 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %884 = stablehlo.broadcast_in_dim %cst_298, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %885 = stablehlo.multiply %884, %arg78 : tensor<768xbf16>
    %886 = stablehlo.add %883, %885 : tensor<768xbf16>
    %887 = stablehlo.multiply %597, %597 : tensor<768xbf16>
    %cst_299 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %888 = stablehlo.broadcast_in_dim %cst_299, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %889 = stablehlo.multiply %888, %887 : tensor<768xbf16>
    %cst_300 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %890 = stablehlo.broadcast_in_dim %cst_300, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %891 = stablehlo.multiply %890, %arg79 : tensor<768xbf16>
    %892 = stablehlo.add %889, %891 : tensor<768xbf16>
    %893 = stablehlo.multiply %602, %602 : tensor<30522x768xbf16>
    %cst_301 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %894 = stablehlo.broadcast_in_dim %cst_301, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %895 = stablehlo.multiply %894, %893 : tensor<30522x768xbf16>
    %cst_302 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %896 = stablehlo.broadcast_in_dim %cst_302, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %897 = stablehlo.multiply %896, %arg80 : tensor<30522x768xbf16>
    %898 = stablehlo.add %895, %897 : tensor<30522x768xbf16>
    %899 = stablehlo.multiply %607, %607 : tensor<30522xbf16>
    %cst_303 = stablehlo.constant dense<9.994500e-04> : tensor<bf16>
    %900 = stablehlo.broadcast_in_dim %cst_303, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %901 = stablehlo.multiply %900, %899 : tensor<30522xbf16>
    %cst_304 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %902 = stablehlo.broadcast_in_dim %cst_304, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %903 = stablehlo.multiply %902, %arg81 : tensor<30522xbf16>
    %904 = stablehlo.add %901, %903 : tensor<30522xbf16>
    %c_305 = stablehlo.constant dense<2147483647> : tensor<i32>
    %905 = stablehlo.compare  LT, %arg27, %c_305,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
    %c_306 = stablehlo.constant dense<1> : tensor<i32>
    %906 = stablehlo.add %arg27, %c_306 : tensor<i32>
    %c_307 = stablehlo.constant dense<2147483647> : tensor<i32>
    %907 = call @_where_501(%905, %906, %c_307) : (tensor<i1>, tensor<i32>, tensor<i32>) -> tensor<i32>
    %cst_308 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %908 = stablehlo.convert %907 : (tensor<i32>) -> tensor<f32>
    %909 = stablehlo.power %cst_308, %908 : tensor<f32>
    %cst_309 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %910 = stablehlo.subtract %cst_309, %909 : tensor<f32>
    %911 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %912 = stablehlo.broadcast_in_dim %911, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %913 = stablehlo.divide %612, %912 : tensor<30522x768xbf16>
    %914 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %915 = stablehlo.broadcast_in_dim %914, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %916 = stablehlo.divide %617, %915 : tensor<512x768xbf16>
    %917 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %918 = stablehlo.broadcast_in_dim %917, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %919 = stablehlo.divide %622, %918 : tensor<2x768xbf16>
    %920 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %921 = stablehlo.broadcast_in_dim %920, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %922 = stablehlo.divide %627, %921 : tensor<768xbf16>
    %923 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %924 = stablehlo.broadcast_in_dim %923, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %925 = stablehlo.divide %632, %924 : tensor<768xbf16>
    %926 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %927 = stablehlo.broadcast_in_dim %926, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %928 = stablehlo.divide %637, %927 : tensor<12x768x768xbf16>
    %929 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %930 = stablehlo.broadcast_in_dim %929, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %931 = stablehlo.divide %642, %930 : tensor<12x768xbf16>
    %932 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %933 = stablehlo.broadcast_in_dim %932, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %934 = stablehlo.divide %647, %933 : tensor<12x768x768xbf16>
    %935 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %936 = stablehlo.broadcast_in_dim %935, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %937 = stablehlo.divide %652, %936 : tensor<12x768xbf16>
    %938 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %939 = stablehlo.broadcast_in_dim %938, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %940 = stablehlo.divide %657, %939 : tensor<12x768x768xbf16>
    %941 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %942 = stablehlo.broadcast_in_dim %941, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %943 = stablehlo.divide %662, %942 : tensor<12x768xbf16>
    %944 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %945 = stablehlo.broadcast_in_dim %944, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %946 = stablehlo.divide %667, %945 : tensor<12x768x768xbf16>
    %947 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %948 = stablehlo.broadcast_in_dim %947, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %949 = stablehlo.divide %672, %948 : tensor<12x768xbf16>
    %950 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %951 = stablehlo.broadcast_in_dim %950, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %952 = stablehlo.divide %677, %951 : tensor<12x768xbf16>
    %953 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %954 = stablehlo.broadcast_in_dim %953, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %955 = stablehlo.divide %682, %954 : tensor<12x768xbf16>
    %956 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %957 = stablehlo.broadcast_in_dim %956, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %958 = stablehlo.divide %687, %957 : tensor<12x3072x768xbf16>
    %959 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %960 = stablehlo.broadcast_in_dim %959, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %961 = stablehlo.divide %692, %960 : tensor<12x3072xbf16>
    %962 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %963 = stablehlo.broadcast_in_dim %962, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %964 = stablehlo.divide %697, %963 : tensor<12x768x3072xbf16>
    %965 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %966 = stablehlo.broadcast_in_dim %965, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %967 = stablehlo.divide %702, %966 : tensor<12x768xbf16>
    %968 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %969 = stablehlo.broadcast_in_dim %968, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %970 = stablehlo.divide %707, %969 : tensor<12x768xbf16>
    %971 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %972 = stablehlo.broadcast_in_dim %971, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %973 = stablehlo.divide %712, %972 : tensor<12x768xbf16>
    %974 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %975 = stablehlo.broadcast_in_dim %974, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %976 = stablehlo.divide %717, %975 : tensor<768x768xbf16>
    %977 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %978 = stablehlo.broadcast_in_dim %977, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %979 = stablehlo.divide %722, %978 : tensor<768xbf16>
    %980 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %981 = stablehlo.broadcast_in_dim %980, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %982 = stablehlo.divide %727, %981 : tensor<768xbf16>
    %983 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %984 = stablehlo.broadcast_in_dim %983, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %985 = stablehlo.divide %732, %984 : tensor<768xbf16>
    %986 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %987 = stablehlo.broadcast_in_dim %986, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %988 = stablehlo.divide %737, %987 : tensor<30522x768xbf16>
    %989 = stablehlo.convert %910 : (tensor<f32>) -> tensor<bf16>
    %990 = stablehlo.broadcast_in_dim %989, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %991 = stablehlo.divide %742, %990 : tensor<30522xbf16>
    %cst_310 = stablehlo.constant dense<9.990000e-01> : tensor<f32>
    %992 = stablehlo.convert %907 : (tensor<i32>) -> tensor<f32>
    %993 = stablehlo.power %cst_310, %992 : tensor<f32>
    %cst_311 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %994 = stablehlo.subtract %cst_311, %993 : tensor<f32>
    %995 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %996 = stablehlo.broadcast_in_dim %995, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %997 = stablehlo.divide %748, %996 : tensor<30522x768xbf16>
    %998 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %999 = stablehlo.broadcast_in_dim %998, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1000 = stablehlo.divide %754, %999 : tensor<512x768xbf16>
    %1001 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1002 = stablehlo.broadcast_in_dim %1001, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1003 = stablehlo.divide %760, %1002 : tensor<2x768xbf16>
    %1004 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1005 = stablehlo.broadcast_in_dim %1004, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1006 = stablehlo.divide %766, %1005 : tensor<768xbf16>
    %1007 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1008 = stablehlo.broadcast_in_dim %1007, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1009 = stablehlo.divide %772, %1008 : tensor<768xbf16>
    %1010 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1011 = stablehlo.broadcast_in_dim %1010, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1012 = stablehlo.divide %778, %1011 : tensor<12x768x768xbf16>
    %1013 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1014 = stablehlo.broadcast_in_dim %1013, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1015 = stablehlo.divide %784, %1014 : tensor<12x768xbf16>
    %1016 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1017 = stablehlo.broadcast_in_dim %1016, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1018 = stablehlo.divide %790, %1017 : tensor<12x768x768xbf16>
    %1019 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1020 = stablehlo.broadcast_in_dim %1019, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1021 = stablehlo.divide %796, %1020 : tensor<12x768xbf16>
    %1022 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1023 = stablehlo.broadcast_in_dim %1022, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1024 = stablehlo.divide %802, %1023 : tensor<12x768x768xbf16>
    %1025 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1026 = stablehlo.broadcast_in_dim %1025, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1027 = stablehlo.divide %808, %1026 : tensor<12x768xbf16>
    %1028 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1029 = stablehlo.broadcast_in_dim %1028, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1030 = stablehlo.divide %814, %1029 : tensor<12x768x768xbf16>
    %1031 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1032 = stablehlo.broadcast_in_dim %1031, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1033 = stablehlo.divide %820, %1032 : tensor<12x768xbf16>
    %1034 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1035 = stablehlo.broadcast_in_dim %1034, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1036 = stablehlo.divide %826, %1035 : tensor<12x768xbf16>
    %1037 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1038 = stablehlo.broadcast_in_dim %1037, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1039 = stablehlo.divide %832, %1038 : tensor<12x768xbf16>
    %1040 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1041 = stablehlo.broadcast_in_dim %1040, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1042 = stablehlo.divide %838, %1041 : tensor<12x3072x768xbf16>
    %1043 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1044 = stablehlo.broadcast_in_dim %1043, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1045 = stablehlo.divide %844, %1044 : tensor<12x3072xbf16>
    %1046 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1047 = stablehlo.broadcast_in_dim %1046, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1048 = stablehlo.divide %850, %1047 : tensor<12x768x3072xbf16>
    %1049 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1050 = stablehlo.broadcast_in_dim %1049, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1051 = stablehlo.divide %856, %1050 : tensor<12x768xbf16>
    %1052 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1053 = stablehlo.broadcast_in_dim %1052, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1054 = stablehlo.divide %862, %1053 : tensor<12x768xbf16>
    %1055 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1056 = stablehlo.broadcast_in_dim %1055, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1057 = stablehlo.divide %868, %1056 : tensor<12x768xbf16>
    %1058 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1059 = stablehlo.broadcast_in_dim %1058, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1060 = stablehlo.divide %874, %1059 : tensor<768x768xbf16>
    %1061 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1062 = stablehlo.broadcast_in_dim %1061, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1063 = stablehlo.divide %880, %1062 : tensor<768xbf16>
    %1064 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1065 = stablehlo.broadcast_in_dim %1064, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1066 = stablehlo.divide %886, %1065 : tensor<768xbf16>
    %1067 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1068 = stablehlo.broadcast_in_dim %1067, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1069 = stablehlo.divide %892, %1068 : tensor<768xbf16>
    %1070 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1071 = stablehlo.broadcast_in_dim %1070, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1072 = stablehlo.divide %898, %1071 : tensor<30522x768xbf16>
    %1073 = stablehlo.convert %994 : (tensor<f32>) -> tensor<bf16>
    %1074 = stablehlo.broadcast_in_dim %1073, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1075 = stablehlo.divide %904, %1074 : tensor<30522xbf16>
    %cst_312 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1076 = stablehlo.broadcast_in_dim %cst_312, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1077 = stablehlo.add %997, %1076 : tensor<30522x768xbf16>
    %1078 = stablehlo.sqrt %1077 : tensor<30522x768xbf16>
    %cst_313 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1079 = stablehlo.broadcast_in_dim %cst_313, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1080 = stablehlo.add %1078, %1079 : tensor<30522x768xbf16>
    %1081 = stablehlo.divide %913, %1080 : tensor<30522x768xbf16>
    %cst_314 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1082 = stablehlo.broadcast_in_dim %cst_314, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1083 = stablehlo.add %1000, %1082 : tensor<512x768xbf16>
    %1084 = stablehlo.sqrt %1083 : tensor<512x768xbf16>
    %cst_315 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1085 = stablehlo.broadcast_in_dim %cst_315, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1086 = stablehlo.add %1084, %1085 : tensor<512x768xbf16>
    %1087 = stablehlo.divide %916, %1086 : tensor<512x768xbf16>
    %cst_316 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1088 = stablehlo.broadcast_in_dim %cst_316, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1089 = stablehlo.add %1003, %1088 : tensor<2x768xbf16>
    %1090 = stablehlo.sqrt %1089 : tensor<2x768xbf16>
    %cst_317 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1091 = stablehlo.broadcast_in_dim %cst_317, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1092 = stablehlo.add %1090, %1091 : tensor<2x768xbf16>
    %1093 = stablehlo.divide %919, %1092 : tensor<2x768xbf16>
    %cst_318 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1094 = stablehlo.broadcast_in_dim %cst_318, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1095 = stablehlo.add %1006, %1094 : tensor<768xbf16>
    %1096 = stablehlo.sqrt %1095 : tensor<768xbf16>
    %cst_319 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1097 = stablehlo.broadcast_in_dim %cst_319, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1098 = stablehlo.add %1096, %1097 : tensor<768xbf16>
    %1099 = stablehlo.divide %922, %1098 : tensor<768xbf16>
    %cst_320 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1100 = stablehlo.broadcast_in_dim %cst_320, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1101 = stablehlo.add %1009, %1100 : tensor<768xbf16>
    %1102 = stablehlo.sqrt %1101 : tensor<768xbf16>
    %cst_321 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1103 = stablehlo.broadcast_in_dim %cst_321, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1104 = stablehlo.add %1102, %1103 : tensor<768xbf16>
    %1105 = stablehlo.divide %925, %1104 : tensor<768xbf16>
    %cst_322 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1106 = stablehlo.broadcast_in_dim %cst_322, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1107 = stablehlo.add %1012, %1106 : tensor<12x768x768xbf16>
    %1108 = stablehlo.sqrt %1107 : tensor<12x768x768xbf16>
    %cst_323 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1109 = stablehlo.broadcast_in_dim %cst_323, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1110 = stablehlo.add %1108, %1109 : tensor<12x768x768xbf16>
    %1111 = stablehlo.divide %928, %1110 : tensor<12x768x768xbf16>
    %cst_324 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1112 = stablehlo.broadcast_in_dim %cst_324, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1113 = stablehlo.add %1015, %1112 : tensor<12x768xbf16>
    %1114 = stablehlo.sqrt %1113 : tensor<12x768xbf16>
    %cst_325 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1115 = stablehlo.broadcast_in_dim %cst_325, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1116 = stablehlo.add %1114, %1115 : tensor<12x768xbf16>
    %1117 = stablehlo.divide %931, %1116 : tensor<12x768xbf16>
    %cst_326 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1118 = stablehlo.broadcast_in_dim %cst_326, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1119 = stablehlo.add %1018, %1118 : tensor<12x768x768xbf16>
    %1120 = stablehlo.sqrt %1119 : tensor<12x768x768xbf16>
    %cst_327 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1121 = stablehlo.broadcast_in_dim %cst_327, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1122 = stablehlo.add %1120, %1121 : tensor<12x768x768xbf16>
    %1123 = stablehlo.divide %934, %1122 : tensor<12x768x768xbf16>
    %cst_328 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1124 = stablehlo.broadcast_in_dim %cst_328, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1125 = stablehlo.add %1021, %1124 : tensor<12x768xbf16>
    %1126 = stablehlo.sqrt %1125 : tensor<12x768xbf16>
    %cst_329 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1127 = stablehlo.broadcast_in_dim %cst_329, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1128 = stablehlo.add %1126, %1127 : tensor<12x768xbf16>
    %1129 = stablehlo.divide %937, %1128 : tensor<12x768xbf16>
    %cst_330 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1130 = stablehlo.broadcast_in_dim %cst_330, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1131 = stablehlo.add %1024, %1130 : tensor<12x768x768xbf16>
    %1132 = stablehlo.sqrt %1131 : tensor<12x768x768xbf16>
    %cst_331 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1133 = stablehlo.broadcast_in_dim %cst_331, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1134 = stablehlo.add %1132, %1133 : tensor<12x768x768xbf16>
    %1135 = stablehlo.divide %940, %1134 : tensor<12x768x768xbf16>
    %cst_332 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1136 = stablehlo.broadcast_in_dim %cst_332, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1137 = stablehlo.add %1027, %1136 : tensor<12x768xbf16>
    %1138 = stablehlo.sqrt %1137 : tensor<12x768xbf16>
    %cst_333 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1139 = stablehlo.broadcast_in_dim %cst_333, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1140 = stablehlo.add %1138, %1139 : tensor<12x768xbf16>
    %1141 = stablehlo.divide %943, %1140 : tensor<12x768xbf16>
    %cst_334 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1142 = stablehlo.broadcast_in_dim %cst_334, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1143 = stablehlo.add %1030, %1142 : tensor<12x768x768xbf16>
    %1144 = stablehlo.sqrt %1143 : tensor<12x768x768xbf16>
    %cst_335 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1145 = stablehlo.broadcast_in_dim %cst_335, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1146 = stablehlo.add %1144, %1145 : tensor<12x768x768xbf16>
    %1147 = stablehlo.divide %946, %1146 : tensor<12x768x768xbf16>
    %cst_336 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1148 = stablehlo.broadcast_in_dim %cst_336, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1149 = stablehlo.add %1033, %1148 : tensor<12x768xbf16>
    %1150 = stablehlo.sqrt %1149 : tensor<12x768xbf16>
    %cst_337 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1151 = stablehlo.broadcast_in_dim %cst_337, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1152 = stablehlo.add %1150, %1151 : tensor<12x768xbf16>
    %1153 = stablehlo.divide %949, %1152 : tensor<12x768xbf16>
    %cst_338 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1154 = stablehlo.broadcast_in_dim %cst_338, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1155 = stablehlo.add %1036, %1154 : tensor<12x768xbf16>
    %1156 = stablehlo.sqrt %1155 : tensor<12x768xbf16>
    %cst_339 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1157 = stablehlo.broadcast_in_dim %cst_339, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1158 = stablehlo.add %1156, %1157 : tensor<12x768xbf16>
    %1159 = stablehlo.divide %952, %1158 : tensor<12x768xbf16>
    %cst_340 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1160 = stablehlo.broadcast_in_dim %cst_340, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1161 = stablehlo.add %1039, %1160 : tensor<12x768xbf16>
    %1162 = stablehlo.sqrt %1161 : tensor<12x768xbf16>
    %cst_341 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1163 = stablehlo.broadcast_in_dim %cst_341, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1164 = stablehlo.add %1162, %1163 : tensor<12x768xbf16>
    %1165 = stablehlo.divide %955, %1164 : tensor<12x768xbf16>
    %cst_342 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1166 = stablehlo.broadcast_in_dim %cst_342, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1167 = stablehlo.add %1042, %1166 : tensor<12x3072x768xbf16>
    %1168 = stablehlo.sqrt %1167 : tensor<12x3072x768xbf16>
    %cst_343 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1169 = stablehlo.broadcast_in_dim %cst_343, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1170 = stablehlo.add %1168, %1169 : tensor<12x3072x768xbf16>
    %1171 = stablehlo.divide %958, %1170 : tensor<12x3072x768xbf16>
    %cst_344 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1172 = stablehlo.broadcast_in_dim %cst_344, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1173 = stablehlo.add %1045, %1172 : tensor<12x3072xbf16>
    %1174 = stablehlo.sqrt %1173 : tensor<12x3072xbf16>
    %cst_345 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1175 = stablehlo.broadcast_in_dim %cst_345, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1176 = stablehlo.add %1174, %1175 : tensor<12x3072xbf16>
    %1177 = stablehlo.divide %961, %1176 : tensor<12x3072xbf16>
    %cst_346 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1178 = stablehlo.broadcast_in_dim %cst_346, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1179 = stablehlo.add %1048, %1178 : tensor<12x768x3072xbf16>
    %1180 = stablehlo.sqrt %1179 : tensor<12x768x3072xbf16>
    %cst_347 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1181 = stablehlo.broadcast_in_dim %cst_347, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1182 = stablehlo.add %1180, %1181 : tensor<12x768x3072xbf16>
    %1183 = stablehlo.divide %964, %1182 : tensor<12x768x3072xbf16>
    %cst_348 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1184 = stablehlo.broadcast_in_dim %cst_348, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1185 = stablehlo.add %1051, %1184 : tensor<12x768xbf16>
    %1186 = stablehlo.sqrt %1185 : tensor<12x768xbf16>
    %cst_349 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1187 = stablehlo.broadcast_in_dim %cst_349, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1188 = stablehlo.add %1186, %1187 : tensor<12x768xbf16>
    %1189 = stablehlo.divide %967, %1188 : tensor<12x768xbf16>
    %cst_350 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1190 = stablehlo.broadcast_in_dim %cst_350, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1191 = stablehlo.add %1054, %1190 : tensor<12x768xbf16>
    %1192 = stablehlo.sqrt %1191 : tensor<12x768xbf16>
    %cst_351 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1193 = stablehlo.broadcast_in_dim %cst_351, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1194 = stablehlo.add %1192, %1193 : tensor<12x768xbf16>
    %1195 = stablehlo.divide %970, %1194 : tensor<12x768xbf16>
    %cst_352 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1196 = stablehlo.broadcast_in_dim %cst_352, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1197 = stablehlo.add %1057, %1196 : tensor<12x768xbf16>
    %1198 = stablehlo.sqrt %1197 : tensor<12x768xbf16>
    %cst_353 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1199 = stablehlo.broadcast_in_dim %cst_353, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1200 = stablehlo.add %1198, %1199 : tensor<12x768xbf16>
    %1201 = stablehlo.divide %973, %1200 : tensor<12x768xbf16>
    %cst_354 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1202 = stablehlo.broadcast_in_dim %cst_354, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1203 = stablehlo.add %1060, %1202 : tensor<768x768xbf16>
    %1204 = stablehlo.sqrt %1203 : tensor<768x768xbf16>
    %cst_355 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1205 = stablehlo.broadcast_in_dim %cst_355, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1206 = stablehlo.add %1204, %1205 : tensor<768x768xbf16>
    %1207 = stablehlo.divide %976, %1206 : tensor<768x768xbf16>
    %cst_356 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1208 = stablehlo.broadcast_in_dim %cst_356, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1209 = stablehlo.add %1063, %1208 : tensor<768xbf16>
    %1210 = stablehlo.sqrt %1209 : tensor<768xbf16>
    %cst_357 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1211 = stablehlo.broadcast_in_dim %cst_357, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1212 = stablehlo.add %1210, %1211 : tensor<768xbf16>
    %1213 = stablehlo.divide %979, %1212 : tensor<768xbf16>
    %cst_358 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1214 = stablehlo.broadcast_in_dim %cst_358, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1215 = stablehlo.add %1066, %1214 : tensor<768xbf16>
    %1216 = stablehlo.sqrt %1215 : tensor<768xbf16>
    %cst_359 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1217 = stablehlo.broadcast_in_dim %cst_359, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1218 = stablehlo.add %1216, %1217 : tensor<768xbf16>
    %1219 = stablehlo.divide %982, %1218 : tensor<768xbf16>
    %cst_360 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1220 = stablehlo.broadcast_in_dim %cst_360, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1221 = stablehlo.add %1069, %1220 : tensor<768xbf16>
    %1222 = stablehlo.sqrt %1221 : tensor<768xbf16>
    %cst_361 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1223 = stablehlo.broadcast_in_dim %cst_361, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1224 = stablehlo.add %1222, %1223 : tensor<768xbf16>
    %1225 = stablehlo.divide %985, %1224 : tensor<768xbf16>
    %cst_362 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1226 = stablehlo.broadcast_in_dim %cst_362, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1227 = stablehlo.add %1072, %1226 : tensor<30522x768xbf16>
    %1228 = stablehlo.sqrt %1227 : tensor<30522x768xbf16>
    %cst_363 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1229 = stablehlo.broadcast_in_dim %cst_363, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1230 = stablehlo.add %1228, %1229 : tensor<30522x768xbf16>
    %1231 = stablehlo.divide %988, %1230 : tensor<30522x768xbf16>
    %cst_364 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1232 = stablehlo.broadcast_in_dim %cst_364, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1233 = stablehlo.add %1075, %1232 : tensor<30522xbf16>
    %1234 = stablehlo.sqrt %1233 : tensor<30522xbf16>
    %cst_365 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1235 = stablehlo.broadcast_in_dim %cst_365, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1236 = stablehlo.add %1234, %1235 : tensor<30522xbf16>
    %1237 = stablehlo.divide %991, %1236 : tensor<30522xbf16>
    %cst_366 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1238 = stablehlo.broadcast_in_dim %cst_366, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1239 = stablehlo.multiply %1238, %arg0 : tensor<30522x768xbf16>
    %1240 = stablehlo.add %1081, %1239 : tensor<30522x768xbf16>
    %cst_367 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1241 = stablehlo.broadcast_in_dim %cst_367, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1242 = stablehlo.multiply %1241, %arg1 : tensor<512x768xbf16>
    %1243 = stablehlo.add %1087, %1242 : tensor<512x768xbf16>
    %cst_368 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1244 = stablehlo.broadcast_in_dim %cst_368, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1245 = stablehlo.multiply %1244, %arg2 : tensor<2x768xbf16>
    %1246 = stablehlo.add %1093, %1245 : tensor<2x768xbf16>
    %cst_369 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1247 = stablehlo.broadcast_in_dim %cst_369, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1248 = stablehlo.multiply %1247, %arg3 : tensor<768xbf16>
    %1249 = stablehlo.add %1099, %1248 : tensor<768xbf16>
    %cst_370 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1250 = stablehlo.broadcast_in_dim %cst_370, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1251 = stablehlo.multiply %1250, %arg4 : tensor<768xbf16>
    %1252 = stablehlo.add %1105, %1251 : tensor<768xbf16>
    %cst_371 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1253 = stablehlo.broadcast_in_dim %cst_371, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1254 = stablehlo.multiply %1253, %arg5 : tensor<12x768x768xbf16>
    %1255 = stablehlo.add %1111, %1254 : tensor<12x768x768xbf16>
    %cst_372 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1256 = stablehlo.broadcast_in_dim %cst_372, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1257 = stablehlo.multiply %1256, %arg6 : tensor<12x768xbf16>
    %1258 = stablehlo.add %1117, %1257 : tensor<12x768xbf16>
    %cst_373 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1259 = stablehlo.broadcast_in_dim %cst_373, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1260 = stablehlo.multiply %1259, %arg7 : tensor<12x768x768xbf16>
    %1261 = stablehlo.add %1123, %1260 : tensor<12x768x768xbf16>
    %cst_374 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1262 = stablehlo.broadcast_in_dim %cst_374, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1263 = stablehlo.multiply %1262, %arg8 : tensor<12x768xbf16>
    %1264 = stablehlo.add %1129, %1263 : tensor<12x768xbf16>
    %cst_375 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1265 = stablehlo.broadcast_in_dim %cst_375, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1266 = stablehlo.multiply %1265, %arg9 : tensor<12x768x768xbf16>
    %1267 = stablehlo.add %1135, %1266 : tensor<12x768x768xbf16>
    %cst_376 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1268 = stablehlo.broadcast_in_dim %cst_376, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1269 = stablehlo.multiply %1268, %arg10 : tensor<12x768xbf16>
    %1270 = stablehlo.add %1141, %1269 : tensor<12x768xbf16>
    %cst_377 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1271 = stablehlo.broadcast_in_dim %cst_377, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1272 = stablehlo.multiply %1271, %arg11 : tensor<12x768x768xbf16>
    %1273 = stablehlo.add %1147, %1272 : tensor<12x768x768xbf16>
    %cst_378 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1274 = stablehlo.broadcast_in_dim %cst_378, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1275 = stablehlo.multiply %1274, %arg12 : tensor<12x768xbf16>
    %1276 = stablehlo.add %1153, %1275 : tensor<12x768xbf16>
    %cst_379 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1277 = stablehlo.broadcast_in_dim %cst_379, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1278 = stablehlo.multiply %1277, %arg13 : tensor<12x768xbf16>
    %1279 = stablehlo.add %1159, %1278 : tensor<12x768xbf16>
    %cst_380 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1280 = stablehlo.broadcast_in_dim %cst_380, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1281 = stablehlo.multiply %1280, %arg14 : tensor<12x768xbf16>
    %1282 = stablehlo.add %1165, %1281 : tensor<12x768xbf16>
    %cst_381 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1283 = stablehlo.broadcast_in_dim %cst_381, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1284 = stablehlo.multiply %1283, %arg15 : tensor<12x3072x768xbf16>
    %1285 = stablehlo.add %1171, %1284 : tensor<12x3072x768xbf16>
    %cst_382 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1286 = stablehlo.broadcast_in_dim %cst_382, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1287 = stablehlo.multiply %1286, %arg16 : tensor<12x3072xbf16>
    %1288 = stablehlo.add %1177, %1287 : tensor<12x3072xbf16>
    %cst_383 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1289 = stablehlo.broadcast_in_dim %cst_383, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1290 = stablehlo.multiply %1289, %arg17 : tensor<12x768x3072xbf16>
    %1291 = stablehlo.add %1183, %1290 : tensor<12x768x3072xbf16>
    %cst_384 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1292 = stablehlo.broadcast_in_dim %cst_384, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1293 = stablehlo.multiply %1292, %arg18 : tensor<12x768xbf16>
    %1294 = stablehlo.add %1189, %1293 : tensor<12x768xbf16>
    %cst_385 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1295 = stablehlo.broadcast_in_dim %cst_385, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1296 = stablehlo.multiply %1295, %arg19 : tensor<12x768xbf16>
    %1297 = stablehlo.add %1195, %1296 : tensor<12x768xbf16>
    %cst_386 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1298 = stablehlo.broadcast_in_dim %cst_386, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1299 = stablehlo.multiply %1298, %arg20 : tensor<12x768xbf16>
    %1300 = stablehlo.add %1201, %1299 : tensor<12x768xbf16>
    %cst_387 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1301 = stablehlo.broadcast_in_dim %cst_387, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1302 = stablehlo.multiply %1301, %arg21 : tensor<768x768xbf16>
    %1303 = stablehlo.add %1207, %1302 : tensor<768x768xbf16>
    %cst_388 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1304 = stablehlo.broadcast_in_dim %cst_388, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1305 = stablehlo.multiply %1304, %arg22 : tensor<768xbf16>
    %1306 = stablehlo.add %1213, %1305 : tensor<768xbf16>
    %cst_389 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1307 = stablehlo.broadcast_in_dim %cst_389, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1308 = stablehlo.multiply %1307, %arg23 : tensor<768xbf16>
    %1309 = stablehlo.add %1219, %1308 : tensor<768xbf16>
    %cst_390 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1310 = stablehlo.broadcast_in_dim %cst_390, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1311 = stablehlo.multiply %1310, %arg24 : tensor<768xbf16>
    %1312 = stablehlo.add %1225, %1311 : tensor<768xbf16>
    %cst_391 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1313 = stablehlo.broadcast_in_dim %cst_391, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1314 = stablehlo.multiply %1313, %arg25 : tensor<30522x768xbf16>
    %1315 = stablehlo.add %1231, %1314 : tensor<30522x768xbf16>
    %cst_392 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1316 = stablehlo.broadcast_in_dim %cst_392, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1317 = stablehlo.multiply %1316, %arg26 : tensor<30522xbf16>
    %1318 = stablehlo.add %1237, %1317 : tensor<30522xbf16>
    %c_393 = stablehlo.constant dense<0> : tensor<i32>
    %1319 = stablehlo.subtract %arg82, %c_393 : tensor<i32>
    %c_394 = stablehlo.constant dense<0> : tensor<i32>
    %c_395 = stablehlo.constant dense<1000> : tensor<i32>
    %1320 = call @clip(%1319, %c_394, %c_395) : (tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<i32>
    %1321 = stablehlo.convert %1320 : (tensor<i32>) -> tensor<f32>
    %cst_396 = stablehlo.constant dense<1.000000e+03> : tensor<f32>
    %1322 = stablehlo.divide %1321, %cst_396 : tensor<f32>
    %cst_397 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %1323 = stablehlo.subtract %cst_397, %1322 : tensor<f32>
    %cst_398 = stablehlo.constant dense<-5.000000e-05> : tensor<f32>
    %1324 = stablehlo.multiply %cst_398, %1323 : tensor<f32>
    %cst_399 = stablehlo.constant dense<5.000000e-05> : tensor<f32>
    %1325 = stablehlo.add %1324, %cst_399 : tensor<f32>
    %c_400 = stablehlo.constant dense<1000> : tensor<i32>
    %1326 = stablehlo.compare  LT, %arg82, %c_400,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
    %c_401 = stablehlo.constant dense<1000> : tensor<i32>
    %1327 = stablehlo.subtract %arg82, %c_401 : tensor<i32>
    %1328 = stablehlo.convert %1327 : (tensor<i32>) -> tensor<f32>
    %cst_402 = stablehlo.constant dense<9.000000e+03> : tensor<f32>
    %1329 = stablehlo.minimum %1328, %cst_402 : tensor<f32>
    %cst_403 = stablehlo.constant dense<3.14159274> : tensor<f32>
    %1330 = stablehlo.multiply %cst_403, %1329 : tensor<f32>
    %cst_404 = stablehlo.constant dense<9.000000e+03> : tensor<f32>
    %1331 = stablehlo.divide %1330, %cst_404 : tensor<f32>
    %1332 = stablehlo.cosine %1331 : tensor<f32>
    %cst_405 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %1333 = stablehlo.add %cst_405, %1332 : tensor<f32>
    %cst_406 = stablehlo.constant dense<5.000000e-01> : tensor<f32>
    %1334 = stablehlo.multiply %cst_406, %1333 : tensor<f32>
    %cst_407 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %1335 = stablehlo.power %1334, %cst_407 : tensor<f32>
    %cst_408 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %1336 = stablehlo.multiply %cst_408, %1335 : tensor<f32>
    %cst_409 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %1337 = stablehlo.add %1336, %cst_409 : tensor<f32>
    %cst_410 = stablehlo.constant dense<5.000000e-05> : tensor<f32>
    %1338 = stablehlo.multiply %cst_410, %1337 : tensor<f32>
    %1339 = call @_where_559(%1326, %1325, %1338) : (tensor<i1>, tensor<f32>, tensor<f32>) -> tensor<f32>
    %cst_411 = stablehlo.constant dense<-1.000000e+00> : tensor<f32>
    %1340 = stablehlo.multiply %cst_411, %1339 : tensor<f32>
    %1341 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1342 = stablehlo.broadcast_in_dim %1341, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1343 = stablehlo.multiply %1342, %1240 : tensor<30522x768xbf16>
    %1344 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1345 = stablehlo.broadcast_in_dim %1344, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1346 = stablehlo.multiply %1345, %1243 : tensor<512x768xbf16>
    %1347 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1348 = stablehlo.broadcast_in_dim %1347, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1349 = stablehlo.multiply %1348, %1246 : tensor<2x768xbf16>
    %1350 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1351 = stablehlo.broadcast_in_dim %1350, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1352 = stablehlo.multiply %1351, %1249 : tensor<768xbf16>
    %1353 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1354 = stablehlo.broadcast_in_dim %1353, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1355 = stablehlo.multiply %1354, %1252 : tensor<768xbf16>
    %1356 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1357 = stablehlo.broadcast_in_dim %1356, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1358 = stablehlo.multiply %1357, %1255 : tensor<12x768x768xbf16>
    %1359 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1360 = stablehlo.broadcast_in_dim %1359, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1361 = stablehlo.multiply %1360, %1258 : tensor<12x768xbf16>
    %1362 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1363 = stablehlo.broadcast_in_dim %1362, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1364 = stablehlo.multiply %1363, %1261 : tensor<12x768x768xbf16>
    %1365 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1366 = stablehlo.broadcast_in_dim %1365, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1367 = stablehlo.multiply %1366, %1264 : tensor<12x768xbf16>
    %1368 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1369 = stablehlo.broadcast_in_dim %1368, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1370 = stablehlo.multiply %1369, %1267 : tensor<12x768x768xbf16>
    %1371 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1372 = stablehlo.broadcast_in_dim %1371, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1373 = stablehlo.multiply %1372, %1270 : tensor<12x768xbf16>
    %1374 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1375 = stablehlo.broadcast_in_dim %1374, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1376 = stablehlo.multiply %1375, %1273 : tensor<12x768x768xbf16>
    %1377 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1378 = stablehlo.broadcast_in_dim %1377, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1379 = stablehlo.multiply %1378, %1276 : tensor<12x768xbf16>
    %1380 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1381 = stablehlo.broadcast_in_dim %1380, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1382 = stablehlo.multiply %1381, %1279 : tensor<12x768xbf16>
    %1383 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1384 = stablehlo.broadcast_in_dim %1383, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1385 = stablehlo.multiply %1384, %1282 : tensor<12x768xbf16>
    %1386 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1387 = stablehlo.broadcast_in_dim %1386, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1388 = stablehlo.multiply %1387, %1285 : tensor<12x3072x768xbf16>
    %1389 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1390 = stablehlo.broadcast_in_dim %1389, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1391 = stablehlo.multiply %1390, %1288 : tensor<12x3072xbf16>
    %1392 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1393 = stablehlo.broadcast_in_dim %1392, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1394 = stablehlo.multiply %1393, %1291 : tensor<12x768x3072xbf16>
    %1395 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1396 = stablehlo.broadcast_in_dim %1395, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1397 = stablehlo.multiply %1396, %1294 : tensor<12x768xbf16>
    %1398 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1399 = stablehlo.broadcast_in_dim %1398, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1400 = stablehlo.multiply %1399, %1297 : tensor<12x768xbf16>
    %1401 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1402 = stablehlo.broadcast_in_dim %1401, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1403 = stablehlo.multiply %1402, %1300 : tensor<12x768xbf16>
    %1404 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1405 = stablehlo.broadcast_in_dim %1404, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1406 = stablehlo.multiply %1405, %1303 : tensor<768x768xbf16>
    %1407 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1408 = stablehlo.broadcast_in_dim %1407, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1409 = stablehlo.multiply %1408, %1306 : tensor<768xbf16>
    %1410 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1411 = stablehlo.broadcast_in_dim %1410, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1412 = stablehlo.multiply %1411, %1309 : tensor<768xbf16>
    %1413 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1414 = stablehlo.broadcast_in_dim %1413, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1415 = stablehlo.multiply %1414, %1312 : tensor<768xbf16>
    %1416 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1417 = stablehlo.broadcast_in_dim %1416, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1418 = stablehlo.multiply %1417, %1315 : tensor<30522x768xbf16>
    %1419 = stablehlo.convert %1340 : (tensor<f32>) -> tensor<bf16>
    %1420 = stablehlo.broadcast_in_dim %1419, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1421 = stablehlo.multiply %1420, %1318 : tensor<30522xbf16>
    %c_412 = stablehlo.constant dense<2147483647> : tensor<i32>
    %1422 = stablehlo.compare  LT, %arg82, %c_412,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
    %c_413 = stablehlo.constant dense<1> : tensor<i32>
    %1423 = stablehlo.add %arg82, %c_413 : tensor<i32>
    %c_414 = stablehlo.constant dense<2147483647> : tensor<i32>
    %1424 = call @_where_501(%1422, %1423, %c_414) : (tensor<i1>, tensor<i32>, tensor<i32>) -> tensor<i32>
    %1425 = stablehlo.add %arg0, %1343 : tensor<30522x768xbf16>
    %1426 = stablehlo.add %arg1, %1346 : tensor<512x768xbf16>
    %1427 = stablehlo.add %arg2, %1349 : tensor<2x768xbf16>
    %1428 = stablehlo.add %arg3, %1352 : tensor<768xbf16>
    %1429 = stablehlo.add %arg4, %1355 : tensor<768xbf16>
    %1430 = stablehlo.add %arg5, %1358 : tensor<12x768x768xbf16>
    %1431 = stablehlo.add %arg6, %1361 : tensor<12x768xbf16>
    %1432 = stablehlo.add %arg7, %1364 : tensor<12x768x768xbf16>
    %1433 = stablehlo.add %arg8, %1367 : tensor<12x768xbf16>
    %1434 = stablehlo.add %arg9, %1370 : tensor<12x768x768xbf16>
    %1435 = stablehlo.add %arg10, %1373 : tensor<12x768xbf16>
    %1436 = stablehlo.add %arg11, %1376 : tensor<12x768x768xbf16>
    %1437 = stablehlo.add %arg12, %1379 : tensor<12x768xbf16>
    %1438 = stablehlo.add %arg13, %1382 : tensor<12x768xbf16>
    %1439 = stablehlo.add %arg14, %1385 : tensor<12x768xbf16>
    %1440 = stablehlo.add %arg15, %1388 : tensor<12x3072x768xbf16>
    %1441 = stablehlo.add %arg16, %1391 : tensor<12x3072xbf16>
    %1442 = stablehlo.add %arg17, %1394 : tensor<12x768x3072xbf16>
    %1443 = stablehlo.add %arg18, %1397 : tensor<12x768xbf16>
    %1444 = stablehlo.add %arg19, %1400 : tensor<12x768xbf16>
    %1445 = stablehlo.add %arg20, %1403 : tensor<12x768xbf16>
    %1446 = stablehlo.add %arg21, %1406 : tensor<768x768xbf16>
    %1447 = stablehlo.add %arg22, %1409 : tensor<768xbf16>
    %1448 = stablehlo.add %arg23, %1412 : tensor<768xbf16>
    %1449 = stablehlo.add %arg24, %1415 : tensor<768xbf16>
    %1450 = stablehlo.add %arg25, %1418 : tensor<30522x768xbf16>
    %1451 = stablehlo.add %arg26, %1421 : tensor<30522xbf16>
    %c_415 = stablehlo.constant dense<0> : tensor<i32>
    return %c_415, %1425, %1426, %1427, %1428, %1429, %1430, %1431, %1432, %1433, %1434, %1435, %1436, %1437, %1438, %1439, %1440, %1441, %1442, %1443, %1444, %1445, %1446, %1447, %1448, %1449, %1450, %1451, %907, %612, %617, %622, %627, %632, %637, %642, %647, %652, %657, %662, %667, %672, %677, %682, %687, %692, %697, %702, %707, %712, %717, %722, %727, %732, %737, %742, %748, %754, %760, %766, %772, %778, %784, %790, %796, %802, %808, %814, %820, %826, %832, %838, %844, %850, %856, %862, %868, %874, %880, %886, %892, %898, %904, %1424, %216, %211, %209, %211, %211 : tensor<i32>, tensor<30522x768xbf16>, tensor<512x768xbf16>, tensor<2x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<30522x768xbf16>, tensor<30522xbf16>, tensor<i32>, tensor<30522x768xbf16>, tensor<512x768xbf16>, tensor<2x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<30522x768xbf16>, tensor<30522xbf16>, tensor<30522x768xbf16>, tensor<512x768xbf16>, tensor<2x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<30522x768xbf16>, tensor<30522xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<f32>, tensor<i32>, tensor<i32>
  }
  func.func private @_threefry_split(%arg0: tensor<2xui32>) -> tensor<2x2xui32> {
    %0 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %1 = stablehlo.reshape %0 : (tensor<1xui32>) -> tensor<ui32>
    %2 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %3 = stablehlo.reshape %2 : (tensor<1xui32>) -> tensor<ui32>
    %4 = stablehlo.iota dim = 0 : tensor<2xui64>
    %c = stablehlo.constant dense<1> : tensor<ui64>
    %5 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<2xui64>
    %6 = stablehlo.multiply %5, %4 : tensor<2xui64>
    %c_0 = stablehlo.constant dense<32> : tensor<ui64>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<2xui64>
    %8 = stablehlo.shift_right_logical %6, %7 : tensor<2xui64>
    %9 = stablehlo.convert %6 : (tensor<2xui64>) -> tensor<2xui32>
    %10 = stablehlo.convert %8 : (tensor<2xui64>) -> tensor<2xui32>
    %11:2 = call @threefry2x32(%1, %3, %10, %9) : (tensor<ui32>, tensor<ui32>, tensor<2xui32>, tensor<2xui32>) -> (tensor<2xui32>, tensor<2xui32>)
    %12 = stablehlo.broadcast_in_dim %11#0, dims = [0] : (tensor<2xui32>) -> tensor<2x1xui32>
    %13 = stablehlo.broadcast_in_dim %11#1, dims = [0] : (tensor<2xui32>) -> tensor<2x1xui32>
    %14 = stablehlo.concatenate %12, %13, dim = 1 : (tensor<2x1xui32>, tensor<2x1xui32>) -> tensor<2x2xui32>
    return %14 : tensor<2x2xui32>
  }
  func.func private @threefry2x32(%arg0: tensor<ui32>, %arg1: tensor<ui32>, %arg2: tensor<2xui32>, %arg3: tensor<2xui32>) -> (tensor<2xui32>, tensor<2xui32>) {
    %0 = stablehlo.xor %arg0, %arg1 : tensor<ui32>
    %c = stablehlo.constant dense<466688986> : tensor<ui32>
    %1 = stablehlo.xor %0, %c : tensor<ui32>
    %2 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %3 = stablehlo.add %arg2, %2 : tensor<2xui32>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %5 = stablehlo.add %arg3, %4 : tensor<2xui32>
    %6 = stablehlo.add %3, %5 : tensor<2xui32>
    %c_0 = stablehlo.constant dense<13> : tensor<ui32>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %8 = stablehlo.shift_left %5, %7 : tensor<2xui32>
    %c_1 = stablehlo.constant dense<19> : tensor<ui32>
    %9 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %10 = stablehlo.shift_right_logical %5, %9 : tensor<2xui32>
    %11 = stablehlo.or %8, %10 : tensor<2xui32>
    %12 = stablehlo.xor %6, %11 : tensor<2xui32>
    %13 = stablehlo.add %6, %12 : tensor<2xui32>
    %c_2 = stablehlo.constant dense<15> : tensor<ui32>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %15 = stablehlo.shift_left %12, %14 : tensor<2xui32>
    %c_3 = stablehlo.constant dense<17> : tensor<ui32>
    %16 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %17 = stablehlo.shift_right_logical %12, %16 : tensor<2xui32>
    %18 = stablehlo.or %15, %17 : tensor<2xui32>
    %19 = stablehlo.xor %13, %18 : tensor<2xui32>
    %20 = stablehlo.add %13, %19 : tensor<2xui32>
    %c_4 = stablehlo.constant dense<26> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %22 = stablehlo.shift_left %19, %21 : tensor<2xui32>
    %c_5 = stablehlo.constant dense<6> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %24 = stablehlo.shift_right_logical %19, %23 : tensor<2xui32>
    %25 = stablehlo.or %22, %24 : tensor<2xui32>
    %26 = stablehlo.xor %20, %25 : tensor<2xui32>
    %27 = stablehlo.add %20, %26 : tensor<2xui32>
    %c_6 = stablehlo.constant dense<6> : tensor<ui32>
    %28 = stablehlo.broadcast_in_dim %c_6, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %29 = stablehlo.shift_left %26, %28 : tensor<2xui32>
    %c_7 = stablehlo.constant dense<26> : tensor<ui32>
    %30 = stablehlo.broadcast_in_dim %c_7, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %31 = stablehlo.shift_right_logical %26, %30 : tensor<2xui32>
    %32 = stablehlo.or %29, %31 : tensor<2xui32>
    %33 = stablehlo.xor %27, %32 : tensor<2xui32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %35 = stablehlo.add %27, %34 : tensor<2xui32>
    %36 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %37 = stablehlo.add %33, %36 : tensor<2xui32>
    %c_8 = stablehlo.constant dense<1> : tensor<ui32>
    %38 = stablehlo.broadcast_in_dim %c_8, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %39 = stablehlo.add %37, %38 : tensor<2xui32>
    %40 = stablehlo.add %35, %39 : tensor<2xui32>
    %c_9 = stablehlo.constant dense<17> : tensor<ui32>
    %41 = stablehlo.broadcast_in_dim %c_9, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %42 = stablehlo.shift_left %39, %41 : tensor<2xui32>
    %c_10 = stablehlo.constant dense<15> : tensor<ui32>
    %43 = stablehlo.broadcast_in_dim %c_10, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %44 = stablehlo.shift_right_logical %39, %43 : tensor<2xui32>
    %45 = stablehlo.or %42, %44 : tensor<2xui32>
    %46 = stablehlo.xor %40, %45 : tensor<2xui32>
    %47 = stablehlo.add %40, %46 : tensor<2xui32>
    %c_11 = stablehlo.constant dense<29> : tensor<ui32>
    %48 = stablehlo.broadcast_in_dim %c_11, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %49 = stablehlo.shift_left %46, %48 : tensor<2xui32>
    %c_12 = stablehlo.constant dense<3> : tensor<ui32>
    %50 = stablehlo.broadcast_in_dim %c_12, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %51 = stablehlo.shift_right_logical %46, %50 : tensor<2xui32>
    %52 = stablehlo.or %49, %51 : tensor<2xui32>
    %53 = stablehlo.xor %47, %52 : tensor<2xui32>
    %54 = stablehlo.add %47, %53 : tensor<2xui32>
    %c_13 = stablehlo.constant dense<16> : tensor<ui32>
    %55 = stablehlo.broadcast_in_dim %c_13, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %56 = stablehlo.shift_left %53, %55 : tensor<2xui32>
    %c_14 = stablehlo.constant dense<16> : tensor<ui32>
    %57 = stablehlo.broadcast_in_dim %c_14, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %58 = stablehlo.shift_right_logical %53, %57 : tensor<2xui32>
    %59 = stablehlo.or %56, %58 : tensor<2xui32>
    %60 = stablehlo.xor %54, %59 : tensor<2xui32>
    %61 = stablehlo.add %54, %60 : tensor<2xui32>
    %c_15 = stablehlo.constant dense<24> : tensor<ui32>
    %62 = stablehlo.broadcast_in_dim %c_15, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %63 = stablehlo.shift_left %60, %62 : tensor<2xui32>
    %c_16 = stablehlo.constant dense<8> : tensor<ui32>
    %64 = stablehlo.broadcast_in_dim %c_16, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %65 = stablehlo.shift_right_logical %60, %64 : tensor<2xui32>
    %66 = stablehlo.or %63, %65 : tensor<2xui32>
    %67 = stablehlo.xor %61, %66 : tensor<2xui32>
    %68 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %69 = stablehlo.add %61, %68 : tensor<2xui32>
    %70 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %71 = stablehlo.add %67, %70 : tensor<2xui32>
    %c_17 = stablehlo.constant dense<2> : tensor<ui32>
    %72 = stablehlo.broadcast_in_dim %c_17, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %73 = stablehlo.add %71, %72 : tensor<2xui32>
    %74 = stablehlo.add %69, %73 : tensor<2xui32>
    %c_18 = stablehlo.constant dense<13> : tensor<ui32>
    %75 = stablehlo.broadcast_in_dim %c_18, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %76 = stablehlo.shift_left %73, %75 : tensor<2xui32>
    %c_19 = stablehlo.constant dense<19> : tensor<ui32>
    %77 = stablehlo.broadcast_in_dim %c_19, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %78 = stablehlo.shift_right_logical %73, %77 : tensor<2xui32>
    %79 = stablehlo.or %76, %78 : tensor<2xui32>
    %80 = stablehlo.xor %74, %79 : tensor<2xui32>
    %81 = stablehlo.add %74, %80 : tensor<2xui32>
    %c_20 = stablehlo.constant dense<15> : tensor<ui32>
    %82 = stablehlo.broadcast_in_dim %c_20, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %83 = stablehlo.shift_left %80, %82 : tensor<2xui32>
    %c_21 = stablehlo.constant dense<17> : tensor<ui32>
    %84 = stablehlo.broadcast_in_dim %c_21, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %85 = stablehlo.shift_right_logical %80, %84 : tensor<2xui32>
    %86 = stablehlo.or %83, %85 : tensor<2xui32>
    %87 = stablehlo.xor %81, %86 : tensor<2xui32>
    %88 = stablehlo.add %81, %87 : tensor<2xui32>
    %c_22 = stablehlo.constant dense<26> : tensor<ui32>
    %89 = stablehlo.broadcast_in_dim %c_22, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %90 = stablehlo.shift_left %87, %89 : tensor<2xui32>
    %c_23 = stablehlo.constant dense<6> : tensor<ui32>
    %91 = stablehlo.broadcast_in_dim %c_23, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %92 = stablehlo.shift_right_logical %87, %91 : tensor<2xui32>
    %93 = stablehlo.or %90, %92 : tensor<2xui32>
    %94 = stablehlo.xor %88, %93 : tensor<2xui32>
    %95 = stablehlo.add %88, %94 : tensor<2xui32>
    %c_24 = stablehlo.constant dense<6> : tensor<ui32>
    %96 = stablehlo.broadcast_in_dim %c_24, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %97 = stablehlo.shift_left %94, %96 : tensor<2xui32>
    %c_25 = stablehlo.constant dense<26> : tensor<ui32>
    %98 = stablehlo.broadcast_in_dim %c_25, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %99 = stablehlo.shift_right_logical %94, %98 : tensor<2xui32>
    %100 = stablehlo.or %97, %99 : tensor<2xui32>
    %101 = stablehlo.xor %95, %100 : tensor<2xui32>
    %102 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %103 = stablehlo.add %95, %102 : tensor<2xui32>
    %104 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %105 = stablehlo.add %101, %104 : tensor<2xui32>
    %c_26 = stablehlo.constant dense<3> : tensor<ui32>
    %106 = stablehlo.broadcast_in_dim %c_26, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %107 = stablehlo.add %105, %106 : tensor<2xui32>
    %108 = stablehlo.add %103, %107 : tensor<2xui32>
    %c_27 = stablehlo.constant dense<17> : tensor<ui32>
    %109 = stablehlo.broadcast_in_dim %c_27, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %110 = stablehlo.shift_left %107, %109 : tensor<2xui32>
    %c_28 = stablehlo.constant dense<15> : tensor<ui32>
    %111 = stablehlo.broadcast_in_dim %c_28, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %112 = stablehlo.shift_right_logical %107, %111 : tensor<2xui32>
    %113 = stablehlo.or %110, %112 : tensor<2xui32>
    %114 = stablehlo.xor %108, %113 : tensor<2xui32>
    %115 = stablehlo.add %108, %114 : tensor<2xui32>
    %c_29 = stablehlo.constant dense<29> : tensor<ui32>
    %116 = stablehlo.broadcast_in_dim %c_29, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %117 = stablehlo.shift_left %114, %116 : tensor<2xui32>
    %c_30 = stablehlo.constant dense<3> : tensor<ui32>
    %118 = stablehlo.broadcast_in_dim %c_30, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %119 = stablehlo.shift_right_logical %114, %118 : tensor<2xui32>
    %120 = stablehlo.or %117, %119 : tensor<2xui32>
    %121 = stablehlo.xor %115, %120 : tensor<2xui32>
    %122 = stablehlo.add %115, %121 : tensor<2xui32>
    %c_31 = stablehlo.constant dense<16> : tensor<ui32>
    %123 = stablehlo.broadcast_in_dim %c_31, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %124 = stablehlo.shift_left %121, %123 : tensor<2xui32>
    %c_32 = stablehlo.constant dense<16> : tensor<ui32>
    %125 = stablehlo.broadcast_in_dim %c_32, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %126 = stablehlo.shift_right_logical %121, %125 : tensor<2xui32>
    %127 = stablehlo.or %124, %126 : tensor<2xui32>
    %128 = stablehlo.xor %122, %127 : tensor<2xui32>
    %129 = stablehlo.add %122, %128 : tensor<2xui32>
    %c_33 = stablehlo.constant dense<24> : tensor<ui32>
    %130 = stablehlo.broadcast_in_dim %c_33, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %131 = stablehlo.shift_left %128, %130 : tensor<2xui32>
    %c_34 = stablehlo.constant dense<8> : tensor<ui32>
    %132 = stablehlo.broadcast_in_dim %c_34, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %133 = stablehlo.shift_right_logical %128, %132 : tensor<2xui32>
    %134 = stablehlo.or %131, %133 : tensor<2xui32>
    %135 = stablehlo.xor %129, %134 : tensor<2xui32>
    %136 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %137 = stablehlo.add %129, %136 : tensor<2xui32>
    %138 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %139 = stablehlo.add %135, %138 : tensor<2xui32>
    %c_35 = stablehlo.constant dense<4> : tensor<ui32>
    %140 = stablehlo.broadcast_in_dim %c_35, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %141 = stablehlo.add %139, %140 : tensor<2xui32>
    %142 = stablehlo.add %137, %141 : tensor<2xui32>
    %c_36 = stablehlo.constant dense<13> : tensor<ui32>
    %143 = stablehlo.broadcast_in_dim %c_36, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %144 = stablehlo.shift_left %141, %143 : tensor<2xui32>
    %c_37 = stablehlo.constant dense<19> : tensor<ui32>
    %145 = stablehlo.broadcast_in_dim %c_37, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %146 = stablehlo.shift_right_logical %141, %145 : tensor<2xui32>
    %147 = stablehlo.or %144, %146 : tensor<2xui32>
    %148 = stablehlo.xor %142, %147 : tensor<2xui32>
    %149 = stablehlo.add %142, %148 : tensor<2xui32>
    %c_38 = stablehlo.constant dense<15> : tensor<ui32>
    %150 = stablehlo.broadcast_in_dim %c_38, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %151 = stablehlo.shift_left %148, %150 : tensor<2xui32>
    %c_39 = stablehlo.constant dense<17> : tensor<ui32>
    %152 = stablehlo.broadcast_in_dim %c_39, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %153 = stablehlo.shift_right_logical %148, %152 : tensor<2xui32>
    %154 = stablehlo.or %151, %153 : tensor<2xui32>
    %155 = stablehlo.xor %149, %154 : tensor<2xui32>
    %156 = stablehlo.add %149, %155 : tensor<2xui32>
    %c_40 = stablehlo.constant dense<26> : tensor<ui32>
    %157 = stablehlo.broadcast_in_dim %c_40, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %158 = stablehlo.shift_left %155, %157 : tensor<2xui32>
    %c_41 = stablehlo.constant dense<6> : tensor<ui32>
    %159 = stablehlo.broadcast_in_dim %c_41, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %160 = stablehlo.shift_right_logical %155, %159 : tensor<2xui32>
    %161 = stablehlo.or %158, %160 : tensor<2xui32>
    %162 = stablehlo.xor %156, %161 : tensor<2xui32>
    %163 = stablehlo.add %156, %162 : tensor<2xui32>
    %c_42 = stablehlo.constant dense<6> : tensor<ui32>
    %164 = stablehlo.broadcast_in_dim %c_42, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %165 = stablehlo.shift_left %162, %164 : tensor<2xui32>
    %c_43 = stablehlo.constant dense<26> : tensor<ui32>
    %166 = stablehlo.broadcast_in_dim %c_43, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %167 = stablehlo.shift_right_logical %162, %166 : tensor<2xui32>
    %168 = stablehlo.or %165, %167 : tensor<2xui32>
    %169 = stablehlo.xor %163, %168 : tensor<2xui32>
    %170 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %171 = stablehlo.add %163, %170 : tensor<2xui32>
    %172 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %173 = stablehlo.add %169, %172 : tensor<2xui32>
    %c_44 = stablehlo.constant dense<5> : tensor<ui32>
    %174 = stablehlo.broadcast_in_dim %c_44, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %175 = stablehlo.add %173, %174 : tensor<2xui32>
    return %171, %175 : tensor<2xui32>, tensor<2xui32>
  }
  func.func private @_take(%arg0: tensor<30522x768xbf16>, %arg1: tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %1 = stablehlo.compare  LT, %arg1, %0,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %c_0 = stablehlo.constant dense<30522> : tensor<i32>
    %2 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %3 = stablehlo.add %arg1, %2 : tensor<64x512xi32>
    %4 = call @_where(%1, %3, %arg1) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %c_1 = stablehlo.constant dense<30521> : tensor<1xi32>
    %c_2 = stablehlo.constant dense<0> : tensor<i32>
    %6 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %7 = stablehlo.compare  GE, %5, %6,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %8 = stablehlo.broadcast_in_dim %c_1, dims = [2] : (tensor<1xi32>) -> tensor<1x1x1xi32>
    %9 = stablehlo.broadcast_in_dim %8, dims = [0, 1, 2] : (tensor<1x1x1xi32>) -> tensor<64x512x1xi32>
    %10 = stablehlo.compare  LE, %5, %9,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %11 = stablehlo.and %7, %10 : tensor<64x512x1xi1>
    %c_3 = stablehlo.constant dense<true> : tensor<i1>
    %12 = stablehlo.reduce(%11 init: %c_3) applies stablehlo.and across dimensions = [2] : (tensor<64x512x1xi1>, tensor<i1>) -> tensor<64x512xi1>
    %13 = "stablehlo.gather"(%arg0, %5) <{dimension_numbers = #stablehlo.gather<offset_dims = [2], collapsed_slice_dims = [0], start_index_map = [0], index_vector_dim = 2>, indices_are_sorted = false, slice_sizes = array<i64: 1, 768>}> : (tensor<30522x768xbf16>, tensor<64x512x1xi32>) -> tensor<64x512x768xbf16>
    %14 = stablehlo.broadcast_in_dim %12, dims = [0, 1] : (tensor<64x512xi1>) -> tensor<64x512x768xi1>
    %cst = stablehlo.constant dense<0x7FC0> : tensor<bf16>
    %15 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %16 = stablehlo.select %14, %13, %15 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %16, %5 : tensor<64x512x768xbf16>, tensor<64x512x1xi32>
  }
  func.func private @_where(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xi32>, %arg2: tensor<64x512xi32>) -> tensor<64x512xi32> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<64x512xi1>, tensor<64x512xi32>
    return %0 : tensor<64x512xi32>
  }
  func.func private @_take_15(%arg0: tensor<512x768xbf16>, %arg1: tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %1 = stablehlo.compare  LT, %arg1, %0,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %c_0 = stablehlo.constant dense<512> : tensor<i32>
    %2 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %3 = stablehlo.add %arg1, %2 : tensor<64x512xi32>
    %4 = call @_where_18(%1, %3, %arg1) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %c_1 = stablehlo.constant dense<511> : tensor<1xi32>
    %c_2 = stablehlo.constant dense<0> : tensor<i32>
    %6 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %7 = stablehlo.compare  GE, %5, %6,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %8 = stablehlo.broadcast_in_dim %c_1, dims = [2] : (tensor<1xi32>) -> tensor<1x1x1xi32>
    %9 = stablehlo.broadcast_in_dim %8, dims = [0, 1, 2] : (tensor<1x1x1xi32>) -> tensor<64x512x1xi32>
    %10 = stablehlo.compare  LE, %5, %9,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %11 = stablehlo.and %7, %10 : tensor<64x512x1xi1>
    %c_3 = stablehlo.constant dense<true> : tensor<i1>
    %12 = stablehlo.reduce(%11 init: %c_3) applies stablehlo.and across dimensions = [2] : (tensor<64x512x1xi1>, tensor<i1>) -> tensor<64x512xi1>
    %13 = "stablehlo.gather"(%arg0, %5) <{dimension_numbers = #stablehlo.gather<offset_dims = [2], collapsed_slice_dims = [0], start_index_map = [0], index_vector_dim = 2>, indices_are_sorted = false, slice_sizes = array<i64: 1, 768>}> : (tensor<512x768xbf16>, tensor<64x512x1xi32>) -> tensor<64x512x768xbf16>
    %14 = stablehlo.broadcast_in_dim %12, dims = [0, 1] : (tensor<64x512xi1>) -> tensor<64x512x768xi1>
    %cst = stablehlo.constant dense<0x7FC0> : tensor<bf16>
    %15 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %16 = stablehlo.select %14, %13, %15 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %16, %5 : tensor<64x512x768xbf16>, tensor<64x512x1xi32>
  }
  func.func private @_where_18(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xi32>, %arg2: tensor<64x512xi32>) -> tensor<64x512xi32> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<64x512xi1>, tensor<64x512xi32>
    return %0 : tensor<64x512xi32>
  }
  func.func private @_take_29(%arg0: tensor<2x768xbf16>, %arg1: tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %1 = stablehlo.compare  LT, %arg1, %0,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %c_0 = stablehlo.constant dense<2> : tensor<i32>
    %2 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %3 = stablehlo.add %arg1, %2 : tensor<64x512xi32>
    %4 = call @_where(%1, %3, %arg1) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %c_1 = stablehlo.constant dense<1> : tensor<1xi32>
    %c_2 = stablehlo.constant dense<0> : tensor<i32>
    %6 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %7 = stablehlo.compare  GE, %5, %6,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %8 = stablehlo.broadcast_in_dim %c_1, dims = [2] : (tensor<1xi32>) -> tensor<1x1x1xi32>
    %9 = stablehlo.broadcast_in_dim %8, dims = [0, 1, 2] : (tensor<1x1x1xi32>) -> tensor<64x512x1xi32>
    %10 = stablehlo.compare  LE, %5, %9,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %11 = stablehlo.and %7, %10 : tensor<64x512x1xi1>
    %c_3 = stablehlo.constant dense<true> : tensor<i1>
    %12 = stablehlo.reduce(%11 init: %c_3) applies stablehlo.and across dimensions = [2] : (tensor<64x512x1xi1>, tensor<i1>) -> tensor<64x512xi1>
    %13 = "stablehlo.gather"(%arg0, %5) <{dimension_numbers = #stablehlo.gather<offset_dims = [2], collapsed_slice_dims = [0], start_index_map = [0], index_vector_dim = 2>, indices_are_sorted = false, slice_sizes = array<i64: 1, 768>}> : (tensor<2x768xbf16>, tensor<64x512x1xi32>) -> tensor<64x512x768xbf16>
    %14 = stablehlo.broadcast_in_dim %12, dims = [0, 1] : (tensor<64x512xi1>) -> tensor<64x512x768xi1>
    %cst = stablehlo.constant dense<0x7FC0> : tensor<bf16>
    %15 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %16 = stablehlo.select %14, %13, %15 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %16, %5 : tensor<64x512x768xbf16>, tensor<64x512x1xi32>
  }
  func.func private @_var(%arg0: tensor<64x512x768xbf16>, %arg1: tensor<i32>) -> (tensor<64x512x1xbf16>, tensor<64x512x768xf32>, tensor<f32>, tensor<i1>) {
    %0 = stablehlo.convert %arg0 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %1 = stablehlo.reduce(%0 init: %cst) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %2 = stablehlo.broadcast_in_dim %1, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_0 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %3 = stablehlo.broadcast_in_dim %cst_0, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %4 = stablehlo.divide %2, %3 : tensor<64x512x1xf32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %6 = stablehlo.subtract %0, %5 : tensor<64x512x768xf32>
    %7 = stablehlo.multiply %6, %6 : tensor<64x512x768xf32>
    %cst_1 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %8 = stablehlo.broadcast_in_dim %cst_1, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %9 = stablehlo.multiply %8, %6 : tensor<64x512x768xf32>
    %10 = stablehlo.convert %arg1 : (tensor<i32>) -> tensor<f32>
    %cst_2 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %11 = stablehlo.subtract %cst_2, %10 : tensor<f32>
    %cst_3 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %12 = stablehlo.reduce(%7 init: %cst_3) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %13 = stablehlo.broadcast_in_dim %12, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %14 = stablehlo.broadcast_in_dim %11, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %15 = stablehlo.divide %13, %14 : tensor<64x512x1xf32>
    %16 = stablehlo.convert %15 : (tensor<64x512x1xf32>) -> tensor<64x512x1xbf16>
    %cst_4 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %17 = stablehlo.compare  GT, %11, %cst_4,  FLOAT : (tensor<f32>, tensor<f32>) -> tensor<i1>
    %cst_5 = stablehlo.constant dense<0x7FC00000> : tensor<f32>
    %18 = call @_where_36(%17, %16, %cst_5) : (tensor<i1>, tensor<64x512x1xbf16>, tensor<f32>) -> tensor<64x512x1xbf16>
    return %18, %9, %11, %17 : tensor<64x512x1xbf16>, tensor<64x512x768xf32>, tensor<f32>, tensor<i1>
  }
  func.func private @_where_36(%arg0: tensor<i1>, %arg1: tensor<64x512x1xbf16>, %arg2: tensor<f32>) -> tensor<64x512x1xbf16> {
    %0 = stablehlo.convert %arg2 : (tensor<f32>) -> tensor<bf16>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %2 = stablehlo.select %arg0, %arg1, %1 : tensor<i1>, tensor<64x512x1xbf16>
    return %2 : tensor<64x512x1xbf16>
  }
  func.func private @_bernoulli(%arg0: tensor<2xui32>, %arg1: tensor<f32>) -> tensor<64x512x768xi1> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %cst_0 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %0 = call @_uniform(%arg0, %cst, %cst_0) : (tensor<2xui32>, tensor<f32>, tensor<f32>) -> tensor<64x512x768xf32>
    %1 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %2 = stablehlo.compare  LT, %0, %1,  FLOAT : (tensor<64x512x768xf32>, tensor<64x512x768xf32>) -> tensor<64x512x768xi1>
    return %2 : tensor<64x512x768xi1>
  }
  func.func private @_uniform(%arg0: tensor<2xui32>, %arg1: tensor<f32>, %arg2: tensor<f32>) -> tensor<64x512x768xf32> {
    %0 = stablehlo.convert %arg1 : tensor<f32>
    %1 = stablehlo.convert %arg2 : tensor<f32>
    %2 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<f32>) -> tensor<1x1x1xf32>
    %3 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<f32>) -> tensor<1x1x1xf32>
    %4 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %5 = stablehlo.reshape %4 : (tensor<1xui32>) -> tensor<ui32>
    %6 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %7 = stablehlo.reshape %6 : (tensor<1xui32>) -> tensor<ui32>
    %8 = stablehlo.iota dim = 0 : tensor<64x512x768xui64>
    %9 = stablehlo.iota dim = 1 : tensor<64x512x768xui64>
    %10 = stablehlo.iota dim = 2 : tensor<64x512x768xui64>
    %c = stablehlo.constant dense<393216> : tensor<ui64>
    %11 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %12 = stablehlo.multiply %11, %8 : tensor<64x512x768xui64>
    %c_0 = stablehlo.constant dense<768> : tensor<ui64>
    %13 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %14 = stablehlo.multiply %13, %9 : tensor<64x512x768xui64>
    %c_1 = stablehlo.constant dense<1> : tensor<ui64>
    %15 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %16 = stablehlo.multiply %15, %10 : tensor<64x512x768xui64>
    %17 = stablehlo.add %12, %14 : tensor<64x512x768xui64>
    %18 = stablehlo.add %17, %16 : tensor<64x512x768xui64>
    %c_2 = stablehlo.constant dense<32> : tensor<ui64>
    %19 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %20 = stablehlo.shift_right_logical %18, %19 : tensor<64x512x768xui64>
    %21 = stablehlo.convert %18 : (tensor<64x512x768xui64>) -> tensor<64x512x768xui32>
    %22 = stablehlo.convert %20 : (tensor<64x512x768xui64>) -> tensor<64x512x768xui32>
    %23:2 = call @threefry2x32_53(%5, %7, %22, %21) : (tensor<ui32>, tensor<ui32>, tensor<64x512x768xui32>, tensor<64x512x768xui32>) -> (tensor<64x512x768xui32>, tensor<64x512x768xui32>)
    %24 = stablehlo.xor %23#0, %23#1 : tensor<64x512x768xui32>
    %c_3 = stablehlo.constant dense<9> : tensor<ui32>
    %25 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %26 = stablehlo.shift_right_logical %24, %25 : tensor<64x512x768xui32>
    %c_4 = stablehlo.constant dense<1065353216> : tensor<ui32>
    %27 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %28 = stablehlo.or %26, %27 : tensor<64x512x768xui32>
    %29 = stablehlo.bitcast_convert %28 : (tensor<64x512x768xui32>) -> tensor<64x512x768xf32>
    %cst = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %30 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %31 = stablehlo.subtract %29, %30 : tensor<64x512x768xf32>
    %32 = stablehlo.subtract %3, %2 : tensor<1x1x1xf32>
    %33 = stablehlo.broadcast_in_dim %32, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %34 = stablehlo.multiply %31, %33 : tensor<64x512x768xf32>
    %35 = stablehlo.broadcast_in_dim %2, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %36 = stablehlo.add %34, %35 : tensor<64x512x768xf32>
    %37 = stablehlo.broadcast_in_dim %2, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %38 = stablehlo.maximum %37, %36 : tensor<64x512x768xf32>
    return %38 : tensor<64x512x768xf32>
  }
  func.func private @threefry2x32_53(%arg0: tensor<ui32>, %arg1: tensor<ui32>, %arg2: tensor<64x512x768xui32>, %arg3: tensor<64x512x768xui32>) -> (tensor<64x512x768xui32>, tensor<64x512x768xui32>) {
    %0 = stablehlo.xor %arg0, %arg1 : tensor<ui32>
    %c = stablehlo.constant dense<466688986> : tensor<ui32>
    %1 = stablehlo.xor %0, %c : tensor<ui32>
    %2 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %3 = stablehlo.add %arg2, %2 : tensor<64x512x768xui32>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %5 = stablehlo.add %arg3, %4 : tensor<64x512x768xui32>
    %6 = stablehlo.add %3, %5 : tensor<64x512x768xui32>
    %c_0 = stablehlo.constant dense<13> : tensor<ui32>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %8 = stablehlo.shift_left %5, %7 : tensor<64x512x768xui32>
    %c_1 = stablehlo.constant dense<19> : tensor<ui32>
    %9 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %10 = stablehlo.shift_right_logical %5, %9 : tensor<64x512x768xui32>
    %11 = stablehlo.or %8, %10 : tensor<64x512x768xui32>
    %12 = stablehlo.xor %6, %11 : tensor<64x512x768xui32>
    %13 = stablehlo.add %6, %12 : tensor<64x512x768xui32>
    %c_2 = stablehlo.constant dense<15> : tensor<ui32>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %15 = stablehlo.shift_left %12, %14 : tensor<64x512x768xui32>
    %c_3 = stablehlo.constant dense<17> : tensor<ui32>
    %16 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %17 = stablehlo.shift_right_logical %12, %16 : tensor<64x512x768xui32>
    %18 = stablehlo.or %15, %17 : tensor<64x512x768xui32>
    %19 = stablehlo.xor %13, %18 : tensor<64x512x768xui32>
    %20 = stablehlo.add %13, %19 : tensor<64x512x768xui32>
    %c_4 = stablehlo.constant dense<26> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %22 = stablehlo.shift_left %19, %21 : tensor<64x512x768xui32>
    %c_5 = stablehlo.constant dense<6> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %24 = stablehlo.shift_right_logical %19, %23 : tensor<64x512x768xui32>
    %25 = stablehlo.or %22, %24 : tensor<64x512x768xui32>
    %26 = stablehlo.xor %20, %25 : tensor<64x512x768xui32>
    %27 = stablehlo.add %20, %26 : tensor<64x512x768xui32>
    %c_6 = stablehlo.constant dense<6> : tensor<ui32>
    %28 = stablehlo.broadcast_in_dim %c_6, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %29 = stablehlo.shift_left %26, %28 : tensor<64x512x768xui32>
    %c_7 = stablehlo.constant dense<26> : tensor<ui32>
    %30 = stablehlo.broadcast_in_dim %c_7, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %31 = stablehlo.shift_right_logical %26, %30 : tensor<64x512x768xui32>
    %32 = stablehlo.or %29, %31 : tensor<64x512x768xui32>
    %33 = stablehlo.xor %27, %32 : tensor<64x512x768xui32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %35 = stablehlo.add %27, %34 : tensor<64x512x768xui32>
    %36 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %37 = stablehlo.add %33, %36 : tensor<64x512x768xui32>
    %c_8 = stablehlo.constant dense<1> : tensor<ui32>
    %38 = stablehlo.broadcast_in_dim %c_8, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %39 = stablehlo.add %37, %38 : tensor<64x512x768xui32>
    %40 = stablehlo.add %35, %39 : tensor<64x512x768xui32>
    %c_9 = stablehlo.constant dense<17> : tensor<ui32>
    %41 = stablehlo.broadcast_in_dim %c_9, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %42 = stablehlo.shift_left %39, %41 : tensor<64x512x768xui32>
    %c_10 = stablehlo.constant dense<15> : tensor<ui32>
    %43 = stablehlo.broadcast_in_dim %c_10, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %44 = stablehlo.shift_right_logical %39, %43 : tensor<64x512x768xui32>
    %45 = stablehlo.or %42, %44 : tensor<64x512x768xui32>
    %46 = stablehlo.xor %40, %45 : tensor<64x512x768xui32>
    %47 = stablehlo.add %40, %46 : tensor<64x512x768xui32>
    %c_11 = stablehlo.constant dense<29> : tensor<ui32>
    %48 = stablehlo.broadcast_in_dim %c_11, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %49 = stablehlo.shift_left %46, %48 : tensor<64x512x768xui32>
    %c_12 = stablehlo.constant dense<3> : tensor<ui32>
    %50 = stablehlo.broadcast_in_dim %c_12, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %51 = stablehlo.shift_right_logical %46, %50 : tensor<64x512x768xui32>
    %52 = stablehlo.or %49, %51 : tensor<64x512x768xui32>
    %53 = stablehlo.xor %47, %52 : tensor<64x512x768xui32>
    %54 = stablehlo.add %47, %53 : tensor<64x512x768xui32>
    %c_13 = stablehlo.constant dense<16> : tensor<ui32>
    %55 = stablehlo.broadcast_in_dim %c_13, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %56 = stablehlo.shift_left %53, %55 : tensor<64x512x768xui32>
    %c_14 = stablehlo.constant dense<16> : tensor<ui32>
    %57 = stablehlo.broadcast_in_dim %c_14, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %58 = stablehlo.shift_right_logical %53, %57 : tensor<64x512x768xui32>
    %59 = stablehlo.or %56, %58 : tensor<64x512x768xui32>
    %60 = stablehlo.xor %54, %59 : tensor<64x512x768xui32>
    %61 = stablehlo.add %54, %60 : tensor<64x512x768xui32>
    %c_15 = stablehlo.constant dense<24> : tensor<ui32>
    %62 = stablehlo.broadcast_in_dim %c_15, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %63 = stablehlo.shift_left %60, %62 : tensor<64x512x768xui32>
    %c_16 = stablehlo.constant dense<8> : tensor<ui32>
    %64 = stablehlo.broadcast_in_dim %c_16, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %65 = stablehlo.shift_right_logical %60, %64 : tensor<64x512x768xui32>
    %66 = stablehlo.or %63, %65 : tensor<64x512x768xui32>
    %67 = stablehlo.xor %61, %66 : tensor<64x512x768xui32>
    %68 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %69 = stablehlo.add %61, %68 : tensor<64x512x768xui32>
    %70 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %71 = stablehlo.add %67, %70 : tensor<64x512x768xui32>
    %c_17 = stablehlo.constant dense<2> : tensor<ui32>
    %72 = stablehlo.broadcast_in_dim %c_17, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %73 = stablehlo.add %71, %72 : tensor<64x512x768xui32>
    %74 = stablehlo.add %69, %73 : tensor<64x512x768xui32>
    %c_18 = stablehlo.constant dense<13> : tensor<ui32>
    %75 = stablehlo.broadcast_in_dim %c_18, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %76 = stablehlo.shift_left %73, %75 : tensor<64x512x768xui32>
    %c_19 = stablehlo.constant dense<19> : tensor<ui32>
    %77 = stablehlo.broadcast_in_dim %c_19, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %78 = stablehlo.shift_right_logical %73, %77 : tensor<64x512x768xui32>
    %79 = stablehlo.or %76, %78 : tensor<64x512x768xui32>
    %80 = stablehlo.xor %74, %79 : tensor<64x512x768xui32>
    %81 = stablehlo.add %74, %80 : tensor<64x512x768xui32>
    %c_20 = stablehlo.constant dense<15> : tensor<ui32>
    %82 = stablehlo.broadcast_in_dim %c_20, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %83 = stablehlo.shift_left %80, %82 : tensor<64x512x768xui32>
    %c_21 = stablehlo.constant dense<17> : tensor<ui32>
    %84 = stablehlo.broadcast_in_dim %c_21, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %85 = stablehlo.shift_right_logical %80, %84 : tensor<64x512x768xui32>
    %86 = stablehlo.or %83, %85 : tensor<64x512x768xui32>
    %87 = stablehlo.xor %81, %86 : tensor<64x512x768xui32>
    %88 = stablehlo.add %81, %87 : tensor<64x512x768xui32>
    %c_22 = stablehlo.constant dense<26> : tensor<ui32>
    %89 = stablehlo.broadcast_in_dim %c_22, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %90 = stablehlo.shift_left %87, %89 : tensor<64x512x768xui32>
    %c_23 = stablehlo.constant dense<6> : tensor<ui32>
    %91 = stablehlo.broadcast_in_dim %c_23, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %92 = stablehlo.shift_right_logical %87, %91 : tensor<64x512x768xui32>
    %93 = stablehlo.or %90, %92 : tensor<64x512x768xui32>
    %94 = stablehlo.xor %88, %93 : tensor<64x512x768xui32>
    %95 = stablehlo.add %88, %94 : tensor<64x512x768xui32>
    %c_24 = stablehlo.constant dense<6> : tensor<ui32>
    %96 = stablehlo.broadcast_in_dim %c_24, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %97 = stablehlo.shift_left %94, %96 : tensor<64x512x768xui32>
    %c_25 = stablehlo.constant dense<26> : tensor<ui32>
    %98 = stablehlo.broadcast_in_dim %c_25, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %99 = stablehlo.shift_right_logical %94, %98 : tensor<64x512x768xui32>
    %100 = stablehlo.or %97, %99 : tensor<64x512x768xui32>
    %101 = stablehlo.xor %95, %100 : tensor<64x512x768xui32>
    %102 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %103 = stablehlo.add %95, %102 : tensor<64x512x768xui32>
    %104 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %105 = stablehlo.add %101, %104 : tensor<64x512x768xui32>
    %c_26 = stablehlo.constant dense<3> : tensor<ui32>
    %106 = stablehlo.broadcast_in_dim %c_26, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %107 = stablehlo.add %105, %106 : tensor<64x512x768xui32>
    %108 = stablehlo.add %103, %107 : tensor<64x512x768xui32>
    %c_27 = stablehlo.constant dense<17> : tensor<ui32>
    %109 = stablehlo.broadcast_in_dim %c_27, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %110 = stablehlo.shift_left %107, %109 : tensor<64x512x768xui32>
    %c_28 = stablehlo.constant dense<15> : tensor<ui32>
    %111 = stablehlo.broadcast_in_dim %c_28, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %112 = stablehlo.shift_right_logical %107, %111 : tensor<64x512x768xui32>
    %113 = stablehlo.or %110, %112 : tensor<64x512x768xui32>
    %114 = stablehlo.xor %108, %113 : tensor<64x512x768xui32>
    %115 = stablehlo.add %108, %114 : tensor<64x512x768xui32>
    %c_29 = stablehlo.constant dense<29> : tensor<ui32>
    %116 = stablehlo.broadcast_in_dim %c_29, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %117 = stablehlo.shift_left %114, %116 : tensor<64x512x768xui32>
    %c_30 = stablehlo.constant dense<3> : tensor<ui32>
    %118 = stablehlo.broadcast_in_dim %c_30, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %119 = stablehlo.shift_right_logical %114, %118 : tensor<64x512x768xui32>
    %120 = stablehlo.or %117, %119 : tensor<64x512x768xui32>
    %121 = stablehlo.xor %115, %120 : tensor<64x512x768xui32>
    %122 = stablehlo.add %115, %121 : tensor<64x512x768xui32>
    %c_31 = stablehlo.constant dense<16> : tensor<ui32>
    %123 = stablehlo.broadcast_in_dim %c_31, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %124 = stablehlo.shift_left %121, %123 : tensor<64x512x768xui32>
    %c_32 = stablehlo.constant dense<16> : tensor<ui32>
    %125 = stablehlo.broadcast_in_dim %c_32, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %126 = stablehlo.shift_right_logical %121, %125 : tensor<64x512x768xui32>
    %127 = stablehlo.or %124, %126 : tensor<64x512x768xui32>
    %128 = stablehlo.xor %122, %127 : tensor<64x512x768xui32>
    %129 = stablehlo.add %122, %128 : tensor<64x512x768xui32>
    %c_33 = stablehlo.constant dense<24> : tensor<ui32>
    %130 = stablehlo.broadcast_in_dim %c_33, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %131 = stablehlo.shift_left %128, %130 : tensor<64x512x768xui32>
    %c_34 = stablehlo.constant dense<8> : tensor<ui32>
    %132 = stablehlo.broadcast_in_dim %c_34, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %133 = stablehlo.shift_right_logical %128, %132 : tensor<64x512x768xui32>
    %134 = stablehlo.or %131, %133 : tensor<64x512x768xui32>
    %135 = stablehlo.xor %129, %134 : tensor<64x512x768xui32>
    %136 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %137 = stablehlo.add %129, %136 : tensor<64x512x768xui32>
    %138 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %139 = stablehlo.add %135, %138 : tensor<64x512x768xui32>
    %c_35 = stablehlo.constant dense<4> : tensor<ui32>
    %140 = stablehlo.broadcast_in_dim %c_35, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %141 = stablehlo.add %139, %140 : tensor<64x512x768xui32>
    %142 = stablehlo.add %137, %141 : tensor<64x512x768xui32>
    %c_36 = stablehlo.constant dense<13> : tensor<ui32>
    %143 = stablehlo.broadcast_in_dim %c_36, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %144 = stablehlo.shift_left %141, %143 : tensor<64x512x768xui32>
    %c_37 = stablehlo.constant dense<19> : tensor<ui32>
    %145 = stablehlo.broadcast_in_dim %c_37, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %146 = stablehlo.shift_right_logical %141, %145 : tensor<64x512x768xui32>
    %147 = stablehlo.or %144, %146 : tensor<64x512x768xui32>
    %148 = stablehlo.xor %142, %147 : tensor<64x512x768xui32>
    %149 = stablehlo.add %142, %148 : tensor<64x512x768xui32>
    %c_38 = stablehlo.constant dense<15> : tensor<ui32>
    %150 = stablehlo.broadcast_in_dim %c_38, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %151 = stablehlo.shift_left %148, %150 : tensor<64x512x768xui32>
    %c_39 = stablehlo.constant dense<17> : tensor<ui32>
    %152 = stablehlo.broadcast_in_dim %c_39, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %153 = stablehlo.shift_right_logical %148, %152 : tensor<64x512x768xui32>
    %154 = stablehlo.or %151, %153 : tensor<64x512x768xui32>
    %155 = stablehlo.xor %149, %154 : tensor<64x512x768xui32>
    %156 = stablehlo.add %149, %155 : tensor<64x512x768xui32>
    %c_40 = stablehlo.constant dense<26> : tensor<ui32>
    %157 = stablehlo.broadcast_in_dim %c_40, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %158 = stablehlo.shift_left %155, %157 : tensor<64x512x768xui32>
    %c_41 = stablehlo.constant dense<6> : tensor<ui32>
    %159 = stablehlo.broadcast_in_dim %c_41, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %160 = stablehlo.shift_right_logical %155, %159 : tensor<64x512x768xui32>
    %161 = stablehlo.or %158, %160 : tensor<64x512x768xui32>
    %162 = stablehlo.xor %156, %161 : tensor<64x512x768xui32>
    %163 = stablehlo.add %156, %162 : tensor<64x512x768xui32>
    %c_42 = stablehlo.constant dense<6> : tensor<ui32>
    %164 = stablehlo.broadcast_in_dim %c_42, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %165 = stablehlo.shift_left %162, %164 : tensor<64x512x768xui32>
    %c_43 = stablehlo.constant dense<26> : tensor<ui32>
    %166 = stablehlo.broadcast_in_dim %c_43, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %167 = stablehlo.shift_right_logical %162, %166 : tensor<64x512x768xui32>
    %168 = stablehlo.or %165, %167 : tensor<64x512x768xui32>
    %169 = stablehlo.xor %163, %168 : tensor<64x512x768xui32>
    %170 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %171 = stablehlo.add %163, %170 : tensor<64x512x768xui32>
    %172 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %173 = stablehlo.add %169, %172 : tensor<64x512x768xui32>
    %c_44 = stablehlo.constant dense<5> : tensor<ui32>
    %174 = stablehlo.broadcast_in_dim %c_44, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %175 = stablehlo.add %173, %174 : tensor<64x512x768xui32>
    return %171, %175 : tensor<64x512x768xui32>, tensor<64x512x768xui32>
  }
  func.func private @_where_68(%arg0: tensor<64x512x768xi1>, %arg1: tensor<64x512x768xbf16>, %arg2: tensor<i32>) -> tensor<64x512x768xbf16> {
    %0 = stablehlo.convert %arg2 : (tensor<i32>) -> tensor<bf16>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %2 = stablehlo.select %arg0, %arg1, %1 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %2 : tensor<64x512x768xbf16>
  }
  func.func private @_threefry_split_78(%arg0: tensor<2xui32>) -> tensor<12x2xui32> {
    %0 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %1 = stablehlo.reshape %0 : (tensor<1xui32>) -> tensor<ui32>
    %2 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %3 = stablehlo.reshape %2 : (tensor<1xui32>) -> tensor<ui32>
    %4 = stablehlo.iota dim = 0 : tensor<12xui64>
    %c = stablehlo.constant dense<1> : tensor<ui64>
    %5 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<12xui64>
    %6 = stablehlo.multiply %5, %4 : tensor<12xui64>
    %c_0 = stablehlo.constant dense<32> : tensor<ui64>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<12xui64>
    %8 = stablehlo.shift_right_logical %6, %7 : tensor<12xui64>
    %9 = stablehlo.convert %6 : (tensor<12xui64>) -> tensor<12xui32>
    %10 = stablehlo.convert %8 : (tensor<12xui64>) -> tensor<12xui32>
    %11:2 = call @threefry2x32_80(%1, %3, %10, %9) : (tensor<ui32>, tensor<ui32>, tensor<12xui32>, tensor<12xui32>) -> (tensor<12xui32>, tensor<12xui32>)
    %12 = stablehlo.broadcast_in_dim %11#0, dims = [0] : (tensor<12xui32>) -> tensor<12x1xui32>
    %13 = stablehlo.broadcast_in_dim %11#1, dims = [0] : (tensor<12xui32>) -> tensor<12x1xui32>
    %14 = stablehlo.concatenate %12, %13, dim = 1 : (tensor<12x1xui32>, tensor<12x1xui32>) -> tensor<12x2xui32>
    return %14 : tensor<12x2xui32>
  }
  func.func private @threefry2x32_80(%arg0: tensor<ui32>, %arg1: tensor<ui32>, %arg2: tensor<12xui32>, %arg3: tensor<12xui32>) -> (tensor<12xui32>, tensor<12xui32>) {
    %0 = stablehlo.xor %arg0, %arg1 : tensor<ui32>
    %c = stablehlo.constant dense<466688986> : tensor<ui32>
    %1 = stablehlo.xor %0, %c : tensor<ui32>
    %2 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %3 = stablehlo.add %arg2, %2 : tensor<12xui32>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %5 = stablehlo.add %arg3, %4 : tensor<12xui32>
    %6 = stablehlo.add %3, %5 : tensor<12xui32>
    %c_0 = stablehlo.constant dense<13> : tensor<ui32>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %8 = stablehlo.shift_left %5, %7 : tensor<12xui32>
    %c_1 = stablehlo.constant dense<19> : tensor<ui32>
    %9 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %10 = stablehlo.shift_right_logical %5, %9 : tensor<12xui32>
    %11 = stablehlo.or %8, %10 : tensor<12xui32>
    %12 = stablehlo.xor %6, %11 : tensor<12xui32>
    %13 = stablehlo.add %6, %12 : tensor<12xui32>
    %c_2 = stablehlo.constant dense<15> : tensor<ui32>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %15 = stablehlo.shift_left %12, %14 : tensor<12xui32>
    %c_3 = stablehlo.constant dense<17> : tensor<ui32>
    %16 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %17 = stablehlo.shift_right_logical %12, %16 : tensor<12xui32>
    %18 = stablehlo.or %15, %17 : tensor<12xui32>
    %19 = stablehlo.xor %13, %18 : tensor<12xui32>
    %20 = stablehlo.add %13, %19 : tensor<12xui32>
    %c_4 = stablehlo.constant dense<26> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %22 = stablehlo.shift_left %19, %21 : tensor<12xui32>
    %c_5 = stablehlo.constant dense<6> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %24 = stablehlo.shift_right_logical %19, %23 : tensor<12xui32>
    %25 = stablehlo.or %22, %24 : tensor<12xui32>
    %26 = stablehlo.xor %20, %25 : tensor<12xui32>
    %27 = stablehlo.add %20, %26 : tensor<12xui32>
    %c_6 = stablehlo.constant dense<6> : tensor<ui32>
    %28 = stablehlo.broadcast_in_dim %c_6, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %29 = stablehlo.shift_left %26, %28 : tensor<12xui32>
    %c_7 = stablehlo.constant dense<26> : tensor<ui32>
    %30 = stablehlo.broadcast_in_dim %c_7, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %31 = stablehlo.shift_right_logical %26, %30 : tensor<12xui32>
    %32 = stablehlo.or %29, %31 : tensor<12xui32>
    %33 = stablehlo.xor %27, %32 : tensor<12xui32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %35 = stablehlo.add %27, %34 : tensor<12xui32>
    %36 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %37 = stablehlo.add %33, %36 : tensor<12xui32>
    %c_8 = stablehlo.constant dense<1> : tensor<ui32>
    %38 = stablehlo.broadcast_in_dim %c_8, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %39 = stablehlo.add %37, %38 : tensor<12xui32>
    %40 = stablehlo.add %35, %39 : tensor<12xui32>
    %c_9 = stablehlo.constant dense<17> : tensor<ui32>
    %41 = stablehlo.broadcast_in_dim %c_9, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %42 = stablehlo.shift_left %39, %41 : tensor<12xui32>
    %c_10 = stablehlo.constant dense<15> : tensor<ui32>
    %43 = stablehlo.broadcast_in_dim %c_10, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %44 = stablehlo.shift_right_logical %39, %43 : tensor<12xui32>
    %45 = stablehlo.or %42, %44 : tensor<12xui32>
    %46 = stablehlo.xor %40, %45 : tensor<12xui32>
    %47 = stablehlo.add %40, %46 : tensor<12xui32>
    %c_11 = stablehlo.constant dense<29> : tensor<ui32>
    %48 = stablehlo.broadcast_in_dim %c_11, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %49 = stablehlo.shift_left %46, %48 : tensor<12xui32>
    %c_12 = stablehlo.constant dense<3> : tensor<ui32>
    %50 = stablehlo.broadcast_in_dim %c_12, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %51 = stablehlo.shift_right_logical %46, %50 : tensor<12xui32>
    %52 = stablehlo.or %49, %51 : tensor<12xui32>
    %53 = stablehlo.xor %47, %52 : tensor<12xui32>
    %54 = stablehlo.add %47, %53 : tensor<12xui32>
    %c_13 = stablehlo.constant dense<16> : tensor<ui32>
    %55 = stablehlo.broadcast_in_dim %c_13, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %56 = stablehlo.shift_left %53, %55 : tensor<12xui32>
    %c_14 = stablehlo.constant dense<16> : tensor<ui32>
    %57 = stablehlo.broadcast_in_dim %c_14, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %58 = stablehlo.shift_right_logical %53, %57 : tensor<12xui32>
    %59 = stablehlo.or %56, %58 : tensor<12xui32>
    %60 = stablehlo.xor %54, %59 : tensor<12xui32>
    %61 = stablehlo.add %54, %60 : tensor<12xui32>
    %c_15 = stablehlo.constant dense<24> : tensor<ui32>
    %62 = stablehlo.broadcast_in_dim %c_15, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %63 = stablehlo.shift_left %60, %62 : tensor<12xui32>
    %c_16 = stablehlo.constant dense<8> : tensor<ui32>
    %64 = stablehlo.broadcast_in_dim %c_16, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %65 = stablehlo.shift_right_logical %60, %64 : tensor<12xui32>
    %66 = stablehlo.or %63, %65 : tensor<12xui32>
    %67 = stablehlo.xor %61, %66 : tensor<12xui32>
    %68 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %69 = stablehlo.add %61, %68 : tensor<12xui32>
    %70 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %71 = stablehlo.add %67, %70 : tensor<12xui32>
    %c_17 = stablehlo.constant dense<2> : tensor<ui32>
    %72 = stablehlo.broadcast_in_dim %c_17, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %73 = stablehlo.add %71, %72 : tensor<12xui32>
    %74 = stablehlo.add %69, %73 : tensor<12xui32>
    %c_18 = stablehlo.constant dense<13> : tensor<ui32>
    %75 = stablehlo.broadcast_in_dim %c_18, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %76 = stablehlo.shift_left %73, %75 : tensor<12xui32>
    %c_19 = stablehlo.constant dense<19> : tensor<ui32>
    %77 = stablehlo.broadcast_in_dim %c_19, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %78 = stablehlo.shift_right_logical %73, %77 : tensor<12xui32>
    %79 = stablehlo.or %76, %78 : tensor<12xui32>
    %80 = stablehlo.xor %74, %79 : tensor<12xui32>
    %81 = stablehlo.add %74, %80 : tensor<12xui32>
    %c_20 = stablehlo.constant dense<15> : tensor<ui32>
    %82 = stablehlo.broadcast_in_dim %c_20, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %83 = stablehlo.shift_left %80, %82 : tensor<12xui32>
    %c_21 = stablehlo.constant dense<17> : tensor<ui32>
    %84 = stablehlo.broadcast_in_dim %c_21, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %85 = stablehlo.shift_right_logical %80, %84 : tensor<12xui32>
    %86 = stablehlo.or %83, %85 : tensor<12xui32>
    %87 = stablehlo.xor %81, %86 : tensor<12xui32>
    %88 = stablehlo.add %81, %87 : tensor<12xui32>
    %c_22 = stablehlo.constant dense<26> : tensor<ui32>
    %89 = stablehlo.broadcast_in_dim %c_22, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %90 = stablehlo.shift_left %87, %89 : tensor<12xui32>
    %c_23 = stablehlo.constant dense<6> : tensor<ui32>
    %91 = stablehlo.broadcast_in_dim %c_23, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %92 = stablehlo.shift_right_logical %87, %91 : tensor<12xui32>
    %93 = stablehlo.or %90, %92 : tensor<12xui32>
    %94 = stablehlo.xor %88, %93 : tensor<12xui32>
    %95 = stablehlo.add %88, %94 : tensor<12xui32>
    %c_24 = stablehlo.constant dense<6> : tensor<ui32>
    %96 = stablehlo.broadcast_in_dim %c_24, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %97 = stablehlo.shift_left %94, %96 : tensor<12xui32>
    %c_25 = stablehlo.constant dense<26> : tensor<ui32>
    %98 = stablehlo.broadcast_in_dim %c_25, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %99 = stablehlo.shift_right_logical %94, %98 : tensor<12xui32>
    %100 = stablehlo.or %97, %99 : tensor<12xui32>
    %101 = stablehlo.xor %95, %100 : tensor<12xui32>
    %102 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %103 = stablehlo.add %95, %102 : tensor<12xui32>
    %104 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %105 = stablehlo.add %101, %104 : tensor<12xui32>
    %c_26 = stablehlo.constant dense<3> : tensor<ui32>
    %106 = stablehlo.broadcast_in_dim %c_26, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %107 = stablehlo.add %105, %106 : tensor<12xui32>
    %108 = stablehlo.add %103, %107 : tensor<12xui32>
    %c_27 = stablehlo.constant dense<17> : tensor<ui32>
    %109 = stablehlo.broadcast_in_dim %c_27, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %110 = stablehlo.shift_left %107, %109 : tensor<12xui32>
    %c_28 = stablehlo.constant dense<15> : tensor<ui32>
    %111 = stablehlo.broadcast_in_dim %c_28, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %112 = stablehlo.shift_right_logical %107, %111 : tensor<12xui32>
    %113 = stablehlo.or %110, %112 : tensor<12xui32>
    %114 = stablehlo.xor %108, %113 : tensor<12xui32>
    %115 = stablehlo.add %108, %114 : tensor<12xui32>
    %c_29 = stablehlo.constant dense<29> : tensor<ui32>
    %116 = stablehlo.broadcast_in_dim %c_29, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %117 = stablehlo.shift_left %114, %116 : tensor<12xui32>
    %c_30 = stablehlo.constant dense<3> : tensor<ui32>
    %118 = stablehlo.broadcast_in_dim %c_30, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %119 = stablehlo.shift_right_logical %114, %118 : tensor<12xui32>
    %120 = stablehlo.or %117, %119 : tensor<12xui32>
    %121 = stablehlo.xor %115, %120 : tensor<12xui32>
    %122 = stablehlo.add %115, %121 : tensor<12xui32>
    %c_31 = stablehlo.constant dense<16> : tensor<ui32>
    %123 = stablehlo.broadcast_in_dim %c_31, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %124 = stablehlo.shift_left %121, %123 : tensor<12xui32>
    %c_32 = stablehlo.constant dense<16> : tensor<ui32>
    %125 = stablehlo.broadcast_in_dim %c_32, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %126 = stablehlo.shift_right_logical %121, %125 : tensor<12xui32>
    %127 = stablehlo.or %124, %126 : tensor<12xui32>
    %128 = stablehlo.xor %122, %127 : tensor<12xui32>
    %129 = stablehlo.add %122, %128 : tensor<12xui32>
    %c_33 = stablehlo.constant dense<24> : tensor<ui32>
    %130 = stablehlo.broadcast_in_dim %c_33, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %131 = stablehlo.shift_left %128, %130 : tensor<12xui32>
    %c_34 = stablehlo.constant dense<8> : tensor<ui32>
    %132 = stablehlo.broadcast_in_dim %c_34, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %133 = stablehlo.shift_right_logical %128, %132 : tensor<12xui32>
    %134 = stablehlo.or %131, %133 : tensor<12xui32>
    %135 = stablehlo.xor %129, %134 : tensor<12xui32>
    %136 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %137 = stablehlo.add %129, %136 : tensor<12xui32>
    %138 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %139 = stablehlo.add %135, %138 : tensor<12xui32>
    %c_35 = stablehlo.constant dense<4> : tensor<ui32>
    %140 = stablehlo.broadcast_in_dim %c_35, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %141 = stablehlo.add %139, %140 : tensor<12xui32>
    %142 = stablehlo.add %137, %141 : tensor<12xui32>
    %c_36 = stablehlo.constant dense<13> : tensor<ui32>
    %143 = stablehlo.broadcast_in_dim %c_36, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %144 = stablehlo.shift_left %141, %143 : tensor<12xui32>
    %c_37 = stablehlo.constant dense<19> : tensor<ui32>
    %145 = stablehlo.broadcast_in_dim %c_37, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %146 = stablehlo.shift_right_logical %141, %145 : tensor<12xui32>
    %147 = stablehlo.or %144, %146 : tensor<12xui32>
    %148 = stablehlo.xor %142, %147 : tensor<12xui32>
    %149 = stablehlo.add %142, %148 : tensor<12xui32>
    %c_38 = stablehlo.constant dense<15> : tensor<ui32>
    %150 = stablehlo.broadcast_in_dim %c_38, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %151 = stablehlo.shift_left %148, %150 : tensor<12xui32>
    %c_39 = stablehlo.constant dense<17> : tensor<ui32>
    %152 = stablehlo.broadcast_in_dim %c_39, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %153 = stablehlo.shift_right_logical %148, %152 : tensor<12xui32>
    %154 = stablehlo.or %151, %153 : tensor<12xui32>
    %155 = stablehlo.xor %149, %154 : tensor<12xui32>
    %156 = stablehlo.add %149, %155 : tensor<12xui32>
    %c_40 = stablehlo.constant dense<26> : tensor<ui32>
    %157 = stablehlo.broadcast_in_dim %c_40, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %158 = stablehlo.shift_left %155, %157 : tensor<12xui32>
    %c_41 = stablehlo.constant dense<6> : tensor<ui32>
    %159 = stablehlo.broadcast_in_dim %c_41, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %160 = stablehlo.shift_right_logical %155, %159 : tensor<12xui32>
    %161 = stablehlo.or %158, %160 : tensor<12xui32>
    %162 = stablehlo.xor %156, %161 : tensor<12xui32>
    %163 = stablehlo.add %156, %162 : tensor<12xui32>
    %c_42 = stablehlo.constant dense<6> : tensor<ui32>
    %164 = stablehlo.broadcast_in_dim %c_42, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %165 = stablehlo.shift_left %162, %164 : tensor<12xui32>
    %c_43 = stablehlo.constant dense<26> : tensor<ui32>
    %166 = stablehlo.broadcast_in_dim %c_43, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %167 = stablehlo.shift_right_logical %162, %166 : tensor<12xui32>
    %168 = stablehlo.or %165, %167 : tensor<12xui32>
    %169 = stablehlo.xor %163, %168 : tensor<12xui32>
    %170 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %171 = stablehlo.add %163, %170 : tensor<12xui32>
    %172 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %173 = stablehlo.add %169, %172 : tensor<12xui32>
    %c_44 = stablehlo.constant dense<5> : tensor<ui32>
    %174 = stablehlo.broadcast_in_dim %c_44, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %175 = stablehlo.add %173, %174 : tensor<12xui32>
    return %171, %175 : tensor<12xui32>, tensor<12xui32>
  }
  func.func private @_where_91(%arg0: tensor<64x512x1x512xi32>, %arg1: tensor<bf16>) -> (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<i32>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<i32>) -> tensor<64x512x1x512xi32>
    %2 = stablehlo.compare  NE, %arg0, %1,  SIGNED : (tensor<64x512x1x512xi32>, tensor<64x512x1x512xi32>) -> tensor<64x512x1x512xi1>
    %3 = stablehlo.broadcast_in_dim %2, dims = [0, 1, 2, 3] : (tensor<64x512x1x512xi1>) -> tensor<64x512x12x512xi1>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    return %3, %4 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
  }
  func.func private @_bernoulli_95() -> (tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>) {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %cst_0 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %0:2 = call @_uniform_96(%cst, %cst_0) : (tensor<f32>, tensor<f32>) -> (tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>)
    return %0#0, %0#1 : tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>
  }
  func.func private @_uniform_96(%arg0: tensor<f32>, %arg1: tensor<f32>) -> (tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>) {
    %0 = stablehlo.convert %arg0 : tensor<f32>
    %1 = stablehlo.convert %arg1 : tensor<f32>
    %2 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<f32>) -> tensor<1x1x1x1xf32>
    %3 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<f32>) -> tensor<1x1x1x1xf32>
    %4 = stablehlo.subtract %3, %2 : tensor<1x1x1x1xf32>
    return %2, %4 : tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>
  }
  func.func private @_where_99(%arg0: tensor<i32>) -> tensor<64x512x12x512xbf16> {
    %0 = stablehlo.convert %arg0 : (tensor<i32>) -> tensor<bf16>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    return %1 : tensor<64x512x12x512xbf16>
  }
  func.func private @_bernoulli_101() -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>) {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %cst_0 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %0:2 = call @_uniform_102(%cst, %cst_0) : (tensor<f32>, tensor<f32>) -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>)
    return %0#0, %0#1 : tensor<1x1x1xf32>, tensor<1x1x1xf32>
  }
  func.func private @_uniform_102(%arg0: tensor<f32>, %arg1: tensor<f32>) -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>) {
    %0 = stablehlo.convert %arg0 : tensor<f32>
    %1 = stablehlo.convert %arg1 : tensor<f32>
    %2 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<f32>) -> tensor<1x1x1xf32>
    %3 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<f32>) -> tensor<1x1x1xf32>
    %4 = stablehlo.subtract %3, %2 : tensor<1x1x1xf32>
    return %2, %4 : tensor<1x1x1xf32>, tensor<1x1x1xf32>
  }
  func.func private @_where_103(%arg0: tensor<i32>) -> tensor<64x512x768xbf16> {
    %0 = stablehlo.convert %arg0 : (tensor<i32>) -> tensor<bf16>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    return %1 : tensor<64x512x768xbf16>
  }
  func.func private @_var_104(%arg0: tensor<i32>) -> (tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>) {
    %0 = stablehlo.convert %arg0 : (tensor<i32>) -> tensor<f32>
    %cst = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %1 = stablehlo.subtract %cst, %0 : tensor<f32>
    %cst_0 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %2 = stablehlo.compare  GT, %1, %cst_0,  FLOAT : (tensor<f32>, tensor<f32>) -> tensor<i1>
    %cst_1 = stablehlo.constant dense<0x7FC00000> : tensor<f32>
    %3 = call @_where_105(%cst_1) : (tensor<f32>) -> tensor<64x512x1xbf16>
    return %1, %2, %3 : tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>
  }
  func.func private @_where_105(%arg0: tensor<f32>) -> tensor<64x512x1xbf16> {
    %0 = stablehlo.convert %arg0 : (tensor<f32>) -> tensor<bf16>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    return %1 : tensor<64x512x1xbf16>
  }
  func.func private @closed_call(%arg0: tensor<1x1x1xf32>, %arg1: tensor<1x1x1xf32>, %arg2: tensor<f32>, %arg3: tensor<1x1x1xf32>, %arg4: tensor<1x1x1xf32>, %arg5: tensor<f32>, %arg6: tensor<1x1x1x1xf32>, %arg7: tensor<1x1x1x1xf32>, %arg8: tensor<f32>, %arg9: tensor<bf16>, %arg10: tensor<64x512x12x512xi1>, %arg11: tensor<64x512x12x512xbf16>, %arg12: tensor<64x512x12x512xbf16>, %arg13: tensor<64x512x768xbf16>, %arg14: tensor<f32>, %arg15: tensor<i1>, %arg16: tensor<64x512x1xbf16>, %arg17: tensor<64x512x768xbf16>, %arg18: tensor<f32>, %arg19: tensor<i1>, %arg20: tensor<64x512x1xbf16>, %arg21: tensor<64x512x1xbf16>, %arg22: tensor<64x512x1xbf16>, %arg23: tensor<64x512x1xbf16>, %arg24: tensor<64x512x1xbf16>, %arg25: tensor<bf16>, %arg26: tensor<64x512x1xbf16>, %arg27: tensor<64x512x1xbf16>, %arg28: tensor<64x512x1xbf16>, %arg29: tensor<64x512x1xbf16>, %arg30: tensor<64x512x768xbf16>, %arg31: tensor<768x768xbf16>, %arg32: tensor<768xbf16>, %arg33: tensor<768x768xbf16>, %arg34: tensor<768xbf16>, %arg35: tensor<768x768xbf16>, %arg36: tensor<768xbf16>, %arg37: tensor<768x768xbf16>, %arg38: tensor<768xbf16>, %arg39: tensor<768xbf16>, %arg40: tensor<768xbf16>, %arg41: tensor<3072x768xbf16>, %arg42: tensor<3072xbf16>, %arg43: tensor<768x3072xbf16>, %arg44: tensor<768xbf16>, %arg45: tensor<768xbf16>, %arg46: tensor<768xbf16>, %arg47: tensor<2xui32>) -> (tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768x768xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x512xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x64xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<1x1x768xbf16>, tensor<768x3072xbf16>, tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<3072x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<1x1x768xbf16>) {
    %0 = call @_threefry_split(%arg47) : (tensor<2xui32>) -> tensor<2x2xui32>
    %1 = stablehlo.slice %0 [0:1, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %2 = stablehlo.reshape %1 : (tensor<1x2xui32>) -> tensor<2xui32>
    %3 = stablehlo.slice %0 [1:2, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %4 = stablehlo.reshape %3 : (tensor<1x2xui32>) -> tensor<2xui32>
    %5 = call @_threefry_split(%2) : (tensor<2xui32>) -> tensor<2x2xui32>
    %6 = stablehlo.slice %5 [0:1, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %7 = stablehlo.reshape %6 : (tensor<1x2xui32>) -> tensor<2xui32>
    %8 = stablehlo.slice %5 [1:2, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %9 = stablehlo.reshape %8 : (tensor<1x2xui32>) -> tensor<2xui32>
    %10 = stablehlo.transpose %arg31, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %11 = stablehlo.dot_general %arg30, %10, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %12 = stablehlo.broadcast_in_dim %arg32, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %13 = stablehlo.broadcast_in_dim %12, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %14 = stablehlo.add %11, %13 : tensor<64x512x768xbf16>
    %15 = stablehlo.reshape %14 : (tensor<64x512x768xbf16>) -> tensor<64x512x12x64xbf16>
    %16 = stablehlo.transpose %arg33, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %17 = stablehlo.dot_general %arg30, %16, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %18 = stablehlo.broadcast_in_dim %arg34, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %19 = stablehlo.broadcast_in_dim %18, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %20 = stablehlo.add %17, %19 : tensor<64x512x768xbf16>
    %21 = stablehlo.reshape %20 : (tensor<64x512x768xbf16>) -> tensor<64x512x12x64xbf16>
    %22 = stablehlo.transpose %arg35, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %23 = stablehlo.dot_general %arg30, %22, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %24 = stablehlo.broadcast_in_dim %arg36, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %25 = stablehlo.broadcast_in_dim %24, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %26 = stablehlo.add %23, %25 : tensor<64x512x768xbf16>
    %27 = stablehlo.reshape %26 : (tensor<64x512x768xbf16>) -> tensor<64x512x12x64xbf16>
    %28 = stablehlo.broadcast_in_dim %arg9, dims = [] : (tensor<bf16>) -> tensor<64x512x12x64xbf16>
    %29 = stablehlo.divide %15, %28 : tensor<64x512x12x64xbf16>
    %30 = stablehlo.dot_general %21, %29, batching_dims = [0, 2] x [0, 2], contracting_dims = [3] x [3], precision = [DEFAULT, DEFAULT] : (tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>) -> tensor<64x12x512x512xbf16>
    %31 = stablehlo.transpose %30, dims = [0, 3, 1, 2] : (tensor<64x12x512x512xbf16>) -> tensor<64x512x12x512xbf16>
    %32 = call @_where_137(%31, %arg10, %arg11) : (tensor<64x512x12x512xbf16>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
    %33 = stablehlo.convert %32 : (tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xf32>
    %cst = stablehlo.constant dense<0xFF800000> : tensor<f32>
    %34 = stablehlo.reduce(%33 init: %cst) applies stablehlo.maximum across dimensions = [3] : (tensor<64x512x12x512xf32>, tensor<f32>) -> tensor<64x512x12xf32>
    %cst_0 = stablehlo.constant dense<0xFF800000> : tensor<f32>
    %35 = stablehlo.broadcast_in_dim %cst_0, dims = [] : (tensor<f32>) -> tensor<64x512x12xf32>
    %36 = stablehlo.maximum %35, %34 : tensor<64x512x12xf32>
    %37 = stablehlo.broadcast_in_dim %36, dims = [0, 1, 2] : (tensor<64x512x12xf32>) -> tensor<64x512x12x1xf32>
    %38 = stablehlo.broadcast_in_dim %37, dims = [0, 1, 2, 3] : (tensor<64x512x12x1xf32>) -> tensor<64x512x12x512xf32>
    %39 = stablehlo.subtract %33, %38 : tensor<64x512x12x512xf32>
    %40 = stablehlo.exponential %39 : tensor<64x512x12x512xf32>
    %cst_1 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %41 = stablehlo.reduce(%40 init: %cst_1) applies stablehlo.add across dimensions = [3] : (tensor<64x512x12x512xf32>, tensor<f32>) -> tensor<64x512x12xf32>
    %42 = stablehlo.broadcast_in_dim %41, dims = [0, 1, 2] : (tensor<64x512x12xf32>) -> tensor<64x512x12x1xf32>
    %43 = stablehlo.broadcast_in_dim %42, dims = [0, 1, 2, 3] : (tensor<64x512x12x1xf32>) -> tensor<64x512x12x512xf32>
    %44 = stablehlo.divide %40, %43 : tensor<64x512x12x512xf32>
    %45 = stablehlo.multiply %42, %42 : tensor<64x512x12x1xf32>
    %cst_2 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %46 = stablehlo.broadcast_in_dim %cst_2, dims = [] : (tensor<f32>) -> tensor<64x512x12x1xf32>
    %47 = stablehlo.divide %46, %45 : tensor<64x512x12x1xf32>
    %48 = stablehlo.convert %44 : (tensor<64x512x12x512xf32>) -> tensor<64x512x12x512xbf16>
    %49 = call @_bernoulli_149(%7, %arg6, %arg7, %arg8) : (tensor<2xui32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>, tensor<f32>) -> tensor<64x512x12x512xi1>
    %cst_3 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %50 = stablehlo.broadcast_in_dim %cst_3, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    %51 = stablehlo.divide %48, %50 : tensor<64x512x12x512xbf16>
    %52 = call @_where_168(%49, %51, %arg12) : (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
    %53 = stablehlo.dot_general %27, %52, batching_dims = [0, 2] x [0, 2], contracting_dims = [1] x [3], precision = [DEFAULT, DEFAULT] : (tensor<64x512x12x64xbf16>, tensor<64x512x12x512xbf16>) -> tensor<64x12x64x512xbf16>
    %54 = stablehlo.transpose %53, dims = [0, 3, 1, 2] : (tensor<64x12x64x512xbf16>) -> tensor<64x512x12x64xbf16>
    %55 = stablehlo.reshape %54 : (tensor<64x512x12x64xbf16>) -> tensor<64x512x768xbf16>
    %56 = stablehlo.transpose %arg37, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %57 = stablehlo.dot_general %55, %56, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %58 = stablehlo.broadcast_in_dim %arg38, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %59 = stablehlo.broadcast_in_dim %58, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %60 = stablehlo.add %57, %59 : tensor<64x512x768xbf16>
    %61 = call @_bernoulli_173(%9, %arg3, %arg4, %arg5) : (tensor<2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>) -> tensor<64x512x768xi1>
    %cst_4 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %62 = stablehlo.broadcast_in_dim %cst_4, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %63 = stablehlo.divide %60, %62 : tensor<64x512x768xbf16>
    %64 = call @_where_175(%61, %63, %arg13) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %65 = stablehlo.add %64, %arg30 : tensor<64x512x768xbf16>
    %66 = stablehlo.convert %65 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst_5 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %67 = stablehlo.reduce(%66 init: %cst_5) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %68 = stablehlo.broadcast_in_dim %67, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_6 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %69 = stablehlo.broadcast_in_dim %cst_6, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %70 = stablehlo.divide %68, %69 : tensor<64x512x1xf32>
    %71 = stablehlo.convert %70 : (tensor<64x512x1xf32>) -> tensor<64x512x1xbf16>
    %72:2 = call @_var_176(%65, %arg14, %arg15, %arg16) : (tensor<64x512x768xbf16>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>) -> (tensor<64x512x1xbf16>, tensor<64x512x768xf32>)
    %cst_7 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %73 = stablehlo.broadcast_in_dim %cst_7, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %74 = stablehlo.maximum %72#0, %73 : tensor<64x512x1xbf16>
    %75 = stablehlo.compare  EQ, %72#0, %74,  FLOAT : (tensor<64x512x1xbf16>, tensor<64x512x1xbf16>) -> tensor<64x512x1xi1>
    %76 = stablehlo.select %75, %arg22, %arg21 : tensor<64x512x1xi1>, tensor<64x512x1xbf16>
    %cst_8 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %77 = stablehlo.broadcast_in_dim %cst_8, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %78 = stablehlo.compare  EQ, %77, %74,  FLOAT : (tensor<64x512x1xbf16>, tensor<64x512x1xbf16>) -> tensor<64x512x1xi1>
    %79 = stablehlo.select %78, %arg24, %arg23 : tensor<64x512x1xi1>, tensor<64x512x1xbf16>
    %80 = stablehlo.divide %76, %79 : tensor<64x512x1xbf16>
    %cst_9 = stablehlo.constant dense<1.001870e-12> : tensor<bf16>
    %81 = stablehlo.broadcast_in_dim %cst_9, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %82 = stablehlo.add %74, %81 : tensor<64x512x1xbf16>
    %83 = stablehlo.rsqrt %82 : tensor<64x512x1xbf16>
    %84 = stablehlo.divide %83, %82 : tensor<64x512x1xbf16>
    %cst_10 = stablehlo.constant dense<-5.000000e-01> : tensor<bf16>
    %85 = stablehlo.broadcast_in_dim %cst_10, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %86 = stablehlo.multiply %85, %84 : tensor<64x512x1xbf16>
    %87 = stablehlo.broadcast_in_dim %71, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %88 = stablehlo.subtract %65, %87 : tensor<64x512x768xbf16>
    %89 = stablehlo.broadcast_in_dim %83, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %90 = stablehlo.multiply %88, %89 : tensor<64x512x768xbf16>
    %91 = stablehlo.broadcast_in_dim %arg39, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %92 = stablehlo.broadcast_in_dim %91, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %93 = stablehlo.multiply %92, %90 : tensor<64x512x768xbf16>
    %94 = stablehlo.broadcast_in_dim %arg40, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %95 = stablehlo.broadcast_in_dim %94, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %96 = stablehlo.add %93, %95 : tensor<64x512x768xbf16>
    %97 = stablehlo.transpose %arg41, dims = [1, 0] : (tensor<3072x768xbf16>) -> tensor<768x3072xbf16>
    %98 = stablehlo.dot_general %96, %97, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x3072xbf16>) -> tensor<64x512x3072xbf16>
    %99 = stablehlo.broadcast_in_dim %arg42, dims = [2] : (tensor<3072xbf16>) -> tensor<1x1x3072xbf16>
    %100 = stablehlo.broadcast_in_dim %99, dims = [0, 1, 2] : (tensor<1x1x3072xbf16>) -> tensor<64x512x3072xbf16>
    %101 = stablehlo.add %98, %100 : tensor<64x512x3072xbf16>
    %102 = stablehlo.multiply %101, %101 : tensor<64x512x3072xbf16>
    %103 = stablehlo.multiply %102, %101 : tensor<64x512x3072xbf16>
    %104 = stablehlo.multiply %101, %101 : tensor<64x512x3072xbf16>
    %cst_11 = stablehlo.constant dense<3.000000e+00> : tensor<bf16>
    %105 = stablehlo.broadcast_in_dim %cst_11, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %106 = stablehlo.multiply %105, %104 : tensor<64x512x3072xbf16>
    %cst_12 = stablehlo.constant dense<4.467770e-02> : tensor<bf16>
    %107 = stablehlo.broadcast_in_dim %cst_12, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %108 = stablehlo.multiply %107, %103 : tensor<64x512x3072xbf16>
    %109 = stablehlo.add %101, %108 : tensor<64x512x3072xbf16>
    %cst_13 = stablehlo.constant dense<7.968750e-01> : tensor<bf16>
    %110 = stablehlo.broadcast_in_dim %cst_13, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %111 = stablehlo.multiply %110, %109 : tensor<64x512x3072xbf16>
    %112 = stablehlo.tanh %111 : tensor<64x512x3072xbf16>
    %113 = stablehlo.broadcast_in_dim %arg25, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %114 = stablehlo.subtract %113, %112 : tensor<64x512x3072xbf16>
    %cst_14 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %115 = stablehlo.broadcast_in_dim %cst_14, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %116 = stablehlo.add %115, %112 : tensor<64x512x3072xbf16>
    %cst_15 = stablehlo.constant dense<5.000000e-01> : tensor<bf16>
    %117 = stablehlo.broadcast_in_dim %cst_15, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %118 = stablehlo.multiply %117, %116 : tensor<64x512x3072xbf16>
    %119 = stablehlo.multiply %101, %118 : tensor<64x512x3072xbf16>
    %120 = stablehlo.transpose %arg43, dims = [1, 0] : (tensor<768x3072xbf16>) -> tensor<3072x768xbf16>
    %121 = stablehlo.dot_general %119, %120, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x3072xbf16>, tensor<3072x768xbf16>) -> tensor<64x512x768xbf16>
    %122 = stablehlo.broadcast_in_dim %arg44, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %123 = stablehlo.broadcast_in_dim %122, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %124 = stablehlo.add %121, %123 : tensor<64x512x768xbf16>
    %125 = call @_bernoulli_173(%4, %arg0, %arg1, %arg2) : (tensor<2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>) -> tensor<64x512x768xi1>
    %cst_16 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %126 = stablehlo.broadcast_in_dim %cst_16, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %127 = stablehlo.divide %124, %126 : tensor<64x512x768xbf16>
    %128 = call @_where_175(%125, %127, %arg17) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %129 = stablehlo.add %128, %96 : tensor<64x512x768xbf16>
    %130 = stablehlo.convert %129 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst_17 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %131 = stablehlo.reduce(%130 init: %cst_17) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %132 = stablehlo.broadcast_in_dim %131, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_18 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %133 = stablehlo.broadcast_in_dim %cst_18, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %134 = stablehlo.divide %132, %133 : tensor<64x512x1xf32>
    %135 = stablehlo.convert %134 : (tensor<64x512x1xf32>) -> tensor<64x512x1xbf16>
    %136:2 = call @_var_176(%129, %arg18, %arg19, %arg20) : (tensor<64x512x768xbf16>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>) -> (tensor<64x512x1xbf16>, tensor<64x512x768xf32>)
    %cst_19 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %137 = stablehlo.broadcast_in_dim %cst_19, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %138 = stablehlo.maximum %136#0, %137 : tensor<64x512x1xbf16>
    %139 = stablehlo.compare  EQ, %136#0, %138,  FLOAT : (tensor<64x512x1xbf16>, tensor<64x512x1xbf16>) -> tensor<64x512x1xi1>
    %140 = stablehlo.select %139, %arg27, %arg26 : tensor<64x512x1xi1>, tensor<64x512x1xbf16>
    %cst_20 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %141 = stablehlo.broadcast_in_dim %cst_20, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %142 = stablehlo.compare  EQ, %141, %138,  FLOAT : (tensor<64x512x1xbf16>, tensor<64x512x1xbf16>) -> tensor<64x512x1xi1>
    %143 = stablehlo.select %142, %arg29, %arg28 : tensor<64x512x1xi1>, tensor<64x512x1xbf16>
    %144 = stablehlo.divide %140, %143 : tensor<64x512x1xbf16>
    %cst_21 = stablehlo.constant dense<1.001870e-12> : tensor<bf16>
    %145 = stablehlo.broadcast_in_dim %cst_21, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %146 = stablehlo.add %138, %145 : tensor<64x512x1xbf16>
    %147 = stablehlo.rsqrt %146 : tensor<64x512x1xbf16>
    %148 = stablehlo.divide %147, %146 : tensor<64x512x1xbf16>
    %cst_22 = stablehlo.constant dense<-5.000000e-01> : tensor<bf16>
    %149 = stablehlo.broadcast_in_dim %cst_22, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %150 = stablehlo.multiply %149, %148 : tensor<64x512x1xbf16>
    %151 = stablehlo.broadcast_in_dim %135, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %152 = stablehlo.subtract %129, %151 : tensor<64x512x768xbf16>
    %153 = stablehlo.broadcast_in_dim %147, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %154 = stablehlo.multiply %152, %153 : tensor<64x512x768xbf16>
    %155 = stablehlo.broadcast_in_dim %arg45, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %156 = stablehlo.broadcast_in_dim %155, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %157 = stablehlo.multiply %156, %154 : tensor<64x512x768xbf16>
    %158 = stablehlo.broadcast_in_dim %arg46, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %159 = stablehlo.broadcast_in_dim %158, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %160 = stablehlo.add %157, %159 : tensor<64x512x768xbf16>
    return %160, %10, %arg30, %16, %22, %29, %21, %40, %42, %47, %49, %52, %27, %56, %55, %61, %72#1, %80, %86, %83, %88, %90, %91, %97, %96, %106, %112, %114, %118, %101, %120, %119, %125, %136#1, %144, %150, %147, %152, %154, %155 : tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768x768xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x512xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x64xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<1x1x768xbf16>, tensor<768x3072xbf16>, tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<3072x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x1xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<1x1x768xbf16>
  }
  func.func private @_where_137(%arg0: tensor<64x512x12x512xbf16>, %arg1: tensor<64x512x12x512xi1>, %arg2: tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16> {
    %0 = stablehlo.select %arg1, %arg0, %arg2 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
    return %0 : tensor<64x512x12x512xbf16>
  }
  func.func private @_bernoulli_149(%arg0: tensor<2xui32>, %arg1: tensor<1x1x1x1xf32>, %arg2: tensor<1x1x1x1xf32>, %arg3: tensor<f32>) -> tensor<64x512x12x512xi1> {
    %0 = call @_uniform_150(%arg0, %arg1, %arg2) : (tensor<2xui32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32>
    %1 = stablehlo.broadcast_in_dim %arg3, dims = [] : (tensor<f32>) -> tensor<64x512x12x512xf32>
    %2 = stablehlo.compare  LT, %0, %1,  FLOAT : (tensor<64x512x12x512xf32>, tensor<64x512x12x512xf32>) -> tensor<64x512x12x512xi1>
    return %2 : tensor<64x512x12x512xi1>
  }
  func.func private @_uniform_150(%arg0: tensor<2xui32>, %arg1: tensor<1x1x1x1xf32>, %arg2: tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32> {
    %0 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %1 = stablehlo.reshape %0 : (tensor<1xui32>) -> tensor<ui32>
    %2 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %3 = stablehlo.reshape %2 : (tensor<1xui32>) -> tensor<ui32>
    %4 = stablehlo.iota dim = 0 : tensor<64x512x12x512xui64>
    %5 = stablehlo.iota dim = 1 : tensor<64x512x12x512xui64>
    %6 = stablehlo.iota dim = 2 : tensor<64x512x12x512xui64>
    %7 = stablehlo.iota dim = 3 : tensor<64x512x12x512xui64>
    %c = stablehlo.constant dense<3145728> : tensor<ui64>
    %8 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %9 = stablehlo.multiply %8, %4 : tensor<64x512x12x512xui64>
    %c_0 = stablehlo.constant dense<6144> : tensor<ui64>
    %10 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %11 = stablehlo.multiply %10, %5 : tensor<64x512x12x512xui64>
    %c_1 = stablehlo.constant dense<512> : tensor<ui64>
    %12 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %13 = stablehlo.multiply %12, %6 : tensor<64x512x12x512xui64>
    %c_2 = stablehlo.constant dense<1> : tensor<ui64>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %15 = stablehlo.multiply %14, %7 : tensor<64x512x12x512xui64>
    %16 = stablehlo.add %9, %11 : tensor<64x512x12x512xui64>
    %17 = stablehlo.add %16, %13 : tensor<64x512x12x512xui64>
    %18 = stablehlo.add %17, %15 : tensor<64x512x12x512xui64>
    %c_3 = stablehlo.constant dense<32> : tensor<ui64>
    %19 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %20 = stablehlo.shift_right_logical %18, %19 : tensor<64x512x12x512xui64>
    %21 = stablehlo.convert %18 : (tensor<64x512x12x512xui64>) -> tensor<64x512x12x512xui32>
    %22 = stablehlo.convert %20 : (tensor<64x512x12x512xui64>) -> tensor<64x512x12x512xui32>
    %23:2 = call @threefry2x32_153(%1, %3, %22, %21) : (tensor<ui32>, tensor<ui32>, tensor<64x512x12x512xui32>, tensor<64x512x12x512xui32>) -> (tensor<64x512x12x512xui32>, tensor<64x512x12x512xui32>)
    %24 = stablehlo.xor %23#0, %23#1 : tensor<64x512x12x512xui32>
    %c_4 = stablehlo.constant dense<9> : tensor<ui32>
    %25 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %26 = stablehlo.shift_right_logical %24, %25 : tensor<64x512x12x512xui32>
    %c_5 = stablehlo.constant dense<1065353216> : tensor<ui32>
    %27 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %28 = stablehlo.or %26, %27 : tensor<64x512x12x512xui32>
    %29 = stablehlo.bitcast_convert %28 : (tensor<64x512x12x512xui32>) -> tensor<64x512x12x512xf32>
    %cst = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %30 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x12x512xf32>
    %31 = stablehlo.subtract %29, %30 : tensor<64x512x12x512xf32>
    %32 = stablehlo.broadcast_in_dim %arg2, dims = [0, 1, 2, 3] : (tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32>
    %33 = stablehlo.multiply %31, %32 : tensor<64x512x12x512xf32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [0, 1, 2, 3] : (tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32>
    %35 = stablehlo.add %33, %34 : tensor<64x512x12x512xf32>
    %36 = stablehlo.broadcast_in_dim %arg1, dims = [0, 1, 2, 3] : (tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32>
    %37 = stablehlo.maximum %36, %35 : tensor<64x512x12x512xf32>
    return %37 : tensor<64x512x12x512xf32>
  }
  func.func private @threefry2x32_153(%arg0: tensor<ui32>, %arg1: tensor<ui32>, %arg2: tensor<64x512x12x512xui32>, %arg3: tensor<64x512x12x512xui32>) -> (tensor<64x512x12x512xui32>, tensor<64x512x12x512xui32>) {
    %0 = stablehlo.xor %arg0, %arg1 : tensor<ui32>
    %c = stablehlo.constant dense<466688986> : tensor<ui32>
    %1 = stablehlo.xor %0, %c : tensor<ui32>
    %2 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %3 = stablehlo.add %arg2, %2 : tensor<64x512x12x512xui32>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %5 = stablehlo.add %arg3, %4 : tensor<64x512x12x512xui32>
    %6 = stablehlo.add %3, %5 : tensor<64x512x12x512xui32>
    %c_0 = stablehlo.constant dense<13> : tensor<ui32>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %8 = stablehlo.shift_left %5, %7 : tensor<64x512x12x512xui32>
    %c_1 = stablehlo.constant dense<19> : tensor<ui32>
    %9 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %10 = stablehlo.shift_right_logical %5, %9 : tensor<64x512x12x512xui32>
    %11 = stablehlo.or %8, %10 : tensor<64x512x12x512xui32>
    %12 = stablehlo.xor %6, %11 : tensor<64x512x12x512xui32>
    %13 = stablehlo.add %6, %12 : tensor<64x512x12x512xui32>
    %c_2 = stablehlo.constant dense<15> : tensor<ui32>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %15 = stablehlo.shift_left %12, %14 : tensor<64x512x12x512xui32>
    %c_3 = stablehlo.constant dense<17> : tensor<ui32>
    %16 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %17 = stablehlo.shift_right_logical %12, %16 : tensor<64x512x12x512xui32>
    %18 = stablehlo.or %15, %17 : tensor<64x512x12x512xui32>
    %19 = stablehlo.xor %13, %18 : tensor<64x512x12x512xui32>
    %20 = stablehlo.add %13, %19 : tensor<64x512x12x512xui32>
    %c_4 = stablehlo.constant dense<26> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %22 = stablehlo.shift_left %19, %21 : tensor<64x512x12x512xui32>
    %c_5 = stablehlo.constant dense<6> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %24 = stablehlo.shift_right_logical %19, %23 : tensor<64x512x12x512xui32>
    %25 = stablehlo.or %22, %24 : tensor<64x512x12x512xui32>
    %26 = stablehlo.xor %20, %25 : tensor<64x512x12x512xui32>
    %27 = stablehlo.add %20, %26 : tensor<64x512x12x512xui32>
    %c_6 = stablehlo.constant dense<6> : tensor<ui32>
    %28 = stablehlo.broadcast_in_dim %c_6, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %29 = stablehlo.shift_left %26, %28 : tensor<64x512x12x512xui32>
    %c_7 = stablehlo.constant dense<26> : tensor<ui32>
    %30 = stablehlo.broadcast_in_dim %c_7, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %31 = stablehlo.shift_right_logical %26, %30 : tensor<64x512x12x512xui32>
    %32 = stablehlo.or %29, %31 : tensor<64x512x12x512xui32>
    %33 = stablehlo.xor %27, %32 : tensor<64x512x12x512xui32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %35 = stablehlo.add %27, %34 : tensor<64x512x12x512xui32>
    %36 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %37 = stablehlo.add %33, %36 : tensor<64x512x12x512xui32>
    %c_8 = stablehlo.constant dense<1> : tensor<ui32>
    %38 = stablehlo.broadcast_in_dim %c_8, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %39 = stablehlo.add %37, %38 : tensor<64x512x12x512xui32>
    %40 = stablehlo.add %35, %39 : tensor<64x512x12x512xui32>
    %c_9 = stablehlo.constant dense<17> : tensor<ui32>
    %41 = stablehlo.broadcast_in_dim %c_9, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %42 = stablehlo.shift_left %39, %41 : tensor<64x512x12x512xui32>
    %c_10 = stablehlo.constant dense<15> : tensor<ui32>
    %43 = stablehlo.broadcast_in_dim %c_10, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %44 = stablehlo.shift_right_logical %39, %43 : tensor<64x512x12x512xui32>
    %45 = stablehlo.or %42, %44 : tensor<64x512x12x512xui32>
    %46 = stablehlo.xor %40, %45 : tensor<64x512x12x512xui32>
    %47 = stablehlo.add %40, %46 : tensor<64x512x12x512xui32>
    %c_11 = stablehlo.constant dense<29> : tensor<ui32>
    %48 = stablehlo.broadcast_in_dim %c_11, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %49 = stablehlo.shift_left %46, %48 : tensor<64x512x12x512xui32>
    %c_12 = stablehlo.constant dense<3> : tensor<ui32>
    %50 = stablehlo.broadcast_in_dim %c_12, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %51 = stablehlo.shift_right_logical %46, %50 : tensor<64x512x12x512xui32>
    %52 = stablehlo.or %49, %51 : tensor<64x512x12x512xui32>
    %53 = stablehlo.xor %47, %52 : tensor<64x512x12x512xui32>
    %54 = stablehlo.add %47, %53 : tensor<64x512x12x512xui32>
    %c_13 = stablehlo.constant dense<16> : tensor<ui32>
    %55 = stablehlo.broadcast_in_dim %c_13, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %56 = stablehlo.shift_left %53, %55 : tensor<64x512x12x512xui32>
    %c_14 = stablehlo.constant dense<16> : tensor<ui32>
    %57 = stablehlo.broadcast_in_dim %c_14, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %58 = stablehlo.shift_right_logical %53, %57 : tensor<64x512x12x512xui32>
    %59 = stablehlo.or %56, %58 : tensor<64x512x12x512xui32>
    %60 = stablehlo.xor %54, %59 : tensor<64x512x12x512xui32>
    %61 = stablehlo.add %54, %60 : tensor<64x512x12x512xui32>
    %c_15 = stablehlo.constant dense<24> : tensor<ui32>
    %62 = stablehlo.broadcast_in_dim %c_15, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %63 = stablehlo.shift_left %60, %62 : tensor<64x512x12x512xui32>
    %c_16 = stablehlo.constant dense<8> : tensor<ui32>
    %64 = stablehlo.broadcast_in_dim %c_16, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %65 = stablehlo.shift_right_logical %60, %64 : tensor<64x512x12x512xui32>
    %66 = stablehlo.or %63, %65 : tensor<64x512x12x512xui32>
    %67 = stablehlo.xor %61, %66 : tensor<64x512x12x512xui32>
    %68 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %69 = stablehlo.add %61, %68 : tensor<64x512x12x512xui32>
    %70 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %71 = stablehlo.add %67, %70 : tensor<64x512x12x512xui32>
    %c_17 = stablehlo.constant dense<2> : tensor<ui32>
    %72 = stablehlo.broadcast_in_dim %c_17, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %73 = stablehlo.add %71, %72 : tensor<64x512x12x512xui32>
    %74 = stablehlo.add %69, %73 : tensor<64x512x12x512xui32>
    %c_18 = stablehlo.constant dense<13> : tensor<ui32>
    %75 = stablehlo.broadcast_in_dim %c_18, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %76 = stablehlo.shift_left %73, %75 : tensor<64x512x12x512xui32>
    %c_19 = stablehlo.constant dense<19> : tensor<ui32>
    %77 = stablehlo.broadcast_in_dim %c_19, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %78 = stablehlo.shift_right_logical %73, %77 : tensor<64x512x12x512xui32>
    %79 = stablehlo.or %76, %78 : tensor<64x512x12x512xui32>
    %80 = stablehlo.xor %74, %79 : tensor<64x512x12x512xui32>
    %81 = stablehlo.add %74, %80 : tensor<64x512x12x512xui32>
    %c_20 = stablehlo.constant dense<15> : tensor<ui32>
    %82 = stablehlo.broadcast_in_dim %c_20, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %83 = stablehlo.shift_left %80, %82 : tensor<64x512x12x512xui32>
    %c_21 = stablehlo.constant dense<17> : tensor<ui32>
    %84 = stablehlo.broadcast_in_dim %c_21, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %85 = stablehlo.shift_right_logical %80, %84 : tensor<64x512x12x512xui32>
    %86 = stablehlo.or %83, %85 : tensor<64x512x12x512xui32>
    %87 = stablehlo.xor %81, %86 : tensor<64x512x12x512xui32>
    %88 = stablehlo.add %81, %87 : tensor<64x512x12x512xui32>
    %c_22 = stablehlo.constant dense<26> : tensor<ui32>
    %89 = stablehlo.broadcast_in_dim %c_22, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %90 = stablehlo.shift_left %87, %89 : tensor<64x512x12x512xui32>
    %c_23 = stablehlo.constant dense<6> : tensor<ui32>
    %91 = stablehlo.broadcast_in_dim %c_23, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %92 = stablehlo.shift_right_logical %87, %91 : tensor<64x512x12x512xui32>
    %93 = stablehlo.or %90, %92 : tensor<64x512x12x512xui32>
    %94 = stablehlo.xor %88, %93 : tensor<64x512x12x512xui32>
    %95 = stablehlo.add %88, %94 : tensor<64x512x12x512xui32>
    %c_24 = stablehlo.constant dense<6> : tensor<ui32>
    %96 = stablehlo.broadcast_in_dim %c_24, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %97 = stablehlo.shift_left %94, %96 : tensor<64x512x12x512xui32>
    %c_25 = stablehlo.constant dense<26> : tensor<ui32>
    %98 = stablehlo.broadcast_in_dim %c_25, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %99 = stablehlo.shift_right_logical %94, %98 : tensor<64x512x12x512xui32>
    %100 = stablehlo.or %97, %99 : tensor<64x512x12x512xui32>
    %101 = stablehlo.xor %95, %100 : tensor<64x512x12x512xui32>
    %102 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %103 = stablehlo.add %95, %102 : tensor<64x512x12x512xui32>
    %104 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %105 = stablehlo.add %101, %104 : tensor<64x512x12x512xui32>
    %c_26 = stablehlo.constant dense<3> : tensor<ui32>
    %106 = stablehlo.broadcast_in_dim %c_26, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %107 = stablehlo.add %105, %106 : tensor<64x512x12x512xui32>
    %108 = stablehlo.add %103, %107 : tensor<64x512x12x512xui32>
    %c_27 = stablehlo.constant dense<17> : tensor<ui32>
    %109 = stablehlo.broadcast_in_dim %c_27, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %110 = stablehlo.shift_left %107, %109 : tensor<64x512x12x512xui32>
    %c_28 = stablehlo.constant dense<15> : tensor<ui32>
    %111 = stablehlo.broadcast_in_dim %c_28, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %112 = stablehlo.shift_right_logical %107, %111 : tensor<64x512x12x512xui32>
    %113 = stablehlo.or %110, %112 : tensor<64x512x12x512xui32>
    %114 = stablehlo.xor %108, %113 : tensor<64x512x12x512xui32>
    %115 = stablehlo.add %108, %114 : tensor<64x512x12x512xui32>
    %c_29 = stablehlo.constant dense<29> : tensor<ui32>
    %116 = stablehlo.broadcast_in_dim %c_29, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %117 = stablehlo.shift_left %114, %116 : tensor<64x512x12x512xui32>
    %c_30 = stablehlo.constant dense<3> : tensor<ui32>
    %118 = stablehlo.broadcast_in_dim %c_30, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %119 = stablehlo.shift_right_logical %114, %118 : tensor<64x512x12x512xui32>
    %120 = stablehlo.or %117, %119 : tensor<64x512x12x512xui32>
    %121 = stablehlo.xor %115, %120 : tensor<64x512x12x512xui32>
    %122 = stablehlo.add %115, %121 : tensor<64x512x12x512xui32>
    %c_31 = stablehlo.constant dense<16> : tensor<ui32>
    %123 = stablehlo.broadcast_in_dim %c_31, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %124 = stablehlo.shift_left %121, %123 : tensor<64x512x12x512xui32>
    %c_32 = stablehlo.constant dense<16> : tensor<ui32>
    %125 = stablehlo.broadcast_in_dim %c_32, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %126 = stablehlo.shift_right_logical %121, %125 : tensor<64x512x12x512xui32>
    %127 = stablehlo.or %124, %126 : tensor<64x512x12x512xui32>
    %128 = stablehlo.xor %122, %127 : tensor<64x512x12x512xui32>
    %129 = stablehlo.add %122, %128 : tensor<64x512x12x512xui32>
    %c_33 = stablehlo.constant dense<24> : tensor<ui32>
    %130 = stablehlo.broadcast_in_dim %c_33, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %131 = stablehlo.shift_left %128, %130 : tensor<64x512x12x512xui32>
    %c_34 = stablehlo.constant dense<8> : tensor<ui32>
    %132 = stablehlo.broadcast_in_dim %c_34, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %133 = stablehlo.shift_right_logical %128, %132 : tensor<64x512x12x512xui32>
    %134 = stablehlo.or %131, %133 : tensor<64x512x12x512xui32>
    %135 = stablehlo.xor %129, %134 : tensor<64x512x12x512xui32>
    %136 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %137 = stablehlo.add %129, %136 : tensor<64x512x12x512xui32>
    %138 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %139 = stablehlo.add %135, %138 : tensor<64x512x12x512xui32>
    %c_35 = stablehlo.constant dense<4> : tensor<ui32>
    %140 = stablehlo.broadcast_in_dim %c_35, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %141 = stablehlo.add %139, %140 : tensor<64x512x12x512xui32>
    %142 = stablehlo.add %137, %141 : tensor<64x512x12x512xui32>
    %c_36 = stablehlo.constant dense<13> : tensor<ui32>
    %143 = stablehlo.broadcast_in_dim %c_36, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %144 = stablehlo.shift_left %141, %143 : tensor<64x512x12x512xui32>
    %c_37 = stablehlo.constant dense<19> : tensor<ui32>
    %145 = stablehlo.broadcast_in_dim %c_37, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %146 = stablehlo.shift_right_logical %141, %145 : tensor<64x512x12x512xui32>
    %147 = stablehlo.or %144, %146 : tensor<64x512x12x512xui32>
    %148 = stablehlo.xor %142, %147 : tensor<64x512x12x512xui32>
    %149 = stablehlo.add %142, %148 : tensor<64x512x12x512xui32>
    %c_38 = stablehlo.constant dense<15> : tensor<ui32>
    %150 = stablehlo.broadcast_in_dim %c_38, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %151 = stablehlo.shift_left %148, %150 : tensor<64x512x12x512xui32>
    %c_39 = stablehlo.constant dense<17> : tensor<ui32>
    %152 = stablehlo.broadcast_in_dim %c_39, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %153 = stablehlo.shift_right_logical %148, %152 : tensor<64x512x12x512xui32>
    %154 = stablehlo.or %151, %153 : tensor<64x512x12x512xui32>
    %155 = stablehlo.xor %149, %154 : tensor<64x512x12x512xui32>
    %156 = stablehlo.add %149, %155 : tensor<64x512x12x512xui32>
    %c_40 = stablehlo.constant dense<26> : tensor<ui32>
    %157 = stablehlo.broadcast_in_dim %c_40, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %158 = stablehlo.shift_left %155, %157 : tensor<64x512x12x512xui32>
    %c_41 = stablehlo.constant dense<6> : tensor<ui32>
    %159 = stablehlo.broadcast_in_dim %c_41, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %160 = stablehlo.shift_right_logical %155, %159 : tensor<64x512x12x512xui32>
    %161 = stablehlo.or %158, %160 : tensor<64x512x12x512xui32>
    %162 = stablehlo.xor %156, %161 : tensor<64x512x12x512xui32>
    %163 = stablehlo.add %156, %162 : tensor<64x512x12x512xui32>
    %c_42 = stablehlo.constant dense<6> : tensor<ui32>
    %164 = stablehlo.broadcast_in_dim %c_42, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %165 = stablehlo.shift_left %162, %164 : tensor<64x512x12x512xui32>
    %c_43 = stablehlo.constant dense<26> : tensor<ui32>
    %166 = stablehlo.broadcast_in_dim %c_43, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %167 = stablehlo.shift_right_logical %162, %166 : tensor<64x512x12x512xui32>
    %168 = stablehlo.or %165, %167 : tensor<64x512x12x512xui32>
    %169 = stablehlo.xor %163, %168 : tensor<64x512x12x512xui32>
    %170 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %171 = stablehlo.add %163, %170 : tensor<64x512x12x512xui32>
    %172 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %173 = stablehlo.add %169, %172 : tensor<64x512x12x512xui32>
    %c_44 = stablehlo.constant dense<5> : tensor<ui32>
    %174 = stablehlo.broadcast_in_dim %c_44, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %175 = stablehlo.add %173, %174 : tensor<64x512x12x512xui32>
    return %171, %175 : tensor<64x512x12x512xui32>, tensor<64x512x12x512xui32>
  }
  func.func private @_where_168(%arg0: tensor<64x512x12x512xi1>, %arg1: tensor<64x512x12x512xbf16>, %arg2: tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
    return %0 : tensor<64x512x12x512xbf16>
  }
  func.func private @_bernoulli_173(%arg0: tensor<2xui32>, %arg1: tensor<1x1x1xf32>, %arg2: tensor<1x1x1xf32>, %arg3: tensor<f32>) -> tensor<64x512x768xi1> {
    %0 = call @_uniform_174(%arg0, %arg1, %arg2) : (tensor<2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %1 = stablehlo.broadcast_in_dim %arg3, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %2 = stablehlo.compare  LT, %0, %1,  FLOAT : (tensor<64x512x768xf32>, tensor<64x512x768xf32>) -> tensor<64x512x768xi1>
    return %2 : tensor<64x512x768xi1>
  }
  func.func private @_uniform_174(%arg0: tensor<2xui32>, %arg1: tensor<1x1x1xf32>, %arg2: tensor<1x1x1xf32>) -> tensor<64x512x768xf32> {
    %0 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %1 = stablehlo.reshape %0 : (tensor<1xui32>) -> tensor<ui32>
    %2 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %3 = stablehlo.reshape %2 : (tensor<1xui32>) -> tensor<ui32>
    %4 = stablehlo.iota dim = 0 : tensor<64x512x768xui64>
    %5 = stablehlo.iota dim = 1 : tensor<64x512x768xui64>
    %6 = stablehlo.iota dim = 2 : tensor<64x512x768xui64>
    %c = stablehlo.constant dense<393216> : tensor<ui64>
    %7 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %8 = stablehlo.multiply %7, %4 : tensor<64x512x768xui64>
    %c_0 = stablehlo.constant dense<768> : tensor<ui64>
    %9 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %10 = stablehlo.multiply %9, %5 : tensor<64x512x768xui64>
    %c_1 = stablehlo.constant dense<1> : tensor<ui64>
    %11 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %12 = stablehlo.multiply %11, %6 : tensor<64x512x768xui64>
    %13 = stablehlo.add %8, %10 : tensor<64x512x768xui64>
    %14 = stablehlo.add %13, %12 : tensor<64x512x768xui64>
    %c_2 = stablehlo.constant dense<32> : tensor<ui64>
    %15 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %16 = stablehlo.shift_right_logical %14, %15 : tensor<64x512x768xui64>
    %17 = stablehlo.convert %14 : (tensor<64x512x768xui64>) -> tensor<64x512x768xui32>
    %18 = stablehlo.convert %16 : (tensor<64x512x768xui64>) -> tensor<64x512x768xui32>
    %19:2 = call @threefry2x32_53(%1, %3, %18, %17) : (tensor<ui32>, tensor<ui32>, tensor<64x512x768xui32>, tensor<64x512x768xui32>) -> (tensor<64x512x768xui32>, tensor<64x512x768xui32>)
    %20 = stablehlo.xor %19#0, %19#1 : tensor<64x512x768xui32>
    %c_3 = stablehlo.constant dense<9> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %22 = stablehlo.shift_right_logical %20, %21 : tensor<64x512x768xui32>
    %c_4 = stablehlo.constant dense<1065353216> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %24 = stablehlo.or %22, %23 : tensor<64x512x768xui32>
    %25 = stablehlo.bitcast_convert %24 : (tensor<64x512x768xui32>) -> tensor<64x512x768xf32>
    %cst = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %26 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %27 = stablehlo.subtract %25, %26 : tensor<64x512x768xf32>
    %28 = stablehlo.broadcast_in_dim %arg2, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %29 = stablehlo.multiply %27, %28 : tensor<64x512x768xf32>
    %30 = stablehlo.broadcast_in_dim %arg1, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %31 = stablehlo.add %29, %30 : tensor<64x512x768xf32>
    %32 = stablehlo.broadcast_in_dim %arg1, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %33 = stablehlo.maximum %32, %31 : tensor<64x512x768xf32>
    return %33 : tensor<64x512x768xf32>
  }
  func.func private @_where_175(%arg0: tensor<64x512x768xi1>, %arg1: tensor<64x512x768xbf16>, %arg2: tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %0 : tensor<64x512x768xbf16>
  }
  func.func private @_var_176(%arg0: tensor<64x512x768xbf16>, %arg1: tensor<f32>, %arg2: tensor<i1>, %arg3: tensor<64x512x1xbf16>) -> (tensor<64x512x1xbf16>, tensor<64x512x768xf32>) {
    %0 = stablehlo.convert %arg0 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %1 = stablehlo.reduce(%0 init: %cst) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %2 = stablehlo.broadcast_in_dim %1, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_0 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %3 = stablehlo.broadcast_in_dim %cst_0, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %4 = stablehlo.divide %2, %3 : tensor<64x512x1xf32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %6 = stablehlo.subtract %0, %5 : tensor<64x512x768xf32>
    %7 = stablehlo.multiply %6, %6 : tensor<64x512x768xf32>
    %cst_1 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %8 = stablehlo.broadcast_in_dim %cst_1, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %9 = stablehlo.multiply %8, %6 : tensor<64x512x768xf32>
    %cst_2 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %10 = stablehlo.reduce(%7 init: %cst_2) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %11 = stablehlo.broadcast_in_dim %10, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %12 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %13 = stablehlo.divide %11, %12 : tensor<64x512x1xf32>
    %14 = stablehlo.convert %13 : (tensor<64x512x1xf32>) -> tensor<64x512x1xbf16>
    %15 = call @_where_177(%14, %arg2, %arg3) : (tensor<64x512x1xbf16>, tensor<i1>, tensor<64x512x1xbf16>) -> tensor<64x512x1xbf16>
    return %15, %9 : tensor<64x512x1xbf16>, tensor<64x512x768xf32>
  }
  func.func private @_where_177(%arg0: tensor<64x512x1xbf16>, %arg1: tensor<i1>, %arg2: tensor<64x512x1xbf16>) -> tensor<64x512x1xbf16> {
    %0 = stablehlo.select %arg1, %arg0, %arg2 : tensor<i1>, tensor<64x512x1xbf16>
    return %0 : tensor<64x512x1xbf16>
  }
  func.func private @_where_232(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xi32>, %arg2: tensor<i32>) -> tensor<64x512xi32> {
    %0 = stablehlo.convert %arg2 : tensor<i32>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %2 = stablehlo.select %arg0, %arg1, %1 : tensor<64x512xi1>, tensor<64x512xi32>
    return %2 : tensor<64x512xi32>
  }
  func.func private @take_along_axis(%arg0: tensor<64x512x30522xf32>, %arg1: tensor<64x512x1xi32>) -> (tensor<64x512x1xf32>, tensor<64x512x1x1xi32>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %1 = stablehlo.compare  LT, %arg1, %0,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %c_0 = stablehlo.constant dense<30522> : tensor<i32>
    %2 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %3 = stablehlo.add %arg1, %2 : tensor<64x512x1xi32>
    %4 = stablehlo.select %1, %3, %arg1 : tensor<64x512x1xi1>, tensor<64x512x1xi32>
    %5 = stablehlo.reshape %4 : (tensor<64x512x1xi32>) -> tensor<64x512x1x1xi32>
    %c_1 = stablehlo.constant dense<30521> : tensor<1xi32>
    %c_2 = stablehlo.constant dense<0> : tensor<i32>
    %6 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<i32>) -> tensor<64x512x1x1xi32>
    %7 = stablehlo.compare  GE, %5, %6,  SIGNED : (tensor<64x512x1x1xi32>, tensor<64x512x1x1xi32>) -> tensor<64x512x1x1xi1>
    %8 = stablehlo.broadcast_in_dim %c_1, dims = [3] : (tensor<1xi32>) -> tensor<1x1x1x1xi32>
    %9 = stablehlo.broadcast_in_dim %8, dims = [0, 1, 2, 3] : (tensor<1x1x1x1xi32>) -> tensor<64x512x1x1xi32>
    %10 = stablehlo.compare  LE, %5, %9,  SIGNED : (tensor<64x512x1x1xi32>, tensor<64x512x1x1xi32>) -> tensor<64x512x1x1xi1>
    %11 = stablehlo.and %7, %10 : tensor<64x512x1x1xi1>
    %c_3 = stablehlo.constant dense<true> : tensor<i1>
    %12 = stablehlo.reduce(%11 init: %c_3) applies stablehlo.and across dimensions = [3] : (tensor<64x512x1x1xi1>, tensor<i1>) -> tensor<64x512x1xi1>
    %13 = "stablehlo.gather"(%arg0, %5) <{dimension_numbers = #stablehlo.gather<collapsed_slice_dims = [2], operand_batching_dims = [0, 1], start_indices_batching_dims = [0, 1], start_index_map = [2], index_vector_dim = 3>, indices_are_sorted = false, slice_sizes = array<i64: 1, 1, 1>}> : (tensor<64x512x30522xf32>, tensor<64x512x1x1xi32>) -> tensor<64x512x1xf32>
    %cst = stablehlo.constant dense<0x7FC00000> : tensor<f32>
    %14 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %15 = stablehlo.select %12, %13, %14 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    return %15, %5 : tensor<64x512x1xf32>, tensor<64x512x1x1xi32>
  }
  func.func private @_where_256(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xf32>, %arg2: tensor<f32>) -> tensor<64x512xf32> {
    %0 = stablehlo.convert %arg2 : tensor<f32>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<f32>) -> tensor<64x512xf32>
    %2 = stablehlo.select %arg0, %arg1, %1 : tensor<64x512xi1>, tensor<64x512xf32>
    return %2 : tensor<64x512xf32>
  }
  func.func private @argmax(%arg0: tensor<64x512x30522xf32>) -> tensor<64x512xi32> {
    %0 = stablehlo.iota dim = 2 : tensor<64x512x30522xi32>
    %cst = stablehlo.constant dense<0xFF800000> : tensor<f32>
    %c = stablehlo.constant dense<0> : tensor<i32>
    %1:2 = stablehlo.reduce(%arg0 init: %cst), (%0 init: %c) across dimensions = [2] : (tensor<64x512x30522xf32>, tensor<64x512x30522xi32>, tensor<f32>, tensor<i32>) -> (tensor<64x512xf32>, tensor<64x512xi32>)
     reducer(%arg1: tensor<f32>, %arg3: tensor<f32>) (%arg2: tensor<i32>, %arg4: tensor<i32>)  {
      %2 = stablehlo.compare  GT, %arg1, %arg3,  FLOAT : (tensor<f32>, tensor<f32>) -> tensor<i1>
      %3 = stablehlo.compare  NE, %arg1, %arg1,  FLOAT : (tensor<f32>, tensor<f32>) -> tensor<i1>
      %4 = stablehlo.or %2, %3 : tensor<i1>
      %5 = stablehlo.compare  EQ, %arg1, %arg3,  FLOAT : (tensor<f32>, tensor<f32>) -> tensor<i1>
      %6 = stablehlo.compare  LT, %arg2, %arg4,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
      %7 = stablehlo.and %5, %6 : tensor<i1>
      %8 = stablehlo.or %4, %7 : tensor<i1>
      %9 = stablehlo.select %4, %arg1, %arg3 : tensor<i1>, tensor<f32>
      %10 = stablehlo.select %8, %arg2, %arg4 : tensor<i1>, tensor<i32>
      stablehlo.return %9, %10 : tensor<f32>, tensor<i32>
    }
    return %1#1 : tensor<64x512xi32>
  }
  func.func private @_where_274(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xf32>) -> tensor<64x512xf32> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512xf32>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512xi1>, tensor<64x512xf32>
    return %1 : tensor<64x512xf32>
  }
  func.func private @take_along_axis_275(%arg0: tensor<64x512x1x1xi32>, %arg1: tensor<64x512x1xf32>) -> tensor<64x512x30522xf32> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x30522xf32>
    %1 = "stablehlo.scatter"(%0, %arg0, %arg1) <{indices_are_sorted = false, scatter_dimension_numbers = #stablehlo.scatter<inserted_window_dims = [2], input_batching_dims = [0, 1], scatter_indices_batching_dims = [0, 1], scatter_dims_to_operand_dims = [2], index_vector_dim = 3>, unique_indices = false}> ({
    ^bb0(%arg2: tensor<f32>, %arg3: tensor<f32>):
      %2 = stablehlo.add %arg2, %arg3 : tensor<f32>
      stablehlo.return %2 : tensor<f32>
    }) : (tensor<64x512x30522xf32>, tensor<64x512x1x1xi32>, tensor<64x512x1xf32>) -> tensor<64x512x30522xf32>
    return %1 : tensor<64x512x30522xf32>
  }
  func.func private @_var_295(%arg0: tensor<64x512x768xf32>, %arg1: tensor<f32>, %arg2: tensor<i1>, %arg3: tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16> {
    %0 = call @_where_296(%arg2, %arg3) : (tensor<i1>, tensor<64x512x1xbf16>) -> tensor<64x512x1xbf16>
    %1 = stablehlo.convert %0 : (tensor<64x512x1xbf16>) -> tensor<64x512x1xf32>
    %2 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %3 = stablehlo.divide %1, %2 : tensor<64x512x1xf32>
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %4 = stablehlo.reduce(%3 init: %cst) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %6 = stablehlo.multiply %5, %arg0 : tensor<64x512x768xf32>
    %7 = stablehlo.negate %6 : tensor<64x512x768xf32>
    %cst_0 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %8 = stablehlo.reduce(%7 init: %cst_0) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %9 = stablehlo.reshape %8 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_1 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %10 = stablehlo.broadcast_in_dim %cst_1, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %11 = stablehlo.divide %9, %10 : tensor<64x512x1xf32>
    %cst_2 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %12 = stablehlo.reduce(%11 init: %cst_2) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %13 = stablehlo.broadcast_in_dim %12, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %14 = stablehlo.add %6, %13 : tensor<64x512x768xf32>
    %15 = stablehlo.convert %14 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    return %15 : tensor<64x512x768xbf16>
  }
  func.func private @_where_296(%arg0: tensor<i1>, %arg1: tensor<64x512x1xbf16>) -> tensor<64x512x1xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<i1>, tensor<64x512x1xbf16>
    return %1 : tensor<64x512x1xbf16>
  }
  func.func private @closed_call_335(%arg0: tensor<bf16>, %arg1: tensor<64x512x12x512xi1>, %arg2: tensor<f32>, %arg3: tensor<i1>, %arg4: tensor<f32>, %arg5: tensor<i1>, %arg6: tensor<64x512x768xbf16>, %arg7: tensor<768x768xbf16>, %arg8: tensor<64x512x768xbf16>, %arg9: tensor<768x768xbf16>, %arg10: tensor<768x768xbf16>, %arg11: tensor<64x512x12x64xbf16>, %arg12: tensor<64x512x12x64xbf16>, %arg13: tensor<64x512x12x512xf32>, %arg14: tensor<64x512x12x1xf32>, %arg15: tensor<64x512x12x1xf32>, %arg16: tensor<64x512x12x512xi1>, %arg17: tensor<64x512x12x512xbf16>, %arg18: tensor<64x512x12x64xbf16>, %arg19: tensor<768x768xbf16>, %arg20: tensor<64x512x768xbf16>, %arg21: tensor<64x512x768xi1>, %arg22: tensor<64x512x768xf32>, %arg23: tensor<64x512x1xbf16>, %arg24: tensor<64x512x1xbf16>, %arg25: tensor<64x512x1xbf16>, %arg26: tensor<64x512x768xbf16>, %arg27: tensor<64x512x768xbf16>, %arg28: tensor<1x1x768xbf16>, %arg29: tensor<768x3072xbf16>, %arg30: tensor<64x512x768xbf16>, %arg31: tensor<64x512x3072xbf16>, %arg32: tensor<64x512x3072xbf16>, %arg33: tensor<64x512x3072xbf16>, %arg34: tensor<64x512x3072xbf16>, %arg35: tensor<64x512x3072xbf16>, %arg36: tensor<3072x768xbf16>, %arg37: tensor<64x512x3072xbf16>, %arg38: tensor<64x512x768xi1>, %arg39: tensor<64x512x768xf32>, %arg40: tensor<64x512x1xbf16>, %arg41: tensor<64x512x1xbf16>, %arg42: tensor<64x512x1xbf16>, %arg43: tensor<64x512x768xbf16>, %arg44: tensor<64x512x768xbf16>, %arg45: tensor<1x1x768xbf16>) -> (tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<3072x768xbf16>, tensor<3072xbf16>, tensor<768x3072xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>) {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.reduce(%arg6 init: %cst) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %1 = stablehlo.reshape %0 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_0 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %2 = stablehlo.reduce(%1 init: %cst_0) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %3 = stablehlo.broadcast_in_dim %arg45, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %4 = stablehlo.multiply %3, %arg6 : tensor<64x512x768xbf16>
    %5 = stablehlo.multiply %arg6, %arg44 : tensor<64x512x768xbf16>
    %cst_1 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %6 = stablehlo.reduce(%5 init: %cst_1) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %7 = stablehlo.reshape %6 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_2 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %8 = stablehlo.reduce(%7 init: %cst_2) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %9 = stablehlo.multiply %arg43, %4 : tensor<64x512x768xbf16>
    %cst_3 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %10 = stablehlo.reduce(%9 init: %cst_3) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<64x512xbf16>
    %11 = stablehlo.reshape %10 : (tensor<64x512xbf16>) -> tensor<64x512x1xbf16>
    %12 = stablehlo.broadcast_in_dim %arg42, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %13 = stablehlo.multiply %4, %12 : tensor<64x512x768xbf16>
    %14 = stablehlo.negate %13 : tensor<64x512x768xbf16>
    %cst_4 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %15 = stablehlo.reduce(%14 init: %cst_4) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<64x512xbf16>
    %16 = stablehlo.reshape %15 : (tensor<64x512xbf16>) -> tensor<64x512x1xbf16>
    %17 = stablehlo.multiply %11, %arg41 : tensor<64x512x1xbf16>
    %18 = stablehlo.multiply %17, %arg40 : tensor<64x512x1xbf16>
    %19 = call @_var_336(%arg39, %arg4, %arg5, %18) : (tensor<64x512x768xf32>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %20 = stablehlo.add %13, %19 : tensor<64x512x768xbf16>
    %21 = stablehlo.convert %16 : (tensor<64x512x1xbf16>) -> tensor<64x512x1xf32>
    %cst_5 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %22 = stablehlo.broadcast_in_dim %cst_5, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %23 = stablehlo.divide %21, %22 : tensor<64x512x1xf32>
    %cst_6 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %24 = stablehlo.reduce(%23 init: %cst_6) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %25 = stablehlo.broadcast_in_dim %24, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %26 = stablehlo.convert %25 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %27 = stablehlo.add %20, %26 : tensor<64x512x768xbf16>
    %28 = call @_where_338(%arg38, %27) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %cst_7 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %29 = stablehlo.broadcast_in_dim %cst_7, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %30 = stablehlo.divide %28, %29 : tensor<64x512x768xbf16>
    %cst_8 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %31 = stablehlo.reduce(%30 init: %cst_8) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %32 = stablehlo.reshape %31 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_9 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %33 = stablehlo.reduce(%32 init: %cst_9) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %34 = stablehlo.dot_general %30, %arg37, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>) -> tensor<768x3072xbf16>
    %35 = stablehlo.transpose %34, dims = [1, 0] : (tensor<768x3072xbf16>) -> tensor<3072x768xbf16>
    %36 = stablehlo.dot_general %30, %arg36, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<3072x768xbf16>) -> tensor<64x512x3072xbf16>
    %37 = stablehlo.transpose %35, dims = [1, 0] : (tensor<3072x768xbf16>) -> tensor<768x3072xbf16>
    %38 = stablehlo.multiply %arg35, %36 : tensor<64x512x3072xbf16>
    %39 = stablehlo.multiply %36, %arg34 : tensor<64x512x3072xbf16>
    %cst_10 = stablehlo.constant dense<5.000000e-01> : tensor<bf16>
    %40 = stablehlo.broadcast_in_dim %cst_10, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %41 = stablehlo.multiply %40, %38 : tensor<64x512x3072xbf16>
    %42 = stablehlo.multiply %41, %arg33 : tensor<64x512x3072xbf16>
    %43 = stablehlo.multiply %42, %arg32 : tensor<64x512x3072xbf16>
    %44 = stablehlo.add %42, %43 : tensor<64x512x3072xbf16>
    %cst_11 = stablehlo.constant dense<7.968750e-01> : tensor<bf16>
    %45 = stablehlo.broadcast_in_dim %cst_11, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %46 = stablehlo.multiply %45, %44 : tensor<64x512x3072xbf16>
    %47 = stablehlo.add %39, %46 : tensor<64x512x3072xbf16>
    %cst_12 = stablehlo.constant dense<4.467770e-02> : tensor<bf16>
    %48 = stablehlo.broadcast_in_dim %cst_12, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %49 = stablehlo.multiply %48, %46 : tensor<64x512x3072xbf16>
    %50 = stablehlo.multiply %49, %arg31 : tensor<64x512x3072xbf16>
    %51 = stablehlo.add %47, %50 : tensor<64x512x3072xbf16>
    %cst_13 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %52 = stablehlo.reduce(%51 init: %cst_13) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x3072xbf16>, tensor<bf16>) -> tensor<3072xbf16>
    %53 = stablehlo.reshape %52 : (tensor<3072xbf16>) -> tensor<1x1x3072xbf16>
    %cst_14 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %54 = stablehlo.reduce(%53 init: %cst_14) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x3072xbf16>, tensor<bf16>) -> tensor<3072xbf16>
    %55 = stablehlo.dot_general %51, %arg30, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x3072xbf16>, tensor<64x512x768xbf16>) -> tensor<3072x768xbf16>
    %56 = stablehlo.transpose %55, dims = [1, 0] : (tensor<3072x768xbf16>) -> tensor<768x3072xbf16>
    %57 = stablehlo.dot_general %51, %arg29, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x3072xbf16>, tensor<768x3072xbf16>) -> tensor<64x512x768xbf16>
    %58 = stablehlo.add %27, %57 : tensor<64x512x768xbf16>
    %59 = stablehlo.transpose %56, dims = [1, 0] : (tensor<768x3072xbf16>) -> tensor<3072x768xbf16>
    %cst_15 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %60 = stablehlo.reduce(%58 init: %cst_15) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %61 = stablehlo.reshape %60 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_16 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %62 = stablehlo.reduce(%61 init: %cst_16) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %63 = stablehlo.broadcast_in_dim %arg28, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %64 = stablehlo.multiply %63, %58 : tensor<64x512x768xbf16>
    %65 = stablehlo.multiply %58, %arg27 : tensor<64x512x768xbf16>
    %cst_17 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %66 = stablehlo.reduce(%65 init: %cst_17) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %67 = stablehlo.reshape %66 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_18 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %68 = stablehlo.reduce(%67 init: %cst_18) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %69 = stablehlo.multiply %arg26, %64 : tensor<64x512x768xbf16>
    %cst_19 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %70 = stablehlo.reduce(%69 init: %cst_19) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<64x512xbf16>
    %71 = stablehlo.reshape %70 : (tensor<64x512xbf16>) -> tensor<64x512x1xbf16>
    %72 = stablehlo.broadcast_in_dim %arg25, dims = [0, 1, 2] : (tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %73 = stablehlo.multiply %64, %72 : tensor<64x512x768xbf16>
    %74 = stablehlo.negate %73 : tensor<64x512x768xbf16>
    %cst_20 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %75 = stablehlo.reduce(%74 init: %cst_20) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<64x512xbf16>
    %76 = stablehlo.reshape %75 : (tensor<64x512xbf16>) -> tensor<64x512x1xbf16>
    %77 = stablehlo.multiply %71, %arg24 : tensor<64x512x1xbf16>
    %78 = stablehlo.multiply %77, %arg23 : tensor<64x512x1xbf16>
    %79 = call @_var_336(%arg22, %arg2, %arg3, %78) : (tensor<64x512x768xf32>, tensor<f32>, tensor<i1>, tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16>
    %80 = stablehlo.add %73, %79 : tensor<64x512x768xbf16>
    %81 = stablehlo.convert %76 : (tensor<64x512x1xbf16>) -> tensor<64x512x1xf32>
    %cst_21 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %82 = stablehlo.broadcast_in_dim %cst_21, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %83 = stablehlo.divide %81, %82 : tensor<64x512x1xf32>
    %cst_22 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %84 = stablehlo.reduce(%83 init: %cst_22) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %85 = stablehlo.broadcast_in_dim %84, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %86 = stablehlo.convert %85 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %87 = stablehlo.add %80, %86 : tensor<64x512x768xbf16>
    %88 = call @_where_338(%arg21, %87) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %cst_23 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %89 = stablehlo.broadcast_in_dim %cst_23, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %90 = stablehlo.divide %88, %89 : tensor<64x512x768xbf16>
    %cst_24 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %91 = stablehlo.reduce(%90 init: %cst_24) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %92 = stablehlo.reshape %91 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_25 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %93 = stablehlo.reduce(%92 init: %cst_25) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %94 = stablehlo.dot_general %90, %arg20, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %95 = stablehlo.transpose %94, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %96 = stablehlo.dot_general %90, %arg19, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %97 = stablehlo.transpose %95, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %98 = stablehlo.reshape %96 : (tensor<64x512x768xbf16>) -> tensor<64x512x12x64xbf16>
    %99 = stablehlo.transpose %98, dims = [0, 2, 3, 1] : (tensor<64x512x12x64xbf16>) -> tensor<64x12x64x512xbf16>
    %100 = stablehlo.dot_general %99, %arg18, batching_dims = [0, 1] x [0, 2], contracting_dims = [2] x [3], precision = [DEFAULT, DEFAULT] : (tensor<64x12x64x512xbf16>, tensor<64x512x12x64xbf16>) -> tensor<64x12x512x512xbf16>
    %101 = stablehlo.transpose %100, dims = [0, 2, 1, 3] : (tensor<64x12x512x512xbf16>) -> tensor<64x512x12x512xbf16>
    %102 = stablehlo.dot_general %99, %arg17, batching_dims = [0, 1] x [0, 2], contracting_dims = [3] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x12x64x512xbf16>, tensor<64x512x12x512xbf16>) -> tensor<64x12x64x512xbf16>
    %103 = stablehlo.transpose %102, dims = [0, 3, 1, 2] : (tensor<64x12x64x512xbf16>) -> tensor<64x512x12x64xbf16>
    %104 = call @_where_353(%arg16, %101) : (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
    %cst_26 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %105 = stablehlo.broadcast_in_dim %cst_26, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    %106 = stablehlo.divide %104, %105 : tensor<64x512x12x512xbf16>
    %107 = stablehlo.convert %106 : (tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xf32>
    %108 = stablehlo.broadcast_in_dim %arg15, dims = [0, 1, 2, 3] : (tensor<64x512x12x1xf32>) -> tensor<64x512x12x512xf32>
    %109 = stablehlo.multiply %107, %108 : tensor<64x512x12x512xf32>
    %110 = stablehlo.multiply %109, %arg13 : tensor<64x512x12x512xf32>
    %cst_27 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %111 = stablehlo.reduce(%110 init: %cst_27) applies stablehlo.add across dimensions = [3] : (tensor<64x512x12x512xf32>, tensor<f32>) -> tensor<64x512x12xf32>
    %112 = stablehlo.reshape %111 : (tensor<64x512x12xf32>) -> tensor<64x512x12x1xf32>
    %113 = stablehlo.negate %112 : tensor<64x512x12x1xf32>
    %114 = stablehlo.broadcast_in_dim %arg14, dims = [0, 1, 2, 3] : (tensor<64x512x12x1xf32>) -> tensor<64x512x12x512xf32>
    %115 = stablehlo.divide %107, %114 : tensor<64x512x12x512xf32>
    %cst_28 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %116 = stablehlo.reduce(%113 init: %cst_28) applies stablehlo.add across dimensions = [3] : (tensor<64x512x12x1xf32>, tensor<f32>) -> tensor<64x512x12xf32>
    %117 = stablehlo.broadcast_in_dim %116, dims = [0, 1, 2] : (tensor<64x512x12xf32>) -> tensor<64x512x12x512xf32>
    %118 = stablehlo.add %115, %117 : tensor<64x512x12x512xf32>
    %119 = stablehlo.multiply %118, %arg13 : tensor<64x512x12x512xf32>
    %120 = stablehlo.convert %119 : (tensor<64x512x12x512xf32>) -> tensor<64x512x12x512xbf16>
    %121 = call @_where_364(%arg1, %120) : (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
    %122 = stablehlo.transpose %121, dims = [0, 2, 3, 1] : (tensor<64x512x12x512xbf16>) -> tensor<64x12x512x512xbf16>
    %123 = stablehlo.dot_general %122, %arg12, batching_dims = [0, 1] x [0, 2], contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x12x512x512xbf16>, tensor<64x512x12x64xbf16>) -> tensor<64x12x512x64xbf16>
    %124 = stablehlo.transpose %123, dims = [0, 2, 1, 3] : (tensor<64x12x512x64xbf16>) -> tensor<64x512x12x64xbf16>
    %125 = stablehlo.dot_general %122, %arg11, batching_dims = [0, 1] x [0, 2], contracting_dims = [3] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x12x512x512xbf16>, tensor<64x512x12x64xbf16>) -> tensor<64x12x512x64xbf16>
    %126 = stablehlo.transpose %125, dims = [0, 2, 1, 3] : (tensor<64x12x512x64xbf16>) -> tensor<64x512x12x64xbf16>
    %127 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<bf16>) -> tensor<64x512x12x64xbf16>
    %128 = stablehlo.divide %124, %127 : tensor<64x512x12x64xbf16>
    %129 = stablehlo.reshape %103 : (tensor<64x512x12x64xbf16>) -> tensor<64x512x768xbf16>
    %cst_29 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %130 = stablehlo.reduce(%129 init: %cst_29) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %131 = stablehlo.reshape %130 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_30 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %132 = stablehlo.reduce(%131 init: %cst_30) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %133 = stablehlo.dot_general %129, %arg8, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %134 = stablehlo.transpose %133, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %135 = stablehlo.dot_general %129, %arg10, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %136 = stablehlo.add %87, %135 : tensor<64x512x768xbf16>
    %137 = stablehlo.transpose %134, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %138 = stablehlo.reshape %126 : (tensor<64x512x12x64xbf16>) -> tensor<64x512x768xbf16>
    %cst_31 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %139 = stablehlo.reduce(%138 init: %cst_31) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %140 = stablehlo.reshape %139 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_32 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %141 = stablehlo.reduce(%140 init: %cst_32) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %142 = stablehlo.dot_general %138, %arg8, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %143 = stablehlo.transpose %142, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %144 = stablehlo.dot_general %138, %arg9, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %145 = stablehlo.add %136, %144 : tensor<64x512x768xbf16>
    %146 = stablehlo.transpose %143, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %147 = stablehlo.reshape %128 : (tensor<64x512x12x64xbf16>) -> tensor<64x512x768xbf16>
    %cst_33 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %148 = stablehlo.reduce(%147 init: %cst_33) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %149 = stablehlo.reshape %148 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_34 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %150 = stablehlo.reduce(%149 init: %cst_34) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %151 = stablehlo.dot_general %147, %arg8, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %152 = stablehlo.transpose %151, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %153 = stablehlo.dot_general %147, %arg7, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %154 = stablehlo.add %145, %153 : tensor<64x512x768xbf16>
    %155 = stablehlo.transpose %152, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    return %154, %155, %150, %146, %141, %137, %132, %97, %93, %68, %62, %59, %54, %37, %33, %8, %2 : tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<3072x768xbf16>, tensor<3072xbf16>, tensor<768x3072xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>
  }
  func.func private @_var_336(%arg0: tensor<64x512x768xf32>, %arg1: tensor<f32>, %arg2: tensor<i1>, %arg3: tensor<64x512x1xbf16>) -> tensor<64x512x768xbf16> {
    %0 = call @_where_337(%arg2, %arg3) : (tensor<i1>, tensor<64x512x1xbf16>) -> tensor<64x512x1xbf16>
    %1 = stablehlo.convert %0 : (tensor<64x512x1xbf16>) -> tensor<64x512x1xf32>
    %2 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %3 = stablehlo.divide %1, %2 : tensor<64x512x1xf32>
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %4 = stablehlo.reduce(%3 init: %cst) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %6 = stablehlo.multiply %5, %arg0 : tensor<64x512x768xf32>
    %7 = stablehlo.negate %6 : tensor<64x512x768xf32>
    %cst_0 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %8 = stablehlo.reduce(%7 init: %cst_0) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %9 = stablehlo.reshape %8 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_1 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %10 = stablehlo.broadcast_in_dim %cst_1, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %11 = stablehlo.divide %9, %10 : tensor<64x512x1xf32>
    %cst_2 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %12 = stablehlo.reduce(%11 init: %cst_2) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %13 = stablehlo.broadcast_in_dim %12, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %14 = stablehlo.add %6, %13 : tensor<64x512x768xf32>
    %15 = stablehlo.convert %14 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    return %15 : tensor<64x512x768xbf16>
  }
  func.func private @_where_337(%arg0: tensor<i1>, %arg1: tensor<64x512x1xbf16>) -> tensor<64x512x1xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x1xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<i1>, tensor<64x512x1xbf16>
    return %1 : tensor<64x512x1xbf16>
  }
  func.func private @_where_338(%arg0: tensor<64x512x768xi1>, %arg1: tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %1 : tensor<64x512x768xbf16>
  }
  func.func private @_where_353(%arg0: tensor<64x512x12x512xi1>, %arg1: tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
    return %1 : tensor<64x512x12x512xbf16>
  }
  func.func private @_where_364(%arg0: tensor<64x512x12x512xi1>, %arg1: tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
    return %1 : tensor<64x512x12x512xbf16>
  }
  func.func private @_where_374(%arg0: tensor<64x512x768xi1>, %arg1: tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %1 : tensor<64x512x768xbf16>
  }
  func.func private @_take_375(%arg0: tensor<64x512x1xi32>, %arg1: tensor<64x512x768xbf16>) -> tensor<2x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1 = "stablehlo.scatter"(%0, %arg0, %arg1) <{indices_are_sorted = false, scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [2], inserted_window_dims = [0], scatter_dims_to_operand_dims = [0], index_vector_dim = 2>, unique_indices = false}> ({
    ^bb0(%arg2: tensor<bf16>, %arg3: tensor<bf16>):
      %2 = stablehlo.add %arg2, %arg3 : tensor<bf16>
      stablehlo.return %2 : tensor<bf16>
    }) : (tensor<2x768xbf16>, tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<2x768xbf16>
    return %1 : tensor<2x768xbf16>
  }
  func.func private @_take_379(%arg0: tensor<64x512x1xi32>, %arg1: tensor<64x512x768xbf16>) -> tensor<512x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1 = "stablehlo.scatter"(%0, %arg0, %arg1) <{indices_are_sorted = false, scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [2], inserted_window_dims = [0], scatter_dims_to_operand_dims = [0], index_vector_dim = 2>, unique_indices = false}> ({
    ^bb0(%arg2: tensor<bf16>, %arg3: tensor<bf16>):
      %2 = stablehlo.add %arg2, %arg3 : tensor<bf16>
      stablehlo.return %2 : tensor<bf16>
    }) : (tensor<512x768xbf16>, tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<512x768xbf16>
    return %1 : tensor<512x768xbf16>
  }
  func.func private @_take_382(%arg0: tensor<64x512x1xi32>, %arg1: tensor<64x512x768xbf16>) -> tensor<30522x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1 = "stablehlo.scatter"(%0, %arg0, %arg1) <{indices_are_sorted = false, scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [2], inserted_window_dims = [0], scatter_dims_to_operand_dims = [0], index_vector_dim = 2>, unique_indices = false}> ({
    ^bb0(%arg2: tensor<bf16>, %arg3: tensor<bf16>):
      %2 = stablehlo.add %arg2, %arg3 : tensor<bf16>
      stablehlo.return %2 : tensor<bf16>
    }) : (tensor<30522x768xbf16>, tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<30522x768xbf16>
    return %1 : tensor<30522x768xbf16>
  }
  func.func private @_where_501(%arg0: tensor<i1>, %arg1: tensor<i32>, %arg2: tensor<i32>) -> tensor<i32> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<i1>, tensor<i32>
    return %0 : tensor<i32>
  }
  func.func private @clip(%arg0: tensor<i32>, %arg1: tensor<i32>, %arg2: tensor<i32>) -> tensor<i32> {
    %0 = stablehlo.convert %arg1 : tensor<i32>
    %1 = stablehlo.maximum %0, %arg0 : tensor<i32>
    %2 = stablehlo.convert %arg2 : tensor<i32>
    %3 = stablehlo.minimum %2, %1 : tensor<i32>
    return %3 : tensor<i32>
  }
  func.func private @_where_559(%arg0: tensor<i1>, %arg1: tensor<f32>, %arg2: tensor<f32>) -> tensor<f32> {
    %0 = stablehlo.convert %arg2 : tensor<f32>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<i1>, tensor<f32>
    return %1 : tensor<f32>
  }
}
