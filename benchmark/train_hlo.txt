module @jit_train_step attributes {mhlo.num_partitions = 4 : i32, mhlo.num_replicas = 1 : i32} {
  sdy.mesh @mesh = <["dp"=4]>
  sdy.mesh @empty_mesh = <[]>
  func.func public @main(%arg0: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg1: tensor<512x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg2: tensor<2x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg3: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg4: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg5: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg6: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg7: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg8: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg9: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg10: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg11: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg12: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg13: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg14: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg15: tensor<12x3072x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg16: tensor<12x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg17: tensor<12x768x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg18: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg19: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg20: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg21: tensor<768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg22: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg23: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg24: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg25: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg26: tensor<30522xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg27: tensor<i32> {sdy.sharding = #sdy.sharding<@empty_mesh, []>}, %arg28: tensor<i32> {sdy.sharding = #sdy.sharding<@empty_mesh, []>}, %arg29: tensor<i32> {sdy.sharding = #sdy.sharding<@empty_mesh, []>}, %arg30: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg31: tensor<512x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg32: tensor<2x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg33: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg34: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg35: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg36: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg37: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg38: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg39: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg40: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg41: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg42: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg43: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg44: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg45: tensor<12x3072x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg46: tensor<12x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg47: tensor<12x768x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg48: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg49: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg50: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg51: tensor<768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg52: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg53: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg54: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg55: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg56: tensor<30522xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg57: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg58: tensor<512x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg59: tensor<2x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg60: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg61: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg62: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg63: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg64: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg65: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg66: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg67: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg68: tensor<12x768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg69: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg70: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg71: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg72: tensor<12x3072x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg73: tensor<12x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg74: tensor<12x768x3072xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}, {}]>}, %arg75: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg76: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg77: tensor<12x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg78: tensor<768x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg79: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg80: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg81: tensor<768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg82: tensor<30522x768xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}, {}]>}, %arg83: tensor<30522xbf16> {sdy.sharding = #sdy.sharding<@mesh, [{}]>}, %arg84: tensor<64x512xi32> {sdy.sharding = #sdy.sharding<@mesh, [{"dp"}, {}]>}, %arg85: tensor<64x512xi32> {sdy.sharding = #sdy.sharding<@mesh, [{"dp"}, {}]>}, %arg86: tensor<64x512xi32> {sdy.sharding = #sdy.sharding<@mesh, [{"dp"}, {}]>}, %arg87: tensor<64x512xi32> {sdy.sharding = #sdy.sharding<@mesh, [{"dp"}, {}]>}, %arg88: tensor<2xui32>) -> (tensor<i32> {jax.result_info = "result[0]"}, tensor<30522x768xbf16> {jax.result_info = "result[1][0].bert.embeddings.word_embeddings.weight"}, tensor<512x768xbf16> {jax.result_info = "result[1][0].bert.embeddings.position_embeddings.weight"}, tensor<2x768xbf16> {jax.result_info = "result[1][0].bert.embeddings.token_type_embeddings.weight"}, tensor<768xbf16> {jax.result_info = "result[1][0].bert.embeddings.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][0].bert.embeddings.layer_norm.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.query.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.query.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.key.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.key.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.value.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.self_attention.value.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.attention.output.layer_norm.bias"}, tensor<12x3072x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.intermediate.dense.weight"}, tensor<12x3072xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.intermediate.dense.bias"}, tensor<12x768x3072xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][0].bert.encoder.layers.output.layer_norm.bias"}, tensor<768x768xbf16> {jax.result_info = "result[1][0].mlm_head.dense.weight"}, tensor<768xbf16> {jax.result_info = "result[1][0].mlm_head.dense.bias"}, tensor<768xbf16> {jax.result_info = "result[1][0].mlm_head.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][0].mlm_head.layer_norm.bias"}, tensor<30522x768xbf16> {jax.result_info = "result[1][0].mlm_head.lm_head.pytree[0].weight"}, tensor<30522xbf16> {jax.result_info = "result[1][0].mlm_head.bias"}, tensor<i32> {jax.result_info = "result[1][1].opt_state.count"}, tensor<bf16> {jax.result_info = "result[1][1].opt_state.hyperparams['learning_rate']"}, tensor<i32> {jax.result_info = "result[1][1].opt_state.hyperparams_states['learning_rate'].count"}, tensor<i32> {jax.result_info = "result[1][1].opt_state.inner_state[1].count"}, tensor<30522x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.embeddings.word_embeddings.weight"}, tensor<512x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.embeddings.position_embeddings.weight"}, tensor<2x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.embeddings.token_type_embeddings.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.embeddings.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.embeddings.layer_norm.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.self_attention.query.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.self_attention.query.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.self_attention.key.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.self_attention.key.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.self_attention.value.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.self_attention.value.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.attention.output.layer_norm.bias"}, tensor<12x3072x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.intermediate.dense.weight"}, tensor<12x3072xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.intermediate.dense.bias"}, tensor<12x768x3072xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.bert.encoder.layers.output.layer_norm.bias"}, tensor<768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.mlm_head.dense.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.mlm_head.dense.bias"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.mlm_head.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.mlm_head.layer_norm.bias"}, tensor<30522x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.mlm_head.lm_head.pytree[0].weight"}, tensor<30522xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].mu.mlm_head.bias"}, tensor<30522x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.embeddings.word_embeddings.weight"}, tensor<512x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.embeddings.position_embeddings.weight"}, tensor<2x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.embeddings.token_type_embeddings.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.embeddings.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.embeddings.layer_norm.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.self_attention.query.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.self_attention.query.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.self_attention.key.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.self_attention.key.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.self_attention.value.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.self_attention.value.bias"}, tensor<12x768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.attention.output.layer_norm.bias"}, tensor<12x3072x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.intermediate.dense.weight"}, tensor<12x3072xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.intermediate.dense.bias"}, tensor<12x768x3072xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.output.dense.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.output.dense.bias"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.output.layer_norm.weight"}, tensor<12x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.bert.encoder.layers.output.layer_norm.bias"}, tensor<768x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.mlm_head.dense.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.mlm_head.dense.bias"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.mlm_head.layer_norm.weight"}, tensor<768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.mlm_head.layer_norm.bias"}, tensor<30522x768xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.mlm_head.lm_head.pytree[0].weight"}, tensor<30522xbf16> {jax.result_info = "result[1][1].opt_state.inner_state[1].nu.mlm_head.bias"}, tensor<i32> {jax.result_info = "result[1][2]['acc'][0]"}, tensor<i32> {jax.result_info = "result[1][2]['acc'][1]"}, tensor<f32> {jax.result_info = "result[1][2]['loss'][0]"}, tensor<i32> {jax.result_info = "result[1][2]['loss'][1]"}, tensor<i32> {jax.result_info = "result[1][2]['total_token']"}) {
    %0 = call @_threefry_split(%arg88) : (tensor<2xui32>) -> tensor<2x2xui32>
    %1 = stablehlo.slice %0 [1:2, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %2 = stablehlo.reshape %1 : (tensor<1x2xui32>) -> tensor<2xui32>
    %3 = stablehlo.iota dim = 0 : tensor<512xi32>
    %4 = stablehlo.broadcast_in_dim %3, dims = [1] : (tensor<512xi32>) -> tensor<1x512xi32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<1x512xi32>) -> tensor<64x512xi32>
    %6 = call @_threefry_split(%2) : (tensor<2xui32>) -> tensor<2x2xui32>
    %7 = stablehlo.slice %6 [0:1, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %8 = stablehlo.reshape %7 : (tensor<1x2xui32>) -> tensor<2xui32>
    %9 = call @_threefry_split(%8) : (tensor<2xui32>) -> tensor<2x2xui32>
    %10 = stablehlo.slice %9 [0:1, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %11 = stablehlo.reshape %10 : (tensor<1x2xui32>) -> tensor<2xui32>
    %12 = stablehlo.slice %9 [1:2, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %13 = stablehlo.reshape %12 : (tensor<1x2xui32>) -> tensor<2xui32>
    %14:2 = call @_take(%arg0, %arg84) : (tensor<30522x768xbf16>, tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>)
    %15:2 = call @_take_15(%arg1, %5) : (tensor<512x768xbf16>, tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>)
    %16 = stablehlo.add %14#0, %15#0 : tensor<64x512x768xbf16>
    %17:2 = call @_take_29(%arg2, %arg86) : (tensor<2x768xbf16>, tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>)
    %18 = stablehlo.add %16, %17#0 : tensor<64x512x768xbf16>
    %19 = stablehlo.convert %18 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %20 = stablehlo.reduce(%19 init: %cst) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %21 = stablehlo.broadcast_in_dim %20, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_0 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %22 = stablehlo.broadcast_in_dim %cst_0, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %23 = stablehlo.divide %21, %22 : tensor<64x512x1xf32>
    %24 = stablehlo.broadcast_in_dim %23, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %25 = stablehlo.subtract %19, %24 : tensor<64x512x768xf32>
    %26 = stablehlo.multiply %19, %19 : tensor<64x512x768xf32>
    %cst_1 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %27 = stablehlo.broadcast_in_dim %cst_1, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %28 = stablehlo.multiply %27, %19 : tensor<64x512x768xf32>
    %cst_2 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %29 = stablehlo.reduce(%26 init: %cst_2) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %30 = stablehlo.broadcast_in_dim %29, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_3 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %31 = stablehlo.broadcast_in_dim %cst_3, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %32 = stablehlo.divide %30, %31 : tensor<64x512x1xf32>
    %33 = stablehlo.multiply %23, %23 : tensor<64x512x1xf32>
    %cst_4 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %34 = stablehlo.broadcast_in_dim %cst_4, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %35 = stablehlo.multiply %34, %23 : tensor<64x512x1xf32>
    %36 = stablehlo.subtract %32, %33 : tensor<64x512x1xf32>
    %cst_5 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %37 = stablehlo.broadcast_in_dim %cst_5, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %38 = stablehlo.maximum %37, %36 : tensor<64x512x1xf32>
    %39 = stablehlo.compare  EQ, %36, %38,  FLOAT : (tensor<64x512x1xf32>, tensor<64x512x1xf32>) -> tensor<64x512x1xi1>
    %cst_6 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %40 = stablehlo.broadcast_in_dim %cst_6, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_7 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %41 = stablehlo.broadcast_in_dim %cst_7, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %42 = stablehlo.select %39, %40, %41 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    %cst_8 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %43 = stablehlo.broadcast_in_dim %cst_8, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %44 = stablehlo.compare  EQ, %43, %38,  FLOAT : (tensor<64x512x1xf32>, tensor<64x512x1xf32>) -> tensor<64x512x1xi1>
    %cst_9 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %45 = stablehlo.broadcast_in_dim %cst_9, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_10 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %46 = stablehlo.broadcast_in_dim %cst_10, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %47 = stablehlo.select %44, %45, %46 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    %48 = stablehlo.divide %42, %47 : tensor<64x512x1xf32>
    %cst_11 = stablehlo.constant dense<9.99999996E-13> : tensor<f32>
    %49 = stablehlo.broadcast_in_dim %cst_11, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %50 = stablehlo.add %38, %49 : tensor<64x512x1xf32>
    %51 = stablehlo.rsqrt %50 : tensor<64x512x1xf32>
    %52 = stablehlo.divide %51, %50 : tensor<64x512x1xf32>
    %cst_12 = stablehlo.constant dense<-5.000000e-01> : tensor<f32>
    %53 = stablehlo.broadcast_in_dim %cst_12, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %54 = stablehlo.multiply %53, %52 : tensor<64x512x1xf32>
    %55 = stablehlo.broadcast_in_dim %51, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %56 = stablehlo.multiply %25, %55 : tensor<64x512x768xf32>
    %57 = stablehlo.convert %arg3 : (tensor<768xbf16>) -> tensor<768xf32>
    %58 = stablehlo.broadcast_in_dim %57, dims = [2] : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %59 = stablehlo.broadcast_in_dim %58, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %60 = stablehlo.multiply %59, %56 : tensor<64x512x768xf32>
    %61 = stablehlo.convert %arg4 : (tensor<768xbf16>) -> tensor<768xf32>
    %62 = stablehlo.broadcast_in_dim %61, dims = [2] : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %63 = stablehlo.broadcast_in_dim %62, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %64 = stablehlo.add %60, %63 : tensor<64x512x768xf32>
    %65 = stablehlo.convert %64 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %cst_13 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %66 = call @_bernoulli(%11, %cst_13) : (tensor<2xui32>, tensor<f32>) -> tensor<64x512x768xi1>
    %cst_14 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %67 = stablehlo.broadcast_in_dim %cst_14, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %68 = stablehlo.divide %65, %67 : tensor<64x512x768xbf16>
    %c = stablehlo.constant dense<0> : tensor<i32>
    %69 = call @_where_65(%66, %68, %c) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>, tensor<i32>) -> tensor<64x512x768xbf16>
    %c_15 = stablehlo.constant dense<true> : tensor<i1>
    %70 = stablehlo.broadcast_in_dim %c_15, dims = [] : (tensor<i1>) -> tensor<512xi1>
    %71 = stablehlo.broadcast_in_dim %70, dims = [1] : (tensor<512xi1>) -> tensor<512x512xi1>
    %72 = stablehlo.broadcast_in_dim %71, dims = [1, 2] : (tensor<512x512xi1>) -> tensor<64x512x512xi1>
    %73 = stablehlo.broadcast_in_dim %arg85, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %74 = stablehlo.convert %72 : (tensor<64x512x512xi1>) -> tensor<64x512x512xi32>
    %75 = stablehlo.broadcast_in_dim %73, dims = [0, 1, 2] : (tensor<64x512x1xi32>) -> tensor<64x512x512xi32>
    %76 = stablehlo.and %74, %75 : tensor<64x512x512xi32>
    %77 = call @_threefry_split_75(%13) : (tensor<2xui32>) -> tensor<12x2xui32>
    %cst_16 = stablehlo.constant dense<6.400000e+01> : tensor<f32>
    %78 = stablehlo.sqrt %cst_16 : tensor<f32>
    %79 = stablehlo.convert %78 : (tensor<f32>) -> tensor<bf16>
    %80 = stablehlo.broadcast_in_dim %76, dims = [0, 1, 3] : (tensor<64x512x512xi32>) -> tensor<64x512x1x512xi32>
    %cst_17 = stablehlo.constant dense<-3.389530e+38> : tensor<bf16>
    %81:2 = call @_where_89(%80, %cst_17) : (tensor<64x512x1x512xi32>, tensor<bf16>) -> (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>)
    %82:2 = call @_bernoulli_93() : () -> (tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>)
    %c_18 = stablehlo.constant dense<0> : tensor<i32>
    %83 = call @_where_97(%c_18) : (tensor<i32>) -> tensor<64x512x12x512xbf16>
    %84:2 = call @_bernoulli_99() : () -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>)
    %c_19 = stablehlo.constant dense<0> : tensor<i32>
    %85 = call @_where_101(%c_19) : (tensor<i32>) -> tensor<64x512x768xbf16>
    %cst_20 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %86 = stablehlo.broadcast_in_dim %cst_20, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_21 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %87 = stablehlo.broadcast_in_dim %cst_21, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_22 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %88 = stablehlo.broadcast_in_dim %cst_22, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_23 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %89 = stablehlo.broadcast_in_dim %cst_23, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_24 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %90 = stablehlo.broadcast_in_dim %cst_24, dims = [] : (tensor<bf16>) -> tensor<bf16>
    %91:2 = call @_bernoulli_99() : () -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>)
    %c_25 = stablehlo.constant dense<0> : tensor<i32>
    %92 = call @_where_101(%c_25) : (tensor<i32>) -> tensor<64x512x768xbf16>
    %cst_26 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %93 = stablehlo.broadcast_in_dim %cst_26, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_27 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %94 = stablehlo.broadcast_in_dim %cst_27, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_28 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %95 = stablehlo.broadcast_in_dim %cst_28, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_29 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %96 = stablehlo.broadcast_in_dim %cst_29, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_30 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %cst_31 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %cst_32 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %cst_33 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %97 = stablehlo.broadcast_in_dim %cst_33, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_34 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %98 = stablehlo.broadcast_in_dim %cst_34, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %cst_35 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %99 = stablehlo.broadcast_in_dim %cst_35, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_36 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %100 = stablehlo.broadcast_in_dim %cst_36, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_37 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %101 = stablehlo.broadcast_in_dim %cst_37, dims = [] : (tensor<bf16>) -> tensor<12x64x512x12x64xbf16>
    %cst_38 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %102 = stablehlo.broadcast_in_dim %cst_38, dims = [] : (tensor<bf16>) -> tensor<12x64x512x12x64xbf16>
    %cst_39 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %103 = stablehlo.broadcast_in_dim %cst_39, dims = [] : (tensor<f32>) -> tensor<12x64x512x12x512xf32>
    %cst_40 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %104 = stablehlo.broadcast_in_dim %cst_40, dims = [] : (tensor<f32>) -> tensor<12x64x512x12x1xf32>
    %cst_41 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %105 = stablehlo.broadcast_in_dim %cst_41, dims = [] : (tensor<f32>) -> tensor<12x64x512x12x1xf32>
    %c_42 = stablehlo.constant dense<false> : tensor<i1>
    %106 = stablehlo.broadcast_in_dim %c_42, dims = [] : (tensor<i1>) -> tensor<12x64x512x12x512xi1>
    %cst_43 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %107 = stablehlo.broadcast_in_dim %cst_43, dims = [] : (tensor<bf16>) -> tensor<12x64x512x12x512xbf16>
    %cst_44 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %108 = stablehlo.broadcast_in_dim %cst_44, dims = [] : (tensor<bf16>) -> tensor<12x64x512x12x64xbf16>
    %cst_45 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %109 = stablehlo.broadcast_in_dim %cst_45, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_46 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %110 = stablehlo.broadcast_in_dim %cst_46, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %c_47 = stablehlo.constant dense<false> : tensor<i1>
    %111 = stablehlo.broadcast_in_dim %c_47, dims = [] : (tensor<i1>) -> tensor<12x64x512x768xi1>
    %cst_48 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %112 = stablehlo.broadcast_in_dim %cst_48, dims = [] : (tensor<f32>) -> tensor<12x64x512x768xf32>
    %cst_49 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %113 = stablehlo.broadcast_in_dim %cst_49, dims = [] : (tensor<f32>) -> tensor<12x64x512x1xf32>
    %cst_50 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %114 = stablehlo.broadcast_in_dim %cst_50, dims = [] : (tensor<f32>) -> tensor<12x64x512x1xf32>
    %cst_51 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %115 = stablehlo.broadcast_in_dim %cst_51, dims = [] : (tensor<f32>) -> tensor<12x64x512x1xf32>
    %cst_52 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %116 = stablehlo.broadcast_in_dim %cst_52, dims = [] : (tensor<f32>) -> tensor<12x64x512x1xf32>
    %cst_53 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %117 = stablehlo.broadcast_in_dim %cst_53, dims = [] : (tensor<f32>) -> tensor<12x64x512x768xf32>
    %cst_54 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %118 = stablehlo.broadcast_in_dim %cst_54, dims = [] : (tensor<f32>) -> tensor<12x64x512x768xf32>
    %cst_55 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %119 = stablehlo.broadcast_in_dim %cst_55, dims = [] : (tensor<f32>) -> tensor<12x1x1x768xf32>
    %cst_56 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %120 = stablehlo.broadcast_in_dim %cst_56, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %cst_57 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %121 = stablehlo.broadcast_in_dim %cst_57, dims = [] : (tensor<bf16>) -> tensor<12x64x512x768xbf16>
    %cst_58 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %122 = stablehlo.broadcast_in_dim %cst_58, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_59 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %123 = stablehlo.broadcast_in_dim %cst_59, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_60 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %124 = stablehlo.broadcast_in_dim %cst_60, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_61 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %125 = stablehlo.broadcast_in_dim %cst_61, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_62 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %126 = stablehlo.broadcast_in_dim %cst_62, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %cst_63 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %127 = stablehlo.broadcast_in_dim %cst_63, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %cst_64 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %128 = stablehlo.broadcast_in_dim %cst_64, dims = [] : (tensor<bf16>) -> tensor<12x64x512x3072xbf16>
    %c_65 = stablehlo.constant dense<false> : tensor<i1>
    %129 = stablehlo.broadcast_in_dim %c_65, dims = [] : (tensor<i1>) -> tensor<12x64x512x768xi1>
    %cst_66 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %130 = stablehlo.broadcast_in_dim %cst_66, dims = [] : (tensor<f32>) -> tensor<12x64x512x768xf32>
    %cst_67 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %131 = stablehlo.broadcast_in_dim %cst_67, dims = [] : (tensor<f32>) -> tensor<12x64x512x1xf32>
    %cst_68 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %132 = stablehlo.broadcast_in_dim %cst_68, dims = [] : (tensor<f32>) -> tensor<12x64x512x1xf32>
    %cst_69 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %133 = stablehlo.broadcast_in_dim %cst_69, dims = [] : (tensor<f32>) -> tensor<12x64x512x1xf32>
    %cst_70 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %134 = stablehlo.broadcast_in_dim %cst_70, dims = [] : (tensor<f32>) -> tensor<12x64x512x1xf32>
    %cst_71 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %135 = stablehlo.broadcast_in_dim %cst_71, dims = [] : (tensor<f32>) -> tensor<12x64x512x768xf32>
    %cst_72 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %136 = stablehlo.broadcast_in_dim %cst_72, dims = [] : (tensor<f32>) -> tensor<12x64x512x768xf32>
    %cst_73 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %137 = stablehlo.broadcast_in_dim %cst_73, dims = [] : (tensor<f32>) -> tensor<12x1x1x768xf32>
    %c_74 = stablehlo.constant dense<0> : tensor<i32>
    %138:84 = stablehlo.while(%iterArg = %arg5, %iterArg_417 = %arg6, %iterArg_418 = %arg7, %iterArg_419 = %arg8, %iterArg_420 = %arg9, %iterArg_421 = %arg10, %iterArg_422 = %arg11, %iterArg_423 = %arg12, %iterArg_424 = %arg13, %iterArg_425 = %arg14, %iterArg_426 = %arg15, %iterArg_427 = %arg16, %iterArg_428 = %arg17, %iterArg_429 = %arg18, %iterArg_430 = %arg19, %iterArg_431 = %arg20, %iterArg_432 = %77, %iterArg_433 = %91#0, %iterArg_434 = %91#1, %iterArg_435 = %cst_30, %iterArg_436 = %84#0, %iterArg_437 = %84#1, %iterArg_438 = %cst_31, %iterArg_439 = %82#0, %iterArg_440 = %82#1, %iterArg_441 = %cst_32, %iterArg_442 = %79, %iterArg_443 = %81#0, %iterArg_444 = %81#1, %iterArg_445 = %83, %iterArg_446 = %85, %iterArg_447 = %92, %iterArg_448 = %87, %iterArg_449 = %86, %iterArg_450 = %89, %iterArg_451 = %88, %iterArg_452 = %90, %iterArg_453 = %94, %iterArg_454 = %93, %iterArg_455 = %96, %iterArg_456 = %95, %iterArg_457 = %c_74, %iterArg_458 = %69, %iterArg_459 = %97, %iterArg_460 = %98, %iterArg_461 = %99, %iterArg_462 = %100, %iterArg_463 = %101, %iterArg_464 = %102, %iterArg_465 = %103, %iterArg_466 = %104, %iterArg_467 = %105, %iterArg_468 = %106, %iterArg_469 = %107, %iterArg_470 = %108, %iterArg_471 = %109, %iterArg_472 = %110, %iterArg_473 = %111, %iterArg_474 = %112, %iterArg_475 = %113, %iterArg_476 = %114, %iterArg_477 = %115, %iterArg_478 = %116, %iterArg_479 = %117, %iterArg_480 = %118, %iterArg_481 = %119, %iterArg_482 = %120, %iterArg_483 = %121, %iterArg_484 = %122, %iterArg_485 = %123, %iterArg_486 = %124, %iterArg_487 = %125, %iterArg_488 = %126, %iterArg_489 = %127, %iterArg_490 = %128, %iterArg_491 = %129, %iterArg_492 = %130, %iterArg_493 = %131, %iterArg_494 = %132, %iterArg_495 = %133, %iterArg_496 = %134, %iterArg_497 = %135, %iterArg_498 = %136, %iterArg_499 = %137) : tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>, tensor<f32>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x512xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<bf16>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<i32>, tensor<64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x512xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x512xi1>, tensor<12x64x512x12x512xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x768xf32>, tensor<12x64x512x768xf32>, tensor<12x1x1x768xf32>, tensor<12x768x3072xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x3072x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x768xf32>, tensor<12x64x512x768xf32>, tensor<12x1x1x768xf32>
    cond {
      %c_500 = stablehlo.constant dense<12> : tensor<i32>
      %1457 = stablehlo.compare  LT, %iterArg_457, %c_500,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
      stablehlo.return %1457 : tensor<i1>
    } do {
      %c_500 = stablehlo.constant dense<0> : tensor<i32>
      %c_501 = stablehlo.constant dense<0> : tensor<i32>
      %1457 = stablehlo.dynamic_slice %iterArg, %iterArg_457, %c_500, %c_501, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1458 = stablehlo.reshape %1457 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_502 = stablehlo.constant dense<0> : tensor<i32>
      %1459 = stablehlo.dynamic_slice %iterArg_417, %iterArg_457, %c_502, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1460 = stablehlo.reshape %1459 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_503 = stablehlo.constant dense<0> : tensor<i32>
      %c_504 = stablehlo.constant dense<0> : tensor<i32>
      %1461 = stablehlo.dynamic_slice %iterArg_418, %iterArg_457, %c_503, %c_504, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1462 = stablehlo.reshape %1461 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_505 = stablehlo.constant dense<0> : tensor<i32>
      %1463 = stablehlo.dynamic_slice %iterArg_419, %iterArg_457, %c_505, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1464 = stablehlo.reshape %1463 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_506 = stablehlo.constant dense<0> : tensor<i32>
      %c_507 = stablehlo.constant dense<0> : tensor<i32>
      %1465 = stablehlo.dynamic_slice %iterArg_420, %iterArg_457, %c_506, %c_507, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1466 = stablehlo.reshape %1465 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_508 = stablehlo.constant dense<0> : tensor<i32>
      %1467 = stablehlo.dynamic_slice %iterArg_421, %iterArg_457, %c_508, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1468 = stablehlo.reshape %1467 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_509 = stablehlo.constant dense<0> : tensor<i32>
      %c_510 = stablehlo.constant dense<0> : tensor<i32>
      %1469 = stablehlo.dynamic_slice %iterArg_422, %iterArg_457, %c_509, %c_510, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1470 = stablehlo.reshape %1469 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_511 = stablehlo.constant dense<0> : tensor<i32>
      %1471 = stablehlo.dynamic_slice %iterArg_423, %iterArg_457, %c_511, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1472 = stablehlo.reshape %1471 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_512 = stablehlo.constant dense<0> : tensor<i32>
      %1473 = stablehlo.dynamic_slice %iterArg_424, %iterArg_457, %c_512, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1474 = stablehlo.reshape %1473 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_513 = stablehlo.constant dense<0> : tensor<i32>
      %1475 = stablehlo.dynamic_slice %iterArg_425, %iterArg_457, %c_513, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1476 = stablehlo.reshape %1475 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_514 = stablehlo.constant dense<0> : tensor<i32>
      %c_515 = stablehlo.constant dense<0> : tensor<i32>
      %1477 = stablehlo.dynamic_slice %iterArg_426, %iterArg_457, %c_514, %c_515, sizes = [1, 3072, 768] : (tensor<12x3072x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x3072x768xbf16>
      %1478 = stablehlo.reshape %1477 : (tensor<1x3072x768xbf16>) -> tensor<3072x768xbf16>
      %c_516 = stablehlo.constant dense<0> : tensor<i32>
      %1479 = stablehlo.dynamic_slice %iterArg_427, %iterArg_457, %c_516, sizes = [1, 3072] : (tensor<12x3072xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x3072xbf16>
      %1480 = stablehlo.reshape %1479 : (tensor<1x3072xbf16>) -> tensor<3072xbf16>
      %c_517 = stablehlo.constant dense<0> : tensor<i32>
      %c_518 = stablehlo.constant dense<0> : tensor<i32>
      %1481 = stablehlo.dynamic_slice %iterArg_428, %iterArg_457, %c_517, %c_518, sizes = [1, 768, 3072] : (tensor<12x768x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x3072xbf16>
      %1482 = stablehlo.reshape %1481 : (tensor<1x768x3072xbf16>) -> tensor<768x3072xbf16>
      %c_519 = stablehlo.constant dense<0> : tensor<i32>
      %1483 = stablehlo.dynamic_slice %iterArg_429, %iterArg_457, %c_519, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1484 = stablehlo.reshape %1483 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_520 = stablehlo.constant dense<0> : tensor<i32>
      %1485 = stablehlo.dynamic_slice %iterArg_430, %iterArg_457, %c_520, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1486 = stablehlo.reshape %1485 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_521 = stablehlo.constant dense<0> : tensor<i32>
      %1487 = stablehlo.dynamic_slice %iterArg_431, %iterArg_457, %c_521, sizes = [1, 768] : (tensor<12x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<1x768xbf16>
      %1488 = stablehlo.reshape %1487 : (tensor<1x768xbf16>) -> tensor<768xbf16>
      %c_522 = stablehlo.constant dense<0> : tensor<i32>
      %1489 = stablehlo.dynamic_slice %iterArg_432, %iterArg_457, %c_522, sizes = [1, 2] : (tensor<12x2xui32>, tensor<i32>, tensor<i32>) -> tensor<1x2xui32>
      %1490 = stablehlo.reshape %1489 : (tensor<1x2xui32>) -> tensor<2xui32>
      %1491:42 = func.call @closed_call(%iterArg_433, %iterArg_434, %iterArg_435, %iterArg_436, %iterArg_437, %iterArg_438, %iterArg_439, %iterArg_440, %iterArg_441, %iterArg_442, %iterArg_443, %iterArg_444, %iterArg_445, %iterArg_446, %iterArg_447, %iterArg_448, %iterArg_449, %iterArg_450, %iterArg_451, %iterArg_452, %iterArg_453, %iterArg_454, %iterArg_455, %iterArg_456, %iterArg_458, %1458, %1460, %1462, %1464, %1466, %1468, %1470, %1472, %1474, %1476, %1478, %1480, %1482, %1484, %1486, %1488, %1490) : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>, tensor<f32>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x512xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<bf16>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<3072x768xbf16>, tensor<3072xbf16>, tensor<768x3072xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<2xui32>) -> (tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768x768xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x512xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x64xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x768xf32>, tensor<64x512x768xf32>, tensor<1x1x768xf32>, tensor<768x3072xbf16>, tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<3072x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x768xf32>, tensor<64x512x768xf32>, tensor<1x1x768xf32>)
      %1492 = stablehlo.broadcast_in_dim %1491#1, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_523 = stablehlo.constant dense<0> : tensor<i32>
      %c_524 = stablehlo.constant dense<0> : tensor<i32>
      %1493 = stablehlo.dynamic_update_slice %iterArg_459, %1492, %iterArg_457, %c_523, %c_524 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1494 = stablehlo.broadcast_in_dim %1491#2, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_525 = stablehlo.constant dense<0> : tensor<i32>
      %c_526 = stablehlo.constant dense<0> : tensor<i32>
      %c_527 = stablehlo.constant dense<0> : tensor<i32>
      %1495 = stablehlo.dynamic_update_slice %iterArg_460, %1494, %iterArg_457, %c_525, %c_526, %c_527 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1496 = stablehlo.broadcast_in_dim %1491#3, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_528 = stablehlo.constant dense<0> : tensor<i32>
      %c_529 = stablehlo.constant dense<0> : tensor<i32>
      %1497 = stablehlo.dynamic_update_slice %iterArg_461, %1496, %iterArg_457, %c_528, %c_529 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1498 = stablehlo.broadcast_in_dim %1491#4, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_530 = stablehlo.constant dense<0> : tensor<i32>
      %c_531 = stablehlo.constant dense<0> : tensor<i32>
      %1499 = stablehlo.dynamic_update_slice %iterArg_462, %1498, %iterArg_457, %c_530, %c_531 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1500 = stablehlo.broadcast_in_dim %1491#5, dims = [1, 2, 3, 4] : (tensor<64x512x12x64xbf16>) -> tensor<1x64x512x12x64xbf16>
      %c_532 = stablehlo.constant dense<0> : tensor<i32>
      %c_533 = stablehlo.constant dense<0> : tensor<i32>
      %c_534 = stablehlo.constant dense<0> : tensor<i32>
      %c_535 = stablehlo.constant dense<0> : tensor<i32>
      %1501 = stablehlo.dynamic_update_slice %iterArg_463, %1500, %iterArg_457, %c_532, %c_533, %c_534, %c_535 : (tensor<12x64x512x12x64xbf16>, tensor<1x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x64xbf16>
      %1502 = stablehlo.broadcast_in_dim %1491#6, dims = [1, 2, 3, 4] : (tensor<64x512x12x64xbf16>) -> tensor<1x64x512x12x64xbf16>
      %c_536 = stablehlo.constant dense<0> : tensor<i32>
      %c_537 = stablehlo.constant dense<0> : tensor<i32>
      %c_538 = stablehlo.constant dense<0> : tensor<i32>
      %c_539 = stablehlo.constant dense<0> : tensor<i32>
      %1503 = stablehlo.dynamic_update_slice %iterArg_464, %1502, %iterArg_457, %c_536, %c_537, %c_538, %c_539 : (tensor<12x64x512x12x64xbf16>, tensor<1x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x64xbf16>
      %1504 = stablehlo.broadcast_in_dim %1491#7, dims = [1, 2, 3, 4] : (tensor<64x512x12x512xf32>) -> tensor<1x64x512x12x512xf32>
      %c_540 = stablehlo.constant dense<0> : tensor<i32>
      %c_541 = stablehlo.constant dense<0> : tensor<i32>
      %c_542 = stablehlo.constant dense<0> : tensor<i32>
      %c_543 = stablehlo.constant dense<0> : tensor<i32>
      %1505 = stablehlo.dynamic_update_slice %iterArg_465, %1504, %iterArg_457, %c_540, %c_541, %c_542, %c_543 : (tensor<12x64x512x12x512xf32>, tensor<1x64x512x12x512xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x512xf32>
      %1506 = stablehlo.broadcast_in_dim %1491#8, dims = [1, 2, 3, 4] : (tensor<64x512x12x1xf32>) -> tensor<1x64x512x12x1xf32>
      %c_544 = stablehlo.constant dense<0> : tensor<i32>
      %c_545 = stablehlo.constant dense<0> : tensor<i32>
      %c_546 = stablehlo.constant dense<0> : tensor<i32>
      %c_547 = stablehlo.constant dense<0> : tensor<i32>
      %1507 = stablehlo.dynamic_update_slice %iterArg_466, %1506, %iterArg_457, %c_544, %c_545, %c_546, %c_547 : (tensor<12x64x512x12x1xf32>, tensor<1x64x512x12x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x1xf32>
      %1508 = stablehlo.broadcast_in_dim %1491#9, dims = [1, 2, 3, 4] : (tensor<64x512x12x1xf32>) -> tensor<1x64x512x12x1xf32>
      %c_548 = stablehlo.constant dense<0> : tensor<i32>
      %c_549 = stablehlo.constant dense<0> : tensor<i32>
      %c_550 = stablehlo.constant dense<0> : tensor<i32>
      %c_551 = stablehlo.constant dense<0> : tensor<i32>
      %1509 = stablehlo.dynamic_update_slice %iterArg_467, %1508, %iterArg_457, %c_548, %c_549, %c_550, %c_551 : (tensor<12x64x512x12x1xf32>, tensor<1x64x512x12x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x1xf32>
      %1510 = stablehlo.broadcast_in_dim %1491#10, dims = [1, 2, 3, 4] : (tensor<64x512x12x512xi1>) -> tensor<1x64x512x12x512xi1>
      %c_552 = stablehlo.constant dense<0> : tensor<i32>
      %c_553 = stablehlo.constant dense<0> : tensor<i32>
      %c_554 = stablehlo.constant dense<0> : tensor<i32>
      %c_555 = stablehlo.constant dense<0> : tensor<i32>
      %1511 = stablehlo.dynamic_update_slice %iterArg_468, %1510, %iterArg_457, %c_552, %c_553, %c_554, %c_555 : (tensor<12x64x512x12x512xi1>, tensor<1x64x512x12x512xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x512xi1>
      %1512 = stablehlo.broadcast_in_dim %1491#11, dims = [1, 2, 3, 4] : (tensor<64x512x12x512xbf16>) -> tensor<1x64x512x12x512xbf16>
      %c_556 = stablehlo.constant dense<0> : tensor<i32>
      %c_557 = stablehlo.constant dense<0> : tensor<i32>
      %c_558 = stablehlo.constant dense<0> : tensor<i32>
      %c_559 = stablehlo.constant dense<0> : tensor<i32>
      %1513 = stablehlo.dynamic_update_slice %iterArg_469, %1512, %iterArg_457, %c_556, %c_557, %c_558, %c_559 : (tensor<12x64x512x12x512xbf16>, tensor<1x64x512x12x512xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x512xbf16>
      %1514 = stablehlo.broadcast_in_dim %1491#12, dims = [1, 2, 3, 4] : (tensor<64x512x12x64xbf16>) -> tensor<1x64x512x12x64xbf16>
      %c_560 = stablehlo.constant dense<0> : tensor<i32>
      %c_561 = stablehlo.constant dense<0> : tensor<i32>
      %c_562 = stablehlo.constant dense<0> : tensor<i32>
      %c_563 = stablehlo.constant dense<0> : tensor<i32>
      %1515 = stablehlo.dynamic_update_slice %iterArg_470, %1514, %iterArg_457, %c_560, %c_561, %c_562, %c_563 : (tensor<12x64x512x12x64xbf16>, tensor<1x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x12x64xbf16>
      %1516 = stablehlo.broadcast_in_dim %1491#13, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_564 = stablehlo.constant dense<0> : tensor<i32>
      %c_565 = stablehlo.constant dense<0> : tensor<i32>
      %1517 = stablehlo.dynamic_update_slice %iterArg_471, %1516, %iterArg_457, %c_564, %c_565 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1518 = stablehlo.broadcast_in_dim %1491#14, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_566 = stablehlo.constant dense<0> : tensor<i32>
      %c_567 = stablehlo.constant dense<0> : tensor<i32>
      %c_568 = stablehlo.constant dense<0> : tensor<i32>
      %1519 = stablehlo.dynamic_update_slice %iterArg_472, %1518, %iterArg_457, %c_566, %c_567, %c_568 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1520 = stablehlo.broadcast_in_dim %1491#15, dims = [1, 2, 3] : (tensor<64x512x768xi1>) -> tensor<1x64x512x768xi1>
      %c_569 = stablehlo.constant dense<0> : tensor<i32>
      %c_570 = stablehlo.constant dense<0> : tensor<i32>
      %c_571 = stablehlo.constant dense<0> : tensor<i32>
      %1521 = stablehlo.dynamic_update_slice %iterArg_473, %1520, %iterArg_457, %c_569, %c_570, %c_571 : (tensor<12x64x512x768xi1>, tensor<1x64x512x768xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xi1>
      %1522 = stablehlo.broadcast_in_dim %1491#16, dims = [1, 2, 3] : (tensor<64x512x768xf32>) -> tensor<1x64x512x768xf32>
      %c_572 = stablehlo.constant dense<0> : tensor<i32>
      %c_573 = stablehlo.constant dense<0> : tensor<i32>
      %c_574 = stablehlo.constant dense<0> : tensor<i32>
      %1523 = stablehlo.dynamic_update_slice %iterArg_474, %1522, %iterArg_457, %c_572, %c_573, %c_574 : (tensor<12x64x512x768xf32>, tensor<1x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xf32>
      %1524 = stablehlo.broadcast_in_dim %1491#17, dims = [1, 2, 3] : (tensor<64x512x1xf32>) -> tensor<1x64x512x1xf32>
      %c_575 = stablehlo.constant dense<0> : tensor<i32>
      %c_576 = stablehlo.constant dense<0> : tensor<i32>
      %c_577 = stablehlo.constant dense<0> : tensor<i32>
      %1525 = stablehlo.dynamic_update_slice %iterArg_475, %1524, %iterArg_457, %c_575, %c_576, %c_577 : (tensor<12x64x512x1xf32>, tensor<1x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xf32>
      %1526 = stablehlo.broadcast_in_dim %1491#18, dims = [1, 2, 3] : (tensor<64x512x1xf32>) -> tensor<1x64x512x1xf32>
      %c_578 = stablehlo.constant dense<0> : tensor<i32>
      %c_579 = stablehlo.constant dense<0> : tensor<i32>
      %c_580 = stablehlo.constant dense<0> : tensor<i32>
      %1527 = stablehlo.dynamic_update_slice %iterArg_476, %1526, %iterArg_457, %c_578, %c_579, %c_580 : (tensor<12x64x512x1xf32>, tensor<1x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xf32>
      %1528 = stablehlo.broadcast_in_dim %1491#19, dims = [1, 2, 3] : (tensor<64x512x1xf32>) -> tensor<1x64x512x1xf32>
      %c_581 = stablehlo.constant dense<0> : tensor<i32>
      %c_582 = stablehlo.constant dense<0> : tensor<i32>
      %c_583 = stablehlo.constant dense<0> : tensor<i32>
      %1529 = stablehlo.dynamic_update_slice %iterArg_477, %1528, %iterArg_457, %c_581, %c_582, %c_583 : (tensor<12x64x512x1xf32>, tensor<1x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xf32>
      %1530 = stablehlo.broadcast_in_dim %1491#20, dims = [1, 2, 3] : (tensor<64x512x1xf32>) -> tensor<1x64x512x1xf32>
      %c_584 = stablehlo.constant dense<0> : tensor<i32>
      %c_585 = stablehlo.constant dense<0> : tensor<i32>
      %c_586 = stablehlo.constant dense<0> : tensor<i32>
      %1531 = stablehlo.dynamic_update_slice %iterArg_478, %1530, %iterArg_457, %c_584, %c_585, %c_586 : (tensor<12x64x512x1xf32>, tensor<1x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xf32>
      %1532 = stablehlo.broadcast_in_dim %1491#21, dims = [1, 2, 3] : (tensor<64x512x768xf32>) -> tensor<1x64x512x768xf32>
      %c_587 = stablehlo.constant dense<0> : tensor<i32>
      %c_588 = stablehlo.constant dense<0> : tensor<i32>
      %c_589 = stablehlo.constant dense<0> : tensor<i32>
      %1533 = stablehlo.dynamic_update_slice %iterArg_479, %1532, %iterArg_457, %c_587, %c_588, %c_589 : (tensor<12x64x512x768xf32>, tensor<1x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xf32>
      %1534 = stablehlo.broadcast_in_dim %1491#22, dims = [1, 2, 3] : (tensor<64x512x768xf32>) -> tensor<1x64x512x768xf32>
      %c_590 = stablehlo.constant dense<0> : tensor<i32>
      %c_591 = stablehlo.constant dense<0> : tensor<i32>
      %c_592 = stablehlo.constant dense<0> : tensor<i32>
      %1535 = stablehlo.dynamic_update_slice %iterArg_480, %1534, %iterArg_457, %c_590, %c_591, %c_592 : (tensor<12x64x512x768xf32>, tensor<1x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xf32>
      %1536 = stablehlo.broadcast_in_dim %1491#23, dims = [1, 2, 3] : (tensor<1x1x768xf32>) -> tensor<1x1x1x768xf32>
      %c_593 = stablehlo.constant dense<0> : tensor<i32>
      %c_594 = stablehlo.constant dense<0> : tensor<i32>
      %c_595 = stablehlo.constant dense<0> : tensor<i32>
      %1537 = stablehlo.dynamic_update_slice %iterArg_481, %1536, %iterArg_457, %c_593, %c_594, %c_595 : (tensor<12x1x1x768xf32>, tensor<1x1x1x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x1x1x768xf32>
      %1538 = stablehlo.broadcast_in_dim %1491#24, dims = [1, 2] : (tensor<768x3072xbf16>) -> tensor<1x768x3072xbf16>
      %c_596 = stablehlo.constant dense<0> : tensor<i32>
      %c_597 = stablehlo.constant dense<0> : tensor<i32>
      %1539 = stablehlo.dynamic_update_slice %iterArg_482, %1538, %iterArg_457, %c_596, %c_597 : (tensor<12x768x3072xbf16>, tensor<1x768x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x3072xbf16>
      %1540 = stablehlo.broadcast_in_dim %1491#25, dims = [1, 2, 3] : (tensor<64x512x768xbf16>) -> tensor<1x64x512x768xbf16>
      %c_598 = stablehlo.constant dense<0> : tensor<i32>
      %c_599 = stablehlo.constant dense<0> : tensor<i32>
      %c_600 = stablehlo.constant dense<0> : tensor<i32>
      %1541 = stablehlo.dynamic_update_slice %iterArg_483, %1540, %iterArg_457, %c_598, %c_599, %c_600 : (tensor<12x64x512x768xbf16>, tensor<1x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xbf16>
      %1542 = stablehlo.broadcast_in_dim %1491#26, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_601 = stablehlo.constant dense<0> : tensor<i32>
      %c_602 = stablehlo.constant dense<0> : tensor<i32>
      %c_603 = stablehlo.constant dense<0> : tensor<i32>
      %1543 = stablehlo.dynamic_update_slice %iterArg_484, %1542, %iterArg_457, %c_601, %c_602, %c_603 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1544 = stablehlo.broadcast_in_dim %1491#27, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_604 = stablehlo.constant dense<0> : tensor<i32>
      %c_605 = stablehlo.constant dense<0> : tensor<i32>
      %c_606 = stablehlo.constant dense<0> : tensor<i32>
      %1545 = stablehlo.dynamic_update_slice %iterArg_485, %1544, %iterArg_457, %c_604, %c_605, %c_606 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1546 = stablehlo.broadcast_in_dim %1491#28, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_607 = stablehlo.constant dense<0> : tensor<i32>
      %c_608 = stablehlo.constant dense<0> : tensor<i32>
      %c_609 = stablehlo.constant dense<0> : tensor<i32>
      %1547 = stablehlo.dynamic_update_slice %iterArg_486, %1546, %iterArg_457, %c_607, %c_608, %c_609 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1548 = stablehlo.broadcast_in_dim %1491#29, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_610 = stablehlo.constant dense<0> : tensor<i32>
      %c_611 = stablehlo.constant dense<0> : tensor<i32>
      %c_612 = stablehlo.constant dense<0> : tensor<i32>
      %1549 = stablehlo.dynamic_update_slice %iterArg_487, %1548, %iterArg_457, %c_610, %c_611, %c_612 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1550 = stablehlo.broadcast_in_dim %1491#30, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_613 = stablehlo.constant dense<0> : tensor<i32>
      %c_614 = stablehlo.constant dense<0> : tensor<i32>
      %c_615 = stablehlo.constant dense<0> : tensor<i32>
      %1551 = stablehlo.dynamic_update_slice %iterArg_488, %1550, %iterArg_457, %c_613, %c_614, %c_615 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1552 = stablehlo.broadcast_in_dim %1491#31, dims = [1, 2] : (tensor<3072x768xbf16>) -> tensor<1x3072x768xbf16>
      %c_616 = stablehlo.constant dense<0> : tensor<i32>
      %c_617 = stablehlo.constant dense<0> : tensor<i32>
      %1553 = stablehlo.dynamic_update_slice %iterArg_489, %1552, %iterArg_457, %c_616, %c_617 : (tensor<12x3072x768xbf16>, tensor<1x3072x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x3072x768xbf16>
      %1554 = stablehlo.broadcast_in_dim %1491#32, dims = [1, 2, 3] : (tensor<64x512x3072xbf16>) -> tensor<1x64x512x3072xbf16>
      %c_618 = stablehlo.constant dense<0> : tensor<i32>
      %c_619 = stablehlo.constant dense<0> : tensor<i32>
      %c_620 = stablehlo.constant dense<0> : tensor<i32>
      %1555 = stablehlo.dynamic_update_slice %iterArg_490, %1554, %iterArg_457, %c_618, %c_619, %c_620 : (tensor<12x64x512x3072xbf16>, tensor<1x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x3072xbf16>
      %1556 = stablehlo.broadcast_in_dim %1491#33, dims = [1, 2, 3] : (tensor<64x512x768xi1>) -> tensor<1x64x512x768xi1>
      %c_621 = stablehlo.constant dense<0> : tensor<i32>
      %c_622 = stablehlo.constant dense<0> : tensor<i32>
      %c_623 = stablehlo.constant dense<0> : tensor<i32>
      %1557 = stablehlo.dynamic_update_slice %iterArg_491, %1556, %iterArg_457, %c_621, %c_622, %c_623 : (tensor<12x64x512x768xi1>, tensor<1x64x512x768xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xi1>
      %1558 = stablehlo.broadcast_in_dim %1491#34, dims = [1, 2, 3] : (tensor<64x512x768xf32>) -> tensor<1x64x512x768xf32>
      %c_624 = stablehlo.constant dense<0> : tensor<i32>
      %c_625 = stablehlo.constant dense<0> : tensor<i32>
      %c_626 = stablehlo.constant dense<0> : tensor<i32>
      %1559 = stablehlo.dynamic_update_slice %iterArg_492, %1558, %iterArg_457, %c_624, %c_625, %c_626 : (tensor<12x64x512x768xf32>, tensor<1x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xf32>
      %1560 = stablehlo.broadcast_in_dim %1491#35, dims = [1, 2, 3] : (tensor<64x512x1xf32>) -> tensor<1x64x512x1xf32>
      %c_627 = stablehlo.constant dense<0> : tensor<i32>
      %c_628 = stablehlo.constant dense<0> : tensor<i32>
      %c_629 = stablehlo.constant dense<0> : tensor<i32>
      %1561 = stablehlo.dynamic_update_slice %iterArg_493, %1560, %iterArg_457, %c_627, %c_628, %c_629 : (tensor<12x64x512x1xf32>, tensor<1x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xf32>
      %1562 = stablehlo.broadcast_in_dim %1491#36, dims = [1, 2, 3] : (tensor<64x512x1xf32>) -> tensor<1x64x512x1xf32>
      %c_630 = stablehlo.constant dense<0> : tensor<i32>
      %c_631 = stablehlo.constant dense<0> : tensor<i32>
      %c_632 = stablehlo.constant dense<0> : tensor<i32>
      %1563 = stablehlo.dynamic_update_slice %iterArg_494, %1562, %iterArg_457, %c_630, %c_631, %c_632 : (tensor<12x64x512x1xf32>, tensor<1x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xf32>
      %1564 = stablehlo.broadcast_in_dim %1491#37, dims = [1, 2, 3] : (tensor<64x512x1xf32>) -> tensor<1x64x512x1xf32>
      %c_633 = stablehlo.constant dense<0> : tensor<i32>
      %c_634 = stablehlo.constant dense<0> : tensor<i32>
      %c_635 = stablehlo.constant dense<0> : tensor<i32>
      %1565 = stablehlo.dynamic_update_slice %iterArg_495, %1564, %iterArg_457, %c_633, %c_634, %c_635 : (tensor<12x64x512x1xf32>, tensor<1x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xf32>
      %1566 = stablehlo.broadcast_in_dim %1491#38, dims = [1, 2, 3] : (tensor<64x512x1xf32>) -> tensor<1x64x512x1xf32>
      %c_636 = stablehlo.constant dense<0> : tensor<i32>
      %c_637 = stablehlo.constant dense<0> : tensor<i32>
      %c_638 = stablehlo.constant dense<0> : tensor<i32>
      %1567 = stablehlo.dynamic_update_slice %iterArg_496, %1566, %iterArg_457, %c_636, %c_637, %c_638 : (tensor<12x64x512x1xf32>, tensor<1x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x1xf32>
      %1568 = stablehlo.broadcast_in_dim %1491#39, dims = [1, 2, 3] : (tensor<64x512x768xf32>) -> tensor<1x64x512x768xf32>
      %c_639 = stablehlo.constant dense<0> : tensor<i32>
      %c_640 = stablehlo.constant dense<0> : tensor<i32>
      %c_641 = stablehlo.constant dense<0> : tensor<i32>
      %1569 = stablehlo.dynamic_update_slice %iterArg_497, %1568, %iterArg_457, %c_639, %c_640, %c_641 : (tensor<12x64x512x768xf32>, tensor<1x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xf32>
      %1570 = stablehlo.broadcast_in_dim %1491#40, dims = [1, 2, 3] : (tensor<64x512x768xf32>) -> tensor<1x64x512x768xf32>
      %c_642 = stablehlo.constant dense<0> : tensor<i32>
      %c_643 = stablehlo.constant dense<0> : tensor<i32>
      %c_644 = stablehlo.constant dense<0> : tensor<i32>
      %1571 = stablehlo.dynamic_update_slice %iterArg_498, %1570, %iterArg_457, %c_642, %c_643, %c_644 : (tensor<12x64x512x768xf32>, tensor<1x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x64x512x768xf32>
      %1572 = stablehlo.broadcast_in_dim %1491#41, dims = [1, 2, 3] : (tensor<1x1x768xf32>) -> tensor<1x1x1x768xf32>
      %c_645 = stablehlo.constant dense<0> : tensor<i32>
      %c_646 = stablehlo.constant dense<0> : tensor<i32>
      %c_647 = stablehlo.constant dense<0> : tensor<i32>
      %1573 = stablehlo.dynamic_update_slice %iterArg_499, %1572, %iterArg_457, %c_645, %c_646, %c_647 : (tensor<12x1x1x768xf32>, tensor<1x1x1x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x1x1x768xf32>
      %c_648 = stablehlo.constant dense<1> : tensor<i32>
      %1574 = stablehlo.add %iterArg_457, %c_648 : tensor<i32>
      stablehlo.return %iterArg, %iterArg_417, %iterArg_418, %iterArg_419, %iterArg_420, %iterArg_421, %iterArg_422, %iterArg_423, %iterArg_424, %iterArg_425, %iterArg_426, %iterArg_427, %iterArg_428, %iterArg_429, %iterArg_430, %iterArg_431, %iterArg_432, %iterArg_433, %iterArg_434, %iterArg_435, %iterArg_436, %iterArg_437, %iterArg_438, %iterArg_439, %iterArg_440, %iterArg_441, %iterArg_442, %iterArg_443, %iterArg_444, %iterArg_445, %iterArg_446, %iterArg_447, %iterArg_448, %iterArg_449, %iterArg_450, %iterArg_451, %iterArg_452, %iterArg_453, %iterArg_454, %iterArg_455, %iterArg_456, %1574, %1491#0, %1493, %1495, %1497, %1499, %1501, %1503, %1505, %1507, %1509, %1511, %1513, %1515, %1517, %1519, %1521, %1523, %1525, %1527, %1529, %1531, %1533, %1535, %1537, %1539, %1541, %1543, %1545, %1547, %1549, %1551, %1553, %1555, %1557, %1559, %1561, %1563, %1565, %1567, %1569, %1571, %1573 : tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>, tensor<f32>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x512xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<bf16>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<i32>, tensor<64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x512xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x512xi1>, tensor<12x64x512x12x512xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x768xf32>, tensor<12x64x512x768xf32>, tensor<12x1x1x768xf32>, tensor<12x768x3072xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x3072x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x768xf32>, tensor<12x64x512x768xf32>, tensor<12x1x1x768xf32>
    }
    %139 = stablehlo.transpose %arg21, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %140 = stablehlo.dot_general %138#42, %139, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %141 = stablehlo.broadcast_in_dim %arg22, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %142 = stablehlo.broadcast_in_dim %141, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %143 = stablehlo.add %140, %142 : tensor<64x512x768xbf16>
    %144 = stablehlo.multiply %143, %143 : tensor<64x512x768xbf16>
    %145 = stablehlo.multiply %144, %143 : tensor<64x512x768xbf16>
    %146 = stablehlo.multiply %143, %143 : tensor<64x512x768xbf16>
    %cst_75 = stablehlo.constant dense<3.000000e+00> : tensor<bf16>
    %147 = stablehlo.broadcast_in_dim %cst_75, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %148 = stablehlo.multiply %147, %146 : tensor<64x512x768xbf16>
    %cst_76 = stablehlo.constant dense<4.467770e-02> : tensor<bf16>
    %149 = stablehlo.broadcast_in_dim %cst_76, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %150 = stablehlo.multiply %149, %145 : tensor<64x512x768xbf16>
    %151 = stablehlo.add %143, %150 : tensor<64x512x768xbf16>
    %cst_77 = stablehlo.constant dense<7.968750e-01> : tensor<bf16>
    %152 = stablehlo.broadcast_in_dim %cst_77, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %153 = stablehlo.multiply %152, %151 : tensor<64x512x768xbf16>
    %154 = stablehlo.tanh %153 : tensor<64x512x768xbf16>
    %cst_78 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %155 = stablehlo.broadcast_in_dim %cst_78, dims = [] : (tensor<bf16>) -> tensor<bf16>
    %156 = stablehlo.broadcast_in_dim %155, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %157 = stablehlo.subtract %156, %154 : tensor<64x512x768xbf16>
    %cst_79 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %158 = stablehlo.broadcast_in_dim %cst_79, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %159 = stablehlo.add %158, %154 : tensor<64x512x768xbf16>
    %cst_80 = stablehlo.constant dense<5.000000e-01> : tensor<bf16>
    %160 = stablehlo.broadcast_in_dim %cst_80, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %161 = stablehlo.multiply %160, %159 : tensor<64x512x768xbf16>
    %162 = stablehlo.multiply %143, %161 : tensor<64x512x768xbf16>
    %163 = stablehlo.convert %162 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst_81 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %164 = stablehlo.reduce(%163 init: %cst_81) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %165 = stablehlo.broadcast_in_dim %164, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_82 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %166 = stablehlo.broadcast_in_dim %cst_82, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %167 = stablehlo.divide %165, %166 : tensor<64x512x1xf32>
    %168 = stablehlo.broadcast_in_dim %167, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %169 = stablehlo.subtract %163, %168 : tensor<64x512x768xf32>
    %170 = stablehlo.multiply %163, %163 : tensor<64x512x768xf32>
    %cst_83 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %171 = stablehlo.broadcast_in_dim %cst_83, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %172 = stablehlo.multiply %171, %163 : tensor<64x512x768xf32>
    %cst_84 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %173 = stablehlo.reduce(%170 init: %cst_84) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %174 = stablehlo.broadcast_in_dim %173, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_85 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %175 = stablehlo.broadcast_in_dim %cst_85, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %176 = stablehlo.divide %174, %175 : tensor<64x512x1xf32>
    %177 = stablehlo.multiply %167, %167 : tensor<64x512x1xf32>
    %cst_86 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %178 = stablehlo.broadcast_in_dim %cst_86, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %179 = stablehlo.multiply %178, %167 : tensor<64x512x1xf32>
    %180 = stablehlo.subtract %176, %177 : tensor<64x512x1xf32>
    %cst_87 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %181 = stablehlo.broadcast_in_dim %cst_87, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %182 = stablehlo.maximum %181, %180 : tensor<64x512x1xf32>
    %183 = stablehlo.compare  EQ, %180, %182,  FLOAT : (tensor<64x512x1xf32>, tensor<64x512x1xf32>) -> tensor<64x512x1xi1>
    %cst_88 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %184 = stablehlo.broadcast_in_dim %cst_88, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_89 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %185 = stablehlo.broadcast_in_dim %cst_89, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %186 = stablehlo.select %183, %184, %185 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    %cst_90 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %187 = stablehlo.broadcast_in_dim %cst_90, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %188 = stablehlo.compare  EQ, %187, %182,  FLOAT : (tensor<64x512x1xf32>, tensor<64x512x1xf32>) -> tensor<64x512x1xi1>
    %cst_91 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %189 = stablehlo.broadcast_in_dim %cst_91, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %cst_92 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %190 = stablehlo.broadcast_in_dim %cst_92, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %191 = stablehlo.select %188, %189, %190 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    %192 = stablehlo.divide %186, %191 : tensor<64x512x1xf32>
    %cst_93 = stablehlo.constant dense<9.99999996E-13> : tensor<f32>
    %193 = stablehlo.broadcast_in_dim %cst_93, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %194 = stablehlo.add %182, %193 : tensor<64x512x1xf32>
    %195 = stablehlo.rsqrt %194 : tensor<64x512x1xf32>
    %196 = stablehlo.divide %195, %194 : tensor<64x512x1xf32>
    %cst_94 = stablehlo.constant dense<-5.000000e-01> : tensor<f32>
    %197 = stablehlo.broadcast_in_dim %cst_94, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %198 = stablehlo.multiply %197, %196 : tensor<64x512x1xf32>
    %199 = stablehlo.broadcast_in_dim %195, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %200 = stablehlo.multiply %169, %199 : tensor<64x512x768xf32>
    %201 = stablehlo.convert %arg23 : (tensor<768xbf16>) -> tensor<768xf32>
    %202 = stablehlo.broadcast_in_dim %201, dims = [2] : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %203 = stablehlo.broadcast_in_dim %202, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %204 = stablehlo.multiply %203, %200 : tensor<64x512x768xf32>
    %205 = stablehlo.convert %arg24 : (tensor<768xbf16>) -> tensor<768xf32>
    %206 = stablehlo.broadcast_in_dim %205, dims = [2] : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %207 = stablehlo.broadcast_in_dim %206, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %208 = stablehlo.add %204, %207 : tensor<64x512x768xf32>
    %209 = stablehlo.convert %208 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %210 = stablehlo.transpose %arg25, dims = [1, 0] : (tensor<30522x768xbf16>) -> tensor<768x30522xbf16>
    %211 = stablehlo.dot_general %209, %210, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x30522xbf16>) -> tensor<64x512x30522xbf16>
    %212 = stablehlo.broadcast_in_dim %arg26, dims = [2] : (tensor<30522xbf16>) -> tensor<1x1x30522xbf16>
    %213 = stablehlo.broadcast_in_dim %212, dims = [0, 1, 2] : (tensor<1x1x30522xbf16>) -> tensor<64x512x30522xbf16>
    %214 = stablehlo.add %211, %213 : tensor<64x512x30522xbf16>
    %215 = stablehlo.convert %214 : (tensor<64x512x30522xbf16>) -> tensor<64x512x30522xf32>
    %c_95 = stablehlo.constant dense<-100> : tensor<i32>
    %216 = stablehlo.broadcast_in_dim %c_95, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %217 = stablehlo.compare  NE, %arg87, %216,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %c_96 = stablehlo.constant dense<0> : tensor<i32>
    %218 = call @_where_228(%217, %arg87, %c_96) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<i32>) -> tensor<64x512xi32>
    %c_97 = stablehlo.constant dense<0> : tensor<i32>
    %219 = call @_where_228(%217, %218, %c_97) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<i32>) -> tensor<64x512xi32>
    %cst_98 = stablehlo.constant dense<0xFF800000> : tensor<f32>
    %220 = stablehlo.reduce(%215 init: %cst_98) applies stablehlo.maximum across dimensions = [2] : (tensor<64x512x30522xf32>, tensor<f32>) -> tensor<64x512xf32>
    %221 = stablehlo.broadcast_in_dim %220, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %222 = stablehlo.broadcast_in_dim %221, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x30522xf32>
    %223 = stablehlo.subtract %215, %222 : tensor<64x512x30522xf32>
    %224 = stablehlo.exponential %223 : tensor<64x512x30522xf32>
    %cst_99 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %225 = stablehlo.reduce(%224 init: %cst_99) applies stablehlo.add across dimensions = [2] : (tensor<64x512x30522xf32>, tensor<f32>) -> tensor<64x512xf32>
    %226 = stablehlo.log %225 : tensor<64x512xf32>
    %227 = stablehlo.broadcast_in_dim %219, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %228:2 = call @take_along_axis(%223, %227) : (tensor<64x512x30522xf32>, tensor<64x512x1xi32>) -> (tensor<64x512x1xf32>, tensor<64x512x1x1xi32>)
    %229 = stablehlo.slice %228#0 [0:64, 0:512, 0:1] : (tensor<64x512x1xf32>) -> tensor<64x512x1xf32>
    %230 = stablehlo.reshape %229 : (tensor<64x512x1xf32>) -> tensor<64x512xf32>
    %231 = stablehlo.subtract %226, %230 : tensor<64x512xf32>
    %cst_100 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %232 = call @_where_250(%217, %231, %cst_100) : (tensor<64x512xi1>, tensor<64x512xf32>, tensor<f32>) -> tensor<64x512xf32>
    %cst_101 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %233 = stablehlo.reduce(%232 init: %cst_101) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512xf32>, tensor<f32>) -> tensor<f32>
    %234 = stablehlo.convert %217 : (tensor<64x512xi1>) -> tensor<64x512xi32>
    %c_102 = stablehlo.constant dense<0> : tensor<i32>
    %235 = stablehlo.reduce(%234 init: %c_102) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512xi32>, tensor<i32>) -> tensor<i32>
    %236 = call @argmax(%215) : (tensor<64x512x30522xf32>) -> tensor<64x512xi32>
    %237 = stablehlo.compare  EQ, %236, %arg87,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %238 = stablehlo.and %237, %217 : tensor<64x512xi1>
    %239 = stablehlo.convert %238 : (tensor<64x512xi1>) -> tensor<64x512xi32>
    %c_103 = stablehlo.constant dense<0> : tensor<i32>
    %240 = stablehlo.reduce(%239 init: %c_103) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512xi32>, tensor<i32>) -> tensor<i32>
    %cst_104 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %241 = stablehlo.broadcast_in_dim %cst_104, dims = [] : (tensor<f32>) -> tensor<f32>
    %242 = stablehlo.broadcast_in_dim %241, dims = [] : (tensor<f32>) -> tensor<64x512xf32>
    %243 = call @_where_268(%217, %242) : (tensor<64x512xi1>, tensor<64x512xf32>) -> tensor<64x512xf32>
    %244 = stablehlo.negate %243 : tensor<64x512xf32>
    %245 = stablehlo.broadcast_in_dim %244, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_105 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %246 = stablehlo.pad %245, %cst_105, low = [0, 0, 0], high = [0, 0, 0], interior = [0, 0, 0] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512x1xf32>
    %247 = call @take_along_axis_269(%228#1, %246) : (tensor<64x512x1x1xi32>, tensor<64x512x1xf32>) -> tensor<64x512x30522xf32>
    %248 = stablehlo.divide %243, %225 : tensor<64x512xf32>
    %249 = stablehlo.broadcast_in_dim %248, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x30522xf32>
    %250 = stablehlo.multiply %249, %224 : tensor<64x512x30522xf32>
    %251 = stablehlo.add %247, %250 : tensor<64x512x30522xf32>
    %252 = stablehlo.convert %251 : (tensor<64x512x30522xf32>) -> tensor<64x512x30522xbf16>
    %cst_106 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %253 = stablehlo.reduce(%252 init: %cst_106) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x30522xbf16>, tensor<bf16>) -> tensor<30522xbf16>
    %254 = stablehlo.reshape %253 : (tensor<30522xbf16>) -> tensor<1x1x30522xbf16>
    %cst_107 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %255 = stablehlo.reduce(%254 init: %cst_107) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x30522xbf16>, tensor<bf16>) -> tensor<30522xbf16>
    %256 = stablehlo.dot_general %252, %209, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x30522xbf16>, tensor<64x512x768xbf16>) -> tensor<30522x768xbf16>
    %257 = stablehlo.transpose %256, dims = [1, 0] : (tensor<30522x768xbf16>) -> tensor<768x30522xbf16>
    %258 = stablehlo.dot_general %252, %210, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x30522xbf16>, tensor<768x30522xbf16>) -> tensor<64x512x768xbf16>
    %259 = stablehlo.transpose %257, dims = [1, 0] : (tensor<768x30522xbf16>) -> tensor<30522x768xbf16>
    %260 = stablehlo.convert %258 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst_108 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %261 = stablehlo.reduce(%260 init: %cst_108) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<768xf32>
    %262 = stablehlo.reshape %261 : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %cst_109 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %263 = stablehlo.reduce(%262 init: %cst_109) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xf32>, tensor<f32>) -> tensor<768xf32>
    %264 = stablehlo.convert %263 : (tensor<768xf32>) -> tensor<768xbf16>
    %265 = stablehlo.broadcast_in_dim %202, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %266 = stablehlo.multiply %265, %260 : tensor<64x512x768xf32>
    %267 = stablehlo.multiply %260, %200 : tensor<64x512x768xf32>
    %cst_110 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %268 = stablehlo.reduce(%267 init: %cst_110) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<768xf32>
    %269 = stablehlo.reshape %268 : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %cst_111 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %270 = stablehlo.reduce(%269 init: %cst_111) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xf32>, tensor<f32>) -> tensor<768xf32>
    %271 = stablehlo.convert %270 : (tensor<768xf32>) -> tensor<768xbf16>
    %272 = stablehlo.multiply %169, %266 : tensor<64x512x768xf32>
    %cst_112 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %273 = stablehlo.reduce(%272 init: %cst_112) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %274 = stablehlo.reshape %273 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %275 = stablehlo.broadcast_in_dim %195, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %276 = stablehlo.multiply %266, %275 : tensor<64x512x768xf32>
    %277 = stablehlo.multiply %274, %198 : tensor<64x512x1xf32>
    %278 = stablehlo.multiply %277, %192 : tensor<64x512x1xf32>
    %279 = stablehlo.negate %278 : tensor<64x512x1xf32>
    %280 = stablehlo.multiply %279, %179 : tensor<64x512x1xf32>
    %cst_113 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %281 = stablehlo.broadcast_in_dim %cst_113, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %282 = stablehlo.divide %278, %281 : tensor<64x512x1xf32>
    %cst_114 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %283 = stablehlo.reduce(%282 init: %cst_114) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %284 = stablehlo.broadcast_in_dim %283, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %285 = stablehlo.multiply %284, %172 : tensor<64x512x768xf32>
    %286 = stablehlo.negate %276 : tensor<64x512x768xf32>
    %cst_115 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %287 = stablehlo.reduce(%286 init: %cst_115) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %288 = stablehlo.reshape %287 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %289 = stablehlo.add %285, %276 : tensor<64x512x768xf32>
    %290 = stablehlo.add %280, %288 : tensor<64x512x1xf32>
    %cst_116 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %291 = stablehlo.broadcast_in_dim %cst_116, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %292 = stablehlo.divide %290, %291 : tensor<64x512x1xf32>
    %cst_117 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %293 = stablehlo.reduce(%292 init: %cst_117) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %294 = stablehlo.broadcast_in_dim %293, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %295 = stablehlo.add %289, %294 : tensor<64x512x768xf32>
    %296 = stablehlo.convert %295 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %297 = stablehlo.multiply %143, %296 : tensor<64x512x768xbf16>
    %298 = stablehlo.multiply %296, %161 : tensor<64x512x768xbf16>
    %cst_118 = stablehlo.constant dense<5.000000e-01> : tensor<bf16>
    %299 = stablehlo.broadcast_in_dim %cst_118, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %300 = stablehlo.multiply %299, %297 : tensor<64x512x768xbf16>
    %301 = stablehlo.multiply %300, %157 : tensor<64x512x768xbf16>
    %302 = stablehlo.multiply %301, %154 : tensor<64x512x768xbf16>
    %303 = stablehlo.add %301, %302 : tensor<64x512x768xbf16>
    %cst_119 = stablehlo.constant dense<7.968750e-01> : tensor<bf16>
    %304 = stablehlo.broadcast_in_dim %cst_119, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %305 = stablehlo.multiply %304, %303 : tensor<64x512x768xbf16>
    %306 = stablehlo.add %298, %305 : tensor<64x512x768xbf16>
    %cst_120 = stablehlo.constant dense<4.467770e-02> : tensor<bf16>
    %307 = stablehlo.broadcast_in_dim %cst_120, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %308 = stablehlo.multiply %307, %305 : tensor<64x512x768xbf16>
    %309 = stablehlo.multiply %308, %148 : tensor<64x512x768xbf16>
    %310 = stablehlo.add %306, %309 : tensor<64x512x768xbf16>
    %cst_121 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %311 = stablehlo.reduce(%310 init: %cst_121) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %312 = stablehlo.reshape %311 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_122 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %313 = stablehlo.reduce(%312 init: %cst_122) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %314 = stablehlo.dot_general %310, %138#42, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %315 = stablehlo.transpose %314, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %316 = stablehlo.dot_general %310, %139, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %317 = stablehlo.transpose %315, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %cst_123 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %318 = stablehlo.broadcast_in_dim %cst_123, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_124 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %319 = stablehlo.broadcast_in_dim %cst_124, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_125 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %320 = stablehlo.broadcast_in_dim %cst_125, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_126 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %321 = stablehlo.broadcast_in_dim %cst_126, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_127 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %322 = stablehlo.broadcast_in_dim %cst_127, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_128 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %323 = stablehlo.broadcast_in_dim %cst_128, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_129 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %324 = stablehlo.broadcast_in_dim %cst_129, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %cst_130 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %325 = stablehlo.broadcast_in_dim %cst_130, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_131 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %326 = stablehlo.broadcast_in_dim %cst_131, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_132 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %327 = stablehlo.broadcast_in_dim %cst_132, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_133 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %328 = stablehlo.broadcast_in_dim %cst_133, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %cst_134 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %329 = stablehlo.broadcast_in_dim %cst_134, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %cst_135 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %330 = stablehlo.broadcast_in_dim %cst_135, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %cst_136 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %331 = stablehlo.broadcast_in_dim %cst_136, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_137 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %332 = stablehlo.broadcast_in_dim %cst_137, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %cst_138 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %333 = stablehlo.broadcast_in_dim %cst_138, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %c_139 = stablehlo.constant dense<0> : tensor<i32>
    %334:61 = stablehlo.while(%iterArg = %138#43, %iterArg_417 = %138#44, %iterArg_418 = %138#45, %iterArg_419 = %138#46, %iterArg_420 = %138#47, %iterArg_421 = %138#48, %iterArg_422 = %138#49, %iterArg_423 = %138#50, %iterArg_424 = %138#51, %iterArg_425 = %138#52, %iterArg_426 = %138#53, %iterArg_427 = %138#54, %iterArg_428 = %138#55, %iterArg_429 = %138#56, %iterArg_430 = %138#57, %iterArg_431 = %138#58, %iterArg_432 = %138#59, %iterArg_433 = %138#60, %iterArg_434 = %138#61, %iterArg_435 = %138#62, %iterArg_436 = %138#63, %iterArg_437 = %138#64, %iterArg_438 = %138#65, %iterArg_439 = %138#66, %iterArg_440 = %138#67, %iterArg_441 = %138#68, %iterArg_442 = %138#69, %iterArg_443 = %138#70, %iterArg_444 = %138#71, %iterArg_445 = %138#72, %iterArg_446 = %138#73, %iterArg_447 = %138#74, %iterArg_448 = %138#75, %iterArg_449 = %138#76, %iterArg_450 = %138#77, %iterArg_451 = %138#78, %iterArg_452 = %138#79, %iterArg_453 = %138#80, %iterArg_454 = %138#81, %iterArg_455 = %138#82, %iterArg_456 = %138#83, %iterArg_457 = %79, %iterArg_458 = %81#0, %iterArg_459 = %c_139, %iterArg_460 = %316, %iterArg_461 = %318, %iterArg_462 = %319, %iterArg_463 = %320, %iterArg_464 = %321, %iterArg_465 = %322, %iterArg_466 = %323, %iterArg_467 = %324, %iterArg_468 = %325, %iterArg_469 = %326, %iterArg_470 = %327, %iterArg_471 = %328, %iterArg_472 = %329, %iterArg_473 = %330, %iterArg_474 = %331, %iterArg_475 = %332, %iterArg_476 = %333) : tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x512xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x512xi1>, tensor<12x64x512x12x512xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x768xf32>, tensor<12x64x512x768xf32>, tensor<12x1x1x768xf32>, tensor<12x768x3072xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x3072x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x768xf32>, tensor<12x64x512x768xf32>, tensor<12x1x1x768xf32>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<i32>, tensor<64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>
    cond {
      %c_477 = stablehlo.constant dense<12> : tensor<i32>
      %1457 = stablehlo.compare  LT, %iterArg_459, %c_477,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
      stablehlo.return %1457 : tensor<i1>
    } do {
      %c_477 = stablehlo.constant dense<12> : tensor<i32>
      %1457 = stablehlo.subtract %c_477, %iterArg_459 : tensor<i32>
      %c_478 = stablehlo.constant dense<1> : tensor<i32>
      %1458 = stablehlo.subtract %1457, %c_478 : tensor<i32>
      %c_479 = stablehlo.constant dense<0> : tensor<i32>
      %c_480 = stablehlo.constant dense<0> : tensor<i32>
      %1459 = stablehlo.dynamic_slice %iterArg, %1458, %c_479, %c_480, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1460 = stablehlo.reshape %1459 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_481 = stablehlo.constant dense<0> : tensor<i32>
      %c_482 = stablehlo.constant dense<0> : tensor<i32>
      %c_483 = stablehlo.constant dense<0> : tensor<i32>
      %1461 = stablehlo.dynamic_slice %iterArg_417, %1458, %c_481, %c_482, %c_483, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1462 = stablehlo.reshape %1461 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_484 = stablehlo.constant dense<0> : tensor<i32>
      %c_485 = stablehlo.constant dense<0> : tensor<i32>
      %1463 = stablehlo.dynamic_slice %iterArg_418, %1458, %c_484, %c_485, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1464 = stablehlo.reshape %1463 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_486 = stablehlo.constant dense<0> : tensor<i32>
      %c_487 = stablehlo.constant dense<0> : tensor<i32>
      %1465 = stablehlo.dynamic_slice %iterArg_419, %1458, %c_486, %c_487, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1466 = stablehlo.reshape %1465 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_488 = stablehlo.constant dense<0> : tensor<i32>
      %c_489 = stablehlo.constant dense<0> : tensor<i32>
      %c_490 = stablehlo.constant dense<0> : tensor<i32>
      %c_491 = stablehlo.constant dense<0> : tensor<i32>
      %1467 = stablehlo.dynamic_slice %iterArg_420, %1458, %c_488, %c_489, %c_490, %c_491, sizes = [1, 64, 512, 12, 64] : (tensor<12x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x64xbf16>
      %1468 = stablehlo.reshape %1467 : (tensor<1x64x512x12x64xbf16>) -> tensor<64x512x12x64xbf16>
      %c_492 = stablehlo.constant dense<0> : tensor<i32>
      %c_493 = stablehlo.constant dense<0> : tensor<i32>
      %c_494 = stablehlo.constant dense<0> : tensor<i32>
      %c_495 = stablehlo.constant dense<0> : tensor<i32>
      %1469 = stablehlo.dynamic_slice %iterArg_421, %1458, %c_492, %c_493, %c_494, %c_495, sizes = [1, 64, 512, 12, 64] : (tensor<12x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x64xbf16>
      %1470 = stablehlo.reshape %1469 : (tensor<1x64x512x12x64xbf16>) -> tensor<64x512x12x64xbf16>
      %c_496 = stablehlo.constant dense<0> : tensor<i32>
      %c_497 = stablehlo.constant dense<0> : tensor<i32>
      %c_498 = stablehlo.constant dense<0> : tensor<i32>
      %c_499 = stablehlo.constant dense<0> : tensor<i32>
      %1471 = stablehlo.dynamic_slice %iterArg_422, %1458, %c_496, %c_497, %c_498, %c_499, sizes = [1, 64, 512, 12, 512] : (tensor<12x64x512x12x512xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x512xf32>
      %1472 = stablehlo.reshape %1471 : (tensor<1x64x512x12x512xf32>) -> tensor<64x512x12x512xf32>
      %c_500 = stablehlo.constant dense<0> : tensor<i32>
      %c_501 = stablehlo.constant dense<0> : tensor<i32>
      %c_502 = stablehlo.constant dense<0> : tensor<i32>
      %c_503 = stablehlo.constant dense<0> : tensor<i32>
      %1473 = stablehlo.dynamic_slice %iterArg_423, %1458, %c_500, %c_501, %c_502, %c_503, sizes = [1, 64, 512, 12, 1] : (tensor<12x64x512x12x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x1xf32>
      %1474 = stablehlo.reshape %1473 : (tensor<1x64x512x12x1xf32>) -> tensor<64x512x12x1xf32>
      %c_504 = stablehlo.constant dense<0> : tensor<i32>
      %c_505 = stablehlo.constant dense<0> : tensor<i32>
      %c_506 = stablehlo.constant dense<0> : tensor<i32>
      %c_507 = stablehlo.constant dense<0> : tensor<i32>
      %1475 = stablehlo.dynamic_slice %iterArg_424, %1458, %c_504, %c_505, %c_506, %c_507, sizes = [1, 64, 512, 12, 1] : (tensor<12x64x512x12x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x1xf32>
      %1476 = stablehlo.reshape %1475 : (tensor<1x64x512x12x1xf32>) -> tensor<64x512x12x1xf32>
      %c_508 = stablehlo.constant dense<0> : tensor<i32>
      %c_509 = stablehlo.constant dense<0> : tensor<i32>
      %c_510 = stablehlo.constant dense<0> : tensor<i32>
      %c_511 = stablehlo.constant dense<0> : tensor<i32>
      %1477 = stablehlo.dynamic_slice %iterArg_425, %1458, %c_508, %c_509, %c_510, %c_511, sizes = [1, 64, 512, 12, 512] : (tensor<12x64x512x12x512xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x512xi1>
      %1478 = stablehlo.reshape %1477 : (tensor<1x64x512x12x512xi1>) -> tensor<64x512x12x512xi1>
      %c_512 = stablehlo.constant dense<0> : tensor<i32>
      %c_513 = stablehlo.constant dense<0> : tensor<i32>
      %c_514 = stablehlo.constant dense<0> : tensor<i32>
      %c_515 = stablehlo.constant dense<0> : tensor<i32>
      %1479 = stablehlo.dynamic_slice %iterArg_426, %1458, %c_512, %c_513, %c_514, %c_515, sizes = [1, 64, 512, 12, 512] : (tensor<12x64x512x12x512xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x512xbf16>
      %1480 = stablehlo.reshape %1479 : (tensor<1x64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
      %c_516 = stablehlo.constant dense<0> : tensor<i32>
      %c_517 = stablehlo.constant dense<0> : tensor<i32>
      %c_518 = stablehlo.constant dense<0> : tensor<i32>
      %c_519 = stablehlo.constant dense<0> : tensor<i32>
      %1481 = stablehlo.dynamic_slice %iterArg_427, %1458, %c_516, %c_517, %c_518, %c_519, sizes = [1, 64, 512, 12, 64] : (tensor<12x64x512x12x64xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x12x64xbf16>
      %1482 = stablehlo.reshape %1481 : (tensor<1x64x512x12x64xbf16>) -> tensor<64x512x12x64xbf16>
      %c_520 = stablehlo.constant dense<0> : tensor<i32>
      %c_521 = stablehlo.constant dense<0> : tensor<i32>
      %1483 = stablehlo.dynamic_slice %iterArg_428, %1458, %c_520, %c_521, sizes = [1, 768, 768] : (tensor<12x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x768xbf16>
      %1484 = stablehlo.reshape %1483 : (tensor<1x768x768xbf16>) -> tensor<768x768xbf16>
      %c_522 = stablehlo.constant dense<0> : tensor<i32>
      %c_523 = stablehlo.constant dense<0> : tensor<i32>
      %c_524 = stablehlo.constant dense<0> : tensor<i32>
      %1485 = stablehlo.dynamic_slice %iterArg_429, %1458, %c_522, %c_523, %c_524, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1486 = stablehlo.reshape %1485 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_525 = stablehlo.constant dense<0> : tensor<i32>
      %c_526 = stablehlo.constant dense<0> : tensor<i32>
      %c_527 = stablehlo.constant dense<0> : tensor<i32>
      %1487 = stablehlo.dynamic_slice %iterArg_430, %1458, %c_525, %c_526, %c_527, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xi1>
      %1488 = stablehlo.reshape %1487 : (tensor<1x64x512x768xi1>) -> tensor<64x512x768xi1>
      %c_528 = stablehlo.constant dense<0> : tensor<i32>
      %c_529 = stablehlo.constant dense<0> : tensor<i32>
      %c_530 = stablehlo.constant dense<0> : tensor<i32>
      %1489 = stablehlo.dynamic_slice %iterArg_431, %1458, %c_528, %c_529, %c_530, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xf32>
      %1490 = stablehlo.reshape %1489 : (tensor<1x64x512x768xf32>) -> tensor<64x512x768xf32>
      %c_531 = stablehlo.constant dense<0> : tensor<i32>
      %c_532 = stablehlo.constant dense<0> : tensor<i32>
      %c_533 = stablehlo.constant dense<0> : tensor<i32>
      %1491 = stablehlo.dynamic_slice %iterArg_432, %1458, %c_531, %c_532, %c_533, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xf32>
      %1492 = stablehlo.reshape %1491 : (tensor<1x64x512x1xf32>) -> tensor<64x512x1xf32>
      %c_534 = stablehlo.constant dense<0> : tensor<i32>
      %c_535 = stablehlo.constant dense<0> : tensor<i32>
      %c_536 = stablehlo.constant dense<0> : tensor<i32>
      %1493 = stablehlo.dynamic_slice %iterArg_433, %1458, %c_534, %c_535, %c_536, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xf32>
      %1494 = stablehlo.reshape %1493 : (tensor<1x64x512x1xf32>) -> tensor<64x512x1xf32>
      %c_537 = stablehlo.constant dense<0> : tensor<i32>
      %c_538 = stablehlo.constant dense<0> : tensor<i32>
      %c_539 = stablehlo.constant dense<0> : tensor<i32>
      %1495 = stablehlo.dynamic_slice %iterArg_434, %1458, %c_537, %c_538, %c_539, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xf32>
      %1496 = stablehlo.reshape %1495 : (tensor<1x64x512x1xf32>) -> tensor<64x512x1xf32>
      %c_540 = stablehlo.constant dense<0> : tensor<i32>
      %c_541 = stablehlo.constant dense<0> : tensor<i32>
      %c_542 = stablehlo.constant dense<0> : tensor<i32>
      %1497 = stablehlo.dynamic_slice %iterArg_435, %1458, %c_540, %c_541, %c_542, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xf32>
      %1498 = stablehlo.reshape %1497 : (tensor<1x64x512x1xf32>) -> tensor<64x512x1xf32>
      %c_543 = stablehlo.constant dense<0> : tensor<i32>
      %c_544 = stablehlo.constant dense<0> : tensor<i32>
      %c_545 = stablehlo.constant dense<0> : tensor<i32>
      %1499 = stablehlo.dynamic_slice %iterArg_436, %1458, %c_543, %c_544, %c_545, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xf32>
      %1500 = stablehlo.reshape %1499 : (tensor<1x64x512x768xf32>) -> tensor<64x512x768xf32>
      %c_546 = stablehlo.constant dense<0> : tensor<i32>
      %c_547 = stablehlo.constant dense<0> : tensor<i32>
      %c_548 = stablehlo.constant dense<0> : tensor<i32>
      %1501 = stablehlo.dynamic_slice %iterArg_437, %1458, %c_546, %c_547, %c_548, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xf32>
      %1502 = stablehlo.reshape %1501 : (tensor<1x64x512x768xf32>) -> tensor<64x512x768xf32>
      %c_549 = stablehlo.constant dense<0> : tensor<i32>
      %c_550 = stablehlo.constant dense<0> : tensor<i32>
      %c_551 = stablehlo.constant dense<0> : tensor<i32>
      %1503 = stablehlo.dynamic_slice %iterArg_438, %1458, %c_549, %c_550, %c_551, sizes = [1, 1, 1, 768] : (tensor<12x1x1x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x1x1x768xf32>
      %1504 = stablehlo.reshape %1503 : (tensor<1x1x1x768xf32>) -> tensor<1x1x768xf32>
      %c_552 = stablehlo.constant dense<0> : tensor<i32>
      %c_553 = stablehlo.constant dense<0> : tensor<i32>
      %1505 = stablehlo.dynamic_slice %iterArg_439, %1458, %c_552, %c_553, sizes = [1, 768, 3072] : (tensor<12x768x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x768x3072xbf16>
      %1506 = stablehlo.reshape %1505 : (tensor<1x768x3072xbf16>) -> tensor<768x3072xbf16>
      %c_554 = stablehlo.constant dense<0> : tensor<i32>
      %c_555 = stablehlo.constant dense<0> : tensor<i32>
      %c_556 = stablehlo.constant dense<0> : tensor<i32>
      %1507 = stablehlo.dynamic_slice %iterArg_440, %1458, %c_554, %c_555, %c_556, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xbf16>
      %1508 = stablehlo.reshape %1507 : (tensor<1x64x512x768xbf16>) -> tensor<64x512x768xbf16>
      %c_557 = stablehlo.constant dense<0> : tensor<i32>
      %c_558 = stablehlo.constant dense<0> : tensor<i32>
      %c_559 = stablehlo.constant dense<0> : tensor<i32>
      %1509 = stablehlo.dynamic_slice %iterArg_441, %1458, %c_557, %c_558, %c_559, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1510 = stablehlo.reshape %1509 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_560 = stablehlo.constant dense<0> : tensor<i32>
      %c_561 = stablehlo.constant dense<0> : tensor<i32>
      %c_562 = stablehlo.constant dense<0> : tensor<i32>
      %1511 = stablehlo.dynamic_slice %iterArg_442, %1458, %c_560, %c_561, %c_562, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1512 = stablehlo.reshape %1511 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_563 = stablehlo.constant dense<0> : tensor<i32>
      %c_564 = stablehlo.constant dense<0> : tensor<i32>
      %c_565 = stablehlo.constant dense<0> : tensor<i32>
      %1513 = stablehlo.dynamic_slice %iterArg_443, %1458, %c_563, %c_564, %c_565, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1514 = stablehlo.reshape %1513 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_566 = stablehlo.constant dense<0> : tensor<i32>
      %c_567 = stablehlo.constant dense<0> : tensor<i32>
      %c_568 = stablehlo.constant dense<0> : tensor<i32>
      %1515 = stablehlo.dynamic_slice %iterArg_444, %1458, %c_566, %c_567, %c_568, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1516 = stablehlo.reshape %1515 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_569 = stablehlo.constant dense<0> : tensor<i32>
      %c_570 = stablehlo.constant dense<0> : tensor<i32>
      %c_571 = stablehlo.constant dense<0> : tensor<i32>
      %1517 = stablehlo.dynamic_slice %iterArg_445, %1458, %c_569, %c_570, %c_571, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1518 = stablehlo.reshape %1517 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_572 = stablehlo.constant dense<0> : tensor<i32>
      %c_573 = stablehlo.constant dense<0> : tensor<i32>
      %1519 = stablehlo.dynamic_slice %iterArg_446, %1458, %c_572, %c_573, sizes = [1, 3072, 768] : (tensor<12x3072x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x3072x768xbf16>
      %1520 = stablehlo.reshape %1519 : (tensor<1x3072x768xbf16>) -> tensor<3072x768xbf16>
      %c_574 = stablehlo.constant dense<0> : tensor<i32>
      %c_575 = stablehlo.constant dense<0> : tensor<i32>
      %c_576 = stablehlo.constant dense<0> : tensor<i32>
      %1521 = stablehlo.dynamic_slice %iterArg_447, %1458, %c_574, %c_575, %c_576, sizes = [1, 64, 512, 3072] : (tensor<12x64x512x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x3072xbf16>
      %1522 = stablehlo.reshape %1521 : (tensor<1x64x512x3072xbf16>) -> tensor<64x512x3072xbf16>
      %c_577 = stablehlo.constant dense<0> : tensor<i32>
      %c_578 = stablehlo.constant dense<0> : tensor<i32>
      %c_579 = stablehlo.constant dense<0> : tensor<i32>
      %1523 = stablehlo.dynamic_slice %iterArg_448, %1458, %c_577, %c_578, %c_579, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xi1>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xi1>
      %1524 = stablehlo.reshape %1523 : (tensor<1x64x512x768xi1>) -> tensor<64x512x768xi1>
      %c_580 = stablehlo.constant dense<0> : tensor<i32>
      %c_581 = stablehlo.constant dense<0> : tensor<i32>
      %c_582 = stablehlo.constant dense<0> : tensor<i32>
      %1525 = stablehlo.dynamic_slice %iterArg_449, %1458, %c_580, %c_581, %c_582, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xf32>
      %1526 = stablehlo.reshape %1525 : (tensor<1x64x512x768xf32>) -> tensor<64x512x768xf32>
      %c_583 = stablehlo.constant dense<0> : tensor<i32>
      %c_584 = stablehlo.constant dense<0> : tensor<i32>
      %c_585 = stablehlo.constant dense<0> : tensor<i32>
      %1527 = stablehlo.dynamic_slice %iterArg_450, %1458, %c_583, %c_584, %c_585, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xf32>
      %1528 = stablehlo.reshape %1527 : (tensor<1x64x512x1xf32>) -> tensor<64x512x1xf32>
      %c_586 = stablehlo.constant dense<0> : tensor<i32>
      %c_587 = stablehlo.constant dense<0> : tensor<i32>
      %c_588 = stablehlo.constant dense<0> : tensor<i32>
      %1529 = stablehlo.dynamic_slice %iterArg_451, %1458, %c_586, %c_587, %c_588, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xf32>
      %1530 = stablehlo.reshape %1529 : (tensor<1x64x512x1xf32>) -> tensor<64x512x1xf32>
      %c_589 = stablehlo.constant dense<0> : tensor<i32>
      %c_590 = stablehlo.constant dense<0> : tensor<i32>
      %c_591 = stablehlo.constant dense<0> : tensor<i32>
      %1531 = stablehlo.dynamic_slice %iterArg_452, %1458, %c_589, %c_590, %c_591, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xf32>
      %1532 = stablehlo.reshape %1531 : (tensor<1x64x512x1xf32>) -> tensor<64x512x1xf32>
      %c_592 = stablehlo.constant dense<0> : tensor<i32>
      %c_593 = stablehlo.constant dense<0> : tensor<i32>
      %c_594 = stablehlo.constant dense<0> : tensor<i32>
      %1533 = stablehlo.dynamic_slice %iterArg_453, %1458, %c_592, %c_593, %c_594, sizes = [1, 64, 512, 1] : (tensor<12x64x512x1xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x1xf32>
      %1534 = stablehlo.reshape %1533 : (tensor<1x64x512x1xf32>) -> tensor<64x512x1xf32>
      %c_595 = stablehlo.constant dense<0> : tensor<i32>
      %c_596 = stablehlo.constant dense<0> : tensor<i32>
      %c_597 = stablehlo.constant dense<0> : tensor<i32>
      %1535 = stablehlo.dynamic_slice %iterArg_454, %1458, %c_595, %c_596, %c_597, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xf32>
      %1536 = stablehlo.reshape %1535 : (tensor<1x64x512x768xf32>) -> tensor<64x512x768xf32>
      %c_598 = stablehlo.constant dense<0> : tensor<i32>
      %c_599 = stablehlo.constant dense<0> : tensor<i32>
      %c_600 = stablehlo.constant dense<0> : tensor<i32>
      %1537 = stablehlo.dynamic_slice %iterArg_455, %1458, %c_598, %c_599, %c_600, sizes = [1, 64, 512, 768] : (tensor<12x64x512x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x64x512x768xf32>
      %1538 = stablehlo.reshape %1537 : (tensor<1x64x512x768xf32>) -> tensor<64x512x768xf32>
      %c_601 = stablehlo.constant dense<0> : tensor<i32>
      %c_602 = stablehlo.constant dense<0> : tensor<i32>
      %c_603 = stablehlo.constant dense<0> : tensor<i32>
      %1539 = stablehlo.dynamic_slice %iterArg_456, %1458, %c_601, %c_602, %c_603, sizes = [1, 1, 1, 768] : (tensor<12x1x1x768xf32>, tensor<i32>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<1x1x1x768xf32>
      %1540 = stablehlo.reshape %1539 : (tensor<1x1x1x768xf32>) -> tensor<1x1x768xf32>
      %1541:17 = func.call @closed_call_328(%iterArg_457, %iterArg_458, %iterArg_460, %1460, %1462, %1464, %1466, %1468, %1470, %1472, %1474, %1476, %1478, %1480, %1482, %1484, %1486, %1488, %1490, %1492, %1494, %1496, %1498, %1500, %1502, %1504, %1506, %1508, %1510, %1512, %1514, %1516, %1518, %1520, %1522, %1524, %1526, %1528, %1530, %1532, %1534, %1536, %1538, %1540) : (tensor<bf16>, tensor<64x512x12x512xi1>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768x768xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x512xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x64xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x768xf32>, tensor<64x512x768xf32>, tensor<1x1x768xf32>, tensor<768x3072xbf16>, tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<3072x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x768xf32>, tensor<64x512x768xf32>, tensor<1x1x768xf32>) -> (tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<3072x768xbf16>, tensor<3072xbf16>, tensor<768x3072xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>)
      %1542 = stablehlo.broadcast_in_dim %1541#1, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_604 = stablehlo.constant dense<0> : tensor<i32>
      %c_605 = stablehlo.constant dense<0> : tensor<i32>
      %1543 = stablehlo.dynamic_update_slice %iterArg_461, %1542, %1458, %c_604, %c_605 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1544 = stablehlo.broadcast_in_dim %1541#2, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_606 = stablehlo.constant dense<0> : tensor<i32>
      %1545 = stablehlo.dynamic_update_slice %iterArg_462, %1544, %1458, %c_606 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1546 = stablehlo.broadcast_in_dim %1541#3, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_607 = stablehlo.constant dense<0> : tensor<i32>
      %c_608 = stablehlo.constant dense<0> : tensor<i32>
      %1547 = stablehlo.dynamic_update_slice %iterArg_463, %1546, %1458, %c_607, %c_608 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1548 = stablehlo.broadcast_in_dim %1541#4, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_609 = stablehlo.constant dense<0> : tensor<i32>
      %1549 = stablehlo.dynamic_update_slice %iterArg_464, %1548, %1458, %c_609 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1550 = stablehlo.broadcast_in_dim %1541#5, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_610 = stablehlo.constant dense<0> : tensor<i32>
      %c_611 = stablehlo.constant dense<0> : tensor<i32>
      %1551 = stablehlo.dynamic_update_slice %iterArg_465, %1550, %1458, %c_610, %c_611 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1552 = stablehlo.broadcast_in_dim %1541#6, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_612 = stablehlo.constant dense<0> : tensor<i32>
      %1553 = stablehlo.dynamic_update_slice %iterArg_466, %1552, %1458, %c_612 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1554 = stablehlo.broadcast_in_dim %1541#7, dims = [1, 2] : (tensor<768x768xbf16>) -> tensor<1x768x768xbf16>
      %c_613 = stablehlo.constant dense<0> : tensor<i32>
      %c_614 = stablehlo.constant dense<0> : tensor<i32>
      %1555 = stablehlo.dynamic_update_slice %iterArg_467, %1554, %1458, %c_613, %c_614 : (tensor<12x768x768xbf16>, tensor<1x768x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x768xbf16>
      %1556 = stablehlo.broadcast_in_dim %1541#8, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_615 = stablehlo.constant dense<0> : tensor<i32>
      %1557 = stablehlo.dynamic_update_slice %iterArg_468, %1556, %1458, %c_615 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1558 = stablehlo.broadcast_in_dim %1541#9, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_616 = stablehlo.constant dense<0> : tensor<i32>
      %1559 = stablehlo.dynamic_update_slice %iterArg_469, %1558, %1458, %c_616 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1560 = stablehlo.broadcast_in_dim %1541#10, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_617 = stablehlo.constant dense<0> : tensor<i32>
      %1561 = stablehlo.dynamic_update_slice %iterArg_470, %1560, %1458, %c_617 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1562 = stablehlo.broadcast_in_dim %1541#11, dims = [1, 2] : (tensor<3072x768xbf16>) -> tensor<1x3072x768xbf16>
      %c_618 = stablehlo.constant dense<0> : tensor<i32>
      %c_619 = stablehlo.constant dense<0> : tensor<i32>
      %1563 = stablehlo.dynamic_update_slice %iterArg_471, %1562, %1458, %c_618, %c_619 : (tensor<12x3072x768xbf16>, tensor<1x3072x768xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x3072x768xbf16>
      %1564 = stablehlo.broadcast_in_dim %1541#12, dims = [1] : (tensor<3072xbf16>) -> tensor<1x3072xbf16>
      %c_620 = stablehlo.constant dense<0> : tensor<i32>
      %1565 = stablehlo.dynamic_update_slice %iterArg_472, %1564, %1458, %c_620 : (tensor<12x3072xbf16>, tensor<1x3072xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x3072xbf16>
      %1566 = stablehlo.broadcast_in_dim %1541#13, dims = [1, 2] : (tensor<768x3072xbf16>) -> tensor<1x768x3072xbf16>
      %c_621 = stablehlo.constant dense<0> : tensor<i32>
      %c_622 = stablehlo.constant dense<0> : tensor<i32>
      %1567 = stablehlo.dynamic_update_slice %iterArg_473, %1566, %1458, %c_621, %c_622 : (tensor<12x768x3072xbf16>, tensor<1x768x3072xbf16>, tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<12x768x3072xbf16>
      %1568 = stablehlo.broadcast_in_dim %1541#14, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_623 = stablehlo.constant dense<0> : tensor<i32>
      %1569 = stablehlo.dynamic_update_slice %iterArg_474, %1568, %1458, %c_623 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1570 = stablehlo.broadcast_in_dim %1541#15, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_624 = stablehlo.constant dense<0> : tensor<i32>
      %1571 = stablehlo.dynamic_update_slice %iterArg_475, %1570, %1458, %c_624 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %1572 = stablehlo.broadcast_in_dim %1541#16, dims = [1] : (tensor<768xbf16>) -> tensor<1x768xbf16>
      %c_625 = stablehlo.constant dense<0> : tensor<i32>
      %1573 = stablehlo.dynamic_update_slice %iterArg_476, %1572, %1458, %c_625 : (tensor<12x768xbf16>, tensor<1x768xbf16>, tensor<i32>, tensor<i32>) -> tensor<12x768xbf16>
      %c_626 = stablehlo.constant dense<1> : tensor<i32>
      %1574 = stablehlo.add %iterArg_459, %c_626 : tensor<i32>
      stablehlo.return %iterArg, %iterArg_417, %iterArg_418, %iterArg_419, %iterArg_420, %iterArg_421, %iterArg_422, %iterArg_423, %iterArg_424, %iterArg_425, %iterArg_426, %iterArg_427, %iterArg_428, %iterArg_429, %iterArg_430, %iterArg_431, %iterArg_432, %iterArg_433, %iterArg_434, %iterArg_435, %iterArg_436, %iterArg_437, %iterArg_438, %iterArg_439, %iterArg_440, %iterArg_441, %iterArg_442, %iterArg_443, %iterArg_444, %iterArg_445, %iterArg_446, %iterArg_447, %iterArg_448, %iterArg_449, %iterArg_450, %iterArg_451, %iterArg_452, %iterArg_453, %iterArg_454, %iterArg_455, %iterArg_456, %iterArg_457, %iterArg_458, %1574, %1541#0, %1543, %1545, %1547, %1549, %1551, %1553, %1555, %1557, %1559, %1561, %1563, %1565, %1567, %1569, %1571, %1573 : tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x64x512x12x512xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x1xf32>, tensor<12x64x512x12x512xi1>, tensor<12x64x512x12x512xbf16>, tensor<12x64x512x12x64xbf16>, tensor<12x768x768xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x768xf32>, tensor<12x64x512x768xf32>, tensor<12x1x1x768xf32>, tensor<12x768x3072xbf16>, tensor<12x64x512x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x3072x768xbf16>, tensor<12x64x512x3072xbf16>, tensor<12x64x512x768xi1>, tensor<12x64x512x768xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x1xf32>, tensor<12x64x512x768xf32>, tensor<12x64x512x768xf32>, tensor<12x1x1x768xf32>, tensor<bf16>, tensor<64x512x12x512xi1>, tensor<i32>, tensor<64x512x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>
    }
    %335 = call @_where_365(%66, %334#44) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %cst_140 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %336 = stablehlo.broadcast_in_dim %cst_140, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %337 = stablehlo.divide %335, %336 : tensor<64x512x768xbf16>
    %338 = stablehlo.convert %337 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst_141 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %339 = stablehlo.reduce(%338 init: %cst_141) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<768xf32>
    %340 = stablehlo.reshape %339 : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %cst_142 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %341 = stablehlo.reduce(%340 init: %cst_142) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xf32>, tensor<f32>) -> tensor<768xf32>
    %342 = stablehlo.convert %341 : (tensor<768xf32>) -> tensor<768xbf16>
    %343 = stablehlo.broadcast_in_dim %58, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %344 = stablehlo.multiply %343, %338 : tensor<64x512x768xf32>
    %345 = stablehlo.multiply %338, %56 : tensor<64x512x768xf32>
    %cst_143 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %346 = stablehlo.reduce(%345 init: %cst_143) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<768xf32>
    %347 = stablehlo.reshape %346 : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %cst_144 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %348 = stablehlo.reduce(%347 init: %cst_144) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xf32>, tensor<f32>) -> tensor<768xf32>
    %349 = stablehlo.convert %348 : (tensor<768xf32>) -> tensor<768xbf16>
    %350 = stablehlo.multiply %25, %344 : tensor<64x512x768xf32>
    %cst_145 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %351 = stablehlo.reduce(%350 init: %cst_145) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %352 = stablehlo.reshape %351 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %353 = stablehlo.broadcast_in_dim %51, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %354 = stablehlo.multiply %344, %353 : tensor<64x512x768xf32>
    %355 = stablehlo.multiply %352, %54 : tensor<64x512x1xf32>
    %356 = stablehlo.multiply %355, %48 : tensor<64x512x1xf32>
    %357 = stablehlo.negate %356 : tensor<64x512x1xf32>
    %358 = stablehlo.multiply %357, %35 : tensor<64x512x1xf32>
    %cst_146 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %359 = stablehlo.broadcast_in_dim %cst_146, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %360 = stablehlo.divide %356, %359 : tensor<64x512x1xf32>
    %cst_147 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %361 = stablehlo.reduce(%360 init: %cst_147) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %362 = stablehlo.broadcast_in_dim %361, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %363 = stablehlo.multiply %362, %28 : tensor<64x512x768xf32>
    %364 = stablehlo.negate %354 : tensor<64x512x768xf32>
    %cst_148 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %365 = stablehlo.reduce(%364 init: %cst_148) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %366 = stablehlo.reshape %365 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %367 = stablehlo.add %363, %354 : tensor<64x512x768xf32>
    %368 = stablehlo.add %358, %366 : tensor<64x512x1xf32>
    %cst_149 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %369 = stablehlo.broadcast_in_dim %cst_149, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %370 = stablehlo.divide %368, %369 : tensor<64x512x1xf32>
    %cst_150 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %371 = stablehlo.reduce(%370 init: %cst_150) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %372 = stablehlo.broadcast_in_dim %371, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %373 = stablehlo.add %367, %372 : tensor<64x512x768xf32>
    %374 = stablehlo.convert %373 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %375 = call @_take_366(%17#1, %374) : (tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<2x768xbf16>
    %376 = call @_take_370(%15#1, %374) : (tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<512x768xbf16>
    %377 = call @_take_373(%14#1, %374) : (tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<30522x768xbf16>
    %c_151 = stablehlo.constant dense<0> : tensor<i32>
    %378 = stablehlo.subtract %arg28, %c_151 : tensor<i32>
    %c_152 = stablehlo.constant dense<0> : tensor<i32>
    %c_153 = stablehlo.constant dense<40> : tensor<i32>
    %379 = call @clip(%378, %c_152, %c_153) : (tensor<i32>, tensor<i32>, tensor<i32>) -> tensor<i32>
    %380 = stablehlo.convert %379 : (tensor<i32>) -> tensor<f32>
    %cst_154 = stablehlo.constant dense<4.000000e+01> : tensor<f32>
    %381 = stablehlo.divide %380, %cst_154 : tensor<f32>
    %cst_155 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %382 = stablehlo.subtract %cst_155, %381 : tensor<f32>
    %cst_156 = stablehlo.constant dense<-5.000000e-05> : tensor<f32>
    %383 = stablehlo.multiply %cst_156, %382 : tensor<f32>
    %cst_157 = stablehlo.constant dense<5.000000e-05> : tensor<f32>
    %384 = stablehlo.add %383, %cst_157 : tensor<f32>
    %385 = stablehlo.convert %384 : (tensor<f32>) -> tensor<bf16>
    %c_158 = stablehlo.constant dense<2147483647> : tensor<i32>
    %386 = stablehlo.compare  LT, %arg28, %c_158,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
    %c_159 = stablehlo.constant dense<1> : tensor<i32>
    %387 = stablehlo.add %arg28, %c_159 : tensor<i32>
    %c_160 = stablehlo.constant dense<2147483647> : tensor<i32>
    %388 = call @_where_385(%386, %387, %c_160) : (tensor<i1>, tensor<i32>, tensor<i32>) -> tensor<i32>
    %389 = stablehlo.negate %385 : tensor<bf16>
    %390 = stablehlo.multiply %377, %377 : tensor<30522x768xbf16>
    %391 = stablehlo.convert %390 : (tensor<30522x768xbf16>) -> tensor<30522x768xf32>
    %cst_161 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %392 = stablehlo.reduce(%391 init: %cst_161) applies stablehlo.add across dimensions = [0, 1] : (tensor<30522x768xf32>, tensor<f32>) -> tensor<f32>
    %393 = stablehlo.convert %392 : (tensor<f32>) -> tensor<bf16>
    %cst_162 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %394 = stablehlo.add %cst_162, %393 : tensor<bf16>
    %395 = stablehlo.multiply %376, %376 : tensor<512x768xbf16>
    %396 = stablehlo.convert %395 : (tensor<512x768xbf16>) -> tensor<512x768xf32>
    %cst_163 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %397 = stablehlo.reduce(%396 init: %cst_163) applies stablehlo.add across dimensions = [0, 1] : (tensor<512x768xf32>, tensor<f32>) -> tensor<f32>
    %398 = stablehlo.convert %397 : (tensor<f32>) -> tensor<bf16>
    %399 = stablehlo.add %394, %398 : tensor<bf16>
    %400 = stablehlo.multiply %375, %375 : tensor<2x768xbf16>
    %401 = stablehlo.convert %400 : (tensor<2x768xbf16>) -> tensor<2x768xf32>
    %cst_164 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %402 = stablehlo.reduce(%401 init: %cst_164) applies stablehlo.add across dimensions = [0, 1] : (tensor<2x768xf32>, tensor<f32>) -> tensor<f32>
    %403 = stablehlo.convert %402 : (tensor<f32>) -> tensor<bf16>
    %404 = stablehlo.add %399, %403 : tensor<bf16>
    %405 = stablehlo.multiply %349, %349 : tensor<768xbf16>
    %406 = stablehlo.convert %405 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_165 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %407 = stablehlo.reduce(%406 init: %cst_165) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %408 = stablehlo.convert %407 : (tensor<f32>) -> tensor<bf16>
    %409 = stablehlo.add %404, %408 : tensor<bf16>
    %410 = stablehlo.multiply %342, %342 : tensor<768xbf16>
    %411 = stablehlo.convert %410 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_166 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %412 = stablehlo.reduce(%411 init: %cst_166) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %413 = stablehlo.convert %412 : (tensor<f32>) -> tensor<bf16>
    %414 = stablehlo.add %409, %413 : tensor<bf16>
    %415 = stablehlo.multiply %334#45, %334#45 : tensor<12x768x768xbf16>
    %416 = stablehlo.convert %415 : (tensor<12x768x768xbf16>) -> tensor<12x768x768xf32>
    %cst_167 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %417 = stablehlo.reduce(%416 init: %cst_167) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x768xf32>, tensor<f32>) -> tensor<f32>
    %418 = stablehlo.convert %417 : (tensor<f32>) -> tensor<bf16>
    %419 = stablehlo.add %414, %418 : tensor<bf16>
    %420 = stablehlo.multiply %334#46, %334#46 : tensor<12x768xbf16>
    %421 = stablehlo.convert %420 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_168 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %422 = stablehlo.reduce(%421 init: %cst_168) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %423 = stablehlo.convert %422 : (tensor<f32>) -> tensor<bf16>
    %424 = stablehlo.add %419, %423 : tensor<bf16>
    %425 = stablehlo.multiply %334#47, %334#47 : tensor<12x768x768xbf16>
    %426 = stablehlo.convert %425 : (tensor<12x768x768xbf16>) -> tensor<12x768x768xf32>
    %cst_169 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %427 = stablehlo.reduce(%426 init: %cst_169) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x768xf32>, tensor<f32>) -> tensor<f32>
    %428 = stablehlo.convert %427 : (tensor<f32>) -> tensor<bf16>
    %429 = stablehlo.add %424, %428 : tensor<bf16>
    %430 = stablehlo.multiply %334#48, %334#48 : tensor<12x768xbf16>
    %431 = stablehlo.convert %430 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_170 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %432 = stablehlo.reduce(%431 init: %cst_170) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %433 = stablehlo.convert %432 : (tensor<f32>) -> tensor<bf16>
    %434 = stablehlo.add %429, %433 : tensor<bf16>
    %435 = stablehlo.multiply %334#49, %334#49 : tensor<12x768x768xbf16>
    %436 = stablehlo.convert %435 : (tensor<12x768x768xbf16>) -> tensor<12x768x768xf32>
    %cst_171 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %437 = stablehlo.reduce(%436 init: %cst_171) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x768xf32>, tensor<f32>) -> tensor<f32>
    %438 = stablehlo.convert %437 : (tensor<f32>) -> tensor<bf16>
    %439 = stablehlo.add %434, %438 : tensor<bf16>
    %440 = stablehlo.multiply %334#50, %334#50 : tensor<12x768xbf16>
    %441 = stablehlo.convert %440 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_172 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %442 = stablehlo.reduce(%441 init: %cst_172) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %443 = stablehlo.convert %442 : (tensor<f32>) -> tensor<bf16>
    %444 = stablehlo.add %439, %443 : tensor<bf16>
    %445 = stablehlo.multiply %334#51, %334#51 : tensor<12x768x768xbf16>
    %446 = stablehlo.convert %445 : (tensor<12x768x768xbf16>) -> tensor<12x768x768xf32>
    %cst_173 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %447 = stablehlo.reduce(%446 init: %cst_173) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x768xf32>, tensor<f32>) -> tensor<f32>
    %448 = stablehlo.convert %447 : (tensor<f32>) -> tensor<bf16>
    %449 = stablehlo.add %444, %448 : tensor<bf16>
    %450 = stablehlo.multiply %334#52, %334#52 : tensor<12x768xbf16>
    %451 = stablehlo.convert %450 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_174 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %452 = stablehlo.reduce(%451 init: %cst_174) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %453 = stablehlo.convert %452 : (tensor<f32>) -> tensor<bf16>
    %454 = stablehlo.add %449, %453 : tensor<bf16>
    %455 = stablehlo.multiply %334#53, %334#53 : tensor<12x768xbf16>
    %456 = stablehlo.convert %455 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_175 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %457 = stablehlo.reduce(%456 init: %cst_175) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %458 = stablehlo.convert %457 : (tensor<f32>) -> tensor<bf16>
    %459 = stablehlo.add %454, %458 : tensor<bf16>
    %460 = stablehlo.multiply %334#54, %334#54 : tensor<12x768xbf16>
    %461 = stablehlo.convert %460 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_176 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %462 = stablehlo.reduce(%461 init: %cst_176) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %463 = stablehlo.convert %462 : (tensor<f32>) -> tensor<bf16>
    %464 = stablehlo.add %459, %463 : tensor<bf16>
    %465 = stablehlo.multiply %334#55, %334#55 : tensor<12x3072x768xbf16>
    %466 = stablehlo.convert %465 : (tensor<12x3072x768xbf16>) -> tensor<12x3072x768xf32>
    %cst_177 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %467 = stablehlo.reduce(%466 init: %cst_177) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x3072x768xf32>, tensor<f32>) -> tensor<f32>
    %468 = stablehlo.convert %467 : (tensor<f32>) -> tensor<bf16>
    %469 = stablehlo.add %464, %468 : tensor<bf16>
    %470 = stablehlo.multiply %334#56, %334#56 : tensor<12x3072xbf16>
    %471 = stablehlo.convert %470 : (tensor<12x3072xbf16>) -> tensor<12x3072xf32>
    %cst_178 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %472 = stablehlo.reduce(%471 init: %cst_178) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x3072xf32>, tensor<f32>) -> tensor<f32>
    %473 = stablehlo.convert %472 : (tensor<f32>) -> tensor<bf16>
    %474 = stablehlo.add %469, %473 : tensor<bf16>
    %475 = stablehlo.multiply %334#57, %334#57 : tensor<12x768x3072xbf16>
    %476 = stablehlo.convert %475 : (tensor<12x768x3072xbf16>) -> tensor<12x768x3072xf32>
    %cst_179 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %477 = stablehlo.reduce(%476 init: %cst_179) applies stablehlo.add across dimensions = [0, 1, 2] : (tensor<12x768x3072xf32>, tensor<f32>) -> tensor<f32>
    %478 = stablehlo.convert %477 : (tensor<f32>) -> tensor<bf16>
    %479 = stablehlo.add %474, %478 : tensor<bf16>
    %480 = stablehlo.multiply %334#58, %334#58 : tensor<12x768xbf16>
    %481 = stablehlo.convert %480 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_180 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %482 = stablehlo.reduce(%481 init: %cst_180) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %483 = stablehlo.convert %482 : (tensor<f32>) -> tensor<bf16>
    %484 = stablehlo.add %479, %483 : tensor<bf16>
    %485 = stablehlo.multiply %334#59, %334#59 : tensor<12x768xbf16>
    %486 = stablehlo.convert %485 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_181 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %487 = stablehlo.reduce(%486 init: %cst_181) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %488 = stablehlo.convert %487 : (tensor<f32>) -> tensor<bf16>
    %489 = stablehlo.add %484, %488 : tensor<bf16>
    %490 = stablehlo.multiply %334#60, %334#60 : tensor<12x768xbf16>
    %491 = stablehlo.convert %490 : (tensor<12x768xbf16>) -> tensor<12x768xf32>
    %cst_182 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %492 = stablehlo.reduce(%491 init: %cst_182) applies stablehlo.add across dimensions = [0, 1] : (tensor<12x768xf32>, tensor<f32>) -> tensor<f32>
    %493 = stablehlo.convert %492 : (tensor<f32>) -> tensor<bf16>
    %494 = stablehlo.add %489, %493 : tensor<bf16>
    %495 = stablehlo.multiply %317, %317 : tensor<768x768xbf16>
    %496 = stablehlo.convert %495 : (tensor<768x768xbf16>) -> tensor<768x768xf32>
    %cst_183 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %497 = stablehlo.reduce(%496 init: %cst_183) applies stablehlo.add across dimensions = [0, 1] : (tensor<768x768xf32>, tensor<f32>) -> tensor<f32>
    %498 = stablehlo.convert %497 : (tensor<f32>) -> tensor<bf16>
    %499 = stablehlo.add %494, %498 : tensor<bf16>
    %500 = stablehlo.multiply %313, %313 : tensor<768xbf16>
    %501 = stablehlo.convert %500 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_184 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %502 = stablehlo.reduce(%501 init: %cst_184) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %503 = stablehlo.convert %502 : (tensor<f32>) -> tensor<bf16>
    %504 = stablehlo.add %499, %503 : tensor<bf16>
    %505 = stablehlo.multiply %271, %271 : tensor<768xbf16>
    %506 = stablehlo.convert %505 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_185 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %507 = stablehlo.reduce(%506 init: %cst_185) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %508 = stablehlo.convert %507 : (tensor<f32>) -> tensor<bf16>
    %509 = stablehlo.add %504, %508 : tensor<bf16>
    %510 = stablehlo.multiply %264, %264 : tensor<768xbf16>
    %511 = stablehlo.convert %510 : (tensor<768xbf16>) -> tensor<768xf32>
    %cst_186 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %512 = stablehlo.reduce(%511 init: %cst_186) applies stablehlo.add across dimensions = [0] : (tensor<768xf32>, tensor<f32>) -> tensor<f32>
    %513 = stablehlo.convert %512 : (tensor<f32>) -> tensor<bf16>
    %514 = stablehlo.add %509, %513 : tensor<bf16>
    %515 = stablehlo.multiply %259, %259 : tensor<30522x768xbf16>
    %516 = stablehlo.convert %515 : (tensor<30522x768xbf16>) -> tensor<30522x768xf32>
    %cst_187 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %517 = stablehlo.reduce(%516 init: %cst_187) applies stablehlo.add across dimensions = [0, 1] : (tensor<30522x768xf32>, tensor<f32>) -> tensor<f32>
    %518 = stablehlo.convert %517 : (tensor<f32>) -> tensor<bf16>
    %519 = stablehlo.add %514, %518 : tensor<bf16>
    %520 = stablehlo.multiply %255, %255 : tensor<30522xbf16>
    %521 = stablehlo.convert %520 : (tensor<30522xbf16>) -> tensor<30522xf32>
    %cst_188 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %522 = stablehlo.reduce(%521 init: %cst_188) applies stablehlo.add across dimensions = [0] : (tensor<30522xf32>, tensor<f32>) -> tensor<f32>
    %523 = stablehlo.convert %522 : (tensor<f32>) -> tensor<bf16>
    %524 = stablehlo.add %519, %523 : tensor<bf16>
    %525 = stablehlo.sqrt %524 : tensor<bf16>
    %cst_189 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %526 = stablehlo.compare  LT, %525, %cst_189,  FLOAT : (tensor<bf16>, tensor<bf16>) -> tensor<i1>
    %527 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %528 = stablehlo.divide %377, %527 : tensor<30522x768xbf16>
    %cst_190 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %529 = stablehlo.broadcast_in_dim %cst_190, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %530 = stablehlo.multiply %528, %529 : tensor<30522x768xbf16>
    %531 = stablehlo.select %526, %377, %530 : tensor<i1>, tensor<30522x768xbf16>
    %532 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %533 = stablehlo.divide %376, %532 : tensor<512x768xbf16>
    %cst_191 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %534 = stablehlo.broadcast_in_dim %cst_191, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %535 = stablehlo.multiply %533, %534 : tensor<512x768xbf16>
    %536 = stablehlo.select %526, %376, %535 : tensor<i1>, tensor<512x768xbf16>
    %537 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %538 = stablehlo.divide %375, %537 : tensor<2x768xbf16>
    %cst_192 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %539 = stablehlo.broadcast_in_dim %cst_192, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %540 = stablehlo.multiply %538, %539 : tensor<2x768xbf16>
    %541 = stablehlo.select %526, %375, %540 : tensor<i1>, tensor<2x768xbf16>
    %542 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %543 = stablehlo.divide %349, %542 : tensor<768xbf16>
    %cst_193 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %544 = stablehlo.broadcast_in_dim %cst_193, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %545 = stablehlo.multiply %543, %544 : tensor<768xbf16>
    %546 = stablehlo.select %526, %349, %545 : tensor<i1>, tensor<768xbf16>
    %547 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %548 = stablehlo.divide %342, %547 : tensor<768xbf16>
    %cst_194 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %549 = stablehlo.broadcast_in_dim %cst_194, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %550 = stablehlo.multiply %548, %549 : tensor<768xbf16>
    %551 = stablehlo.select %526, %342, %550 : tensor<i1>, tensor<768xbf16>
    %552 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %553 = stablehlo.divide %334#45, %552 : tensor<12x768x768xbf16>
    %cst_195 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %554 = stablehlo.broadcast_in_dim %cst_195, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %555 = stablehlo.multiply %553, %554 : tensor<12x768x768xbf16>
    %556 = stablehlo.select %526, %334#45, %555 : tensor<i1>, tensor<12x768x768xbf16>
    %557 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %558 = stablehlo.divide %334#46, %557 : tensor<12x768xbf16>
    %cst_196 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %559 = stablehlo.broadcast_in_dim %cst_196, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %560 = stablehlo.multiply %558, %559 : tensor<12x768xbf16>
    %561 = stablehlo.select %526, %334#46, %560 : tensor<i1>, tensor<12x768xbf16>
    %562 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %563 = stablehlo.divide %334#47, %562 : tensor<12x768x768xbf16>
    %cst_197 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %564 = stablehlo.broadcast_in_dim %cst_197, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %565 = stablehlo.multiply %563, %564 : tensor<12x768x768xbf16>
    %566 = stablehlo.select %526, %334#47, %565 : tensor<i1>, tensor<12x768x768xbf16>
    %567 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %568 = stablehlo.divide %334#48, %567 : tensor<12x768xbf16>
    %cst_198 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %569 = stablehlo.broadcast_in_dim %cst_198, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %570 = stablehlo.multiply %568, %569 : tensor<12x768xbf16>
    %571 = stablehlo.select %526, %334#48, %570 : tensor<i1>, tensor<12x768xbf16>
    %572 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %573 = stablehlo.divide %334#49, %572 : tensor<12x768x768xbf16>
    %cst_199 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %574 = stablehlo.broadcast_in_dim %cst_199, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %575 = stablehlo.multiply %573, %574 : tensor<12x768x768xbf16>
    %576 = stablehlo.select %526, %334#49, %575 : tensor<i1>, tensor<12x768x768xbf16>
    %577 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %578 = stablehlo.divide %334#50, %577 : tensor<12x768xbf16>
    %cst_200 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %579 = stablehlo.broadcast_in_dim %cst_200, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %580 = stablehlo.multiply %578, %579 : tensor<12x768xbf16>
    %581 = stablehlo.select %526, %334#50, %580 : tensor<i1>, tensor<12x768xbf16>
    %582 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %583 = stablehlo.divide %334#51, %582 : tensor<12x768x768xbf16>
    %cst_201 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %584 = stablehlo.broadcast_in_dim %cst_201, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %585 = stablehlo.multiply %583, %584 : tensor<12x768x768xbf16>
    %586 = stablehlo.select %526, %334#51, %585 : tensor<i1>, tensor<12x768x768xbf16>
    %587 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %588 = stablehlo.divide %334#52, %587 : tensor<12x768xbf16>
    %cst_202 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %589 = stablehlo.broadcast_in_dim %cst_202, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %590 = stablehlo.multiply %588, %589 : tensor<12x768xbf16>
    %591 = stablehlo.select %526, %334#52, %590 : tensor<i1>, tensor<12x768xbf16>
    %592 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %593 = stablehlo.divide %334#53, %592 : tensor<12x768xbf16>
    %cst_203 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %594 = stablehlo.broadcast_in_dim %cst_203, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %595 = stablehlo.multiply %593, %594 : tensor<12x768xbf16>
    %596 = stablehlo.select %526, %334#53, %595 : tensor<i1>, tensor<12x768xbf16>
    %597 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %598 = stablehlo.divide %334#54, %597 : tensor<12x768xbf16>
    %cst_204 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %599 = stablehlo.broadcast_in_dim %cst_204, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %600 = stablehlo.multiply %598, %599 : tensor<12x768xbf16>
    %601 = stablehlo.select %526, %334#54, %600 : tensor<i1>, tensor<12x768xbf16>
    %602 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %603 = stablehlo.divide %334#55, %602 : tensor<12x3072x768xbf16>
    %cst_205 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %604 = stablehlo.broadcast_in_dim %cst_205, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %605 = stablehlo.multiply %603, %604 : tensor<12x3072x768xbf16>
    %606 = stablehlo.select %526, %334#55, %605 : tensor<i1>, tensor<12x3072x768xbf16>
    %607 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %608 = stablehlo.divide %334#56, %607 : tensor<12x3072xbf16>
    %cst_206 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %609 = stablehlo.broadcast_in_dim %cst_206, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %610 = stablehlo.multiply %608, %609 : tensor<12x3072xbf16>
    %611 = stablehlo.select %526, %334#56, %610 : tensor<i1>, tensor<12x3072xbf16>
    %612 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %613 = stablehlo.divide %334#57, %612 : tensor<12x768x3072xbf16>
    %cst_207 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %614 = stablehlo.broadcast_in_dim %cst_207, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %615 = stablehlo.multiply %613, %614 : tensor<12x768x3072xbf16>
    %616 = stablehlo.select %526, %334#57, %615 : tensor<i1>, tensor<12x768x3072xbf16>
    %617 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %618 = stablehlo.divide %334#58, %617 : tensor<12x768xbf16>
    %cst_208 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %619 = stablehlo.broadcast_in_dim %cst_208, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %620 = stablehlo.multiply %618, %619 : tensor<12x768xbf16>
    %621 = stablehlo.select %526, %334#58, %620 : tensor<i1>, tensor<12x768xbf16>
    %622 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %623 = stablehlo.divide %334#59, %622 : tensor<12x768xbf16>
    %cst_209 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %624 = stablehlo.broadcast_in_dim %cst_209, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %625 = stablehlo.multiply %623, %624 : tensor<12x768xbf16>
    %626 = stablehlo.select %526, %334#59, %625 : tensor<i1>, tensor<12x768xbf16>
    %627 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %628 = stablehlo.divide %334#60, %627 : tensor<12x768xbf16>
    %cst_210 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %629 = stablehlo.broadcast_in_dim %cst_210, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %630 = stablehlo.multiply %628, %629 : tensor<12x768xbf16>
    %631 = stablehlo.select %526, %334#60, %630 : tensor<i1>, tensor<12x768xbf16>
    %632 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %633 = stablehlo.divide %317, %632 : tensor<768x768xbf16>
    %cst_211 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %634 = stablehlo.broadcast_in_dim %cst_211, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %635 = stablehlo.multiply %633, %634 : tensor<768x768xbf16>
    %636 = stablehlo.select %526, %317, %635 : tensor<i1>, tensor<768x768xbf16>
    %637 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %638 = stablehlo.divide %313, %637 : tensor<768xbf16>
    %cst_212 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %639 = stablehlo.broadcast_in_dim %cst_212, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %640 = stablehlo.multiply %638, %639 : tensor<768xbf16>
    %641 = stablehlo.select %526, %313, %640 : tensor<i1>, tensor<768xbf16>
    %642 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %643 = stablehlo.divide %271, %642 : tensor<768xbf16>
    %cst_213 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %644 = stablehlo.broadcast_in_dim %cst_213, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %645 = stablehlo.multiply %643, %644 : tensor<768xbf16>
    %646 = stablehlo.select %526, %271, %645 : tensor<i1>, tensor<768xbf16>
    %647 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %648 = stablehlo.divide %264, %647 : tensor<768xbf16>
    %cst_214 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %649 = stablehlo.broadcast_in_dim %cst_214, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %650 = stablehlo.multiply %648, %649 : tensor<768xbf16>
    %651 = stablehlo.select %526, %264, %650 : tensor<i1>, tensor<768xbf16>
    %652 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %653 = stablehlo.divide %259, %652 : tensor<30522x768xbf16>
    %cst_215 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %654 = stablehlo.broadcast_in_dim %cst_215, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %655 = stablehlo.multiply %653, %654 : tensor<30522x768xbf16>
    %656 = stablehlo.select %526, %259, %655 : tensor<i1>, tensor<30522x768xbf16>
    %657 = stablehlo.broadcast_in_dim %525, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %658 = stablehlo.divide %255, %657 : tensor<30522xbf16>
    %cst_216 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %659 = stablehlo.broadcast_in_dim %cst_216, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %660 = stablehlo.multiply %658, %659 : tensor<30522xbf16>
    %661 = stablehlo.select %526, %255, %660 : tensor<i1>, tensor<30522xbf16>
    %cst_217 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %662 = stablehlo.broadcast_in_dim %cst_217, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %663 = stablehlo.multiply %662, %531 : tensor<30522x768xbf16>
    %cst_218 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %664 = stablehlo.broadcast_in_dim %cst_218, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %665 = stablehlo.multiply %664, %arg30 : tensor<30522x768xbf16>
    %666 = stablehlo.add %663, %665 : tensor<30522x768xbf16>
    %cst_219 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %667 = stablehlo.broadcast_in_dim %cst_219, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %668 = stablehlo.multiply %667, %536 : tensor<512x768xbf16>
    %cst_220 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %669 = stablehlo.broadcast_in_dim %cst_220, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %670 = stablehlo.multiply %669, %arg31 : tensor<512x768xbf16>
    %671 = stablehlo.add %668, %670 : tensor<512x768xbf16>
    %cst_221 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %672 = stablehlo.broadcast_in_dim %cst_221, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %673 = stablehlo.multiply %672, %541 : tensor<2x768xbf16>
    %cst_222 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %674 = stablehlo.broadcast_in_dim %cst_222, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %675 = stablehlo.multiply %674, %arg32 : tensor<2x768xbf16>
    %676 = stablehlo.add %673, %675 : tensor<2x768xbf16>
    %cst_223 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %677 = stablehlo.broadcast_in_dim %cst_223, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %678 = stablehlo.multiply %677, %546 : tensor<768xbf16>
    %cst_224 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %679 = stablehlo.broadcast_in_dim %cst_224, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %680 = stablehlo.multiply %679, %arg33 : tensor<768xbf16>
    %681 = stablehlo.add %678, %680 : tensor<768xbf16>
    %cst_225 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %682 = stablehlo.broadcast_in_dim %cst_225, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %683 = stablehlo.multiply %682, %551 : tensor<768xbf16>
    %cst_226 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %684 = stablehlo.broadcast_in_dim %cst_226, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %685 = stablehlo.multiply %684, %arg34 : tensor<768xbf16>
    %686 = stablehlo.add %683, %685 : tensor<768xbf16>
    %cst_227 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %687 = stablehlo.broadcast_in_dim %cst_227, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %688 = stablehlo.multiply %687, %556 : tensor<12x768x768xbf16>
    %cst_228 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %689 = stablehlo.broadcast_in_dim %cst_228, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %690 = stablehlo.multiply %689, %arg35 : tensor<12x768x768xbf16>
    %691 = stablehlo.add %688, %690 : tensor<12x768x768xbf16>
    %cst_229 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %692 = stablehlo.broadcast_in_dim %cst_229, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %693 = stablehlo.multiply %692, %561 : tensor<12x768xbf16>
    %cst_230 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %694 = stablehlo.broadcast_in_dim %cst_230, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %695 = stablehlo.multiply %694, %arg36 : tensor<12x768xbf16>
    %696 = stablehlo.add %693, %695 : tensor<12x768xbf16>
    %cst_231 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %697 = stablehlo.broadcast_in_dim %cst_231, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %698 = stablehlo.multiply %697, %566 : tensor<12x768x768xbf16>
    %cst_232 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %699 = stablehlo.broadcast_in_dim %cst_232, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %700 = stablehlo.multiply %699, %arg37 : tensor<12x768x768xbf16>
    %701 = stablehlo.add %698, %700 : tensor<12x768x768xbf16>
    %cst_233 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %702 = stablehlo.broadcast_in_dim %cst_233, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %703 = stablehlo.multiply %702, %571 : tensor<12x768xbf16>
    %cst_234 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %704 = stablehlo.broadcast_in_dim %cst_234, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %705 = stablehlo.multiply %704, %arg38 : tensor<12x768xbf16>
    %706 = stablehlo.add %703, %705 : tensor<12x768xbf16>
    %cst_235 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %707 = stablehlo.broadcast_in_dim %cst_235, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %708 = stablehlo.multiply %707, %576 : tensor<12x768x768xbf16>
    %cst_236 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %709 = stablehlo.broadcast_in_dim %cst_236, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %710 = stablehlo.multiply %709, %arg39 : tensor<12x768x768xbf16>
    %711 = stablehlo.add %708, %710 : tensor<12x768x768xbf16>
    %cst_237 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %712 = stablehlo.broadcast_in_dim %cst_237, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %713 = stablehlo.multiply %712, %581 : tensor<12x768xbf16>
    %cst_238 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %714 = stablehlo.broadcast_in_dim %cst_238, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %715 = stablehlo.multiply %714, %arg40 : tensor<12x768xbf16>
    %716 = stablehlo.add %713, %715 : tensor<12x768xbf16>
    %cst_239 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %717 = stablehlo.broadcast_in_dim %cst_239, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %718 = stablehlo.multiply %717, %586 : tensor<12x768x768xbf16>
    %cst_240 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %719 = stablehlo.broadcast_in_dim %cst_240, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %720 = stablehlo.multiply %719, %arg41 : tensor<12x768x768xbf16>
    %721 = stablehlo.add %718, %720 : tensor<12x768x768xbf16>
    %cst_241 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %722 = stablehlo.broadcast_in_dim %cst_241, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %723 = stablehlo.multiply %722, %591 : tensor<12x768xbf16>
    %cst_242 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %724 = stablehlo.broadcast_in_dim %cst_242, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %725 = stablehlo.multiply %724, %arg42 : tensor<12x768xbf16>
    %726 = stablehlo.add %723, %725 : tensor<12x768xbf16>
    %cst_243 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %727 = stablehlo.broadcast_in_dim %cst_243, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %728 = stablehlo.multiply %727, %596 : tensor<12x768xbf16>
    %cst_244 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %729 = stablehlo.broadcast_in_dim %cst_244, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %730 = stablehlo.multiply %729, %arg43 : tensor<12x768xbf16>
    %731 = stablehlo.add %728, %730 : tensor<12x768xbf16>
    %cst_245 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %732 = stablehlo.broadcast_in_dim %cst_245, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %733 = stablehlo.multiply %732, %601 : tensor<12x768xbf16>
    %cst_246 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %734 = stablehlo.broadcast_in_dim %cst_246, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %735 = stablehlo.multiply %734, %arg44 : tensor<12x768xbf16>
    %736 = stablehlo.add %733, %735 : tensor<12x768xbf16>
    %cst_247 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %737 = stablehlo.broadcast_in_dim %cst_247, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %738 = stablehlo.multiply %737, %606 : tensor<12x3072x768xbf16>
    %cst_248 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %739 = stablehlo.broadcast_in_dim %cst_248, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %740 = stablehlo.multiply %739, %arg45 : tensor<12x3072x768xbf16>
    %741 = stablehlo.add %738, %740 : tensor<12x3072x768xbf16>
    %cst_249 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %742 = stablehlo.broadcast_in_dim %cst_249, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %743 = stablehlo.multiply %742, %611 : tensor<12x3072xbf16>
    %cst_250 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %744 = stablehlo.broadcast_in_dim %cst_250, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %745 = stablehlo.multiply %744, %arg46 : tensor<12x3072xbf16>
    %746 = stablehlo.add %743, %745 : tensor<12x3072xbf16>
    %cst_251 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %747 = stablehlo.broadcast_in_dim %cst_251, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %748 = stablehlo.multiply %747, %616 : tensor<12x768x3072xbf16>
    %cst_252 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %749 = stablehlo.broadcast_in_dim %cst_252, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %750 = stablehlo.multiply %749, %arg47 : tensor<12x768x3072xbf16>
    %751 = stablehlo.add %748, %750 : tensor<12x768x3072xbf16>
    %cst_253 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %752 = stablehlo.broadcast_in_dim %cst_253, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %753 = stablehlo.multiply %752, %621 : tensor<12x768xbf16>
    %cst_254 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %754 = stablehlo.broadcast_in_dim %cst_254, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %755 = stablehlo.multiply %754, %arg48 : tensor<12x768xbf16>
    %756 = stablehlo.add %753, %755 : tensor<12x768xbf16>
    %cst_255 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %757 = stablehlo.broadcast_in_dim %cst_255, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %758 = stablehlo.multiply %757, %626 : tensor<12x768xbf16>
    %cst_256 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %759 = stablehlo.broadcast_in_dim %cst_256, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %760 = stablehlo.multiply %759, %arg49 : tensor<12x768xbf16>
    %761 = stablehlo.add %758, %760 : tensor<12x768xbf16>
    %cst_257 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %762 = stablehlo.broadcast_in_dim %cst_257, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %763 = stablehlo.multiply %762, %631 : tensor<12x768xbf16>
    %cst_258 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %764 = stablehlo.broadcast_in_dim %cst_258, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %765 = stablehlo.multiply %764, %arg50 : tensor<12x768xbf16>
    %766 = stablehlo.add %763, %765 : tensor<12x768xbf16>
    %cst_259 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %767 = stablehlo.broadcast_in_dim %cst_259, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %768 = stablehlo.multiply %767, %636 : tensor<768x768xbf16>
    %cst_260 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %769 = stablehlo.broadcast_in_dim %cst_260, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %770 = stablehlo.multiply %769, %arg51 : tensor<768x768xbf16>
    %771 = stablehlo.add %768, %770 : tensor<768x768xbf16>
    %cst_261 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %772 = stablehlo.broadcast_in_dim %cst_261, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %773 = stablehlo.multiply %772, %641 : tensor<768xbf16>
    %cst_262 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %774 = stablehlo.broadcast_in_dim %cst_262, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %775 = stablehlo.multiply %774, %arg52 : tensor<768xbf16>
    %776 = stablehlo.add %773, %775 : tensor<768xbf16>
    %cst_263 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %777 = stablehlo.broadcast_in_dim %cst_263, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %778 = stablehlo.multiply %777, %646 : tensor<768xbf16>
    %cst_264 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %779 = stablehlo.broadcast_in_dim %cst_264, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %780 = stablehlo.multiply %779, %arg53 : tensor<768xbf16>
    %781 = stablehlo.add %778, %780 : tensor<768xbf16>
    %cst_265 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %782 = stablehlo.broadcast_in_dim %cst_265, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %783 = stablehlo.multiply %782, %651 : tensor<768xbf16>
    %cst_266 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %784 = stablehlo.broadcast_in_dim %cst_266, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %785 = stablehlo.multiply %784, %arg54 : tensor<768xbf16>
    %786 = stablehlo.add %783, %785 : tensor<768xbf16>
    %cst_267 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %787 = stablehlo.broadcast_in_dim %cst_267, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %788 = stablehlo.multiply %787, %656 : tensor<30522x768xbf16>
    %cst_268 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %789 = stablehlo.broadcast_in_dim %cst_268, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %790 = stablehlo.multiply %789, %arg55 : tensor<30522x768xbf16>
    %791 = stablehlo.add %788, %790 : tensor<30522x768xbf16>
    %cst_269 = stablehlo.constant dense<1.000980e-01> : tensor<bf16>
    %792 = stablehlo.broadcast_in_dim %cst_269, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %793 = stablehlo.multiply %792, %661 : tensor<30522xbf16>
    %cst_270 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %794 = stablehlo.broadcast_in_dim %cst_270, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %795 = stablehlo.multiply %794, %arg56 : tensor<30522xbf16>
    %796 = stablehlo.add %793, %795 : tensor<30522xbf16>
    %797 = stablehlo.multiply %531, %531 : tensor<30522x768xbf16>
    %cst_271 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %798 = stablehlo.broadcast_in_dim %cst_271, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %799 = stablehlo.multiply %798, %797 : tensor<30522x768xbf16>
    %cst_272 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %800 = stablehlo.broadcast_in_dim %cst_272, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %801 = stablehlo.multiply %800, %arg57 : tensor<30522x768xbf16>
    %802 = stablehlo.add %799, %801 : tensor<30522x768xbf16>
    %803 = stablehlo.multiply %536, %536 : tensor<512x768xbf16>
    %cst_273 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %804 = stablehlo.broadcast_in_dim %cst_273, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %805 = stablehlo.multiply %804, %803 : tensor<512x768xbf16>
    %cst_274 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %806 = stablehlo.broadcast_in_dim %cst_274, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %807 = stablehlo.multiply %806, %arg58 : tensor<512x768xbf16>
    %808 = stablehlo.add %805, %807 : tensor<512x768xbf16>
    %809 = stablehlo.multiply %541, %541 : tensor<2x768xbf16>
    %cst_275 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %810 = stablehlo.broadcast_in_dim %cst_275, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %811 = stablehlo.multiply %810, %809 : tensor<2x768xbf16>
    %cst_276 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %812 = stablehlo.broadcast_in_dim %cst_276, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %813 = stablehlo.multiply %812, %arg59 : tensor<2x768xbf16>
    %814 = stablehlo.add %811, %813 : tensor<2x768xbf16>
    %815 = stablehlo.multiply %546, %546 : tensor<768xbf16>
    %cst_277 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %816 = stablehlo.broadcast_in_dim %cst_277, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %817 = stablehlo.multiply %816, %815 : tensor<768xbf16>
    %cst_278 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %818 = stablehlo.broadcast_in_dim %cst_278, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %819 = stablehlo.multiply %818, %arg60 : tensor<768xbf16>
    %820 = stablehlo.add %817, %819 : tensor<768xbf16>
    %821 = stablehlo.multiply %551, %551 : tensor<768xbf16>
    %cst_279 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %822 = stablehlo.broadcast_in_dim %cst_279, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %823 = stablehlo.multiply %822, %821 : tensor<768xbf16>
    %cst_280 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %824 = stablehlo.broadcast_in_dim %cst_280, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %825 = stablehlo.multiply %824, %arg61 : tensor<768xbf16>
    %826 = stablehlo.add %823, %825 : tensor<768xbf16>
    %827 = stablehlo.multiply %556, %556 : tensor<12x768x768xbf16>
    %cst_281 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %828 = stablehlo.broadcast_in_dim %cst_281, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %829 = stablehlo.multiply %828, %827 : tensor<12x768x768xbf16>
    %cst_282 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %830 = stablehlo.broadcast_in_dim %cst_282, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %831 = stablehlo.multiply %830, %arg62 : tensor<12x768x768xbf16>
    %832 = stablehlo.add %829, %831 : tensor<12x768x768xbf16>
    %833 = stablehlo.multiply %561, %561 : tensor<12x768xbf16>
    %cst_283 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %834 = stablehlo.broadcast_in_dim %cst_283, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %835 = stablehlo.multiply %834, %833 : tensor<12x768xbf16>
    %cst_284 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %836 = stablehlo.broadcast_in_dim %cst_284, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %837 = stablehlo.multiply %836, %arg63 : tensor<12x768xbf16>
    %838 = stablehlo.add %835, %837 : tensor<12x768xbf16>
    %839 = stablehlo.multiply %566, %566 : tensor<12x768x768xbf16>
    %cst_285 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %840 = stablehlo.broadcast_in_dim %cst_285, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %841 = stablehlo.multiply %840, %839 : tensor<12x768x768xbf16>
    %cst_286 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %842 = stablehlo.broadcast_in_dim %cst_286, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %843 = stablehlo.multiply %842, %arg64 : tensor<12x768x768xbf16>
    %844 = stablehlo.add %841, %843 : tensor<12x768x768xbf16>
    %845 = stablehlo.multiply %571, %571 : tensor<12x768xbf16>
    %cst_287 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %846 = stablehlo.broadcast_in_dim %cst_287, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %847 = stablehlo.multiply %846, %845 : tensor<12x768xbf16>
    %cst_288 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %848 = stablehlo.broadcast_in_dim %cst_288, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %849 = stablehlo.multiply %848, %arg65 : tensor<12x768xbf16>
    %850 = stablehlo.add %847, %849 : tensor<12x768xbf16>
    %851 = stablehlo.multiply %576, %576 : tensor<12x768x768xbf16>
    %cst_289 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %852 = stablehlo.broadcast_in_dim %cst_289, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %853 = stablehlo.multiply %852, %851 : tensor<12x768x768xbf16>
    %cst_290 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %854 = stablehlo.broadcast_in_dim %cst_290, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %855 = stablehlo.multiply %854, %arg66 : tensor<12x768x768xbf16>
    %856 = stablehlo.add %853, %855 : tensor<12x768x768xbf16>
    %857 = stablehlo.multiply %581, %581 : tensor<12x768xbf16>
    %cst_291 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %858 = stablehlo.broadcast_in_dim %cst_291, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %859 = stablehlo.multiply %858, %857 : tensor<12x768xbf16>
    %cst_292 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %860 = stablehlo.broadcast_in_dim %cst_292, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %861 = stablehlo.multiply %860, %arg67 : tensor<12x768xbf16>
    %862 = stablehlo.add %859, %861 : tensor<12x768xbf16>
    %863 = stablehlo.multiply %586, %586 : tensor<12x768x768xbf16>
    %cst_293 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %864 = stablehlo.broadcast_in_dim %cst_293, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %865 = stablehlo.multiply %864, %863 : tensor<12x768x768xbf16>
    %cst_294 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %866 = stablehlo.broadcast_in_dim %cst_294, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %867 = stablehlo.multiply %866, %arg68 : tensor<12x768x768xbf16>
    %868 = stablehlo.add %865, %867 : tensor<12x768x768xbf16>
    %869 = stablehlo.multiply %591, %591 : tensor<12x768xbf16>
    %cst_295 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %870 = stablehlo.broadcast_in_dim %cst_295, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %871 = stablehlo.multiply %870, %869 : tensor<12x768xbf16>
    %cst_296 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %872 = stablehlo.broadcast_in_dim %cst_296, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %873 = stablehlo.multiply %872, %arg69 : tensor<12x768xbf16>
    %874 = stablehlo.add %871, %873 : tensor<12x768xbf16>
    %875 = stablehlo.multiply %596, %596 : tensor<12x768xbf16>
    %cst_297 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %876 = stablehlo.broadcast_in_dim %cst_297, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %877 = stablehlo.multiply %876, %875 : tensor<12x768xbf16>
    %cst_298 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %878 = stablehlo.broadcast_in_dim %cst_298, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %879 = stablehlo.multiply %878, %arg70 : tensor<12x768xbf16>
    %880 = stablehlo.add %877, %879 : tensor<12x768xbf16>
    %881 = stablehlo.multiply %601, %601 : tensor<12x768xbf16>
    %cst_299 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %882 = stablehlo.broadcast_in_dim %cst_299, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %883 = stablehlo.multiply %882, %881 : tensor<12x768xbf16>
    %cst_300 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %884 = stablehlo.broadcast_in_dim %cst_300, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %885 = stablehlo.multiply %884, %arg71 : tensor<12x768xbf16>
    %886 = stablehlo.add %883, %885 : tensor<12x768xbf16>
    %887 = stablehlo.multiply %606, %606 : tensor<12x3072x768xbf16>
    %cst_301 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %888 = stablehlo.broadcast_in_dim %cst_301, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %889 = stablehlo.multiply %888, %887 : tensor<12x3072x768xbf16>
    %cst_302 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %890 = stablehlo.broadcast_in_dim %cst_302, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %891 = stablehlo.multiply %890, %arg72 : tensor<12x3072x768xbf16>
    %892 = stablehlo.add %889, %891 : tensor<12x3072x768xbf16>
    %893 = stablehlo.multiply %611, %611 : tensor<12x3072xbf16>
    %cst_303 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %894 = stablehlo.broadcast_in_dim %cst_303, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %895 = stablehlo.multiply %894, %893 : tensor<12x3072xbf16>
    %cst_304 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %896 = stablehlo.broadcast_in_dim %cst_304, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %897 = stablehlo.multiply %896, %arg73 : tensor<12x3072xbf16>
    %898 = stablehlo.add %895, %897 : tensor<12x3072xbf16>
    %899 = stablehlo.multiply %616, %616 : tensor<12x768x3072xbf16>
    %cst_305 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %900 = stablehlo.broadcast_in_dim %cst_305, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %901 = stablehlo.multiply %900, %899 : tensor<12x768x3072xbf16>
    %cst_306 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %902 = stablehlo.broadcast_in_dim %cst_306, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %903 = stablehlo.multiply %902, %arg74 : tensor<12x768x3072xbf16>
    %904 = stablehlo.add %901, %903 : tensor<12x768x3072xbf16>
    %905 = stablehlo.multiply %621, %621 : tensor<12x768xbf16>
    %cst_307 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %906 = stablehlo.broadcast_in_dim %cst_307, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %907 = stablehlo.multiply %906, %905 : tensor<12x768xbf16>
    %cst_308 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %908 = stablehlo.broadcast_in_dim %cst_308, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %909 = stablehlo.multiply %908, %arg75 : tensor<12x768xbf16>
    %910 = stablehlo.add %907, %909 : tensor<12x768xbf16>
    %911 = stablehlo.multiply %626, %626 : tensor<12x768xbf16>
    %cst_309 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %912 = stablehlo.broadcast_in_dim %cst_309, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %913 = stablehlo.multiply %912, %911 : tensor<12x768xbf16>
    %cst_310 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %914 = stablehlo.broadcast_in_dim %cst_310, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %915 = stablehlo.multiply %914, %arg76 : tensor<12x768xbf16>
    %916 = stablehlo.add %913, %915 : tensor<12x768xbf16>
    %917 = stablehlo.multiply %631, %631 : tensor<12x768xbf16>
    %cst_311 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %918 = stablehlo.broadcast_in_dim %cst_311, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %919 = stablehlo.multiply %918, %917 : tensor<12x768xbf16>
    %cst_312 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %920 = stablehlo.broadcast_in_dim %cst_312, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %921 = stablehlo.multiply %920, %arg77 : tensor<12x768xbf16>
    %922 = stablehlo.add %919, %921 : tensor<12x768xbf16>
    %923 = stablehlo.multiply %636, %636 : tensor<768x768xbf16>
    %cst_313 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %924 = stablehlo.broadcast_in_dim %cst_313, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %925 = stablehlo.multiply %924, %923 : tensor<768x768xbf16>
    %cst_314 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %926 = stablehlo.broadcast_in_dim %cst_314, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %927 = stablehlo.multiply %926, %arg78 : tensor<768x768xbf16>
    %928 = stablehlo.add %925, %927 : tensor<768x768xbf16>
    %929 = stablehlo.multiply %641, %641 : tensor<768xbf16>
    %cst_315 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %930 = stablehlo.broadcast_in_dim %cst_315, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %931 = stablehlo.multiply %930, %929 : tensor<768xbf16>
    %cst_316 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %932 = stablehlo.broadcast_in_dim %cst_316, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %933 = stablehlo.multiply %932, %arg79 : tensor<768xbf16>
    %934 = stablehlo.add %931, %933 : tensor<768xbf16>
    %935 = stablehlo.multiply %646, %646 : tensor<768xbf16>
    %cst_317 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %936 = stablehlo.broadcast_in_dim %cst_317, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %937 = stablehlo.multiply %936, %935 : tensor<768xbf16>
    %cst_318 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %938 = stablehlo.broadcast_in_dim %cst_318, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %939 = stablehlo.multiply %938, %arg80 : tensor<768xbf16>
    %940 = stablehlo.add %937, %939 : tensor<768xbf16>
    %941 = stablehlo.multiply %651, %651 : tensor<768xbf16>
    %cst_319 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %942 = stablehlo.broadcast_in_dim %cst_319, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %943 = stablehlo.multiply %942, %941 : tensor<768xbf16>
    %cst_320 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %944 = stablehlo.broadcast_in_dim %cst_320, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %945 = stablehlo.multiply %944, %arg81 : tensor<768xbf16>
    %946 = stablehlo.add %943, %945 : tensor<768xbf16>
    %947 = stablehlo.multiply %656, %656 : tensor<30522x768xbf16>
    %cst_321 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %948 = stablehlo.broadcast_in_dim %cst_321, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %949 = stablehlo.multiply %948, %947 : tensor<30522x768xbf16>
    %cst_322 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %950 = stablehlo.broadcast_in_dim %cst_322, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %951 = stablehlo.multiply %950, %arg82 : tensor<30522x768xbf16>
    %952 = stablehlo.add %949, %951 : tensor<30522x768xbf16>
    %953 = stablehlo.multiply %661, %661 : tensor<30522xbf16>
    %cst_323 = stablehlo.constant dense<5.004880e-02> : tensor<bf16>
    %954 = stablehlo.broadcast_in_dim %cst_323, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %955 = stablehlo.multiply %954, %953 : tensor<30522xbf16>
    %cst_324 = stablehlo.constant dense<9.492180e-01> : tensor<bf16>
    %956 = stablehlo.broadcast_in_dim %cst_324, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %957 = stablehlo.multiply %956, %arg83 : tensor<30522xbf16>
    %958 = stablehlo.add %955, %957 : tensor<30522xbf16>
    %c_325 = stablehlo.constant dense<2147483647> : tensor<i32>
    %959 = stablehlo.compare  LT, %arg29, %c_325,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
    %c_326 = stablehlo.constant dense<1> : tensor<i32>
    %960 = stablehlo.add %arg29, %c_326 : tensor<i32>
    %c_327 = stablehlo.constant dense<2147483647> : tensor<i32>
    %961 = call @_where_385(%959, %960, %c_327) : (tensor<i1>, tensor<i32>, tensor<i32>) -> tensor<i32>
    %cst_328 = stablehlo.constant dense<0.899999976> : tensor<f32>
    %962 = stablehlo.convert %961 : (tensor<i32>) -> tensor<f32>
    %963 = stablehlo.power %cst_328, %962 : tensor<f32>
    %cst_329 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %964 = stablehlo.subtract %cst_329, %963 : tensor<f32>
    %965 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %966 = stablehlo.broadcast_in_dim %965, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %967 = stablehlo.divide %666, %966 : tensor<30522x768xbf16>
    %968 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %969 = stablehlo.broadcast_in_dim %968, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %970 = stablehlo.divide %671, %969 : tensor<512x768xbf16>
    %971 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %972 = stablehlo.broadcast_in_dim %971, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %973 = stablehlo.divide %676, %972 : tensor<2x768xbf16>
    %974 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %975 = stablehlo.broadcast_in_dim %974, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %976 = stablehlo.divide %681, %975 : tensor<768xbf16>
    %977 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %978 = stablehlo.broadcast_in_dim %977, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %979 = stablehlo.divide %686, %978 : tensor<768xbf16>
    %980 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %981 = stablehlo.broadcast_in_dim %980, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %982 = stablehlo.divide %691, %981 : tensor<12x768x768xbf16>
    %983 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %984 = stablehlo.broadcast_in_dim %983, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %985 = stablehlo.divide %696, %984 : tensor<12x768xbf16>
    %986 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %987 = stablehlo.broadcast_in_dim %986, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %988 = stablehlo.divide %701, %987 : tensor<12x768x768xbf16>
    %989 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %990 = stablehlo.broadcast_in_dim %989, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %991 = stablehlo.divide %706, %990 : tensor<12x768xbf16>
    %992 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %993 = stablehlo.broadcast_in_dim %992, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %994 = stablehlo.divide %711, %993 : tensor<12x768x768xbf16>
    %995 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %996 = stablehlo.broadcast_in_dim %995, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %997 = stablehlo.divide %716, %996 : tensor<12x768xbf16>
    %998 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %999 = stablehlo.broadcast_in_dim %998, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1000 = stablehlo.divide %721, %999 : tensor<12x768x768xbf16>
    %1001 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1002 = stablehlo.broadcast_in_dim %1001, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1003 = stablehlo.divide %726, %1002 : tensor<12x768xbf16>
    %1004 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1005 = stablehlo.broadcast_in_dim %1004, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1006 = stablehlo.divide %731, %1005 : tensor<12x768xbf16>
    %1007 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1008 = stablehlo.broadcast_in_dim %1007, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1009 = stablehlo.divide %736, %1008 : tensor<12x768xbf16>
    %1010 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1011 = stablehlo.broadcast_in_dim %1010, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1012 = stablehlo.divide %741, %1011 : tensor<12x3072x768xbf16>
    %1013 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1014 = stablehlo.broadcast_in_dim %1013, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1015 = stablehlo.divide %746, %1014 : tensor<12x3072xbf16>
    %1016 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1017 = stablehlo.broadcast_in_dim %1016, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1018 = stablehlo.divide %751, %1017 : tensor<12x768x3072xbf16>
    %1019 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1020 = stablehlo.broadcast_in_dim %1019, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1021 = stablehlo.divide %756, %1020 : tensor<12x768xbf16>
    %1022 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1023 = stablehlo.broadcast_in_dim %1022, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1024 = stablehlo.divide %761, %1023 : tensor<12x768xbf16>
    %1025 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1026 = stablehlo.broadcast_in_dim %1025, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1027 = stablehlo.divide %766, %1026 : tensor<12x768xbf16>
    %1028 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1029 = stablehlo.broadcast_in_dim %1028, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1030 = stablehlo.divide %771, %1029 : tensor<768x768xbf16>
    %1031 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1032 = stablehlo.broadcast_in_dim %1031, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1033 = stablehlo.divide %776, %1032 : tensor<768xbf16>
    %1034 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1035 = stablehlo.broadcast_in_dim %1034, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1036 = stablehlo.divide %781, %1035 : tensor<768xbf16>
    %1037 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1038 = stablehlo.broadcast_in_dim %1037, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1039 = stablehlo.divide %786, %1038 : tensor<768xbf16>
    %1040 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1041 = stablehlo.broadcast_in_dim %1040, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1042 = stablehlo.divide %791, %1041 : tensor<30522x768xbf16>
    %1043 = stablehlo.convert %964 : (tensor<f32>) -> tensor<bf16>
    %1044 = stablehlo.broadcast_in_dim %1043, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1045 = stablehlo.divide %796, %1044 : tensor<30522xbf16>
    %cst_330 = stablehlo.constant dense<0.949999988> : tensor<f32>
    %1046 = stablehlo.convert %961 : (tensor<i32>) -> tensor<f32>
    %1047 = stablehlo.power %cst_330, %1046 : tensor<f32>
    %cst_331 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %1048 = stablehlo.subtract %cst_331, %1047 : tensor<f32>
    %1049 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1050 = stablehlo.broadcast_in_dim %1049, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1051 = stablehlo.divide %802, %1050 : tensor<30522x768xbf16>
    %1052 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1053 = stablehlo.broadcast_in_dim %1052, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1054 = stablehlo.divide %808, %1053 : tensor<512x768xbf16>
    %1055 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1056 = stablehlo.broadcast_in_dim %1055, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1057 = stablehlo.divide %814, %1056 : tensor<2x768xbf16>
    %1058 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1059 = stablehlo.broadcast_in_dim %1058, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1060 = stablehlo.divide %820, %1059 : tensor<768xbf16>
    %1061 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1062 = stablehlo.broadcast_in_dim %1061, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1063 = stablehlo.divide %826, %1062 : tensor<768xbf16>
    %1064 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1065 = stablehlo.broadcast_in_dim %1064, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1066 = stablehlo.divide %832, %1065 : tensor<12x768x768xbf16>
    %1067 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1068 = stablehlo.broadcast_in_dim %1067, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1069 = stablehlo.divide %838, %1068 : tensor<12x768xbf16>
    %1070 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1071 = stablehlo.broadcast_in_dim %1070, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1072 = stablehlo.divide %844, %1071 : tensor<12x768x768xbf16>
    %1073 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1074 = stablehlo.broadcast_in_dim %1073, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1075 = stablehlo.divide %850, %1074 : tensor<12x768xbf16>
    %1076 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1077 = stablehlo.broadcast_in_dim %1076, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1078 = stablehlo.divide %856, %1077 : tensor<12x768x768xbf16>
    %1079 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1080 = stablehlo.broadcast_in_dim %1079, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1081 = stablehlo.divide %862, %1080 : tensor<12x768xbf16>
    %1082 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1083 = stablehlo.broadcast_in_dim %1082, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1084 = stablehlo.divide %868, %1083 : tensor<12x768x768xbf16>
    %1085 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1086 = stablehlo.broadcast_in_dim %1085, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1087 = stablehlo.divide %874, %1086 : tensor<12x768xbf16>
    %1088 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1089 = stablehlo.broadcast_in_dim %1088, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1090 = stablehlo.divide %880, %1089 : tensor<12x768xbf16>
    %1091 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1092 = stablehlo.broadcast_in_dim %1091, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1093 = stablehlo.divide %886, %1092 : tensor<12x768xbf16>
    %1094 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1095 = stablehlo.broadcast_in_dim %1094, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1096 = stablehlo.divide %892, %1095 : tensor<12x3072x768xbf16>
    %1097 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1098 = stablehlo.broadcast_in_dim %1097, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1099 = stablehlo.divide %898, %1098 : tensor<12x3072xbf16>
    %1100 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1101 = stablehlo.broadcast_in_dim %1100, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1102 = stablehlo.divide %904, %1101 : tensor<12x768x3072xbf16>
    %1103 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1104 = stablehlo.broadcast_in_dim %1103, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1105 = stablehlo.divide %910, %1104 : tensor<12x768xbf16>
    %1106 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1107 = stablehlo.broadcast_in_dim %1106, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1108 = stablehlo.divide %916, %1107 : tensor<12x768xbf16>
    %1109 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1110 = stablehlo.broadcast_in_dim %1109, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1111 = stablehlo.divide %922, %1110 : tensor<12x768xbf16>
    %1112 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1113 = stablehlo.broadcast_in_dim %1112, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1114 = stablehlo.divide %928, %1113 : tensor<768x768xbf16>
    %1115 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1116 = stablehlo.broadcast_in_dim %1115, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1117 = stablehlo.divide %934, %1116 : tensor<768xbf16>
    %1118 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1119 = stablehlo.broadcast_in_dim %1118, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1120 = stablehlo.divide %940, %1119 : tensor<768xbf16>
    %1121 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1122 = stablehlo.broadcast_in_dim %1121, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1123 = stablehlo.divide %946, %1122 : tensor<768xbf16>
    %1124 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1125 = stablehlo.broadcast_in_dim %1124, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1126 = stablehlo.divide %952, %1125 : tensor<30522x768xbf16>
    %1127 = stablehlo.convert %1048 : (tensor<f32>) -> tensor<bf16>
    %1128 = stablehlo.broadcast_in_dim %1127, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1129 = stablehlo.divide %958, %1128 : tensor<30522xbf16>
    %cst_332 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1130 = stablehlo.broadcast_in_dim %cst_332, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1131 = stablehlo.add %1051, %1130 : tensor<30522x768xbf16>
    %1132 = stablehlo.sqrt %1131 : tensor<30522x768xbf16>
    %cst_333 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1133 = stablehlo.broadcast_in_dim %cst_333, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1134 = stablehlo.add %1132, %1133 : tensor<30522x768xbf16>
    %1135 = stablehlo.divide %967, %1134 : tensor<30522x768xbf16>
    %cst_334 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1136 = stablehlo.broadcast_in_dim %cst_334, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1137 = stablehlo.add %1054, %1136 : tensor<512x768xbf16>
    %1138 = stablehlo.sqrt %1137 : tensor<512x768xbf16>
    %cst_335 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1139 = stablehlo.broadcast_in_dim %cst_335, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1140 = stablehlo.add %1138, %1139 : tensor<512x768xbf16>
    %1141 = stablehlo.divide %970, %1140 : tensor<512x768xbf16>
    %cst_336 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1142 = stablehlo.broadcast_in_dim %cst_336, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1143 = stablehlo.add %1057, %1142 : tensor<2x768xbf16>
    %1144 = stablehlo.sqrt %1143 : tensor<2x768xbf16>
    %cst_337 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1145 = stablehlo.broadcast_in_dim %cst_337, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1146 = stablehlo.add %1144, %1145 : tensor<2x768xbf16>
    %1147 = stablehlo.divide %973, %1146 : tensor<2x768xbf16>
    %cst_338 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1148 = stablehlo.broadcast_in_dim %cst_338, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1149 = stablehlo.add %1060, %1148 : tensor<768xbf16>
    %1150 = stablehlo.sqrt %1149 : tensor<768xbf16>
    %cst_339 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1151 = stablehlo.broadcast_in_dim %cst_339, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1152 = stablehlo.add %1150, %1151 : tensor<768xbf16>
    %1153 = stablehlo.divide %976, %1152 : tensor<768xbf16>
    %cst_340 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1154 = stablehlo.broadcast_in_dim %cst_340, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1155 = stablehlo.add %1063, %1154 : tensor<768xbf16>
    %1156 = stablehlo.sqrt %1155 : tensor<768xbf16>
    %cst_341 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1157 = stablehlo.broadcast_in_dim %cst_341, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1158 = stablehlo.add %1156, %1157 : tensor<768xbf16>
    %1159 = stablehlo.divide %979, %1158 : tensor<768xbf16>
    %cst_342 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1160 = stablehlo.broadcast_in_dim %cst_342, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1161 = stablehlo.add %1066, %1160 : tensor<12x768x768xbf16>
    %1162 = stablehlo.sqrt %1161 : tensor<12x768x768xbf16>
    %cst_343 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1163 = stablehlo.broadcast_in_dim %cst_343, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1164 = stablehlo.add %1162, %1163 : tensor<12x768x768xbf16>
    %1165 = stablehlo.divide %982, %1164 : tensor<12x768x768xbf16>
    %cst_344 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1166 = stablehlo.broadcast_in_dim %cst_344, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1167 = stablehlo.add %1069, %1166 : tensor<12x768xbf16>
    %1168 = stablehlo.sqrt %1167 : tensor<12x768xbf16>
    %cst_345 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1169 = stablehlo.broadcast_in_dim %cst_345, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1170 = stablehlo.add %1168, %1169 : tensor<12x768xbf16>
    %1171 = stablehlo.divide %985, %1170 : tensor<12x768xbf16>
    %cst_346 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1172 = stablehlo.broadcast_in_dim %cst_346, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1173 = stablehlo.add %1072, %1172 : tensor<12x768x768xbf16>
    %1174 = stablehlo.sqrt %1173 : tensor<12x768x768xbf16>
    %cst_347 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1175 = stablehlo.broadcast_in_dim %cst_347, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1176 = stablehlo.add %1174, %1175 : tensor<12x768x768xbf16>
    %1177 = stablehlo.divide %988, %1176 : tensor<12x768x768xbf16>
    %cst_348 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1178 = stablehlo.broadcast_in_dim %cst_348, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1179 = stablehlo.add %1075, %1178 : tensor<12x768xbf16>
    %1180 = stablehlo.sqrt %1179 : tensor<12x768xbf16>
    %cst_349 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1181 = stablehlo.broadcast_in_dim %cst_349, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1182 = stablehlo.add %1180, %1181 : tensor<12x768xbf16>
    %1183 = stablehlo.divide %991, %1182 : tensor<12x768xbf16>
    %cst_350 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1184 = stablehlo.broadcast_in_dim %cst_350, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1185 = stablehlo.add %1078, %1184 : tensor<12x768x768xbf16>
    %1186 = stablehlo.sqrt %1185 : tensor<12x768x768xbf16>
    %cst_351 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1187 = stablehlo.broadcast_in_dim %cst_351, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1188 = stablehlo.add %1186, %1187 : tensor<12x768x768xbf16>
    %1189 = stablehlo.divide %994, %1188 : tensor<12x768x768xbf16>
    %cst_352 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1190 = stablehlo.broadcast_in_dim %cst_352, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1191 = stablehlo.add %1081, %1190 : tensor<12x768xbf16>
    %1192 = stablehlo.sqrt %1191 : tensor<12x768xbf16>
    %cst_353 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1193 = stablehlo.broadcast_in_dim %cst_353, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1194 = stablehlo.add %1192, %1193 : tensor<12x768xbf16>
    %1195 = stablehlo.divide %997, %1194 : tensor<12x768xbf16>
    %cst_354 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1196 = stablehlo.broadcast_in_dim %cst_354, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1197 = stablehlo.add %1084, %1196 : tensor<12x768x768xbf16>
    %1198 = stablehlo.sqrt %1197 : tensor<12x768x768xbf16>
    %cst_355 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1199 = stablehlo.broadcast_in_dim %cst_355, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1200 = stablehlo.add %1198, %1199 : tensor<12x768x768xbf16>
    %1201 = stablehlo.divide %1000, %1200 : tensor<12x768x768xbf16>
    %cst_356 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1202 = stablehlo.broadcast_in_dim %cst_356, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1203 = stablehlo.add %1087, %1202 : tensor<12x768xbf16>
    %1204 = stablehlo.sqrt %1203 : tensor<12x768xbf16>
    %cst_357 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1205 = stablehlo.broadcast_in_dim %cst_357, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1206 = stablehlo.add %1204, %1205 : tensor<12x768xbf16>
    %1207 = stablehlo.divide %1003, %1206 : tensor<12x768xbf16>
    %cst_358 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1208 = stablehlo.broadcast_in_dim %cst_358, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1209 = stablehlo.add %1090, %1208 : tensor<12x768xbf16>
    %1210 = stablehlo.sqrt %1209 : tensor<12x768xbf16>
    %cst_359 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1211 = stablehlo.broadcast_in_dim %cst_359, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1212 = stablehlo.add %1210, %1211 : tensor<12x768xbf16>
    %1213 = stablehlo.divide %1006, %1212 : tensor<12x768xbf16>
    %cst_360 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1214 = stablehlo.broadcast_in_dim %cst_360, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1215 = stablehlo.add %1093, %1214 : tensor<12x768xbf16>
    %1216 = stablehlo.sqrt %1215 : tensor<12x768xbf16>
    %cst_361 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1217 = stablehlo.broadcast_in_dim %cst_361, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1218 = stablehlo.add %1216, %1217 : tensor<12x768xbf16>
    %1219 = stablehlo.divide %1009, %1218 : tensor<12x768xbf16>
    %cst_362 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1220 = stablehlo.broadcast_in_dim %cst_362, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1221 = stablehlo.add %1096, %1220 : tensor<12x3072x768xbf16>
    %1222 = stablehlo.sqrt %1221 : tensor<12x3072x768xbf16>
    %cst_363 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1223 = stablehlo.broadcast_in_dim %cst_363, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1224 = stablehlo.add %1222, %1223 : tensor<12x3072x768xbf16>
    %1225 = stablehlo.divide %1012, %1224 : tensor<12x3072x768xbf16>
    %cst_364 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1226 = stablehlo.broadcast_in_dim %cst_364, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1227 = stablehlo.add %1099, %1226 : tensor<12x3072xbf16>
    %1228 = stablehlo.sqrt %1227 : tensor<12x3072xbf16>
    %cst_365 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1229 = stablehlo.broadcast_in_dim %cst_365, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1230 = stablehlo.add %1228, %1229 : tensor<12x3072xbf16>
    %1231 = stablehlo.divide %1015, %1230 : tensor<12x3072xbf16>
    %cst_366 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1232 = stablehlo.broadcast_in_dim %cst_366, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1233 = stablehlo.add %1102, %1232 : tensor<12x768x3072xbf16>
    %1234 = stablehlo.sqrt %1233 : tensor<12x768x3072xbf16>
    %cst_367 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1235 = stablehlo.broadcast_in_dim %cst_367, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1236 = stablehlo.add %1234, %1235 : tensor<12x768x3072xbf16>
    %1237 = stablehlo.divide %1018, %1236 : tensor<12x768x3072xbf16>
    %cst_368 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1238 = stablehlo.broadcast_in_dim %cst_368, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1239 = stablehlo.add %1105, %1238 : tensor<12x768xbf16>
    %1240 = stablehlo.sqrt %1239 : tensor<12x768xbf16>
    %cst_369 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1241 = stablehlo.broadcast_in_dim %cst_369, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1242 = stablehlo.add %1240, %1241 : tensor<12x768xbf16>
    %1243 = stablehlo.divide %1021, %1242 : tensor<12x768xbf16>
    %cst_370 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1244 = stablehlo.broadcast_in_dim %cst_370, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1245 = stablehlo.add %1108, %1244 : tensor<12x768xbf16>
    %1246 = stablehlo.sqrt %1245 : tensor<12x768xbf16>
    %cst_371 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1247 = stablehlo.broadcast_in_dim %cst_371, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1248 = stablehlo.add %1246, %1247 : tensor<12x768xbf16>
    %1249 = stablehlo.divide %1024, %1248 : tensor<12x768xbf16>
    %cst_372 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1250 = stablehlo.broadcast_in_dim %cst_372, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1251 = stablehlo.add %1111, %1250 : tensor<12x768xbf16>
    %1252 = stablehlo.sqrt %1251 : tensor<12x768xbf16>
    %cst_373 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1253 = stablehlo.broadcast_in_dim %cst_373, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1254 = stablehlo.add %1252, %1253 : tensor<12x768xbf16>
    %1255 = stablehlo.divide %1027, %1254 : tensor<12x768xbf16>
    %cst_374 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1256 = stablehlo.broadcast_in_dim %cst_374, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1257 = stablehlo.add %1114, %1256 : tensor<768x768xbf16>
    %1258 = stablehlo.sqrt %1257 : tensor<768x768xbf16>
    %cst_375 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1259 = stablehlo.broadcast_in_dim %cst_375, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1260 = stablehlo.add %1258, %1259 : tensor<768x768xbf16>
    %1261 = stablehlo.divide %1030, %1260 : tensor<768x768xbf16>
    %cst_376 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1262 = stablehlo.broadcast_in_dim %cst_376, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1263 = stablehlo.add %1117, %1262 : tensor<768xbf16>
    %1264 = stablehlo.sqrt %1263 : tensor<768xbf16>
    %cst_377 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1265 = stablehlo.broadcast_in_dim %cst_377, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1266 = stablehlo.add %1264, %1265 : tensor<768xbf16>
    %1267 = stablehlo.divide %1033, %1266 : tensor<768xbf16>
    %cst_378 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1268 = stablehlo.broadcast_in_dim %cst_378, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1269 = stablehlo.add %1120, %1268 : tensor<768xbf16>
    %1270 = stablehlo.sqrt %1269 : tensor<768xbf16>
    %cst_379 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1271 = stablehlo.broadcast_in_dim %cst_379, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1272 = stablehlo.add %1270, %1271 : tensor<768xbf16>
    %1273 = stablehlo.divide %1036, %1272 : tensor<768xbf16>
    %cst_380 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1274 = stablehlo.broadcast_in_dim %cst_380, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1275 = stablehlo.add %1123, %1274 : tensor<768xbf16>
    %1276 = stablehlo.sqrt %1275 : tensor<768xbf16>
    %cst_381 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1277 = stablehlo.broadcast_in_dim %cst_381, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1278 = stablehlo.add %1276, %1277 : tensor<768xbf16>
    %1279 = stablehlo.divide %1039, %1278 : tensor<768xbf16>
    %cst_382 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1280 = stablehlo.broadcast_in_dim %cst_382, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1281 = stablehlo.add %1126, %1280 : tensor<30522x768xbf16>
    %1282 = stablehlo.sqrt %1281 : tensor<30522x768xbf16>
    %cst_383 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1283 = stablehlo.broadcast_in_dim %cst_383, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1284 = stablehlo.add %1282, %1283 : tensor<30522x768xbf16>
    %1285 = stablehlo.divide %1042, %1284 : tensor<30522x768xbf16>
    %cst_384 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %1286 = stablehlo.broadcast_in_dim %cst_384, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1287 = stablehlo.add %1129, %1286 : tensor<30522xbf16>
    %1288 = stablehlo.sqrt %1287 : tensor<30522xbf16>
    %cst_385 = stablehlo.constant dense<1.001170e-08> : tensor<bf16>
    %1289 = stablehlo.broadcast_in_dim %cst_385, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1290 = stablehlo.add %1288, %1289 : tensor<30522xbf16>
    %1291 = stablehlo.divide %1045, %1290 : tensor<30522xbf16>
    %cst_386 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1292 = stablehlo.broadcast_in_dim %cst_386, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1293 = stablehlo.multiply %1292, %arg0 : tensor<30522x768xbf16>
    %1294 = stablehlo.add %1135, %1293 : tensor<30522x768xbf16>
    %cst_387 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1295 = stablehlo.broadcast_in_dim %cst_387, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1296 = stablehlo.multiply %1295, %arg1 : tensor<512x768xbf16>
    %1297 = stablehlo.add %1141, %1296 : tensor<512x768xbf16>
    %cst_388 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1298 = stablehlo.broadcast_in_dim %cst_388, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1299 = stablehlo.multiply %1298, %arg2 : tensor<2x768xbf16>
    %1300 = stablehlo.add %1147, %1299 : tensor<2x768xbf16>
    %cst_389 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1301 = stablehlo.broadcast_in_dim %cst_389, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1302 = stablehlo.multiply %1301, %arg3 : tensor<768xbf16>
    %1303 = stablehlo.add %1153, %1302 : tensor<768xbf16>
    %cst_390 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1304 = stablehlo.broadcast_in_dim %cst_390, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1305 = stablehlo.multiply %1304, %arg4 : tensor<768xbf16>
    %1306 = stablehlo.add %1159, %1305 : tensor<768xbf16>
    %cst_391 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1307 = stablehlo.broadcast_in_dim %cst_391, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1308 = stablehlo.multiply %1307, %arg5 : tensor<12x768x768xbf16>
    %1309 = stablehlo.add %1165, %1308 : tensor<12x768x768xbf16>
    %cst_392 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1310 = stablehlo.broadcast_in_dim %cst_392, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1311 = stablehlo.multiply %1310, %arg6 : tensor<12x768xbf16>
    %1312 = stablehlo.add %1171, %1311 : tensor<12x768xbf16>
    %cst_393 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1313 = stablehlo.broadcast_in_dim %cst_393, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1314 = stablehlo.multiply %1313, %arg7 : tensor<12x768x768xbf16>
    %1315 = stablehlo.add %1177, %1314 : tensor<12x768x768xbf16>
    %cst_394 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1316 = stablehlo.broadcast_in_dim %cst_394, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1317 = stablehlo.multiply %1316, %arg8 : tensor<12x768xbf16>
    %1318 = stablehlo.add %1183, %1317 : tensor<12x768xbf16>
    %cst_395 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1319 = stablehlo.broadcast_in_dim %cst_395, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1320 = stablehlo.multiply %1319, %arg9 : tensor<12x768x768xbf16>
    %1321 = stablehlo.add %1189, %1320 : tensor<12x768x768xbf16>
    %cst_396 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1322 = stablehlo.broadcast_in_dim %cst_396, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1323 = stablehlo.multiply %1322, %arg10 : tensor<12x768xbf16>
    %1324 = stablehlo.add %1195, %1323 : tensor<12x768xbf16>
    %cst_397 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1325 = stablehlo.broadcast_in_dim %cst_397, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1326 = stablehlo.multiply %1325, %arg11 : tensor<12x768x768xbf16>
    %1327 = stablehlo.add %1201, %1326 : tensor<12x768x768xbf16>
    %cst_398 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1328 = stablehlo.broadcast_in_dim %cst_398, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1329 = stablehlo.multiply %1328, %arg12 : tensor<12x768xbf16>
    %1330 = stablehlo.add %1207, %1329 : tensor<12x768xbf16>
    %cst_399 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1331 = stablehlo.broadcast_in_dim %cst_399, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1332 = stablehlo.multiply %1331, %arg13 : tensor<12x768xbf16>
    %1333 = stablehlo.add %1213, %1332 : tensor<12x768xbf16>
    %cst_400 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1334 = stablehlo.broadcast_in_dim %cst_400, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1335 = stablehlo.multiply %1334, %arg14 : tensor<12x768xbf16>
    %1336 = stablehlo.add %1219, %1335 : tensor<12x768xbf16>
    %cst_401 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1337 = stablehlo.broadcast_in_dim %cst_401, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1338 = stablehlo.multiply %1337, %arg15 : tensor<12x3072x768xbf16>
    %1339 = stablehlo.add %1225, %1338 : tensor<12x3072x768xbf16>
    %cst_402 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1340 = stablehlo.broadcast_in_dim %cst_402, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1341 = stablehlo.multiply %1340, %arg16 : tensor<12x3072xbf16>
    %1342 = stablehlo.add %1231, %1341 : tensor<12x3072xbf16>
    %cst_403 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1343 = stablehlo.broadcast_in_dim %cst_403, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1344 = stablehlo.multiply %1343, %arg17 : tensor<12x768x3072xbf16>
    %1345 = stablehlo.add %1237, %1344 : tensor<12x768x3072xbf16>
    %cst_404 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1346 = stablehlo.broadcast_in_dim %cst_404, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1347 = stablehlo.multiply %1346, %arg18 : tensor<12x768xbf16>
    %1348 = stablehlo.add %1243, %1347 : tensor<12x768xbf16>
    %cst_405 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1349 = stablehlo.broadcast_in_dim %cst_405, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1350 = stablehlo.multiply %1349, %arg19 : tensor<12x768xbf16>
    %1351 = stablehlo.add %1249, %1350 : tensor<12x768xbf16>
    %cst_406 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1352 = stablehlo.broadcast_in_dim %cst_406, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1353 = stablehlo.multiply %1352, %arg20 : tensor<12x768xbf16>
    %1354 = stablehlo.add %1255, %1353 : tensor<12x768xbf16>
    %cst_407 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1355 = stablehlo.broadcast_in_dim %cst_407, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1356 = stablehlo.multiply %1355, %arg21 : tensor<768x768xbf16>
    %1357 = stablehlo.add %1261, %1356 : tensor<768x768xbf16>
    %cst_408 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1358 = stablehlo.broadcast_in_dim %cst_408, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1359 = stablehlo.multiply %1358, %arg22 : tensor<768xbf16>
    %1360 = stablehlo.add %1267, %1359 : tensor<768xbf16>
    %cst_409 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1361 = stablehlo.broadcast_in_dim %cst_409, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1362 = stablehlo.multiply %1361, %arg23 : tensor<768xbf16>
    %1363 = stablehlo.add %1273, %1362 : tensor<768xbf16>
    %cst_410 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1364 = stablehlo.broadcast_in_dim %cst_410, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1365 = stablehlo.multiply %1364, %arg24 : tensor<768xbf16>
    %1366 = stablehlo.add %1279, %1365 : tensor<768xbf16>
    %cst_411 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1367 = stablehlo.broadcast_in_dim %cst_411, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1368 = stablehlo.multiply %1367, %arg25 : tensor<30522x768xbf16>
    %1369 = stablehlo.add %1285, %1368 : tensor<30522x768xbf16>
    %cst_412 = stablehlo.constant dense<1.000980e-02> : tensor<bf16>
    %1370 = stablehlo.broadcast_in_dim %cst_412, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1371 = stablehlo.multiply %1370, %arg26 : tensor<30522xbf16>
    %1372 = stablehlo.add %1291, %1371 : tensor<30522xbf16>
    %1373 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1374 = stablehlo.multiply %1373, %1294 : tensor<30522x768xbf16>
    %1375 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1376 = stablehlo.multiply %1375, %1297 : tensor<512x768xbf16>
    %1377 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1378 = stablehlo.multiply %1377, %1300 : tensor<2x768xbf16>
    %1379 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1380 = stablehlo.multiply %1379, %1303 : tensor<768xbf16>
    %1381 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1382 = stablehlo.multiply %1381, %1306 : tensor<768xbf16>
    %1383 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1384 = stablehlo.multiply %1383, %1309 : tensor<12x768x768xbf16>
    %1385 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1386 = stablehlo.multiply %1385, %1312 : tensor<12x768xbf16>
    %1387 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1388 = stablehlo.multiply %1387, %1315 : tensor<12x768x768xbf16>
    %1389 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1390 = stablehlo.multiply %1389, %1318 : tensor<12x768xbf16>
    %1391 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1392 = stablehlo.multiply %1391, %1321 : tensor<12x768x768xbf16>
    %1393 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1394 = stablehlo.multiply %1393, %1324 : tensor<12x768xbf16>
    %1395 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768x768xbf16>
    %1396 = stablehlo.multiply %1395, %1327 : tensor<12x768x768xbf16>
    %1397 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1398 = stablehlo.multiply %1397, %1330 : tensor<12x768xbf16>
    %1399 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1400 = stablehlo.multiply %1399, %1333 : tensor<12x768xbf16>
    %1401 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1402 = stablehlo.multiply %1401, %1336 : tensor<12x768xbf16>
    %1403 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x3072x768xbf16>
    %1404 = stablehlo.multiply %1403, %1339 : tensor<12x3072x768xbf16>
    %1405 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x3072xbf16>
    %1406 = stablehlo.multiply %1405, %1342 : tensor<12x3072xbf16>
    %1407 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768x3072xbf16>
    %1408 = stablehlo.multiply %1407, %1345 : tensor<12x768x3072xbf16>
    %1409 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1410 = stablehlo.multiply %1409, %1348 : tensor<12x768xbf16>
    %1411 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1412 = stablehlo.multiply %1411, %1351 : tensor<12x768xbf16>
    %1413 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<12x768xbf16>
    %1414 = stablehlo.multiply %1413, %1354 : tensor<12x768xbf16>
    %1415 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<768x768xbf16>
    %1416 = stablehlo.multiply %1415, %1357 : tensor<768x768xbf16>
    %1417 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1418 = stablehlo.multiply %1417, %1360 : tensor<768xbf16>
    %1419 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1420 = stablehlo.multiply %1419, %1363 : tensor<768xbf16>
    %1421 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<768xbf16>
    %1422 = stablehlo.multiply %1421, %1366 : tensor<768xbf16>
    %1423 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1424 = stablehlo.multiply %1423, %1369 : tensor<30522x768xbf16>
    %1425 = stablehlo.broadcast_in_dim %389, dims = [] : (tensor<bf16>) -> tensor<30522xbf16>
    %1426 = stablehlo.multiply %1425, %1372 : tensor<30522xbf16>
    %c_413 = stablehlo.constant dense<2147483647> : tensor<i32>
    %1427 = stablehlo.compare  LT, %arg27, %c_413,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
    %c_414 = stablehlo.constant dense<1> : tensor<i32>
    %1428 = stablehlo.add %arg27, %c_414 : tensor<i32>
    %c_415 = stablehlo.constant dense<2147483647> : tensor<i32>
    %1429 = call @_where_385(%1427, %1428, %c_415) : (tensor<i1>, tensor<i32>, tensor<i32>) -> tensor<i32>
    %1430 = stablehlo.add %arg0, %1374 : tensor<30522x768xbf16>
    %1431 = stablehlo.add %arg1, %1376 : tensor<512x768xbf16>
    %1432 = stablehlo.add %arg2, %1378 : tensor<2x768xbf16>
    %1433 = stablehlo.add %arg3, %1380 : tensor<768xbf16>
    %1434 = stablehlo.add %arg4, %1382 : tensor<768xbf16>
    %1435 = stablehlo.add %arg5, %1384 : tensor<12x768x768xbf16>
    %1436 = stablehlo.add %arg6, %1386 : tensor<12x768xbf16>
    %1437 = stablehlo.add %arg7, %1388 : tensor<12x768x768xbf16>
    %1438 = stablehlo.add %arg8, %1390 : tensor<12x768xbf16>
    %1439 = stablehlo.add %arg9, %1392 : tensor<12x768x768xbf16>
    %1440 = stablehlo.add %arg10, %1394 : tensor<12x768xbf16>
    %1441 = stablehlo.add %arg11, %1396 : tensor<12x768x768xbf16>
    %1442 = stablehlo.add %arg12, %1398 : tensor<12x768xbf16>
    %1443 = stablehlo.add %arg13, %1400 : tensor<12x768xbf16>
    %1444 = stablehlo.add %arg14, %1402 : tensor<12x768xbf16>
    %1445 = stablehlo.add %arg15, %1404 : tensor<12x3072x768xbf16>
    %1446 = stablehlo.add %arg16, %1406 : tensor<12x3072xbf16>
    %1447 = stablehlo.add %arg17, %1408 : tensor<12x768x3072xbf16>
    %1448 = stablehlo.add %arg18, %1410 : tensor<12x768xbf16>
    %1449 = stablehlo.add %arg19, %1412 : tensor<12x768xbf16>
    %1450 = stablehlo.add %arg20, %1414 : tensor<12x768xbf16>
    %1451 = stablehlo.add %arg21, %1416 : tensor<768x768xbf16>
    %1452 = stablehlo.add %arg22, %1418 : tensor<768xbf16>
    %1453 = stablehlo.add %arg23, %1420 : tensor<768xbf16>
    %1454 = stablehlo.add %arg24, %1422 : tensor<768xbf16>
    %1455 = stablehlo.add %arg25, %1424 : tensor<30522x768xbf16>
    %1456 = stablehlo.add %arg26, %1426 : tensor<30522xbf16>
    %c_416 = stablehlo.constant dense<0> : tensor<i32>
    return %c_416, %1430, %1431, %1432, %1433, %1434, %1435, %1436, %1437, %1438, %1439, %1440, %1441, %1442, %1443, %1444, %1445, %1446, %1447, %1448, %1449, %1450, %1451, %1452, %1453, %1454, %1455, %1456, %1429, %385, %388, %961, %666, %671, %676, %681, %686, %691, %696, %701, %706, %711, %716, %721, %726, %731, %736, %741, %746, %751, %756, %761, %766, %771, %776, %781, %786, %791, %796, %802, %808, %814, %820, %826, %832, %838, %844, %850, %856, %862, %868, %874, %880, %886, %892, %898, %904, %910, %916, %922, %928, %934, %940, %946, %952, %958, %240, %235, %233, %235, %235 : tensor<i32>, tensor<30522x768xbf16>, tensor<512x768xbf16>, tensor<2x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<30522x768xbf16>, tensor<30522xbf16>, tensor<i32>, tensor<bf16>, tensor<i32>, tensor<i32>, tensor<30522x768xbf16>, tensor<512x768xbf16>, tensor<2x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<30522x768xbf16>, tensor<30522xbf16>, tensor<30522x768xbf16>, tensor<512x768xbf16>, tensor<2x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x3072x768xbf16>, tensor<12x3072xbf16>, tensor<12x768x3072xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<12x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<30522x768xbf16>, tensor<30522xbf16>, tensor<i32>, tensor<i32>, tensor<f32>, tensor<i32>, tensor<i32>
  }
  func.func private @_threefry_split(%arg0: tensor<2xui32>) -> tensor<2x2xui32> {
    %0 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %1 = stablehlo.reshape %0 : (tensor<1xui32>) -> tensor<ui32>
    %2 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %3 = stablehlo.reshape %2 : (tensor<1xui32>) -> tensor<ui32>
    %4 = stablehlo.iota dim = 0 : tensor<2xui64>
    %c = stablehlo.constant dense<1> : tensor<ui64>
    %5 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<2xui64>
    %6 = stablehlo.multiply %5, %4 : tensor<2xui64>
    %c_0 = stablehlo.constant dense<32> : tensor<ui64>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<2xui64>
    %8 = stablehlo.shift_right_logical %6, %7 : tensor<2xui64>
    %9 = stablehlo.convert %6 : (tensor<2xui64>) -> tensor<2xui32>
    %10 = stablehlo.convert %8 : (tensor<2xui64>) -> tensor<2xui32>
    %11:2 = call @threefry2x32(%1, %3, %10, %9) : (tensor<ui32>, tensor<ui32>, tensor<2xui32>, tensor<2xui32>) -> (tensor<2xui32>, tensor<2xui32>)
    %12 = stablehlo.broadcast_in_dim %11#0, dims = [0] : (tensor<2xui32>) -> tensor<2x1xui32>
    %13 = stablehlo.broadcast_in_dim %11#1, dims = [0] : (tensor<2xui32>) -> tensor<2x1xui32>
    %14 = stablehlo.concatenate %12, %13, dim = 1 : (tensor<2x1xui32>, tensor<2x1xui32>) -> tensor<2x2xui32>
    return %14 : tensor<2x2xui32>
  }
  func.func private @threefry2x32(%arg0: tensor<ui32>, %arg1: tensor<ui32>, %arg2: tensor<2xui32>, %arg3: tensor<2xui32>) -> (tensor<2xui32>, tensor<2xui32>) {
    %0 = stablehlo.xor %arg0, %arg1 : tensor<ui32>
    %c = stablehlo.constant dense<466688986> : tensor<ui32>
    %1 = stablehlo.xor %0, %c : tensor<ui32>
    %2 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %3 = stablehlo.add %arg2, %2 : tensor<2xui32>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %5 = stablehlo.add %arg3, %4 : tensor<2xui32>
    %6 = stablehlo.add %3, %5 : tensor<2xui32>
    %c_0 = stablehlo.constant dense<13> : tensor<ui32>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %8 = stablehlo.shift_left %5, %7 : tensor<2xui32>
    %c_1 = stablehlo.constant dense<19> : tensor<ui32>
    %9 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %10 = stablehlo.shift_right_logical %5, %9 : tensor<2xui32>
    %11 = stablehlo.or %8, %10 : tensor<2xui32>
    %12 = stablehlo.xor %6, %11 : tensor<2xui32>
    %13 = stablehlo.add %6, %12 : tensor<2xui32>
    %c_2 = stablehlo.constant dense<15> : tensor<ui32>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %15 = stablehlo.shift_left %12, %14 : tensor<2xui32>
    %c_3 = stablehlo.constant dense<17> : tensor<ui32>
    %16 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %17 = stablehlo.shift_right_logical %12, %16 : tensor<2xui32>
    %18 = stablehlo.or %15, %17 : tensor<2xui32>
    %19 = stablehlo.xor %13, %18 : tensor<2xui32>
    %20 = stablehlo.add %13, %19 : tensor<2xui32>
    %c_4 = stablehlo.constant dense<26> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %22 = stablehlo.shift_left %19, %21 : tensor<2xui32>
    %c_5 = stablehlo.constant dense<6> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %24 = stablehlo.shift_right_logical %19, %23 : tensor<2xui32>
    %25 = stablehlo.or %22, %24 : tensor<2xui32>
    %26 = stablehlo.xor %20, %25 : tensor<2xui32>
    %27 = stablehlo.add %20, %26 : tensor<2xui32>
    %c_6 = stablehlo.constant dense<6> : tensor<ui32>
    %28 = stablehlo.broadcast_in_dim %c_6, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %29 = stablehlo.shift_left %26, %28 : tensor<2xui32>
    %c_7 = stablehlo.constant dense<26> : tensor<ui32>
    %30 = stablehlo.broadcast_in_dim %c_7, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %31 = stablehlo.shift_right_logical %26, %30 : tensor<2xui32>
    %32 = stablehlo.or %29, %31 : tensor<2xui32>
    %33 = stablehlo.xor %27, %32 : tensor<2xui32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %35 = stablehlo.add %27, %34 : tensor<2xui32>
    %36 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %37 = stablehlo.add %33, %36 : tensor<2xui32>
    %c_8 = stablehlo.constant dense<1> : tensor<ui32>
    %38 = stablehlo.broadcast_in_dim %c_8, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %39 = stablehlo.add %37, %38 : tensor<2xui32>
    %40 = stablehlo.add %35, %39 : tensor<2xui32>
    %c_9 = stablehlo.constant dense<17> : tensor<ui32>
    %41 = stablehlo.broadcast_in_dim %c_9, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %42 = stablehlo.shift_left %39, %41 : tensor<2xui32>
    %c_10 = stablehlo.constant dense<15> : tensor<ui32>
    %43 = stablehlo.broadcast_in_dim %c_10, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %44 = stablehlo.shift_right_logical %39, %43 : tensor<2xui32>
    %45 = stablehlo.or %42, %44 : tensor<2xui32>
    %46 = stablehlo.xor %40, %45 : tensor<2xui32>
    %47 = stablehlo.add %40, %46 : tensor<2xui32>
    %c_11 = stablehlo.constant dense<29> : tensor<ui32>
    %48 = stablehlo.broadcast_in_dim %c_11, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %49 = stablehlo.shift_left %46, %48 : tensor<2xui32>
    %c_12 = stablehlo.constant dense<3> : tensor<ui32>
    %50 = stablehlo.broadcast_in_dim %c_12, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %51 = stablehlo.shift_right_logical %46, %50 : tensor<2xui32>
    %52 = stablehlo.or %49, %51 : tensor<2xui32>
    %53 = stablehlo.xor %47, %52 : tensor<2xui32>
    %54 = stablehlo.add %47, %53 : tensor<2xui32>
    %c_13 = stablehlo.constant dense<16> : tensor<ui32>
    %55 = stablehlo.broadcast_in_dim %c_13, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %56 = stablehlo.shift_left %53, %55 : tensor<2xui32>
    %c_14 = stablehlo.constant dense<16> : tensor<ui32>
    %57 = stablehlo.broadcast_in_dim %c_14, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %58 = stablehlo.shift_right_logical %53, %57 : tensor<2xui32>
    %59 = stablehlo.or %56, %58 : tensor<2xui32>
    %60 = stablehlo.xor %54, %59 : tensor<2xui32>
    %61 = stablehlo.add %54, %60 : tensor<2xui32>
    %c_15 = stablehlo.constant dense<24> : tensor<ui32>
    %62 = stablehlo.broadcast_in_dim %c_15, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %63 = stablehlo.shift_left %60, %62 : tensor<2xui32>
    %c_16 = stablehlo.constant dense<8> : tensor<ui32>
    %64 = stablehlo.broadcast_in_dim %c_16, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %65 = stablehlo.shift_right_logical %60, %64 : tensor<2xui32>
    %66 = stablehlo.or %63, %65 : tensor<2xui32>
    %67 = stablehlo.xor %61, %66 : tensor<2xui32>
    %68 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %69 = stablehlo.add %61, %68 : tensor<2xui32>
    %70 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %71 = stablehlo.add %67, %70 : tensor<2xui32>
    %c_17 = stablehlo.constant dense<2> : tensor<ui32>
    %72 = stablehlo.broadcast_in_dim %c_17, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %73 = stablehlo.add %71, %72 : tensor<2xui32>
    %74 = stablehlo.add %69, %73 : tensor<2xui32>
    %c_18 = stablehlo.constant dense<13> : tensor<ui32>
    %75 = stablehlo.broadcast_in_dim %c_18, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %76 = stablehlo.shift_left %73, %75 : tensor<2xui32>
    %c_19 = stablehlo.constant dense<19> : tensor<ui32>
    %77 = stablehlo.broadcast_in_dim %c_19, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %78 = stablehlo.shift_right_logical %73, %77 : tensor<2xui32>
    %79 = stablehlo.or %76, %78 : tensor<2xui32>
    %80 = stablehlo.xor %74, %79 : tensor<2xui32>
    %81 = stablehlo.add %74, %80 : tensor<2xui32>
    %c_20 = stablehlo.constant dense<15> : tensor<ui32>
    %82 = stablehlo.broadcast_in_dim %c_20, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %83 = stablehlo.shift_left %80, %82 : tensor<2xui32>
    %c_21 = stablehlo.constant dense<17> : tensor<ui32>
    %84 = stablehlo.broadcast_in_dim %c_21, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %85 = stablehlo.shift_right_logical %80, %84 : tensor<2xui32>
    %86 = stablehlo.or %83, %85 : tensor<2xui32>
    %87 = stablehlo.xor %81, %86 : tensor<2xui32>
    %88 = stablehlo.add %81, %87 : tensor<2xui32>
    %c_22 = stablehlo.constant dense<26> : tensor<ui32>
    %89 = stablehlo.broadcast_in_dim %c_22, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %90 = stablehlo.shift_left %87, %89 : tensor<2xui32>
    %c_23 = stablehlo.constant dense<6> : tensor<ui32>
    %91 = stablehlo.broadcast_in_dim %c_23, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %92 = stablehlo.shift_right_logical %87, %91 : tensor<2xui32>
    %93 = stablehlo.or %90, %92 : tensor<2xui32>
    %94 = stablehlo.xor %88, %93 : tensor<2xui32>
    %95 = stablehlo.add %88, %94 : tensor<2xui32>
    %c_24 = stablehlo.constant dense<6> : tensor<ui32>
    %96 = stablehlo.broadcast_in_dim %c_24, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %97 = stablehlo.shift_left %94, %96 : tensor<2xui32>
    %c_25 = stablehlo.constant dense<26> : tensor<ui32>
    %98 = stablehlo.broadcast_in_dim %c_25, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %99 = stablehlo.shift_right_logical %94, %98 : tensor<2xui32>
    %100 = stablehlo.or %97, %99 : tensor<2xui32>
    %101 = stablehlo.xor %95, %100 : tensor<2xui32>
    %102 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %103 = stablehlo.add %95, %102 : tensor<2xui32>
    %104 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %105 = stablehlo.add %101, %104 : tensor<2xui32>
    %c_26 = stablehlo.constant dense<3> : tensor<ui32>
    %106 = stablehlo.broadcast_in_dim %c_26, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %107 = stablehlo.add %105, %106 : tensor<2xui32>
    %108 = stablehlo.add %103, %107 : tensor<2xui32>
    %c_27 = stablehlo.constant dense<17> : tensor<ui32>
    %109 = stablehlo.broadcast_in_dim %c_27, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %110 = stablehlo.shift_left %107, %109 : tensor<2xui32>
    %c_28 = stablehlo.constant dense<15> : tensor<ui32>
    %111 = stablehlo.broadcast_in_dim %c_28, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %112 = stablehlo.shift_right_logical %107, %111 : tensor<2xui32>
    %113 = stablehlo.or %110, %112 : tensor<2xui32>
    %114 = stablehlo.xor %108, %113 : tensor<2xui32>
    %115 = stablehlo.add %108, %114 : tensor<2xui32>
    %c_29 = stablehlo.constant dense<29> : tensor<ui32>
    %116 = stablehlo.broadcast_in_dim %c_29, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %117 = stablehlo.shift_left %114, %116 : tensor<2xui32>
    %c_30 = stablehlo.constant dense<3> : tensor<ui32>
    %118 = stablehlo.broadcast_in_dim %c_30, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %119 = stablehlo.shift_right_logical %114, %118 : tensor<2xui32>
    %120 = stablehlo.or %117, %119 : tensor<2xui32>
    %121 = stablehlo.xor %115, %120 : tensor<2xui32>
    %122 = stablehlo.add %115, %121 : tensor<2xui32>
    %c_31 = stablehlo.constant dense<16> : tensor<ui32>
    %123 = stablehlo.broadcast_in_dim %c_31, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %124 = stablehlo.shift_left %121, %123 : tensor<2xui32>
    %c_32 = stablehlo.constant dense<16> : tensor<ui32>
    %125 = stablehlo.broadcast_in_dim %c_32, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %126 = stablehlo.shift_right_logical %121, %125 : tensor<2xui32>
    %127 = stablehlo.or %124, %126 : tensor<2xui32>
    %128 = stablehlo.xor %122, %127 : tensor<2xui32>
    %129 = stablehlo.add %122, %128 : tensor<2xui32>
    %c_33 = stablehlo.constant dense<24> : tensor<ui32>
    %130 = stablehlo.broadcast_in_dim %c_33, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %131 = stablehlo.shift_left %128, %130 : tensor<2xui32>
    %c_34 = stablehlo.constant dense<8> : tensor<ui32>
    %132 = stablehlo.broadcast_in_dim %c_34, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %133 = stablehlo.shift_right_logical %128, %132 : tensor<2xui32>
    %134 = stablehlo.or %131, %133 : tensor<2xui32>
    %135 = stablehlo.xor %129, %134 : tensor<2xui32>
    %136 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %137 = stablehlo.add %129, %136 : tensor<2xui32>
    %138 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %139 = stablehlo.add %135, %138 : tensor<2xui32>
    %c_35 = stablehlo.constant dense<4> : tensor<ui32>
    %140 = stablehlo.broadcast_in_dim %c_35, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %141 = stablehlo.add %139, %140 : tensor<2xui32>
    %142 = stablehlo.add %137, %141 : tensor<2xui32>
    %c_36 = stablehlo.constant dense<13> : tensor<ui32>
    %143 = stablehlo.broadcast_in_dim %c_36, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %144 = stablehlo.shift_left %141, %143 : tensor<2xui32>
    %c_37 = stablehlo.constant dense<19> : tensor<ui32>
    %145 = stablehlo.broadcast_in_dim %c_37, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %146 = stablehlo.shift_right_logical %141, %145 : tensor<2xui32>
    %147 = stablehlo.or %144, %146 : tensor<2xui32>
    %148 = stablehlo.xor %142, %147 : tensor<2xui32>
    %149 = stablehlo.add %142, %148 : tensor<2xui32>
    %c_38 = stablehlo.constant dense<15> : tensor<ui32>
    %150 = stablehlo.broadcast_in_dim %c_38, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %151 = stablehlo.shift_left %148, %150 : tensor<2xui32>
    %c_39 = stablehlo.constant dense<17> : tensor<ui32>
    %152 = stablehlo.broadcast_in_dim %c_39, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %153 = stablehlo.shift_right_logical %148, %152 : tensor<2xui32>
    %154 = stablehlo.or %151, %153 : tensor<2xui32>
    %155 = stablehlo.xor %149, %154 : tensor<2xui32>
    %156 = stablehlo.add %149, %155 : tensor<2xui32>
    %c_40 = stablehlo.constant dense<26> : tensor<ui32>
    %157 = stablehlo.broadcast_in_dim %c_40, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %158 = stablehlo.shift_left %155, %157 : tensor<2xui32>
    %c_41 = stablehlo.constant dense<6> : tensor<ui32>
    %159 = stablehlo.broadcast_in_dim %c_41, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %160 = stablehlo.shift_right_logical %155, %159 : tensor<2xui32>
    %161 = stablehlo.or %158, %160 : tensor<2xui32>
    %162 = stablehlo.xor %156, %161 : tensor<2xui32>
    %163 = stablehlo.add %156, %162 : tensor<2xui32>
    %c_42 = stablehlo.constant dense<6> : tensor<ui32>
    %164 = stablehlo.broadcast_in_dim %c_42, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %165 = stablehlo.shift_left %162, %164 : tensor<2xui32>
    %c_43 = stablehlo.constant dense<26> : tensor<ui32>
    %166 = stablehlo.broadcast_in_dim %c_43, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %167 = stablehlo.shift_right_logical %162, %166 : tensor<2xui32>
    %168 = stablehlo.or %165, %167 : tensor<2xui32>
    %169 = stablehlo.xor %163, %168 : tensor<2xui32>
    %170 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %171 = stablehlo.add %163, %170 : tensor<2xui32>
    %172 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %173 = stablehlo.add %169, %172 : tensor<2xui32>
    %c_44 = stablehlo.constant dense<5> : tensor<ui32>
    %174 = stablehlo.broadcast_in_dim %c_44, dims = [] : (tensor<ui32>) -> tensor<2xui32>
    %175 = stablehlo.add %173, %174 : tensor<2xui32>
    return %171, %175 : tensor<2xui32>, tensor<2xui32>
  }
  func.func private @_take(%arg0: tensor<30522x768xbf16>, %arg1: tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %1 = stablehlo.compare  LT, %arg1, %0,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %c_0 = stablehlo.constant dense<30522> : tensor<i32>
    %2 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %3 = stablehlo.add %arg1, %2 : tensor<64x512xi32>
    %4 = call @_where(%1, %3, %arg1) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %c_1 = stablehlo.constant dense<30521> : tensor<1xi32>
    %c_2 = stablehlo.constant dense<0> : tensor<i32>
    %6 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %7 = stablehlo.compare  GE, %5, %6,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %8 = stablehlo.broadcast_in_dim %c_1, dims = [2] : (tensor<1xi32>) -> tensor<1x1x1xi32>
    %9 = stablehlo.broadcast_in_dim %8, dims = [0, 1, 2] : (tensor<1x1x1xi32>) -> tensor<64x512x1xi32>
    %10 = stablehlo.compare  LE, %5, %9,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %11 = stablehlo.and %7, %10 : tensor<64x512x1xi1>
    %c_3 = stablehlo.constant dense<true> : tensor<i1>
    %12 = stablehlo.reduce(%11 init: %c_3) applies stablehlo.and across dimensions = [2] : (tensor<64x512x1xi1>, tensor<i1>) -> tensor<64x512xi1>
    %13 = "stablehlo.gather"(%arg0, %5) <{dimension_numbers = #stablehlo.gather<offset_dims = [2], collapsed_slice_dims = [0], start_index_map = [0], index_vector_dim = 2>, indices_are_sorted = false, slice_sizes = array<i64: 1, 768>}> : (tensor<30522x768xbf16>, tensor<64x512x1xi32>) -> tensor<64x512x768xbf16>
    %14 = stablehlo.broadcast_in_dim %12, dims = [0, 1] : (tensor<64x512xi1>) -> tensor<64x512x768xi1>
    %cst = stablehlo.constant dense<0x7FC0> : tensor<bf16>
    %15 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %16 = stablehlo.select %14, %13, %15 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %16, %5 : tensor<64x512x768xbf16>, tensor<64x512x1xi32>
  }
  func.func private @_where(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xi32>, %arg2: tensor<64x512xi32>) -> tensor<64x512xi32> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<64x512xi1>, tensor<64x512xi32>
    return %0 : tensor<64x512xi32>
  }
  func.func private @_take_15(%arg0: tensor<512x768xbf16>, %arg1: tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %1 = stablehlo.compare  LT, %arg1, %0,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %c_0 = stablehlo.constant dense<512> : tensor<i32>
    %2 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %3 = stablehlo.add %arg1, %2 : tensor<64x512xi32>
    %4 = call @_where_18(%1, %3, %arg1) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %c_1 = stablehlo.constant dense<511> : tensor<1xi32>
    %c_2 = stablehlo.constant dense<0> : tensor<i32>
    %6 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %7 = stablehlo.compare  GE, %5, %6,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %8 = stablehlo.broadcast_in_dim %c_1, dims = [2] : (tensor<1xi32>) -> tensor<1x1x1xi32>
    %9 = stablehlo.broadcast_in_dim %8, dims = [0, 1, 2] : (tensor<1x1x1xi32>) -> tensor<64x512x1xi32>
    %10 = stablehlo.compare  LE, %5, %9,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %11 = stablehlo.and %7, %10 : tensor<64x512x1xi1>
    %c_3 = stablehlo.constant dense<true> : tensor<i1>
    %12 = stablehlo.reduce(%11 init: %c_3) applies stablehlo.and across dimensions = [2] : (tensor<64x512x1xi1>, tensor<i1>) -> tensor<64x512xi1>
    %13 = "stablehlo.gather"(%arg0, %5) <{dimension_numbers = #stablehlo.gather<offset_dims = [2], collapsed_slice_dims = [0], start_index_map = [0], index_vector_dim = 2>, indices_are_sorted = false, slice_sizes = array<i64: 1, 768>}> : (tensor<512x768xbf16>, tensor<64x512x1xi32>) -> tensor<64x512x768xbf16>
    %14 = stablehlo.broadcast_in_dim %12, dims = [0, 1] : (tensor<64x512xi1>) -> tensor<64x512x768xi1>
    %cst = stablehlo.constant dense<0x7FC0> : tensor<bf16>
    %15 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %16 = stablehlo.select %14, %13, %15 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %16, %5 : tensor<64x512x768xbf16>, tensor<64x512x1xi32>
  }
  func.func private @_where_18(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xi32>, %arg2: tensor<64x512xi32>) -> tensor<64x512xi32> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<64x512xi1>, tensor<64x512xi32>
    return %0 : tensor<64x512xi32>
  }
  func.func private @_take_29(%arg0: tensor<2x768xbf16>, %arg1: tensor<64x512xi32>) -> (tensor<64x512x768xbf16>, tensor<64x512x1xi32>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %1 = stablehlo.compare  LT, %arg1, %0,  SIGNED : (tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi1>
    %c_0 = stablehlo.constant dense<2> : tensor<i32>
    %2 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %3 = stablehlo.add %arg1, %2 : tensor<64x512xi32>
    %4 = call @_where(%1, %3, %arg1) : (tensor<64x512xi1>, tensor<64x512xi32>, tensor<64x512xi32>) -> tensor<64x512xi32>
    %5 = stablehlo.broadcast_in_dim %4, dims = [0, 1] : (tensor<64x512xi32>) -> tensor<64x512x1xi32>
    %c_1 = stablehlo.constant dense<1> : tensor<1xi32>
    %c_2 = stablehlo.constant dense<0> : tensor<i32>
    %6 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %7 = stablehlo.compare  GE, %5, %6,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %8 = stablehlo.broadcast_in_dim %c_1, dims = [2] : (tensor<1xi32>) -> tensor<1x1x1xi32>
    %9 = stablehlo.broadcast_in_dim %8, dims = [0, 1, 2] : (tensor<1x1x1xi32>) -> tensor<64x512x1xi32>
    %10 = stablehlo.compare  LE, %5, %9,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %11 = stablehlo.and %7, %10 : tensor<64x512x1xi1>
    %c_3 = stablehlo.constant dense<true> : tensor<i1>
    %12 = stablehlo.reduce(%11 init: %c_3) applies stablehlo.and across dimensions = [2] : (tensor<64x512x1xi1>, tensor<i1>) -> tensor<64x512xi1>
    %13 = "stablehlo.gather"(%arg0, %5) <{dimension_numbers = #stablehlo.gather<offset_dims = [2], collapsed_slice_dims = [0], start_index_map = [0], index_vector_dim = 2>, indices_are_sorted = false, slice_sizes = array<i64: 1, 768>}> : (tensor<2x768xbf16>, tensor<64x512x1xi32>) -> tensor<64x512x768xbf16>
    %14 = stablehlo.broadcast_in_dim %12, dims = [0, 1] : (tensor<64x512xi1>) -> tensor<64x512x768xi1>
    %cst = stablehlo.constant dense<0x7FC0> : tensor<bf16>
    %15 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %16 = stablehlo.select %14, %13, %15 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %16, %5 : tensor<64x512x768xbf16>, tensor<64x512x1xi32>
  }
  func.func private @_bernoulli(%arg0: tensor<2xui32>, %arg1: tensor<f32>) -> tensor<64x512x768xi1> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %cst_0 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %0 = call @_uniform(%arg0, %cst, %cst_0) : (tensor<2xui32>, tensor<f32>, tensor<f32>) -> tensor<64x512x768xf32>
    %1 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %2 = stablehlo.compare  LT, %0, %1,  FLOAT : (tensor<64x512x768xf32>, tensor<64x512x768xf32>) -> tensor<64x512x768xi1>
    return %2 : tensor<64x512x768xi1>
  }
  func.func private @_uniform(%arg0: tensor<2xui32>, %arg1: tensor<f32>, %arg2: tensor<f32>) -> tensor<64x512x768xf32> {
    %0 = stablehlo.convert %arg1 : tensor<f32>
    %1 = stablehlo.convert %arg2 : tensor<f32>
    %2 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<f32>) -> tensor<1x1x1xf32>
    %3 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<f32>) -> tensor<1x1x1xf32>
    %4 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %5 = stablehlo.reshape %4 : (tensor<1xui32>) -> tensor<ui32>
    %6 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %7 = stablehlo.reshape %6 : (tensor<1xui32>) -> tensor<ui32>
    %8 = stablehlo.iota dim = 0 : tensor<64x512x768xui64>
    %9 = stablehlo.iota dim = 1 : tensor<64x512x768xui64>
    %10 = stablehlo.iota dim = 2 : tensor<64x512x768xui64>
    %c = stablehlo.constant dense<393216> : tensor<ui64>
    %11 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %12 = stablehlo.multiply %11, %8 : tensor<64x512x768xui64>
    %c_0 = stablehlo.constant dense<768> : tensor<ui64>
    %13 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %14 = stablehlo.multiply %13, %9 : tensor<64x512x768xui64>
    %c_1 = stablehlo.constant dense<1> : tensor<ui64>
    %15 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %16 = stablehlo.multiply %15, %10 : tensor<64x512x768xui64>
    %17 = stablehlo.add %12, %14 : tensor<64x512x768xui64>
    %18 = stablehlo.add %17, %16 : tensor<64x512x768xui64>
    %c_2 = stablehlo.constant dense<32> : tensor<ui64>
    %19 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %20 = stablehlo.shift_right_logical %18, %19 : tensor<64x512x768xui64>
    %21 = stablehlo.convert %18 : (tensor<64x512x768xui64>) -> tensor<64x512x768xui32>
    %22 = stablehlo.convert %20 : (tensor<64x512x768xui64>) -> tensor<64x512x768xui32>
    %23:2 = call @threefry2x32_50(%5, %7, %22, %21) : (tensor<ui32>, tensor<ui32>, tensor<64x512x768xui32>, tensor<64x512x768xui32>) -> (tensor<64x512x768xui32>, tensor<64x512x768xui32>)
    %24 = stablehlo.xor %23#0, %23#1 : tensor<64x512x768xui32>
    %c_3 = stablehlo.constant dense<9> : tensor<ui32>
    %25 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %26 = stablehlo.shift_right_logical %24, %25 : tensor<64x512x768xui32>
    %c_4 = stablehlo.constant dense<1065353216> : tensor<ui32>
    %27 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %28 = stablehlo.or %26, %27 : tensor<64x512x768xui32>
    %29 = stablehlo.bitcast_convert %28 : (tensor<64x512x768xui32>) -> tensor<64x512x768xf32>
    %cst = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %30 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %31 = stablehlo.subtract %29, %30 : tensor<64x512x768xf32>
    %32 = stablehlo.subtract %3, %2 : tensor<1x1x1xf32>
    %33 = stablehlo.broadcast_in_dim %32, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %34 = stablehlo.multiply %31, %33 : tensor<64x512x768xf32>
    %35 = stablehlo.broadcast_in_dim %2, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %36 = stablehlo.add %34, %35 : tensor<64x512x768xf32>
    %37 = stablehlo.broadcast_in_dim %2, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %38 = stablehlo.maximum %37, %36 : tensor<64x512x768xf32>
    return %38 : tensor<64x512x768xf32>
  }
  func.func private @threefry2x32_50(%arg0: tensor<ui32>, %arg1: tensor<ui32>, %arg2: tensor<64x512x768xui32>, %arg3: tensor<64x512x768xui32>) -> (tensor<64x512x768xui32>, tensor<64x512x768xui32>) {
    %0 = stablehlo.xor %arg0, %arg1 : tensor<ui32>
    %c = stablehlo.constant dense<466688986> : tensor<ui32>
    %1 = stablehlo.xor %0, %c : tensor<ui32>
    %2 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %3 = stablehlo.add %arg2, %2 : tensor<64x512x768xui32>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %5 = stablehlo.add %arg3, %4 : tensor<64x512x768xui32>
    %6 = stablehlo.add %3, %5 : tensor<64x512x768xui32>
    %c_0 = stablehlo.constant dense<13> : tensor<ui32>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %8 = stablehlo.shift_left %5, %7 : tensor<64x512x768xui32>
    %c_1 = stablehlo.constant dense<19> : tensor<ui32>
    %9 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %10 = stablehlo.shift_right_logical %5, %9 : tensor<64x512x768xui32>
    %11 = stablehlo.or %8, %10 : tensor<64x512x768xui32>
    %12 = stablehlo.xor %6, %11 : tensor<64x512x768xui32>
    %13 = stablehlo.add %6, %12 : tensor<64x512x768xui32>
    %c_2 = stablehlo.constant dense<15> : tensor<ui32>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %15 = stablehlo.shift_left %12, %14 : tensor<64x512x768xui32>
    %c_3 = stablehlo.constant dense<17> : tensor<ui32>
    %16 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %17 = stablehlo.shift_right_logical %12, %16 : tensor<64x512x768xui32>
    %18 = stablehlo.or %15, %17 : tensor<64x512x768xui32>
    %19 = stablehlo.xor %13, %18 : tensor<64x512x768xui32>
    %20 = stablehlo.add %13, %19 : tensor<64x512x768xui32>
    %c_4 = stablehlo.constant dense<26> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %22 = stablehlo.shift_left %19, %21 : tensor<64x512x768xui32>
    %c_5 = stablehlo.constant dense<6> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %24 = stablehlo.shift_right_logical %19, %23 : tensor<64x512x768xui32>
    %25 = stablehlo.or %22, %24 : tensor<64x512x768xui32>
    %26 = stablehlo.xor %20, %25 : tensor<64x512x768xui32>
    %27 = stablehlo.add %20, %26 : tensor<64x512x768xui32>
    %c_6 = stablehlo.constant dense<6> : tensor<ui32>
    %28 = stablehlo.broadcast_in_dim %c_6, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %29 = stablehlo.shift_left %26, %28 : tensor<64x512x768xui32>
    %c_7 = stablehlo.constant dense<26> : tensor<ui32>
    %30 = stablehlo.broadcast_in_dim %c_7, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %31 = stablehlo.shift_right_logical %26, %30 : tensor<64x512x768xui32>
    %32 = stablehlo.or %29, %31 : tensor<64x512x768xui32>
    %33 = stablehlo.xor %27, %32 : tensor<64x512x768xui32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %35 = stablehlo.add %27, %34 : tensor<64x512x768xui32>
    %36 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %37 = stablehlo.add %33, %36 : tensor<64x512x768xui32>
    %c_8 = stablehlo.constant dense<1> : tensor<ui32>
    %38 = stablehlo.broadcast_in_dim %c_8, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %39 = stablehlo.add %37, %38 : tensor<64x512x768xui32>
    %40 = stablehlo.add %35, %39 : tensor<64x512x768xui32>
    %c_9 = stablehlo.constant dense<17> : tensor<ui32>
    %41 = stablehlo.broadcast_in_dim %c_9, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %42 = stablehlo.shift_left %39, %41 : tensor<64x512x768xui32>
    %c_10 = stablehlo.constant dense<15> : tensor<ui32>
    %43 = stablehlo.broadcast_in_dim %c_10, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %44 = stablehlo.shift_right_logical %39, %43 : tensor<64x512x768xui32>
    %45 = stablehlo.or %42, %44 : tensor<64x512x768xui32>
    %46 = stablehlo.xor %40, %45 : tensor<64x512x768xui32>
    %47 = stablehlo.add %40, %46 : tensor<64x512x768xui32>
    %c_11 = stablehlo.constant dense<29> : tensor<ui32>
    %48 = stablehlo.broadcast_in_dim %c_11, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %49 = stablehlo.shift_left %46, %48 : tensor<64x512x768xui32>
    %c_12 = stablehlo.constant dense<3> : tensor<ui32>
    %50 = stablehlo.broadcast_in_dim %c_12, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %51 = stablehlo.shift_right_logical %46, %50 : tensor<64x512x768xui32>
    %52 = stablehlo.or %49, %51 : tensor<64x512x768xui32>
    %53 = stablehlo.xor %47, %52 : tensor<64x512x768xui32>
    %54 = stablehlo.add %47, %53 : tensor<64x512x768xui32>
    %c_13 = stablehlo.constant dense<16> : tensor<ui32>
    %55 = stablehlo.broadcast_in_dim %c_13, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %56 = stablehlo.shift_left %53, %55 : tensor<64x512x768xui32>
    %c_14 = stablehlo.constant dense<16> : tensor<ui32>
    %57 = stablehlo.broadcast_in_dim %c_14, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %58 = stablehlo.shift_right_logical %53, %57 : tensor<64x512x768xui32>
    %59 = stablehlo.or %56, %58 : tensor<64x512x768xui32>
    %60 = stablehlo.xor %54, %59 : tensor<64x512x768xui32>
    %61 = stablehlo.add %54, %60 : tensor<64x512x768xui32>
    %c_15 = stablehlo.constant dense<24> : tensor<ui32>
    %62 = stablehlo.broadcast_in_dim %c_15, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %63 = stablehlo.shift_left %60, %62 : tensor<64x512x768xui32>
    %c_16 = stablehlo.constant dense<8> : tensor<ui32>
    %64 = stablehlo.broadcast_in_dim %c_16, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %65 = stablehlo.shift_right_logical %60, %64 : tensor<64x512x768xui32>
    %66 = stablehlo.or %63, %65 : tensor<64x512x768xui32>
    %67 = stablehlo.xor %61, %66 : tensor<64x512x768xui32>
    %68 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %69 = stablehlo.add %61, %68 : tensor<64x512x768xui32>
    %70 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %71 = stablehlo.add %67, %70 : tensor<64x512x768xui32>
    %c_17 = stablehlo.constant dense<2> : tensor<ui32>
    %72 = stablehlo.broadcast_in_dim %c_17, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %73 = stablehlo.add %71, %72 : tensor<64x512x768xui32>
    %74 = stablehlo.add %69, %73 : tensor<64x512x768xui32>
    %c_18 = stablehlo.constant dense<13> : tensor<ui32>
    %75 = stablehlo.broadcast_in_dim %c_18, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %76 = stablehlo.shift_left %73, %75 : tensor<64x512x768xui32>
    %c_19 = stablehlo.constant dense<19> : tensor<ui32>
    %77 = stablehlo.broadcast_in_dim %c_19, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %78 = stablehlo.shift_right_logical %73, %77 : tensor<64x512x768xui32>
    %79 = stablehlo.or %76, %78 : tensor<64x512x768xui32>
    %80 = stablehlo.xor %74, %79 : tensor<64x512x768xui32>
    %81 = stablehlo.add %74, %80 : tensor<64x512x768xui32>
    %c_20 = stablehlo.constant dense<15> : tensor<ui32>
    %82 = stablehlo.broadcast_in_dim %c_20, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %83 = stablehlo.shift_left %80, %82 : tensor<64x512x768xui32>
    %c_21 = stablehlo.constant dense<17> : tensor<ui32>
    %84 = stablehlo.broadcast_in_dim %c_21, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %85 = stablehlo.shift_right_logical %80, %84 : tensor<64x512x768xui32>
    %86 = stablehlo.or %83, %85 : tensor<64x512x768xui32>
    %87 = stablehlo.xor %81, %86 : tensor<64x512x768xui32>
    %88 = stablehlo.add %81, %87 : tensor<64x512x768xui32>
    %c_22 = stablehlo.constant dense<26> : tensor<ui32>
    %89 = stablehlo.broadcast_in_dim %c_22, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %90 = stablehlo.shift_left %87, %89 : tensor<64x512x768xui32>
    %c_23 = stablehlo.constant dense<6> : tensor<ui32>
    %91 = stablehlo.broadcast_in_dim %c_23, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %92 = stablehlo.shift_right_logical %87, %91 : tensor<64x512x768xui32>
    %93 = stablehlo.or %90, %92 : tensor<64x512x768xui32>
    %94 = stablehlo.xor %88, %93 : tensor<64x512x768xui32>
    %95 = stablehlo.add %88, %94 : tensor<64x512x768xui32>
    %c_24 = stablehlo.constant dense<6> : tensor<ui32>
    %96 = stablehlo.broadcast_in_dim %c_24, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %97 = stablehlo.shift_left %94, %96 : tensor<64x512x768xui32>
    %c_25 = stablehlo.constant dense<26> : tensor<ui32>
    %98 = stablehlo.broadcast_in_dim %c_25, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %99 = stablehlo.shift_right_logical %94, %98 : tensor<64x512x768xui32>
    %100 = stablehlo.or %97, %99 : tensor<64x512x768xui32>
    %101 = stablehlo.xor %95, %100 : tensor<64x512x768xui32>
    %102 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %103 = stablehlo.add %95, %102 : tensor<64x512x768xui32>
    %104 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %105 = stablehlo.add %101, %104 : tensor<64x512x768xui32>
    %c_26 = stablehlo.constant dense<3> : tensor<ui32>
    %106 = stablehlo.broadcast_in_dim %c_26, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %107 = stablehlo.add %105, %106 : tensor<64x512x768xui32>
    %108 = stablehlo.add %103, %107 : tensor<64x512x768xui32>
    %c_27 = stablehlo.constant dense<17> : tensor<ui32>
    %109 = stablehlo.broadcast_in_dim %c_27, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %110 = stablehlo.shift_left %107, %109 : tensor<64x512x768xui32>
    %c_28 = stablehlo.constant dense<15> : tensor<ui32>
    %111 = stablehlo.broadcast_in_dim %c_28, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %112 = stablehlo.shift_right_logical %107, %111 : tensor<64x512x768xui32>
    %113 = stablehlo.or %110, %112 : tensor<64x512x768xui32>
    %114 = stablehlo.xor %108, %113 : tensor<64x512x768xui32>
    %115 = stablehlo.add %108, %114 : tensor<64x512x768xui32>
    %c_29 = stablehlo.constant dense<29> : tensor<ui32>
    %116 = stablehlo.broadcast_in_dim %c_29, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %117 = stablehlo.shift_left %114, %116 : tensor<64x512x768xui32>
    %c_30 = stablehlo.constant dense<3> : tensor<ui32>
    %118 = stablehlo.broadcast_in_dim %c_30, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %119 = stablehlo.shift_right_logical %114, %118 : tensor<64x512x768xui32>
    %120 = stablehlo.or %117, %119 : tensor<64x512x768xui32>
    %121 = stablehlo.xor %115, %120 : tensor<64x512x768xui32>
    %122 = stablehlo.add %115, %121 : tensor<64x512x768xui32>
    %c_31 = stablehlo.constant dense<16> : tensor<ui32>
    %123 = stablehlo.broadcast_in_dim %c_31, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %124 = stablehlo.shift_left %121, %123 : tensor<64x512x768xui32>
    %c_32 = stablehlo.constant dense<16> : tensor<ui32>
    %125 = stablehlo.broadcast_in_dim %c_32, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %126 = stablehlo.shift_right_logical %121, %125 : tensor<64x512x768xui32>
    %127 = stablehlo.or %124, %126 : tensor<64x512x768xui32>
    %128 = stablehlo.xor %122, %127 : tensor<64x512x768xui32>
    %129 = stablehlo.add %122, %128 : tensor<64x512x768xui32>
    %c_33 = stablehlo.constant dense<24> : tensor<ui32>
    %130 = stablehlo.broadcast_in_dim %c_33, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %131 = stablehlo.shift_left %128, %130 : tensor<64x512x768xui32>
    %c_34 = stablehlo.constant dense<8> : tensor<ui32>
    %132 = stablehlo.broadcast_in_dim %c_34, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %133 = stablehlo.shift_right_logical %128, %132 : tensor<64x512x768xui32>
    %134 = stablehlo.or %131, %133 : tensor<64x512x768xui32>
    %135 = stablehlo.xor %129, %134 : tensor<64x512x768xui32>
    %136 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %137 = stablehlo.add %129, %136 : tensor<64x512x768xui32>
    %138 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %139 = stablehlo.add %135, %138 : tensor<64x512x768xui32>
    %c_35 = stablehlo.constant dense<4> : tensor<ui32>
    %140 = stablehlo.broadcast_in_dim %c_35, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %141 = stablehlo.add %139, %140 : tensor<64x512x768xui32>
    %142 = stablehlo.add %137, %141 : tensor<64x512x768xui32>
    %c_36 = stablehlo.constant dense<13> : tensor<ui32>
    %143 = stablehlo.broadcast_in_dim %c_36, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %144 = stablehlo.shift_left %141, %143 : tensor<64x512x768xui32>
    %c_37 = stablehlo.constant dense<19> : tensor<ui32>
    %145 = stablehlo.broadcast_in_dim %c_37, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %146 = stablehlo.shift_right_logical %141, %145 : tensor<64x512x768xui32>
    %147 = stablehlo.or %144, %146 : tensor<64x512x768xui32>
    %148 = stablehlo.xor %142, %147 : tensor<64x512x768xui32>
    %149 = stablehlo.add %142, %148 : tensor<64x512x768xui32>
    %c_38 = stablehlo.constant dense<15> : tensor<ui32>
    %150 = stablehlo.broadcast_in_dim %c_38, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %151 = stablehlo.shift_left %148, %150 : tensor<64x512x768xui32>
    %c_39 = stablehlo.constant dense<17> : tensor<ui32>
    %152 = stablehlo.broadcast_in_dim %c_39, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %153 = stablehlo.shift_right_logical %148, %152 : tensor<64x512x768xui32>
    %154 = stablehlo.or %151, %153 : tensor<64x512x768xui32>
    %155 = stablehlo.xor %149, %154 : tensor<64x512x768xui32>
    %156 = stablehlo.add %149, %155 : tensor<64x512x768xui32>
    %c_40 = stablehlo.constant dense<26> : tensor<ui32>
    %157 = stablehlo.broadcast_in_dim %c_40, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %158 = stablehlo.shift_left %155, %157 : tensor<64x512x768xui32>
    %c_41 = stablehlo.constant dense<6> : tensor<ui32>
    %159 = stablehlo.broadcast_in_dim %c_41, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %160 = stablehlo.shift_right_logical %155, %159 : tensor<64x512x768xui32>
    %161 = stablehlo.or %158, %160 : tensor<64x512x768xui32>
    %162 = stablehlo.xor %156, %161 : tensor<64x512x768xui32>
    %163 = stablehlo.add %156, %162 : tensor<64x512x768xui32>
    %c_42 = stablehlo.constant dense<6> : tensor<ui32>
    %164 = stablehlo.broadcast_in_dim %c_42, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %165 = stablehlo.shift_left %162, %164 : tensor<64x512x768xui32>
    %c_43 = stablehlo.constant dense<26> : tensor<ui32>
    %166 = stablehlo.broadcast_in_dim %c_43, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %167 = stablehlo.shift_right_logical %162, %166 : tensor<64x512x768xui32>
    %168 = stablehlo.or %165, %167 : tensor<64x512x768xui32>
    %169 = stablehlo.xor %163, %168 : tensor<64x512x768xui32>
    %170 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %171 = stablehlo.add %163, %170 : tensor<64x512x768xui32>
    %172 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %173 = stablehlo.add %169, %172 : tensor<64x512x768xui32>
    %c_44 = stablehlo.constant dense<5> : tensor<ui32>
    %174 = stablehlo.broadcast_in_dim %c_44, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %175 = stablehlo.add %173, %174 : tensor<64x512x768xui32>
    return %171, %175 : tensor<64x512x768xui32>, tensor<64x512x768xui32>
  }
  func.func private @_where_65(%arg0: tensor<64x512x768xi1>, %arg1: tensor<64x512x768xbf16>, %arg2: tensor<i32>) -> tensor<64x512x768xbf16> {
    %0 = stablehlo.convert %arg2 : (tensor<i32>) -> tensor<bf16>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %2 = stablehlo.select %arg0, %arg1, %1 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %2 : tensor<64x512x768xbf16>
  }
  func.func private @_threefry_split_75(%arg0: tensor<2xui32>) -> tensor<12x2xui32> {
    %0 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %1 = stablehlo.reshape %0 : (tensor<1xui32>) -> tensor<ui32>
    %2 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %3 = stablehlo.reshape %2 : (tensor<1xui32>) -> tensor<ui32>
    %4 = stablehlo.iota dim = 0 : tensor<12xui64>
    %c = stablehlo.constant dense<1> : tensor<ui64>
    %5 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<12xui64>
    %6 = stablehlo.multiply %5, %4 : tensor<12xui64>
    %c_0 = stablehlo.constant dense<32> : tensor<ui64>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<12xui64>
    %8 = stablehlo.shift_right_logical %6, %7 : tensor<12xui64>
    %9 = stablehlo.convert %6 : (tensor<12xui64>) -> tensor<12xui32>
    %10 = stablehlo.convert %8 : (tensor<12xui64>) -> tensor<12xui32>
    %11:2 = call @threefry2x32_77(%1, %3, %10, %9) : (tensor<ui32>, tensor<ui32>, tensor<12xui32>, tensor<12xui32>) -> (tensor<12xui32>, tensor<12xui32>)
    %12 = stablehlo.broadcast_in_dim %11#0, dims = [0] : (tensor<12xui32>) -> tensor<12x1xui32>
    %13 = stablehlo.broadcast_in_dim %11#1, dims = [0] : (tensor<12xui32>) -> tensor<12x1xui32>
    %14 = stablehlo.concatenate %12, %13, dim = 1 : (tensor<12x1xui32>, tensor<12x1xui32>) -> tensor<12x2xui32>
    return %14 : tensor<12x2xui32>
  }
  func.func private @threefry2x32_77(%arg0: tensor<ui32>, %arg1: tensor<ui32>, %arg2: tensor<12xui32>, %arg3: tensor<12xui32>) -> (tensor<12xui32>, tensor<12xui32>) {
    %0 = stablehlo.xor %arg0, %arg1 : tensor<ui32>
    %c = stablehlo.constant dense<466688986> : tensor<ui32>
    %1 = stablehlo.xor %0, %c : tensor<ui32>
    %2 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %3 = stablehlo.add %arg2, %2 : tensor<12xui32>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %5 = stablehlo.add %arg3, %4 : tensor<12xui32>
    %6 = stablehlo.add %3, %5 : tensor<12xui32>
    %c_0 = stablehlo.constant dense<13> : tensor<ui32>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %8 = stablehlo.shift_left %5, %7 : tensor<12xui32>
    %c_1 = stablehlo.constant dense<19> : tensor<ui32>
    %9 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %10 = stablehlo.shift_right_logical %5, %9 : tensor<12xui32>
    %11 = stablehlo.or %8, %10 : tensor<12xui32>
    %12 = stablehlo.xor %6, %11 : tensor<12xui32>
    %13 = stablehlo.add %6, %12 : tensor<12xui32>
    %c_2 = stablehlo.constant dense<15> : tensor<ui32>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %15 = stablehlo.shift_left %12, %14 : tensor<12xui32>
    %c_3 = stablehlo.constant dense<17> : tensor<ui32>
    %16 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %17 = stablehlo.shift_right_logical %12, %16 : tensor<12xui32>
    %18 = stablehlo.or %15, %17 : tensor<12xui32>
    %19 = stablehlo.xor %13, %18 : tensor<12xui32>
    %20 = stablehlo.add %13, %19 : tensor<12xui32>
    %c_4 = stablehlo.constant dense<26> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %22 = stablehlo.shift_left %19, %21 : tensor<12xui32>
    %c_5 = stablehlo.constant dense<6> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %24 = stablehlo.shift_right_logical %19, %23 : tensor<12xui32>
    %25 = stablehlo.or %22, %24 : tensor<12xui32>
    %26 = stablehlo.xor %20, %25 : tensor<12xui32>
    %27 = stablehlo.add %20, %26 : tensor<12xui32>
    %c_6 = stablehlo.constant dense<6> : tensor<ui32>
    %28 = stablehlo.broadcast_in_dim %c_6, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %29 = stablehlo.shift_left %26, %28 : tensor<12xui32>
    %c_7 = stablehlo.constant dense<26> : tensor<ui32>
    %30 = stablehlo.broadcast_in_dim %c_7, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %31 = stablehlo.shift_right_logical %26, %30 : tensor<12xui32>
    %32 = stablehlo.or %29, %31 : tensor<12xui32>
    %33 = stablehlo.xor %27, %32 : tensor<12xui32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %35 = stablehlo.add %27, %34 : tensor<12xui32>
    %36 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %37 = stablehlo.add %33, %36 : tensor<12xui32>
    %c_8 = stablehlo.constant dense<1> : tensor<ui32>
    %38 = stablehlo.broadcast_in_dim %c_8, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %39 = stablehlo.add %37, %38 : tensor<12xui32>
    %40 = stablehlo.add %35, %39 : tensor<12xui32>
    %c_9 = stablehlo.constant dense<17> : tensor<ui32>
    %41 = stablehlo.broadcast_in_dim %c_9, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %42 = stablehlo.shift_left %39, %41 : tensor<12xui32>
    %c_10 = stablehlo.constant dense<15> : tensor<ui32>
    %43 = stablehlo.broadcast_in_dim %c_10, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %44 = stablehlo.shift_right_logical %39, %43 : tensor<12xui32>
    %45 = stablehlo.or %42, %44 : tensor<12xui32>
    %46 = stablehlo.xor %40, %45 : tensor<12xui32>
    %47 = stablehlo.add %40, %46 : tensor<12xui32>
    %c_11 = stablehlo.constant dense<29> : tensor<ui32>
    %48 = stablehlo.broadcast_in_dim %c_11, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %49 = stablehlo.shift_left %46, %48 : tensor<12xui32>
    %c_12 = stablehlo.constant dense<3> : tensor<ui32>
    %50 = stablehlo.broadcast_in_dim %c_12, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %51 = stablehlo.shift_right_logical %46, %50 : tensor<12xui32>
    %52 = stablehlo.or %49, %51 : tensor<12xui32>
    %53 = stablehlo.xor %47, %52 : tensor<12xui32>
    %54 = stablehlo.add %47, %53 : tensor<12xui32>
    %c_13 = stablehlo.constant dense<16> : tensor<ui32>
    %55 = stablehlo.broadcast_in_dim %c_13, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %56 = stablehlo.shift_left %53, %55 : tensor<12xui32>
    %c_14 = stablehlo.constant dense<16> : tensor<ui32>
    %57 = stablehlo.broadcast_in_dim %c_14, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %58 = stablehlo.shift_right_logical %53, %57 : tensor<12xui32>
    %59 = stablehlo.or %56, %58 : tensor<12xui32>
    %60 = stablehlo.xor %54, %59 : tensor<12xui32>
    %61 = stablehlo.add %54, %60 : tensor<12xui32>
    %c_15 = stablehlo.constant dense<24> : tensor<ui32>
    %62 = stablehlo.broadcast_in_dim %c_15, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %63 = stablehlo.shift_left %60, %62 : tensor<12xui32>
    %c_16 = stablehlo.constant dense<8> : tensor<ui32>
    %64 = stablehlo.broadcast_in_dim %c_16, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %65 = stablehlo.shift_right_logical %60, %64 : tensor<12xui32>
    %66 = stablehlo.or %63, %65 : tensor<12xui32>
    %67 = stablehlo.xor %61, %66 : tensor<12xui32>
    %68 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %69 = stablehlo.add %61, %68 : tensor<12xui32>
    %70 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %71 = stablehlo.add %67, %70 : tensor<12xui32>
    %c_17 = stablehlo.constant dense<2> : tensor<ui32>
    %72 = stablehlo.broadcast_in_dim %c_17, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %73 = stablehlo.add %71, %72 : tensor<12xui32>
    %74 = stablehlo.add %69, %73 : tensor<12xui32>
    %c_18 = stablehlo.constant dense<13> : tensor<ui32>
    %75 = stablehlo.broadcast_in_dim %c_18, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %76 = stablehlo.shift_left %73, %75 : tensor<12xui32>
    %c_19 = stablehlo.constant dense<19> : tensor<ui32>
    %77 = stablehlo.broadcast_in_dim %c_19, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %78 = stablehlo.shift_right_logical %73, %77 : tensor<12xui32>
    %79 = stablehlo.or %76, %78 : tensor<12xui32>
    %80 = stablehlo.xor %74, %79 : tensor<12xui32>
    %81 = stablehlo.add %74, %80 : tensor<12xui32>
    %c_20 = stablehlo.constant dense<15> : tensor<ui32>
    %82 = stablehlo.broadcast_in_dim %c_20, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %83 = stablehlo.shift_left %80, %82 : tensor<12xui32>
    %c_21 = stablehlo.constant dense<17> : tensor<ui32>
    %84 = stablehlo.broadcast_in_dim %c_21, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %85 = stablehlo.shift_right_logical %80, %84 : tensor<12xui32>
    %86 = stablehlo.or %83, %85 : tensor<12xui32>
    %87 = stablehlo.xor %81, %86 : tensor<12xui32>
    %88 = stablehlo.add %81, %87 : tensor<12xui32>
    %c_22 = stablehlo.constant dense<26> : tensor<ui32>
    %89 = stablehlo.broadcast_in_dim %c_22, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %90 = stablehlo.shift_left %87, %89 : tensor<12xui32>
    %c_23 = stablehlo.constant dense<6> : tensor<ui32>
    %91 = stablehlo.broadcast_in_dim %c_23, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %92 = stablehlo.shift_right_logical %87, %91 : tensor<12xui32>
    %93 = stablehlo.or %90, %92 : tensor<12xui32>
    %94 = stablehlo.xor %88, %93 : tensor<12xui32>
    %95 = stablehlo.add %88, %94 : tensor<12xui32>
    %c_24 = stablehlo.constant dense<6> : tensor<ui32>
    %96 = stablehlo.broadcast_in_dim %c_24, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %97 = stablehlo.shift_left %94, %96 : tensor<12xui32>
    %c_25 = stablehlo.constant dense<26> : tensor<ui32>
    %98 = stablehlo.broadcast_in_dim %c_25, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %99 = stablehlo.shift_right_logical %94, %98 : tensor<12xui32>
    %100 = stablehlo.or %97, %99 : tensor<12xui32>
    %101 = stablehlo.xor %95, %100 : tensor<12xui32>
    %102 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %103 = stablehlo.add %95, %102 : tensor<12xui32>
    %104 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %105 = stablehlo.add %101, %104 : tensor<12xui32>
    %c_26 = stablehlo.constant dense<3> : tensor<ui32>
    %106 = stablehlo.broadcast_in_dim %c_26, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %107 = stablehlo.add %105, %106 : tensor<12xui32>
    %108 = stablehlo.add %103, %107 : tensor<12xui32>
    %c_27 = stablehlo.constant dense<17> : tensor<ui32>
    %109 = stablehlo.broadcast_in_dim %c_27, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %110 = stablehlo.shift_left %107, %109 : tensor<12xui32>
    %c_28 = stablehlo.constant dense<15> : tensor<ui32>
    %111 = stablehlo.broadcast_in_dim %c_28, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %112 = stablehlo.shift_right_logical %107, %111 : tensor<12xui32>
    %113 = stablehlo.or %110, %112 : tensor<12xui32>
    %114 = stablehlo.xor %108, %113 : tensor<12xui32>
    %115 = stablehlo.add %108, %114 : tensor<12xui32>
    %c_29 = stablehlo.constant dense<29> : tensor<ui32>
    %116 = stablehlo.broadcast_in_dim %c_29, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %117 = stablehlo.shift_left %114, %116 : tensor<12xui32>
    %c_30 = stablehlo.constant dense<3> : tensor<ui32>
    %118 = stablehlo.broadcast_in_dim %c_30, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %119 = stablehlo.shift_right_logical %114, %118 : tensor<12xui32>
    %120 = stablehlo.or %117, %119 : tensor<12xui32>
    %121 = stablehlo.xor %115, %120 : tensor<12xui32>
    %122 = stablehlo.add %115, %121 : tensor<12xui32>
    %c_31 = stablehlo.constant dense<16> : tensor<ui32>
    %123 = stablehlo.broadcast_in_dim %c_31, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %124 = stablehlo.shift_left %121, %123 : tensor<12xui32>
    %c_32 = stablehlo.constant dense<16> : tensor<ui32>
    %125 = stablehlo.broadcast_in_dim %c_32, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %126 = stablehlo.shift_right_logical %121, %125 : tensor<12xui32>
    %127 = stablehlo.or %124, %126 : tensor<12xui32>
    %128 = stablehlo.xor %122, %127 : tensor<12xui32>
    %129 = stablehlo.add %122, %128 : tensor<12xui32>
    %c_33 = stablehlo.constant dense<24> : tensor<ui32>
    %130 = stablehlo.broadcast_in_dim %c_33, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %131 = stablehlo.shift_left %128, %130 : tensor<12xui32>
    %c_34 = stablehlo.constant dense<8> : tensor<ui32>
    %132 = stablehlo.broadcast_in_dim %c_34, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %133 = stablehlo.shift_right_logical %128, %132 : tensor<12xui32>
    %134 = stablehlo.or %131, %133 : tensor<12xui32>
    %135 = stablehlo.xor %129, %134 : tensor<12xui32>
    %136 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %137 = stablehlo.add %129, %136 : tensor<12xui32>
    %138 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %139 = stablehlo.add %135, %138 : tensor<12xui32>
    %c_35 = stablehlo.constant dense<4> : tensor<ui32>
    %140 = stablehlo.broadcast_in_dim %c_35, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %141 = stablehlo.add %139, %140 : tensor<12xui32>
    %142 = stablehlo.add %137, %141 : tensor<12xui32>
    %c_36 = stablehlo.constant dense<13> : tensor<ui32>
    %143 = stablehlo.broadcast_in_dim %c_36, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %144 = stablehlo.shift_left %141, %143 : tensor<12xui32>
    %c_37 = stablehlo.constant dense<19> : tensor<ui32>
    %145 = stablehlo.broadcast_in_dim %c_37, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %146 = stablehlo.shift_right_logical %141, %145 : tensor<12xui32>
    %147 = stablehlo.or %144, %146 : tensor<12xui32>
    %148 = stablehlo.xor %142, %147 : tensor<12xui32>
    %149 = stablehlo.add %142, %148 : tensor<12xui32>
    %c_38 = stablehlo.constant dense<15> : tensor<ui32>
    %150 = stablehlo.broadcast_in_dim %c_38, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %151 = stablehlo.shift_left %148, %150 : tensor<12xui32>
    %c_39 = stablehlo.constant dense<17> : tensor<ui32>
    %152 = stablehlo.broadcast_in_dim %c_39, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %153 = stablehlo.shift_right_logical %148, %152 : tensor<12xui32>
    %154 = stablehlo.or %151, %153 : tensor<12xui32>
    %155 = stablehlo.xor %149, %154 : tensor<12xui32>
    %156 = stablehlo.add %149, %155 : tensor<12xui32>
    %c_40 = stablehlo.constant dense<26> : tensor<ui32>
    %157 = stablehlo.broadcast_in_dim %c_40, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %158 = stablehlo.shift_left %155, %157 : tensor<12xui32>
    %c_41 = stablehlo.constant dense<6> : tensor<ui32>
    %159 = stablehlo.broadcast_in_dim %c_41, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %160 = stablehlo.shift_right_logical %155, %159 : tensor<12xui32>
    %161 = stablehlo.or %158, %160 : tensor<12xui32>
    %162 = stablehlo.xor %156, %161 : tensor<12xui32>
    %163 = stablehlo.add %156, %162 : tensor<12xui32>
    %c_42 = stablehlo.constant dense<6> : tensor<ui32>
    %164 = stablehlo.broadcast_in_dim %c_42, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %165 = stablehlo.shift_left %162, %164 : tensor<12xui32>
    %c_43 = stablehlo.constant dense<26> : tensor<ui32>
    %166 = stablehlo.broadcast_in_dim %c_43, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %167 = stablehlo.shift_right_logical %162, %166 : tensor<12xui32>
    %168 = stablehlo.or %165, %167 : tensor<12xui32>
    %169 = stablehlo.xor %163, %168 : tensor<12xui32>
    %170 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %171 = stablehlo.add %163, %170 : tensor<12xui32>
    %172 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %173 = stablehlo.add %169, %172 : tensor<12xui32>
    %c_44 = stablehlo.constant dense<5> : tensor<ui32>
    %174 = stablehlo.broadcast_in_dim %c_44, dims = [] : (tensor<ui32>) -> tensor<12xui32>
    %175 = stablehlo.add %173, %174 : tensor<12xui32>
    return %171, %175 : tensor<12xui32>, tensor<12xui32>
  }
  func.func private @_where_89(%arg0: tensor<64x512x1x512xi32>, %arg1: tensor<bf16>) -> (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<i32>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<i32>) -> tensor<64x512x1x512xi32>
    %2 = stablehlo.compare  NE, %arg0, %1,  SIGNED : (tensor<64x512x1x512xi32>, tensor<64x512x1x512xi32>) -> tensor<64x512x1x512xi1>
    %3 = stablehlo.broadcast_in_dim %2, dims = [0, 1, 2, 3] : (tensor<64x512x1x512xi1>) -> tensor<64x512x12x512xi1>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    return %3, %4 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
  }
  func.func private @_bernoulli_93() -> (tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>) {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %cst_0 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %0:2 = call @_uniform_94(%cst, %cst_0) : (tensor<f32>, tensor<f32>) -> (tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>)
    return %0#0, %0#1 : tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>
  }
  func.func private @_uniform_94(%arg0: tensor<f32>, %arg1: tensor<f32>) -> (tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>) {
    %0 = stablehlo.convert %arg0 : tensor<f32>
    %1 = stablehlo.convert %arg1 : tensor<f32>
    %2 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<f32>) -> tensor<1x1x1x1xf32>
    %3 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<f32>) -> tensor<1x1x1x1xf32>
    %4 = stablehlo.subtract %3, %2 : tensor<1x1x1x1xf32>
    return %2, %4 : tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>
  }
  func.func private @_where_97(%arg0: tensor<i32>) -> tensor<64x512x12x512xbf16> {
    %0 = stablehlo.convert %arg0 : (tensor<i32>) -> tensor<bf16>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    return %1 : tensor<64x512x12x512xbf16>
  }
  func.func private @_bernoulli_99() -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>) {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %cst_0 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %0:2 = call @_uniform_100(%cst, %cst_0) : (tensor<f32>, tensor<f32>) -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>)
    return %0#0, %0#1 : tensor<1x1x1xf32>, tensor<1x1x1xf32>
  }
  func.func private @_uniform_100(%arg0: tensor<f32>, %arg1: tensor<f32>) -> (tensor<1x1x1xf32>, tensor<1x1x1xf32>) {
    %0 = stablehlo.convert %arg0 : tensor<f32>
    %1 = stablehlo.convert %arg1 : tensor<f32>
    %2 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<f32>) -> tensor<1x1x1xf32>
    %3 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<f32>) -> tensor<1x1x1xf32>
    %4 = stablehlo.subtract %3, %2 : tensor<1x1x1xf32>
    return %2, %4 : tensor<1x1x1xf32>, tensor<1x1x1xf32>
  }
  func.func private @_where_101(%arg0: tensor<i32>) -> tensor<64x512x768xbf16> {
    %0 = stablehlo.convert %arg0 : (tensor<i32>) -> tensor<bf16>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    return %1 : tensor<64x512x768xbf16>
  }
  func.func private @closed_call(%arg0: tensor<1x1x1xf32>, %arg1: tensor<1x1x1xf32>, %arg2: tensor<f32>, %arg3: tensor<1x1x1xf32>, %arg4: tensor<1x1x1xf32>, %arg5: tensor<f32>, %arg6: tensor<1x1x1x1xf32>, %arg7: tensor<1x1x1x1xf32>, %arg8: tensor<f32>, %arg9: tensor<bf16>, %arg10: tensor<64x512x12x512xi1>, %arg11: tensor<64x512x12x512xbf16>, %arg12: tensor<64x512x12x512xbf16>, %arg13: tensor<64x512x768xbf16>, %arg14: tensor<64x512x768xbf16>, %arg15: tensor<64x512x1xf32>, %arg16: tensor<64x512x1xf32>, %arg17: tensor<64x512x1xf32>, %arg18: tensor<64x512x1xf32>, %arg19: tensor<bf16>, %arg20: tensor<64x512x1xf32>, %arg21: tensor<64x512x1xf32>, %arg22: tensor<64x512x1xf32>, %arg23: tensor<64x512x1xf32>, %arg24: tensor<64x512x768xbf16>, %arg25: tensor<768x768xbf16>, %arg26: tensor<768xbf16>, %arg27: tensor<768x768xbf16>, %arg28: tensor<768xbf16>, %arg29: tensor<768x768xbf16>, %arg30: tensor<768xbf16>, %arg31: tensor<768x768xbf16>, %arg32: tensor<768xbf16>, %arg33: tensor<768xbf16>, %arg34: tensor<768xbf16>, %arg35: tensor<3072x768xbf16>, %arg36: tensor<3072xbf16>, %arg37: tensor<768x3072xbf16>, %arg38: tensor<768xbf16>, %arg39: tensor<768xbf16>, %arg40: tensor<768xbf16>, %arg41: tensor<2xui32>) -> (tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768x768xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x512xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x64xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x768xf32>, tensor<64x512x768xf32>, tensor<1x1x768xf32>, tensor<768x3072xbf16>, tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<3072x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x768xf32>, tensor<64x512x768xf32>, tensor<1x1x768xf32>) {
    %0 = call @_threefry_split(%arg41) : (tensor<2xui32>) -> tensor<2x2xui32>
    %1 = stablehlo.slice %0 [0:1, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %2 = stablehlo.reshape %1 : (tensor<1x2xui32>) -> tensor<2xui32>
    %3 = stablehlo.slice %0 [1:2, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %4 = stablehlo.reshape %3 : (tensor<1x2xui32>) -> tensor<2xui32>
    %5 = call @_threefry_split(%2) : (tensor<2xui32>) -> tensor<2x2xui32>
    %6 = stablehlo.slice %5 [0:1, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %7 = stablehlo.reshape %6 : (tensor<1x2xui32>) -> tensor<2xui32>
    %8 = stablehlo.slice %5 [1:2, 0:2] : (tensor<2x2xui32>) -> tensor<1x2xui32>
    %9 = stablehlo.reshape %8 : (tensor<1x2xui32>) -> tensor<2xui32>
    %10 = stablehlo.transpose %arg25, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %11 = stablehlo.dot_general %arg24, %10, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %12 = stablehlo.broadcast_in_dim %arg26, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %13 = stablehlo.broadcast_in_dim %12, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %14 = stablehlo.add %11, %13 : tensor<64x512x768xbf16>
    %15 = stablehlo.reshape %14 : (tensor<64x512x768xbf16>) -> tensor<64x512x12x64xbf16>
    %16 = stablehlo.transpose %arg27, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %17 = stablehlo.dot_general %arg24, %16, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %18 = stablehlo.broadcast_in_dim %arg28, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %19 = stablehlo.broadcast_in_dim %18, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %20 = stablehlo.add %17, %19 : tensor<64x512x768xbf16>
    %21 = stablehlo.reshape %20 : (tensor<64x512x768xbf16>) -> tensor<64x512x12x64xbf16>
    %22 = stablehlo.transpose %arg29, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %23 = stablehlo.dot_general %arg24, %22, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %24 = stablehlo.broadcast_in_dim %arg30, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %25 = stablehlo.broadcast_in_dim %24, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %26 = stablehlo.add %23, %25 : tensor<64x512x768xbf16>
    %27 = stablehlo.reshape %26 : (tensor<64x512x768xbf16>) -> tensor<64x512x12x64xbf16>
    %28 = stablehlo.broadcast_in_dim %arg9, dims = [] : (tensor<bf16>) -> tensor<64x512x12x64xbf16>
    %29 = stablehlo.divide %15, %28 : tensor<64x512x12x64xbf16>
    %30 = stablehlo.dot_general %21, %29, batching_dims = [0, 2] x [0, 2], contracting_dims = [3] x [3], precision = [DEFAULT, DEFAULT] : (tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>) -> tensor<64x12x512x512xbf16>
    %31 = stablehlo.transpose %30, dims = [0, 3, 1, 2] : (tensor<64x12x512x512xbf16>) -> tensor<64x512x12x512xbf16>
    %32 = call @_where_135(%31, %arg10, %arg11) : (tensor<64x512x12x512xbf16>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
    %33 = stablehlo.convert %32 : (tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xf32>
    %cst = stablehlo.constant dense<0xFF800000> : tensor<f32>
    %34 = stablehlo.reduce(%33 init: %cst) applies stablehlo.maximum across dimensions = [3] : (tensor<64x512x12x512xf32>, tensor<f32>) -> tensor<64x512x12xf32>
    %cst_0 = stablehlo.constant dense<0xFF800000> : tensor<f32>
    %35 = stablehlo.broadcast_in_dim %cst_0, dims = [] : (tensor<f32>) -> tensor<64x512x12xf32>
    %36 = stablehlo.maximum %35, %34 : tensor<64x512x12xf32>
    %37 = stablehlo.broadcast_in_dim %36, dims = [0, 1, 2] : (tensor<64x512x12xf32>) -> tensor<64x512x12x1xf32>
    %38 = stablehlo.broadcast_in_dim %37, dims = [0, 1, 2, 3] : (tensor<64x512x12x1xf32>) -> tensor<64x512x12x512xf32>
    %39 = stablehlo.subtract %33, %38 : tensor<64x512x12x512xf32>
    %40 = stablehlo.exponential %39 : tensor<64x512x12x512xf32>
    %cst_1 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %41 = stablehlo.reduce(%40 init: %cst_1) applies stablehlo.add across dimensions = [3] : (tensor<64x512x12x512xf32>, tensor<f32>) -> tensor<64x512x12xf32>
    %42 = stablehlo.broadcast_in_dim %41, dims = [0, 1, 2] : (tensor<64x512x12xf32>) -> tensor<64x512x12x1xf32>
    %43 = stablehlo.broadcast_in_dim %42, dims = [0, 1, 2, 3] : (tensor<64x512x12x1xf32>) -> tensor<64x512x12x512xf32>
    %44 = stablehlo.divide %40, %43 : tensor<64x512x12x512xf32>
    %45 = stablehlo.multiply %42, %42 : tensor<64x512x12x1xf32>
    %cst_2 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %46 = stablehlo.broadcast_in_dim %cst_2, dims = [] : (tensor<f32>) -> tensor<64x512x12x1xf32>
    %47 = stablehlo.divide %46, %45 : tensor<64x512x12x1xf32>
    %48 = stablehlo.convert %44 : (tensor<64x512x12x512xf32>) -> tensor<64x512x12x512xbf16>
    %49 = call @_bernoulli_147(%7, %arg6, %arg7, %arg8) : (tensor<2xui32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>, tensor<f32>) -> tensor<64x512x12x512xi1>
    %cst_3 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %50 = stablehlo.broadcast_in_dim %cst_3, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    %51 = stablehlo.divide %48, %50 : tensor<64x512x12x512xbf16>
    %52 = call @_where_166(%49, %51, %arg12) : (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
    %53 = stablehlo.dot_general %27, %52, batching_dims = [0, 2] x [0, 2], contracting_dims = [1] x [3], precision = [DEFAULT, DEFAULT] : (tensor<64x512x12x64xbf16>, tensor<64x512x12x512xbf16>) -> tensor<64x12x64x512xbf16>
    %54 = stablehlo.transpose %53, dims = [0, 3, 1, 2] : (tensor<64x12x64x512xbf16>) -> tensor<64x512x12x64xbf16>
    %55 = stablehlo.reshape %54 : (tensor<64x512x12x64xbf16>) -> tensor<64x512x768xbf16>
    %56 = stablehlo.transpose %arg31, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %57 = stablehlo.dot_general %55, %56, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %58 = stablehlo.broadcast_in_dim %arg32, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %59 = stablehlo.broadcast_in_dim %58, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %60 = stablehlo.add %57, %59 : tensor<64x512x768xbf16>
    %61 = call @_bernoulli_171(%9, %arg3, %arg4, %arg5) : (tensor<2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>) -> tensor<64x512x768xi1>
    %cst_4 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %62 = stablehlo.broadcast_in_dim %cst_4, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %63 = stablehlo.divide %60, %62 : tensor<64x512x768xbf16>
    %64 = call @_where_173(%61, %63, %arg13) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %65 = stablehlo.add %64, %arg24 : tensor<64x512x768xbf16>
    %66 = stablehlo.convert %65 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst_5 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %67 = stablehlo.reduce(%66 init: %cst_5) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %68 = stablehlo.broadcast_in_dim %67, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_6 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %69 = stablehlo.broadcast_in_dim %cst_6, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %70 = stablehlo.divide %68, %69 : tensor<64x512x1xf32>
    %71 = stablehlo.broadcast_in_dim %70, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %72 = stablehlo.subtract %66, %71 : tensor<64x512x768xf32>
    %73 = stablehlo.multiply %66, %66 : tensor<64x512x768xf32>
    %cst_7 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %74 = stablehlo.broadcast_in_dim %cst_7, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %75 = stablehlo.multiply %74, %66 : tensor<64x512x768xf32>
    %cst_8 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %76 = stablehlo.reduce(%73 init: %cst_8) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %77 = stablehlo.broadcast_in_dim %76, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_9 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %78 = stablehlo.broadcast_in_dim %cst_9, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %79 = stablehlo.divide %77, %78 : tensor<64x512x1xf32>
    %80 = stablehlo.multiply %70, %70 : tensor<64x512x1xf32>
    %cst_10 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %81 = stablehlo.broadcast_in_dim %cst_10, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %82 = stablehlo.multiply %81, %70 : tensor<64x512x1xf32>
    %83 = stablehlo.subtract %79, %80 : tensor<64x512x1xf32>
    %cst_11 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %84 = stablehlo.broadcast_in_dim %cst_11, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %85 = stablehlo.maximum %84, %83 : tensor<64x512x1xf32>
    %86 = stablehlo.compare  EQ, %83, %85,  FLOAT : (tensor<64x512x1xf32>, tensor<64x512x1xf32>) -> tensor<64x512x1xi1>
    %87 = stablehlo.select %86, %arg16, %arg15 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    %cst_12 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %88 = stablehlo.broadcast_in_dim %cst_12, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %89 = stablehlo.compare  EQ, %88, %85,  FLOAT : (tensor<64x512x1xf32>, tensor<64x512x1xf32>) -> tensor<64x512x1xi1>
    %90 = stablehlo.select %89, %arg18, %arg17 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    %91 = stablehlo.divide %87, %90 : tensor<64x512x1xf32>
    %cst_13 = stablehlo.constant dense<9.99999996E-13> : tensor<f32>
    %92 = stablehlo.broadcast_in_dim %cst_13, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %93 = stablehlo.add %85, %92 : tensor<64x512x1xf32>
    %94 = stablehlo.rsqrt %93 : tensor<64x512x1xf32>
    %95 = stablehlo.divide %94, %93 : tensor<64x512x1xf32>
    %cst_14 = stablehlo.constant dense<-5.000000e-01> : tensor<f32>
    %96 = stablehlo.broadcast_in_dim %cst_14, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %97 = stablehlo.multiply %96, %95 : tensor<64x512x1xf32>
    %98 = stablehlo.broadcast_in_dim %94, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %99 = stablehlo.multiply %72, %98 : tensor<64x512x768xf32>
    %100 = stablehlo.convert %arg33 : (tensor<768xbf16>) -> tensor<768xf32>
    %101 = stablehlo.broadcast_in_dim %100, dims = [2] : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %102 = stablehlo.broadcast_in_dim %101, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %103 = stablehlo.multiply %102, %99 : tensor<64x512x768xf32>
    %104 = stablehlo.convert %arg34 : (tensor<768xbf16>) -> tensor<768xf32>
    %105 = stablehlo.broadcast_in_dim %104, dims = [2] : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %106 = stablehlo.broadcast_in_dim %105, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %107 = stablehlo.add %103, %106 : tensor<64x512x768xf32>
    %108 = stablehlo.convert %107 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %109 = stablehlo.transpose %arg35, dims = [1, 0] : (tensor<3072x768xbf16>) -> tensor<768x3072xbf16>
    %110 = stablehlo.dot_general %108, %109, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x3072xbf16>) -> tensor<64x512x3072xbf16>
    %111 = stablehlo.broadcast_in_dim %arg36, dims = [2] : (tensor<3072xbf16>) -> tensor<1x1x3072xbf16>
    %112 = stablehlo.broadcast_in_dim %111, dims = [0, 1, 2] : (tensor<1x1x3072xbf16>) -> tensor<64x512x3072xbf16>
    %113 = stablehlo.add %110, %112 : tensor<64x512x3072xbf16>
    %114 = stablehlo.multiply %113, %113 : tensor<64x512x3072xbf16>
    %115 = stablehlo.multiply %114, %113 : tensor<64x512x3072xbf16>
    %116 = stablehlo.multiply %113, %113 : tensor<64x512x3072xbf16>
    %cst_15 = stablehlo.constant dense<3.000000e+00> : tensor<bf16>
    %117 = stablehlo.broadcast_in_dim %cst_15, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %118 = stablehlo.multiply %117, %116 : tensor<64x512x3072xbf16>
    %cst_16 = stablehlo.constant dense<4.467770e-02> : tensor<bf16>
    %119 = stablehlo.broadcast_in_dim %cst_16, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %120 = stablehlo.multiply %119, %115 : tensor<64x512x3072xbf16>
    %121 = stablehlo.add %113, %120 : tensor<64x512x3072xbf16>
    %cst_17 = stablehlo.constant dense<7.968750e-01> : tensor<bf16>
    %122 = stablehlo.broadcast_in_dim %cst_17, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %123 = stablehlo.multiply %122, %121 : tensor<64x512x3072xbf16>
    %124 = stablehlo.tanh %123 : tensor<64x512x3072xbf16>
    %125 = stablehlo.broadcast_in_dim %arg19, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %126 = stablehlo.subtract %125, %124 : tensor<64x512x3072xbf16>
    %cst_18 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %127 = stablehlo.broadcast_in_dim %cst_18, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %128 = stablehlo.add %127, %124 : tensor<64x512x3072xbf16>
    %cst_19 = stablehlo.constant dense<5.000000e-01> : tensor<bf16>
    %129 = stablehlo.broadcast_in_dim %cst_19, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %130 = stablehlo.multiply %129, %128 : tensor<64x512x3072xbf16>
    %131 = stablehlo.multiply %113, %130 : tensor<64x512x3072xbf16>
    %132 = stablehlo.transpose %arg37, dims = [1, 0] : (tensor<768x3072xbf16>) -> tensor<3072x768xbf16>
    %133 = stablehlo.dot_general %131, %132, contracting_dims = [2] x [0], precision = [DEFAULT, DEFAULT] : (tensor<64x512x3072xbf16>, tensor<3072x768xbf16>) -> tensor<64x512x768xbf16>
    %134 = stablehlo.broadcast_in_dim %arg38, dims = [2] : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %135 = stablehlo.broadcast_in_dim %134, dims = [0, 1, 2] : (tensor<1x1x768xbf16>) -> tensor<64x512x768xbf16>
    %136 = stablehlo.add %133, %135 : tensor<64x512x768xbf16>
    %137 = call @_bernoulli_171(%4, %arg0, %arg1, %arg2) : (tensor<2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<f32>) -> tensor<64x512x768xi1>
    %cst_20 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %138 = stablehlo.broadcast_in_dim %cst_20, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %139 = stablehlo.divide %136, %138 : tensor<64x512x768xbf16>
    %140 = call @_where_173(%137, %139, %arg14) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %141 = stablehlo.add %140, %108 : tensor<64x512x768xbf16>
    %142 = stablehlo.convert %141 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst_21 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %143 = stablehlo.reduce(%142 init: %cst_21) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %144 = stablehlo.broadcast_in_dim %143, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_22 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %145 = stablehlo.broadcast_in_dim %cst_22, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %146 = stablehlo.divide %144, %145 : tensor<64x512x1xf32>
    %147 = stablehlo.broadcast_in_dim %146, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %148 = stablehlo.subtract %142, %147 : tensor<64x512x768xf32>
    %149 = stablehlo.multiply %142, %142 : tensor<64x512x768xf32>
    %cst_23 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %150 = stablehlo.broadcast_in_dim %cst_23, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %151 = stablehlo.multiply %150, %142 : tensor<64x512x768xf32>
    %cst_24 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %152 = stablehlo.reduce(%149 init: %cst_24) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %153 = stablehlo.broadcast_in_dim %152, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %cst_25 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %154 = stablehlo.broadcast_in_dim %cst_25, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %155 = stablehlo.divide %153, %154 : tensor<64x512x1xf32>
    %156 = stablehlo.multiply %146, %146 : tensor<64x512x1xf32>
    %cst_26 = stablehlo.constant dense<2.000000e+00> : tensor<f32>
    %157 = stablehlo.broadcast_in_dim %cst_26, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %158 = stablehlo.multiply %157, %146 : tensor<64x512x1xf32>
    %159 = stablehlo.subtract %155, %156 : tensor<64x512x1xf32>
    %cst_27 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %160 = stablehlo.broadcast_in_dim %cst_27, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %161 = stablehlo.maximum %160, %159 : tensor<64x512x1xf32>
    %162 = stablehlo.compare  EQ, %159, %161,  FLOAT : (tensor<64x512x1xf32>, tensor<64x512x1xf32>) -> tensor<64x512x1xi1>
    %163 = stablehlo.select %162, %arg21, %arg20 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    %cst_28 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %164 = stablehlo.broadcast_in_dim %cst_28, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %165 = stablehlo.compare  EQ, %164, %161,  FLOAT : (tensor<64x512x1xf32>, tensor<64x512x1xf32>) -> tensor<64x512x1xi1>
    %166 = stablehlo.select %165, %arg23, %arg22 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    %167 = stablehlo.divide %163, %166 : tensor<64x512x1xf32>
    %cst_29 = stablehlo.constant dense<9.99999996E-13> : tensor<f32>
    %168 = stablehlo.broadcast_in_dim %cst_29, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %169 = stablehlo.add %161, %168 : tensor<64x512x1xf32>
    %170 = stablehlo.rsqrt %169 : tensor<64x512x1xf32>
    %171 = stablehlo.divide %170, %169 : tensor<64x512x1xf32>
    %cst_30 = stablehlo.constant dense<-5.000000e-01> : tensor<f32>
    %172 = stablehlo.broadcast_in_dim %cst_30, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %173 = stablehlo.multiply %172, %171 : tensor<64x512x1xf32>
    %174 = stablehlo.broadcast_in_dim %170, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %175 = stablehlo.multiply %148, %174 : tensor<64x512x768xf32>
    %176 = stablehlo.convert %arg39 : (tensor<768xbf16>) -> tensor<768xf32>
    %177 = stablehlo.broadcast_in_dim %176, dims = [2] : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %178 = stablehlo.broadcast_in_dim %177, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %179 = stablehlo.multiply %178, %175 : tensor<64x512x768xf32>
    %180 = stablehlo.convert %arg40 : (tensor<768xbf16>) -> tensor<768xf32>
    %181 = stablehlo.broadcast_in_dim %180, dims = [2] : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %182 = stablehlo.broadcast_in_dim %181, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %183 = stablehlo.add %179, %182 : tensor<64x512x768xf32>
    %184 = stablehlo.convert %183 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    return %184, %10, %arg24, %16, %22, %29, %21, %40, %42, %47, %49, %52, %27, %56, %55, %61, %75, %82, %91, %97, %94, %72, %99, %101, %109, %108, %118, %124, %126, %130, %113, %132, %131, %137, %151, %158, %167, %173, %170, %148, %175, %177 : tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768x768xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x64xbf16>, tensor<64x512x12x512xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x1xf32>, tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>, tensor<64x512x12x64xbf16>, tensor<768x768xbf16>, tensor<64x512x768xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x768xf32>, tensor<64x512x768xf32>, tensor<1x1x768xf32>, tensor<768x3072xbf16>, tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x3072xbf16>, tensor<3072x768xbf16>, tensor<64x512x3072xbf16>, tensor<64x512x768xi1>, tensor<64x512x768xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x1xf32>, tensor<64x512x768xf32>, tensor<64x512x768xf32>, tensor<1x1x768xf32>
  }
  func.func private @_where_135(%arg0: tensor<64x512x12x512xbf16>, %arg1: tensor<64x512x12x512xi1>, %arg2: tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16> {
    %0 = stablehlo.select %arg1, %arg0, %arg2 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
    return %0 : tensor<64x512x12x512xbf16>
  }
  func.func private @_bernoulli_147(%arg0: tensor<2xui32>, %arg1: tensor<1x1x1x1xf32>, %arg2: tensor<1x1x1x1xf32>, %arg3: tensor<f32>) -> tensor<64x512x12x512xi1> {
    %0 = call @_uniform_148(%arg0, %arg1, %arg2) : (tensor<2xui32>, tensor<1x1x1x1xf32>, tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32>
    %1 = stablehlo.broadcast_in_dim %arg3, dims = [] : (tensor<f32>) -> tensor<64x512x12x512xf32>
    %2 = stablehlo.compare  LT, %0, %1,  FLOAT : (tensor<64x512x12x512xf32>, tensor<64x512x12x512xf32>) -> tensor<64x512x12x512xi1>
    return %2 : tensor<64x512x12x512xi1>
  }
  func.func private @_uniform_148(%arg0: tensor<2xui32>, %arg1: tensor<1x1x1x1xf32>, %arg2: tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32> {
    %0 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %1 = stablehlo.reshape %0 : (tensor<1xui32>) -> tensor<ui32>
    %2 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %3 = stablehlo.reshape %2 : (tensor<1xui32>) -> tensor<ui32>
    %4 = stablehlo.iota dim = 0 : tensor<64x512x12x512xui64>
    %5 = stablehlo.iota dim = 1 : tensor<64x512x12x512xui64>
    %6 = stablehlo.iota dim = 2 : tensor<64x512x12x512xui64>
    %7 = stablehlo.iota dim = 3 : tensor<64x512x12x512xui64>
    %c = stablehlo.constant dense<3145728> : tensor<ui64>
    %8 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %9 = stablehlo.multiply %8, %4 : tensor<64x512x12x512xui64>
    %c_0 = stablehlo.constant dense<6144> : tensor<ui64>
    %10 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %11 = stablehlo.multiply %10, %5 : tensor<64x512x12x512xui64>
    %c_1 = stablehlo.constant dense<512> : tensor<ui64>
    %12 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %13 = stablehlo.multiply %12, %6 : tensor<64x512x12x512xui64>
    %c_2 = stablehlo.constant dense<1> : tensor<ui64>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %15 = stablehlo.multiply %14, %7 : tensor<64x512x12x512xui64>
    %16 = stablehlo.add %9, %11 : tensor<64x512x12x512xui64>
    %17 = stablehlo.add %16, %13 : tensor<64x512x12x512xui64>
    %18 = stablehlo.add %17, %15 : tensor<64x512x12x512xui64>
    %c_3 = stablehlo.constant dense<32> : tensor<ui64>
    %19 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui64>) -> tensor<64x512x12x512xui64>
    %20 = stablehlo.shift_right_logical %18, %19 : tensor<64x512x12x512xui64>
    %21 = stablehlo.convert %18 : (tensor<64x512x12x512xui64>) -> tensor<64x512x12x512xui32>
    %22 = stablehlo.convert %20 : (tensor<64x512x12x512xui64>) -> tensor<64x512x12x512xui32>
    %23:2 = call @threefry2x32_151(%1, %3, %22, %21) : (tensor<ui32>, tensor<ui32>, tensor<64x512x12x512xui32>, tensor<64x512x12x512xui32>) -> (tensor<64x512x12x512xui32>, tensor<64x512x12x512xui32>)
    %24 = stablehlo.xor %23#0, %23#1 : tensor<64x512x12x512xui32>
    %c_4 = stablehlo.constant dense<9> : tensor<ui32>
    %25 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %26 = stablehlo.shift_right_logical %24, %25 : tensor<64x512x12x512xui32>
    %c_5 = stablehlo.constant dense<1065353216> : tensor<ui32>
    %27 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %28 = stablehlo.or %26, %27 : tensor<64x512x12x512xui32>
    %29 = stablehlo.bitcast_convert %28 : (tensor<64x512x12x512xui32>) -> tensor<64x512x12x512xf32>
    %cst = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %30 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x12x512xf32>
    %31 = stablehlo.subtract %29, %30 : tensor<64x512x12x512xf32>
    %32 = stablehlo.broadcast_in_dim %arg2, dims = [0, 1, 2, 3] : (tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32>
    %33 = stablehlo.multiply %31, %32 : tensor<64x512x12x512xf32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [0, 1, 2, 3] : (tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32>
    %35 = stablehlo.add %33, %34 : tensor<64x512x12x512xf32>
    %36 = stablehlo.broadcast_in_dim %arg1, dims = [0, 1, 2, 3] : (tensor<1x1x1x1xf32>) -> tensor<64x512x12x512xf32>
    %37 = stablehlo.maximum %36, %35 : tensor<64x512x12x512xf32>
    return %37 : tensor<64x512x12x512xf32>
  }
  func.func private @threefry2x32_151(%arg0: tensor<ui32>, %arg1: tensor<ui32>, %arg2: tensor<64x512x12x512xui32>, %arg3: tensor<64x512x12x512xui32>) -> (tensor<64x512x12x512xui32>, tensor<64x512x12x512xui32>) {
    %0 = stablehlo.xor %arg0, %arg1 : tensor<ui32>
    %c = stablehlo.constant dense<466688986> : tensor<ui32>
    %1 = stablehlo.xor %0, %c : tensor<ui32>
    %2 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %3 = stablehlo.add %arg2, %2 : tensor<64x512x12x512xui32>
    %4 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %5 = stablehlo.add %arg3, %4 : tensor<64x512x12x512xui32>
    %6 = stablehlo.add %3, %5 : tensor<64x512x12x512xui32>
    %c_0 = stablehlo.constant dense<13> : tensor<ui32>
    %7 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %8 = stablehlo.shift_left %5, %7 : tensor<64x512x12x512xui32>
    %c_1 = stablehlo.constant dense<19> : tensor<ui32>
    %9 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %10 = stablehlo.shift_right_logical %5, %9 : tensor<64x512x12x512xui32>
    %11 = stablehlo.or %8, %10 : tensor<64x512x12x512xui32>
    %12 = stablehlo.xor %6, %11 : tensor<64x512x12x512xui32>
    %13 = stablehlo.add %6, %12 : tensor<64x512x12x512xui32>
    %c_2 = stablehlo.constant dense<15> : tensor<ui32>
    %14 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %15 = stablehlo.shift_left %12, %14 : tensor<64x512x12x512xui32>
    %c_3 = stablehlo.constant dense<17> : tensor<ui32>
    %16 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %17 = stablehlo.shift_right_logical %12, %16 : tensor<64x512x12x512xui32>
    %18 = stablehlo.or %15, %17 : tensor<64x512x12x512xui32>
    %19 = stablehlo.xor %13, %18 : tensor<64x512x12x512xui32>
    %20 = stablehlo.add %13, %19 : tensor<64x512x12x512xui32>
    %c_4 = stablehlo.constant dense<26> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %22 = stablehlo.shift_left %19, %21 : tensor<64x512x12x512xui32>
    %c_5 = stablehlo.constant dense<6> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_5, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %24 = stablehlo.shift_right_logical %19, %23 : tensor<64x512x12x512xui32>
    %25 = stablehlo.or %22, %24 : tensor<64x512x12x512xui32>
    %26 = stablehlo.xor %20, %25 : tensor<64x512x12x512xui32>
    %27 = stablehlo.add %20, %26 : tensor<64x512x12x512xui32>
    %c_6 = stablehlo.constant dense<6> : tensor<ui32>
    %28 = stablehlo.broadcast_in_dim %c_6, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %29 = stablehlo.shift_left %26, %28 : tensor<64x512x12x512xui32>
    %c_7 = stablehlo.constant dense<26> : tensor<ui32>
    %30 = stablehlo.broadcast_in_dim %c_7, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %31 = stablehlo.shift_right_logical %26, %30 : tensor<64x512x12x512xui32>
    %32 = stablehlo.or %29, %31 : tensor<64x512x12x512xui32>
    %33 = stablehlo.xor %27, %32 : tensor<64x512x12x512xui32>
    %34 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %35 = stablehlo.add %27, %34 : tensor<64x512x12x512xui32>
    %36 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %37 = stablehlo.add %33, %36 : tensor<64x512x12x512xui32>
    %c_8 = stablehlo.constant dense<1> : tensor<ui32>
    %38 = stablehlo.broadcast_in_dim %c_8, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %39 = stablehlo.add %37, %38 : tensor<64x512x12x512xui32>
    %40 = stablehlo.add %35, %39 : tensor<64x512x12x512xui32>
    %c_9 = stablehlo.constant dense<17> : tensor<ui32>
    %41 = stablehlo.broadcast_in_dim %c_9, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %42 = stablehlo.shift_left %39, %41 : tensor<64x512x12x512xui32>
    %c_10 = stablehlo.constant dense<15> : tensor<ui32>
    %43 = stablehlo.broadcast_in_dim %c_10, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %44 = stablehlo.shift_right_logical %39, %43 : tensor<64x512x12x512xui32>
    %45 = stablehlo.or %42, %44 : tensor<64x512x12x512xui32>
    %46 = stablehlo.xor %40, %45 : tensor<64x512x12x512xui32>
    %47 = stablehlo.add %40, %46 : tensor<64x512x12x512xui32>
    %c_11 = stablehlo.constant dense<29> : tensor<ui32>
    %48 = stablehlo.broadcast_in_dim %c_11, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %49 = stablehlo.shift_left %46, %48 : tensor<64x512x12x512xui32>
    %c_12 = stablehlo.constant dense<3> : tensor<ui32>
    %50 = stablehlo.broadcast_in_dim %c_12, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %51 = stablehlo.shift_right_logical %46, %50 : tensor<64x512x12x512xui32>
    %52 = stablehlo.or %49, %51 : tensor<64x512x12x512xui32>
    %53 = stablehlo.xor %47, %52 : tensor<64x512x12x512xui32>
    %54 = stablehlo.add %47, %53 : tensor<64x512x12x512xui32>
    %c_13 = stablehlo.constant dense<16> : tensor<ui32>
    %55 = stablehlo.broadcast_in_dim %c_13, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %56 = stablehlo.shift_left %53, %55 : tensor<64x512x12x512xui32>
    %c_14 = stablehlo.constant dense<16> : tensor<ui32>
    %57 = stablehlo.broadcast_in_dim %c_14, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %58 = stablehlo.shift_right_logical %53, %57 : tensor<64x512x12x512xui32>
    %59 = stablehlo.or %56, %58 : tensor<64x512x12x512xui32>
    %60 = stablehlo.xor %54, %59 : tensor<64x512x12x512xui32>
    %61 = stablehlo.add %54, %60 : tensor<64x512x12x512xui32>
    %c_15 = stablehlo.constant dense<24> : tensor<ui32>
    %62 = stablehlo.broadcast_in_dim %c_15, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %63 = stablehlo.shift_left %60, %62 : tensor<64x512x12x512xui32>
    %c_16 = stablehlo.constant dense<8> : tensor<ui32>
    %64 = stablehlo.broadcast_in_dim %c_16, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %65 = stablehlo.shift_right_logical %60, %64 : tensor<64x512x12x512xui32>
    %66 = stablehlo.or %63, %65 : tensor<64x512x12x512xui32>
    %67 = stablehlo.xor %61, %66 : tensor<64x512x12x512xui32>
    %68 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %69 = stablehlo.add %61, %68 : tensor<64x512x12x512xui32>
    %70 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %71 = stablehlo.add %67, %70 : tensor<64x512x12x512xui32>
    %c_17 = stablehlo.constant dense<2> : tensor<ui32>
    %72 = stablehlo.broadcast_in_dim %c_17, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %73 = stablehlo.add %71, %72 : tensor<64x512x12x512xui32>
    %74 = stablehlo.add %69, %73 : tensor<64x512x12x512xui32>
    %c_18 = stablehlo.constant dense<13> : tensor<ui32>
    %75 = stablehlo.broadcast_in_dim %c_18, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %76 = stablehlo.shift_left %73, %75 : tensor<64x512x12x512xui32>
    %c_19 = stablehlo.constant dense<19> : tensor<ui32>
    %77 = stablehlo.broadcast_in_dim %c_19, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %78 = stablehlo.shift_right_logical %73, %77 : tensor<64x512x12x512xui32>
    %79 = stablehlo.or %76, %78 : tensor<64x512x12x512xui32>
    %80 = stablehlo.xor %74, %79 : tensor<64x512x12x512xui32>
    %81 = stablehlo.add %74, %80 : tensor<64x512x12x512xui32>
    %c_20 = stablehlo.constant dense<15> : tensor<ui32>
    %82 = stablehlo.broadcast_in_dim %c_20, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %83 = stablehlo.shift_left %80, %82 : tensor<64x512x12x512xui32>
    %c_21 = stablehlo.constant dense<17> : tensor<ui32>
    %84 = stablehlo.broadcast_in_dim %c_21, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %85 = stablehlo.shift_right_logical %80, %84 : tensor<64x512x12x512xui32>
    %86 = stablehlo.or %83, %85 : tensor<64x512x12x512xui32>
    %87 = stablehlo.xor %81, %86 : tensor<64x512x12x512xui32>
    %88 = stablehlo.add %81, %87 : tensor<64x512x12x512xui32>
    %c_22 = stablehlo.constant dense<26> : tensor<ui32>
    %89 = stablehlo.broadcast_in_dim %c_22, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %90 = stablehlo.shift_left %87, %89 : tensor<64x512x12x512xui32>
    %c_23 = stablehlo.constant dense<6> : tensor<ui32>
    %91 = stablehlo.broadcast_in_dim %c_23, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %92 = stablehlo.shift_right_logical %87, %91 : tensor<64x512x12x512xui32>
    %93 = stablehlo.or %90, %92 : tensor<64x512x12x512xui32>
    %94 = stablehlo.xor %88, %93 : tensor<64x512x12x512xui32>
    %95 = stablehlo.add %88, %94 : tensor<64x512x12x512xui32>
    %c_24 = stablehlo.constant dense<6> : tensor<ui32>
    %96 = stablehlo.broadcast_in_dim %c_24, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %97 = stablehlo.shift_left %94, %96 : tensor<64x512x12x512xui32>
    %c_25 = stablehlo.constant dense<26> : tensor<ui32>
    %98 = stablehlo.broadcast_in_dim %c_25, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %99 = stablehlo.shift_right_logical %94, %98 : tensor<64x512x12x512xui32>
    %100 = stablehlo.or %97, %99 : tensor<64x512x12x512xui32>
    %101 = stablehlo.xor %95, %100 : tensor<64x512x12x512xui32>
    %102 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %103 = stablehlo.add %95, %102 : tensor<64x512x12x512xui32>
    %104 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %105 = stablehlo.add %101, %104 : tensor<64x512x12x512xui32>
    %c_26 = stablehlo.constant dense<3> : tensor<ui32>
    %106 = stablehlo.broadcast_in_dim %c_26, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %107 = stablehlo.add %105, %106 : tensor<64x512x12x512xui32>
    %108 = stablehlo.add %103, %107 : tensor<64x512x12x512xui32>
    %c_27 = stablehlo.constant dense<17> : tensor<ui32>
    %109 = stablehlo.broadcast_in_dim %c_27, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %110 = stablehlo.shift_left %107, %109 : tensor<64x512x12x512xui32>
    %c_28 = stablehlo.constant dense<15> : tensor<ui32>
    %111 = stablehlo.broadcast_in_dim %c_28, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %112 = stablehlo.shift_right_logical %107, %111 : tensor<64x512x12x512xui32>
    %113 = stablehlo.or %110, %112 : tensor<64x512x12x512xui32>
    %114 = stablehlo.xor %108, %113 : tensor<64x512x12x512xui32>
    %115 = stablehlo.add %108, %114 : tensor<64x512x12x512xui32>
    %c_29 = stablehlo.constant dense<29> : tensor<ui32>
    %116 = stablehlo.broadcast_in_dim %c_29, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %117 = stablehlo.shift_left %114, %116 : tensor<64x512x12x512xui32>
    %c_30 = stablehlo.constant dense<3> : tensor<ui32>
    %118 = stablehlo.broadcast_in_dim %c_30, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %119 = stablehlo.shift_right_logical %114, %118 : tensor<64x512x12x512xui32>
    %120 = stablehlo.or %117, %119 : tensor<64x512x12x512xui32>
    %121 = stablehlo.xor %115, %120 : tensor<64x512x12x512xui32>
    %122 = stablehlo.add %115, %121 : tensor<64x512x12x512xui32>
    %c_31 = stablehlo.constant dense<16> : tensor<ui32>
    %123 = stablehlo.broadcast_in_dim %c_31, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %124 = stablehlo.shift_left %121, %123 : tensor<64x512x12x512xui32>
    %c_32 = stablehlo.constant dense<16> : tensor<ui32>
    %125 = stablehlo.broadcast_in_dim %c_32, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %126 = stablehlo.shift_right_logical %121, %125 : tensor<64x512x12x512xui32>
    %127 = stablehlo.or %124, %126 : tensor<64x512x12x512xui32>
    %128 = stablehlo.xor %122, %127 : tensor<64x512x12x512xui32>
    %129 = stablehlo.add %122, %128 : tensor<64x512x12x512xui32>
    %c_33 = stablehlo.constant dense<24> : tensor<ui32>
    %130 = stablehlo.broadcast_in_dim %c_33, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %131 = stablehlo.shift_left %128, %130 : tensor<64x512x12x512xui32>
    %c_34 = stablehlo.constant dense<8> : tensor<ui32>
    %132 = stablehlo.broadcast_in_dim %c_34, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %133 = stablehlo.shift_right_logical %128, %132 : tensor<64x512x12x512xui32>
    %134 = stablehlo.or %131, %133 : tensor<64x512x12x512xui32>
    %135 = stablehlo.xor %129, %134 : tensor<64x512x12x512xui32>
    %136 = stablehlo.broadcast_in_dim %arg1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %137 = stablehlo.add %129, %136 : tensor<64x512x12x512xui32>
    %138 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %139 = stablehlo.add %135, %138 : tensor<64x512x12x512xui32>
    %c_35 = stablehlo.constant dense<4> : tensor<ui32>
    %140 = stablehlo.broadcast_in_dim %c_35, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %141 = stablehlo.add %139, %140 : tensor<64x512x12x512xui32>
    %142 = stablehlo.add %137, %141 : tensor<64x512x12x512xui32>
    %c_36 = stablehlo.constant dense<13> : tensor<ui32>
    %143 = stablehlo.broadcast_in_dim %c_36, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %144 = stablehlo.shift_left %141, %143 : tensor<64x512x12x512xui32>
    %c_37 = stablehlo.constant dense<19> : tensor<ui32>
    %145 = stablehlo.broadcast_in_dim %c_37, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %146 = stablehlo.shift_right_logical %141, %145 : tensor<64x512x12x512xui32>
    %147 = stablehlo.or %144, %146 : tensor<64x512x12x512xui32>
    %148 = stablehlo.xor %142, %147 : tensor<64x512x12x512xui32>
    %149 = stablehlo.add %142, %148 : tensor<64x512x12x512xui32>
    %c_38 = stablehlo.constant dense<15> : tensor<ui32>
    %150 = stablehlo.broadcast_in_dim %c_38, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %151 = stablehlo.shift_left %148, %150 : tensor<64x512x12x512xui32>
    %c_39 = stablehlo.constant dense<17> : tensor<ui32>
    %152 = stablehlo.broadcast_in_dim %c_39, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %153 = stablehlo.shift_right_logical %148, %152 : tensor<64x512x12x512xui32>
    %154 = stablehlo.or %151, %153 : tensor<64x512x12x512xui32>
    %155 = stablehlo.xor %149, %154 : tensor<64x512x12x512xui32>
    %156 = stablehlo.add %149, %155 : tensor<64x512x12x512xui32>
    %c_40 = stablehlo.constant dense<26> : tensor<ui32>
    %157 = stablehlo.broadcast_in_dim %c_40, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %158 = stablehlo.shift_left %155, %157 : tensor<64x512x12x512xui32>
    %c_41 = stablehlo.constant dense<6> : tensor<ui32>
    %159 = stablehlo.broadcast_in_dim %c_41, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %160 = stablehlo.shift_right_logical %155, %159 : tensor<64x512x12x512xui32>
    %161 = stablehlo.or %158, %160 : tensor<64x512x12x512xui32>
    %162 = stablehlo.xor %156, %161 : tensor<64x512x12x512xui32>
    %163 = stablehlo.add %156, %162 : tensor<64x512x12x512xui32>
    %c_42 = stablehlo.constant dense<6> : tensor<ui32>
    %164 = stablehlo.broadcast_in_dim %c_42, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %165 = stablehlo.shift_left %162, %164 : tensor<64x512x12x512xui32>
    %c_43 = stablehlo.constant dense<26> : tensor<ui32>
    %166 = stablehlo.broadcast_in_dim %c_43, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %167 = stablehlo.shift_right_logical %162, %166 : tensor<64x512x12x512xui32>
    %168 = stablehlo.or %165, %167 : tensor<64x512x12x512xui32>
    %169 = stablehlo.xor %163, %168 : tensor<64x512x12x512xui32>
    %170 = stablehlo.broadcast_in_dim %1, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %171 = stablehlo.add %163, %170 : tensor<64x512x12x512xui32>
    %172 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %173 = stablehlo.add %169, %172 : tensor<64x512x12x512xui32>
    %c_44 = stablehlo.constant dense<5> : tensor<ui32>
    %174 = stablehlo.broadcast_in_dim %c_44, dims = [] : (tensor<ui32>) -> tensor<64x512x12x512xui32>
    %175 = stablehlo.add %173, %174 : tensor<64x512x12x512xui32>
    return %171, %175 : tensor<64x512x12x512xui32>, tensor<64x512x12x512xui32>
  }
  func.func private @_where_166(%arg0: tensor<64x512x12x512xi1>, %arg1: tensor<64x512x12x512xbf16>, %arg2: tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
    return %0 : tensor<64x512x12x512xbf16>
  }
  func.func private @_bernoulli_171(%arg0: tensor<2xui32>, %arg1: tensor<1x1x1xf32>, %arg2: tensor<1x1x1xf32>, %arg3: tensor<f32>) -> tensor<64x512x768xi1> {
    %0 = call @_uniform_172(%arg0, %arg1, %arg2) : (tensor<2xui32>, tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %1 = stablehlo.broadcast_in_dim %arg3, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %2 = stablehlo.compare  LT, %0, %1,  FLOAT : (tensor<64x512x768xf32>, tensor<64x512x768xf32>) -> tensor<64x512x768xi1>
    return %2 : tensor<64x512x768xi1>
  }
  func.func private @_uniform_172(%arg0: tensor<2xui32>, %arg1: tensor<1x1x1xf32>, %arg2: tensor<1x1x1xf32>) -> tensor<64x512x768xf32> {
    %0 = stablehlo.slice %arg0 [0:1] : (tensor<2xui32>) -> tensor<1xui32>
    %1 = stablehlo.reshape %0 : (tensor<1xui32>) -> tensor<ui32>
    %2 = stablehlo.slice %arg0 [1:2] : (tensor<2xui32>) -> tensor<1xui32>
    %3 = stablehlo.reshape %2 : (tensor<1xui32>) -> tensor<ui32>
    %4 = stablehlo.iota dim = 0 : tensor<64x512x768xui64>
    %5 = stablehlo.iota dim = 1 : tensor<64x512x768xui64>
    %6 = stablehlo.iota dim = 2 : tensor<64x512x768xui64>
    %c = stablehlo.constant dense<393216> : tensor<ui64>
    %7 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %8 = stablehlo.multiply %7, %4 : tensor<64x512x768xui64>
    %c_0 = stablehlo.constant dense<768> : tensor<ui64>
    %9 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %10 = stablehlo.multiply %9, %5 : tensor<64x512x768xui64>
    %c_1 = stablehlo.constant dense<1> : tensor<ui64>
    %11 = stablehlo.broadcast_in_dim %c_1, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %12 = stablehlo.multiply %11, %6 : tensor<64x512x768xui64>
    %13 = stablehlo.add %8, %10 : tensor<64x512x768xui64>
    %14 = stablehlo.add %13, %12 : tensor<64x512x768xui64>
    %c_2 = stablehlo.constant dense<32> : tensor<ui64>
    %15 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<ui64>) -> tensor<64x512x768xui64>
    %16 = stablehlo.shift_right_logical %14, %15 : tensor<64x512x768xui64>
    %17 = stablehlo.convert %14 : (tensor<64x512x768xui64>) -> tensor<64x512x768xui32>
    %18 = stablehlo.convert %16 : (tensor<64x512x768xui64>) -> tensor<64x512x768xui32>
    %19:2 = call @threefry2x32_50(%1, %3, %18, %17) : (tensor<ui32>, tensor<ui32>, tensor<64x512x768xui32>, tensor<64x512x768xui32>) -> (tensor<64x512x768xui32>, tensor<64x512x768xui32>)
    %20 = stablehlo.xor %19#0, %19#1 : tensor<64x512x768xui32>
    %c_3 = stablehlo.constant dense<9> : tensor<ui32>
    %21 = stablehlo.broadcast_in_dim %c_3, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %22 = stablehlo.shift_right_logical %20, %21 : tensor<64x512x768xui32>
    %c_4 = stablehlo.constant dense<1065353216> : tensor<ui32>
    %23 = stablehlo.broadcast_in_dim %c_4, dims = [] : (tensor<ui32>) -> tensor<64x512x768xui32>
    %24 = stablehlo.or %22, %23 : tensor<64x512x768xui32>
    %25 = stablehlo.bitcast_convert %24 : (tensor<64x512x768xui32>) -> tensor<64x512x768xf32>
    %cst = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %26 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x768xf32>
    %27 = stablehlo.subtract %25, %26 : tensor<64x512x768xf32>
    %28 = stablehlo.broadcast_in_dim %arg2, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %29 = stablehlo.multiply %27, %28 : tensor<64x512x768xf32>
    %30 = stablehlo.broadcast_in_dim %arg1, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %31 = stablehlo.add %29, %30 : tensor<64x512x768xf32>
    %32 = stablehlo.broadcast_in_dim %arg1, dims = [0, 1, 2] : (tensor<1x1x1xf32>) -> tensor<64x512x768xf32>
    %33 = stablehlo.maximum %32, %31 : tensor<64x512x768xf32>
    return %33 : tensor<64x512x768xf32>
  }
  func.func private @_where_173(%arg0: tensor<64x512x768xi1>, %arg1: tensor<64x512x768xbf16>, %arg2: tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %0 : tensor<64x512x768xbf16>
  }
  func.func private @_where_228(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xi32>, %arg2: tensor<i32>) -> tensor<64x512xi32> {
    %0 = stablehlo.convert %arg2 : tensor<i32>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<i32>) -> tensor<64x512xi32>
    %2 = stablehlo.select %arg0, %arg1, %1 : tensor<64x512xi1>, tensor<64x512xi32>
    return %2 : tensor<64x512xi32>
  }
  func.func private @take_along_axis(%arg0: tensor<64x512x30522xf32>, %arg1: tensor<64x512x1xi32>) -> (tensor<64x512x1xf32>, tensor<64x512x1x1xi32>) {
    %c = stablehlo.constant dense<0> : tensor<i32>
    %0 = stablehlo.broadcast_in_dim %c, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %1 = stablehlo.compare  LT, %arg1, %0,  SIGNED : (tensor<64x512x1xi32>, tensor<64x512x1xi32>) -> tensor<64x512x1xi1>
    %c_0 = stablehlo.constant dense<30522> : tensor<i32>
    %2 = stablehlo.broadcast_in_dim %c_0, dims = [] : (tensor<i32>) -> tensor<64x512x1xi32>
    %3 = stablehlo.add %arg1, %2 : tensor<64x512x1xi32>
    %4 = stablehlo.select %1, %3, %arg1 : tensor<64x512x1xi1>, tensor<64x512x1xi32>
    %5 = stablehlo.reshape %4 : (tensor<64x512x1xi32>) -> tensor<64x512x1x1xi32>
    %c_1 = stablehlo.constant dense<30521> : tensor<1xi32>
    %c_2 = stablehlo.constant dense<0> : tensor<i32>
    %6 = stablehlo.broadcast_in_dim %c_2, dims = [] : (tensor<i32>) -> tensor<64x512x1x1xi32>
    %7 = stablehlo.compare  GE, %5, %6,  SIGNED : (tensor<64x512x1x1xi32>, tensor<64x512x1x1xi32>) -> tensor<64x512x1x1xi1>
    %8 = stablehlo.broadcast_in_dim %c_1, dims = [3] : (tensor<1xi32>) -> tensor<1x1x1x1xi32>
    %9 = stablehlo.broadcast_in_dim %8, dims = [0, 1, 2, 3] : (tensor<1x1x1x1xi32>) -> tensor<64x512x1x1xi32>
    %10 = stablehlo.compare  LE, %5, %9,  SIGNED : (tensor<64x512x1x1xi32>, tensor<64x512x1x1xi32>) -> tensor<64x512x1x1xi1>
    %11 = stablehlo.and %7, %10 : tensor<64x512x1x1xi1>
    %c_3 = stablehlo.constant dense<true> : tensor<i1>
    %12 = stablehlo.reduce(%11 init: %c_3) applies stablehlo.and across dimensions = [3] : (tensor<64x512x1x1xi1>, tensor<i1>) -> tensor<64x512x1xi1>
    %13 = "stablehlo.gather"(%arg0, %5) <{dimension_numbers = #stablehlo.gather<collapsed_slice_dims = [2], operand_batching_dims = [0, 1], start_indices_batching_dims = [0, 1], start_index_map = [2], index_vector_dim = 3>, indices_are_sorted = false, slice_sizes = array<i64: 1, 1, 1>}> : (tensor<64x512x30522xf32>, tensor<64x512x1x1xi32>) -> tensor<64x512x1xf32>
    %cst = stablehlo.constant dense<0x7FC00000> : tensor<f32>
    %14 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %15 = stablehlo.select %12, %13, %14 : tensor<64x512x1xi1>, tensor<64x512x1xf32>
    return %15, %5 : tensor<64x512x1xf32>, tensor<64x512x1x1xi32>
  }
  func.func private @_where_250(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xf32>, %arg2: tensor<f32>) -> tensor<64x512xf32> {
    %0 = stablehlo.convert %arg2 : tensor<f32>
    %1 = stablehlo.broadcast_in_dim %0, dims = [] : (tensor<f32>) -> tensor<64x512xf32>
    %2 = stablehlo.select %arg0, %arg1, %1 : tensor<64x512xi1>, tensor<64x512xf32>
    return %2 : tensor<64x512xf32>
  }
  func.func private @argmax(%arg0: tensor<64x512x30522xf32>) -> tensor<64x512xi32> {
    %0 = stablehlo.iota dim = 2 : tensor<64x512x30522xi32>
    %cst = stablehlo.constant dense<0xFF800000> : tensor<f32>
    %c = stablehlo.constant dense<0> : tensor<i32>
    %1:2 = stablehlo.reduce(%arg0 init: %cst), (%0 init: %c) across dimensions = [2] : (tensor<64x512x30522xf32>, tensor<64x512x30522xi32>, tensor<f32>, tensor<i32>) -> (tensor<64x512xf32>, tensor<64x512xi32>)
     reducer(%arg1: tensor<f32>, %arg3: tensor<f32>) (%arg2: tensor<i32>, %arg4: tensor<i32>)  {
      %2 = stablehlo.compare  GT, %arg1, %arg3,  FLOAT : (tensor<f32>, tensor<f32>) -> tensor<i1>
      %3 = stablehlo.compare  NE, %arg1, %arg1,  FLOAT : (tensor<f32>, tensor<f32>) -> tensor<i1>
      %4 = stablehlo.or %2, %3 : tensor<i1>
      %5 = stablehlo.compare  EQ, %arg1, %arg3,  FLOAT : (tensor<f32>, tensor<f32>) -> tensor<i1>
      %6 = stablehlo.compare  LT, %arg2, %arg4,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1>
      %7 = stablehlo.and %5, %6 : tensor<i1>
      %8 = stablehlo.or %4, %7 : tensor<i1>
      %9 = stablehlo.select %4, %arg1, %arg3 : tensor<i1>, tensor<f32>
      %10 = stablehlo.select %8, %arg2, %arg4 : tensor<i1>, tensor<i32>
      stablehlo.return %9, %10 : tensor<f32>, tensor<i32>
    }
    return %1#1 : tensor<64x512xi32>
  }
  func.func private @_where_268(%arg0: tensor<64x512xi1>, %arg1: tensor<64x512xf32>) -> tensor<64x512xf32> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512xf32>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512xi1>, tensor<64x512xf32>
    return %1 : tensor<64x512xf32>
  }
  func.func private @take_along_axis_269(%arg0: tensor<64x512x1x1xi32>, %arg1: tensor<64x512x1xf32>) -> tensor<64x512x30522xf32> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f32>) -> tensor<64x512x30522xf32>
    %1 = "stablehlo.scatter"(%0, %arg0, %arg1) <{indices_are_sorted = false, scatter_dimension_numbers = #stablehlo.scatter<inserted_window_dims = [2], input_batching_dims = [0, 1], scatter_indices_batching_dims = [0, 1], scatter_dims_to_operand_dims = [2], index_vector_dim = 3>, unique_indices = false}> ({
    ^bb0(%arg2: tensor<f32>, %arg3: tensor<f32>):
      %2 = stablehlo.add %arg2, %arg3 : tensor<f32>
      stablehlo.return %2 : tensor<f32>
    }) : (tensor<64x512x30522xf32>, tensor<64x512x1x1xi32>, tensor<64x512x1xf32>) -> tensor<64x512x30522xf32>
    return %1 : tensor<64x512x30522xf32>
  }
  func.func private @closed_call_328(%arg0: tensor<bf16>, %arg1: tensor<64x512x12x512xi1>, %arg2: tensor<64x512x768xbf16>, %arg3: tensor<768x768xbf16>, %arg4: tensor<64x512x768xbf16>, %arg5: tensor<768x768xbf16>, %arg6: tensor<768x768xbf16>, %arg7: tensor<64x512x12x64xbf16>, %arg8: tensor<64x512x12x64xbf16>, %arg9: tensor<64x512x12x512xf32>, %arg10: tensor<64x512x12x1xf32>, %arg11: tensor<64x512x12x1xf32>, %arg12: tensor<64x512x12x512xi1>, %arg13: tensor<64x512x12x512xbf16>, %arg14: tensor<64x512x12x64xbf16>, %arg15: tensor<768x768xbf16>, %arg16: tensor<64x512x768xbf16>, %arg17: tensor<64x512x768xi1>, %arg18: tensor<64x512x768xf32>, %arg19: tensor<64x512x1xf32>, %arg20: tensor<64x512x1xf32>, %arg21: tensor<64x512x1xf32>, %arg22: tensor<64x512x1xf32>, %arg23: tensor<64x512x768xf32>, %arg24: tensor<64x512x768xf32>, %arg25: tensor<1x1x768xf32>, %arg26: tensor<768x3072xbf16>, %arg27: tensor<64x512x768xbf16>, %arg28: tensor<64x512x3072xbf16>, %arg29: tensor<64x512x3072xbf16>, %arg30: tensor<64x512x3072xbf16>, %arg31: tensor<64x512x3072xbf16>, %arg32: tensor<64x512x3072xbf16>, %arg33: tensor<3072x768xbf16>, %arg34: tensor<64x512x3072xbf16>, %arg35: tensor<64x512x768xi1>, %arg36: tensor<64x512x768xf32>, %arg37: tensor<64x512x1xf32>, %arg38: tensor<64x512x1xf32>, %arg39: tensor<64x512x1xf32>, %arg40: tensor<64x512x1xf32>, %arg41: tensor<64x512x768xf32>, %arg42: tensor<64x512x768xf32>, %arg43: tensor<1x1x768xf32>) -> (tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<3072x768xbf16>, tensor<3072xbf16>, tensor<768x3072xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>) {
    %0 = stablehlo.convert %arg2 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %1 = stablehlo.reduce(%0 init: %cst) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<768xf32>
    %2 = stablehlo.reshape %1 : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %cst_0 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %3 = stablehlo.reduce(%2 init: %cst_0) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xf32>, tensor<f32>) -> tensor<768xf32>
    %4 = stablehlo.convert %3 : (tensor<768xf32>) -> tensor<768xbf16>
    %5 = stablehlo.broadcast_in_dim %arg43, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %6 = stablehlo.multiply %5, %0 : tensor<64x512x768xf32>
    %7 = stablehlo.multiply %0, %arg42 : tensor<64x512x768xf32>
    %cst_1 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %8 = stablehlo.reduce(%7 init: %cst_1) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<768xf32>
    %9 = stablehlo.reshape %8 : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %cst_2 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %10 = stablehlo.reduce(%9 init: %cst_2) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xf32>, tensor<f32>) -> tensor<768xf32>
    %11 = stablehlo.convert %10 : (tensor<768xf32>) -> tensor<768xbf16>
    %12 = stablehlo.multiply %arg41, %6 : tensor<64x512x768xf32>
    %cst_3 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %13 = stablehlo.reduce(%12 init: %cst_3) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %14 = stablehlo.reshape %13 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %15 = stablehlo.broadcast_in_dim %arg40, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %16 = stablehlo.multiply %6, %15 : tensor<64x512x768xf32>
    %17 = stablehlo.multiply %14, %arg39 : tensor<64x512x1xf32>
    %18 = stablehlo.multiply %17, %arg38 : tensor<64x512x1xf32>
    %19 = stablehlo.negate %18 : tensor<64x512x1xf32>
    %20 = stablehlo.multiply %19, %arg37 : tensor<64x512x1xf32>
    %cst_4 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %21 = stablehlo.broadcast_in_dim %cst_4, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %22 = stablehlo.divide %18, %21 : tensor<64x512x1xf32>
    %cst_5 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %23 = stablehlo.reduce(%22 init: %cst_5) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %24 = stablehlo.broadcast_in_dim %23, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %25 = stablehlo.multiply %24, %arg36 : tensor<64x512x768xf32>
    %26 = stablehlo.negate %16 : tensor<64x512x768xf32>
    %cst_6 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %27 = stablehlo.reduce(%26 init: %cst_6) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %28 = stablehlo.reshape %27 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %29 = stablehlo.add %25, %16 : tensor<64x512x768xf32>
    %30 = stablehlo.add %20, %28 : tensor<64x512x1xf32>
    %cst_7 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %31 = stablehlo.broadcast_in_dim %cst_7, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %32 = stablehlo.divide %30, %31 : tensor<64x512x1xf32>
    %cst_8 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %33 = stablehlo.reduce(%32 init: %cst_8) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %34 = stablehlo.broadcast_in_dim %33, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %35 = stablehlo.add %29, %34 : tensor<64x512x768xf32>
    %36 = stablehlo.convert %35 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %37 = call @_where_329(%arg35, %36) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %cst_9 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %38 = stablehlo.broadcast_in_dim %cst_9, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %39 = stablehlo.divide %37, %38 : tensor<64x512x768xbf16>
    %cst_10 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %40 = stablehlo.reduce(%39 init: %cst_10) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %41 = stablehlo.reshape %40 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_11 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %42 = stablehlo.reduce(%41 init: %cst_11) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %43 = stablehlo.dot_general %39, %arg34, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x3072xbf16>) -> tensor<768x3072xbf16>
    %44 = stablehlo.transpose %43, dims = [1, 0] : (tensor<768x3072xbf16>) -> tensor<3072x768xbf16>
    %45 = stablehlo.dot_general %39, %arg33, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<3072x768xbf16>) -> tensor<64x512x3072xbf16>
    %46 = stablehlo.transpose %44, dims = [1, 0] : (tensor<3072x768xbf16>) -> tensor<768x3072xbf16>
    %47 = stablehlo.multiply %arg32, %45 : tensor<64x512x3072xbf16>
    %48 = stablehlo.multiply %45, %arg31 : tensor<64x512x3072xbf16>
    %cst_12 = stablehlo.constant dense<5.000000e-01> : tensor<bf16>
    %49 = stablehlo.broadcast_in_dim %cst_12, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %50 = stablehlo.multiply %49, %47 : tensor<64x512x3072xbf16>
    %51 = stablehlo.multiply %50, %arg30 : tensor<64x512x3072xbf16>
    %52 = stablehlo.multiply %51, %arg29 : tensor<64x512x3072xbf16>
    %53 = stablehlo.add %51, %52 : tensor<64x512x3072xbf16>
    %cst_13 = stablehlo.constant dense<7.968750e-01> : tensor<bf16>
    %54 = stablehlo.broadcast_in_dim %cst_13, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %55 = stablehlo.multiply %54, %53 : tensor<64x512x3072xbf16>
    %56 = stablehlo.add %48, %55 : tensor<64x512x3072xbf16>
    %cst_14 = stablehlo.constant dense<4.467770e-02> : tensor<bf16>
    %57 = stablehlo.broadcast_in_dim %cst_14, dims = [] : (tensor<bf16>) -> tensor<64x512x3072xbf16>
    %58 = stablehlo.multiply %57, %55 : tensor<64x512x3072xbf16>
    %59 = stablehlo.multiply %58, %arg28 : tensor<64x512x3072xbf16>
    %60 = stablehlo.add %56, %59 : tensor<64x512x3072xbf16>
    %cst_15 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %61 = stablehlo.reduce(%60 init: %cst_15) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x3072xbf16>, tensor<bf16>) -> tensor<3072xbf16>
    %62 = stablehlo.reshape %61 : (tensor<3072xbf16>) -> tensor<1x1x3072xbf16>
    %cst_16 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %63 = stablehlo.reduce(%62 init: %cst_16) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x3072xbf16>, tensor<bf16>) -> tensor<3072xbf16>
    %64 = stablehlo.dot_general %60, %arg27, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x3072xbf16>, tensor<64x512x768xbf16>) -> tensor<3072x768xbf16>
    %65 = stablehlo.transpose %64, dims = [1, 0] : (tensor<3072x768xbf16>) -> tensor<768x3072xbf16>
    %66 = stablehlo.dot_general %60, %arg26, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x3072xbf16>, tensor<768x3072xbf16>) -> tensor<64x512x768xbf16>
    %67 = stablehlo.add %36, %66 : tensor<64x512x768xbf16>
    %68 = stablehlo.transpose %65, dims = [1, 0] : (tensor<768x3072xbf16>) -> tensor<3072x768xbf16>
    %69 = stablehlo.convert %67 : (tensor<64x512x768xbf16>) -> tensor<64x512x768xf32>
    %cst_17 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %70 = stablehlo.reduce(%69 init: %cst_17) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<768xf32>
    %71 = stablehlo.reshape %70 : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %cst_18 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %72 = stablehlo.reduce(%71 init: %cst_18) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xf32>, tensor<f32>) -> tensor<768xf32>
    %73 = stablehlo.convert %72 : (tensor<768xf32>) -> tensor<768xbf16>
    %74 = stablehlo.broadcast_in_dim %arg25, dims = [0, 1, 2] : (tensor<1x1x768xf32>) -> tensor<64x512x768xf32>
    %75 = stablehlo.multiply %74, %69 : tensor<64x512x768xf32>
    %76 = stablehlo.multiply %69, %arg24 : tensor<64x512x768xf32>
    %cst_19 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %77 = stablehlo.reduce(%76 init: %cst_19) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<768xf32>
    %78 = stablehlo.reshape %77 : (tensor<768xf32>) -> tensor<1x1x768xf32>
    %cst_20 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %79 = stablehlo.reduce(%78 init: %cst_20) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xf32>, tensor<f32>) -> tensor<768xf32>
    %80 = stablehlo.convert %79 : (tensor<768xf32>) -> tensor<768xbf16>
    %81 = stablehlo.multiply %arg23, %75 : tensor<64x512x768xf32>
    %cst_21 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %82 = stablehlo.reduce(%81 init: %cst_21) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %83 = stablehlo.reshape %82 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %84 = stablehlo.broadcast_in_dim %arg22, dims = [0, 1, 2] : (tensor<64x512x1xf32>) -> tensor<64x512x768xf32>
    %85 = stablehlo.multiply %75, %84 : tensor<64x512x768xf32>
    %86 = stablehlo.multiply %83, %arg21 : tensor<64x512x1xf32>
    %87 = stablehlo.multiply %86, %arg20 : tensor<64x512x1xf32>
    %88 = stablehlo.negate %87 : tensor<64x512x1xf32>
    %89 = stablehlo.multiply %88, %arg19 : tensor<64x512x1xf32>
    %cst_22 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %90 = stablehlo.broadcast_in_dim %cst_22, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %91 = stablehlo.divide %87, %90 : tensor<64x512x1xf32>
    %cst_23 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %92 = stablehlo.reduce(%91 init: %cst_23) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %93 = stablehlo.broadcast_in_dim %92, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %94 = stablehlo.multiply %93, %arg18 : tensor<64x512x768xf32>
    %95 = stablehlo.negate %85 : tensor<64x512x768xf32>
    %cst_24 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %96 = stablehlo.reduce(%95 init: %cst_24) applies stablehlo.add across dimensions = [2] : (tensor<64x512x768xf32>, tensor<f32>) -> tensor<64x512xf32>
    %97 = stablehlo.reshape %96 : (tensor<64x512xf32>) -> tensor<64x512x1xf32>
    %98 = stablehlo.add %94, %85 : tensor<64x512x768xf32>
    %99 = stablehlo.add %89, %97 : tensor<64x512x1xf32>
    %cst_25 = stablehlo.constant dense<7.680000e+02> : tensor<f32>
    %100 = stablehlo.broadcast_in_dim %cst_25, dims = [] : (tensor<f32>) -> tensor<64x512x1xf32>
    %101 = stablehlo.divide %99, %100 : tensor<64x512x1xf32>
    %cst_26 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %102 = stablehlo.reduce(%101 init: %cst_26) applies stablehlo.add across dimensions = [2] : (tensor<64x512x1xf32>, tensor<f32>) -> tensor<64x512xf32>
    %103 = stablehlo.broadcast_in_dim %102, dims = [0, 1] : (tensor<64x512xf32>) -> tensor<64x512x768xf32>
    %104 = stablehlo.add %98, %103 : tensor<64x512x768xf32>
    %105 = stablehlo.convert %104 : (tensor<64x512x768xf32>) -> tensor<64x512x768xbf16>
    %106 = call @_where_329(%arg17, %105) : (tensor<64x512x768xi1>, tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16>
    %cst_27 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %107 = stablehlo.broadcast_in_dim %cst_27, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %108 = stablehlo.divide %106, %107 : tensor<64x512x768xbf16>
    %cst_28 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %109 = stablehlo.reduce(%108 init: %cst_28) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %110 = stablehlo.reshape %109 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_29 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %111 = stablehlo.reduce(%110 init: %cst_29) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %112 = stablehlo.dot_general %108, %arg16, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %113 = stablehlo.transpose %112, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %114 = stablehlo.dot_general %108, %arg15, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %115 = stablehlo.transpose %113, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %116 = stablehlo.reshape %114 : (tensor<64x512x768xbf16>) -> tensor<64x512x12x64xbf16>
    %117 = stablehlo.transpose %116, dims = [0, 2, 3, 1] : (tensor<64x512x12x64xbf16>) -> tensor<64x12x64x512xbf16>
    %118 = stablehlo.dot_general %117, %arg14, batching_dims = [0, 1] x [0, 2], contracting_dims = [2] x [3], precision = [DEFAULT, DEFAULT] : (tensor<64x12x64x512xbf16>, tensor<64x512x12x64xbf16>) -> tensor<64x12x512x512xbf16>
    %119 = stablehlo.transpose %118, dims = [0, 2, 1, 3] : (tensor<64x12x512x512xbf16>) -> tensor<64x512x12x512xbf16>
    %120 = stablehlo.dot_general %117, %arg13, batching_dims = [0, 1] x [0, 2], contracting_dims = [3] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x12x64x512xbf16>, tensor<64x512x12x512xbf16>) -> tensor<64x12x64x512xbf16>
    %121 = stablehlo.transpose %120, dims = [0, 3, 1, 2] : (tensor<64x12x64x512xbf16>) -> tensor<64x512x12x64xbf16>
    %122 = call @_where_344(%arg12, %119) : (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
    %cst_30 = stablehlo.constant dense<8.984370e-01> : tensor<bf16>
    %123 = stablehlo.broadcast_in_dim %cst_30, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    %124 = stablehlo.divide %122, %123 : tensor<64x512x12x512xbf16>
    %125 = stablehlo.convert %124 : (tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xf32>
    %126 = stablehlo.broadcast_in_dim %arg11, dims = [0, 1, 2, 3] : (tensor<64x512x12x1xf32>) -> tensor<64x512x12x512xf32>
    %127 = stablehlo.multiply %125, %126 : tensor<64x512x12x512xf32>
    %128 = stablehlo.multiply %127, %arg9 : tensor<64x512x12x512xf32>
    %cst_31 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %129 = stablehlo.reduce(%128 init: %cst_31) applies stablehlo.add across dimensions = [3] : (tensor<64x512x12x512xf32>, tensor<f32>) -> tensor<64x512x12xf32>
    %130 = stablehlo.reshape %129 : (tensor<64x512x12xf32>) -> tensor<64x512x12x1xf32>
    %131 = stablehlo.negate %130 : tensor<64x512x12x1xf32>
    %132 = stablehlo.broadcast_in_dim %arg10, dims = [0, 1, 2, 3] : (tensor<64x512x12x1xf32>) -> tensor<64x512x12x512xf32>
    %133 = stablehlo.divide %125, %132 : tensor<64x512x12x512xf32>
    %cst_32 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %134 = stablehlo.reduce(%131 init: %cst_32) applies stablehlo.add across dimensions = [3] : (tensor<64x512x12x1xf32>, tensor<f32>) -> tensor<64x512x12xf32>
    %135 = stablehlo.broadcast_in_dim %134, dims = [0, 1, 2] : (tensor<64x512x12xf32>) -> tensor<64x512x12x512xf32>
    %136 = stablehlo.add %133, %135 : tensor<64x512x12x512xf32>
    %137 = stablehlo.multiply %136, %arg9 : tensor<64x512x12x512xf32>
    %138 = stablehlo.convert %137 : (tensor<64x512x12x512xf32>) -> tensor<64x512x12x512xbf16>
    %139 = call @_where_355(%arg1, %138) : (tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16>
    %140 = stablehlo.transpose %139, dims = [0, 2, 3, 1] : (tensor<64x512x12x512xbf16>) -> tensor<64x12x512x512xbf16>
    %141 = stablehlo.dot_general %140, %arg8, batching_dims = [0, 1] x [0, 2], contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x12x512x512xbf16>, tensor<64x512x12x64xbf16>) -> tensor<64x12x512x64xbf16>
    %142 = stablehlo.transpose %141, dims = [0, 2, 1, 3] : (tensor<64x12x512x64xbf16>) -> tensor<64x512x12x64xbf16>
    %143 = stablehlo.dot_general %140, %arg7, batching_dims = [0, 1] x [0, 2], contracting_dims = [3] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x12x512x512xbf16>, tensor<64x512x12x64xbf16>) -> tensor<64x12x512x64xbf16>
    %144 = stablehlo.transpose %143, dims = [0, 2, 1, 3] : (tensor<64x12x512x64xbf16>) -> tensor<64x512x12x64xbf16>
    %145 = stablehlo.broadcast_in_dim %arg0, dims = [] : (tensor<bf16>) -> tensor<64x512x12x64xbf16>
    %146 = stablehlo.divide %142, %145 : tensor<64x512x12x64xbf16>
    %147 = stablehlo.reshape %121 : (tensor<64x512x12x64xbf16>) -> tensor<64x512x768xbf16>
    %cst_33 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %148 = stablehlo.reduce(%147 init: %cst_33) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %149 = stablehlo.reshape %148 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_34 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %150 = stablehlo.reduce(%149 init: %cst_34) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %151 = stablehlo.dot_general %147, %arg4, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %152 = stablehlo.transpose %151, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %153 = stablehlo.dot_general %147, %arg6, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %154 = stablehlo.add %105, %153 : tensor<64x512x768xbf16>
    %155 = stablehlo.transpose %152, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %156 = stablehlo.reshape %144 : (tensor<64x512x12x64xbf16>) -> tensor<64x512x768xbf16>
    %cst_35 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %157 = stablehlo.reduce(%156 init: %cst_35) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %158 = stablehlo.reshape %157 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_36 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %159 = stablehlo.reduce(%158 init: %cst_36) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %160 = stablehlo.dot_general %156, %arg4, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %161 = stablehlo.transpose %160, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %162 = stablehlo.dot_general %156, %arg5, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %163 = stablehlo.add %154, %162 : tensor<64x512x768xbf16>
    %164 = stablehlo.transpose %161, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %165 = stablehlo.reshape %146 : (tensor<64x512x12x64xbf16>) -> tensor<64x512x768xbf16>
    %cst_37 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %166 = stablehlo.reduce(%165 init: %cst_37) applies stablehlo.add across dimensions = [0, 1] : (tensor<64x512x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %167 = stablehlo.reshape %166 : (tensor<768xbf16>) -> tensor<1x1x768xbf16>
    %cst_38 = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %168 = stablehlo.reduce(%167 init: %cst_38) applies stablehlo.add across dimensions = [0, 1] : (tensor<1x1x768xbf16>, tensor<bf16>) -> tensor<768xbf16>
    %169 = stablehlo.dot_general %165, %arg4, contracting_dims = [0, 1] x [0, 1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<64x512x768xbf16>) -> tensor<768x768xbf16>
    %170 = stablehlo.transpose %169, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    %171 = stablehlo.dot_general %165, %arg3, contracting_dims = [2] x [1], precision = [DEFAULT, DEFAULT] : (tensor<64x512x768xbf16>, tensor<768x768xbf16>) -> tensor<64x512x768xbf16>
    %172 = stablehlo.add %163, %171 : tensor<64x512x768xbf16>
    %173 = stablehlo.transpose %170, dims = [1, 0] : (tensor<768x768xbf16>) -> tensor<768x768xbf16>
    return %172, %173, %168, %164, %159, %155, %150, %115, %111, %80, %73, %68, %63, %46, %42, %11, %4 : tensor<64x512x768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768x768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<3072x768xbf16>, tensor<3072xbf16>, tensor<768x3072xbf16>, tensor<768xbf16>, tensor<768xbf16>, tensor<768xbf16>
  }
  func.func private @_where_329(%arg0: tensor<64x512x768xi1>, %arg1: tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %1 : tensor<64x512x768xbf16>
  }
  func.func private @_where_344(%arg0: tensor<64x512x12x512xi1>, %arg1: tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
    return %1 : tensor<64x512x12x512xbf16>
  }
  func.func private @_where_355(%arg0: tensor<64x512x12x512xi1>, %arg1: tensor<64x512x12x512xbf16>) -> tensor<64x512x12x512xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x12x512xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512x12x512xi1>, tensor<64x512x12x512xbf16>
    return %1 : tensor<64x512x12x512xbf16>
  }
  func.func private @_where_365(%arg0: tensor<64x512x768xi1>, %arg1: tensor<64x512x768xbf16>) -> tensor<64x512x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<64x512x768xbf16>
    %1 = stablehlo.select %arg0, %arg1, %0 : tensor<64x512x768xi1>, tensor<64x512x768xbf16>
    return %1 : tensor<64x512x768xbf16>
  }
  func.func private @_take_366(%arg0: tensor<64x512x1xi32>, %arg1: tensor<64x512x768xbf16>) -> tensor<2x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<2x768xbf16>
    %1 = "stablehlo.scatter"(%0, %arg0, %arg1) <{indices_are_sorted = false, scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [2], inserted_window_dims = [0], scatter_dims_to_operand_dims = [0], index_vector_dim = 2>, unique_indices = false}> ({
    ^bb0(%arg2: tensor<bf16>, %arg3: tensor<bf16>):
      %2 = stablehlo.add %arg2, %arg3 : tensor<bf16>
      stablehlo.return %2 : tensor<bf16>
    }) : (tensor<2x768xbf16>, tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<2x768xbf16>
    return %1 : tensor<2x768xbf16>
  }
  func.func private @_take_370(%arg0: tensor<64x512x1xi32>, %arg1: tensor<64x512x768xbf16>) -> tensor<512x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<512x768xbf16>
    %1 = "stablehlo.scatter"(%0, %arg0, %arg1) <{indices_are_sorted = false, scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [2], inserted_window_dims = [0], scatter_dims_to_operand_dims = [0], index_vector_dim = 2>, unique_indices = false}> ({
    ^bb0(%arg2: tensor<bf16>, %arg3: tensor<bf16>):
      %2 = stablehlo.add %arg2, %arg3 : tensor<bf16>
      stablehlo.return %2 : tensor<bf16>
    }) : (tensor<512x768xbf16>, tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<512x768xbf16>
    return %1 : tensor<512x768xbf16>
  }
  func.func private @_take_373(%arg0: tensor<64x512x1xi32>, %arg1: tensor<64x512x768xbf16>) -> tensor<30522x768xbf16> {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<bf16>
    %0 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<bf16>) -> tensor<30522x768xbf16>
    %1 = "stablehlo.scatter"(%0, %arg0, %arg1) <{indices_are_sorted = false, scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [2], inserted_window_dims = [0], scatter_dims_to_operand_dims = [0], index_vector_dim = 2>, unique_indices = false}> ({
    ^bb0(%arg2: tensor<bf16>, %arg3: tensor<bf16>):
      %2 = stablehlo.add %arg2, %arg3 : tensor<bf16>
      stablehlo.return %2 : tensor<bf16>
    }) : (tensor<30522x768xbf16>, tensor<64x512x1xi32>, tensor<64x512x768xbf16>) -> tensor<30522x768xbf16>
    return %1 : tensor<30522x768xbf16>
  }
  func.func private @clip(%arg0: tensor<i32>, %arg1: tensor<i32>, %arg2: tensor<i32>) -> tensor<i32> {
    %0 = stablehlo.convert %arg1 : tensor<i32>
    %1 = stablehlo.maximum %0, %arg0 : tensor<i32>
    %2 = stablehlo.convert %arg2 : tensor<i32>
    %3 = stablehlo.minimum %2, %1 : tensor<i32>
    return %3 : tensor<i32>
  }
  func.func private @_where_385(%arg0: tensor<i1>, %arg1: tensor<i32>, %arg2: tensor<i32>) -> tensor<i32> {
    %0 = stablehlo.select %arg0, %arg1, %arg2 : tensor<i1>, tensor<i32>
    return %0 : tensor<i32>
  }
}
